<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">
<meta name="baidu-site-verification" content="codeva-HZoIBm8yNp" />
<meta name="bytedance-verification-code" content="xa6iZeY+/XCOJvarHaDY" />








<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="sw," />










<meta name="description" content="Some background on the hidden features of this blog. Static site, progressive images, AMP, HTTP&#x2F;2, SSL...">
<meta property="og:type" content="article">
<meta property="og:title" content="SSL, HTTP&#x2F;2, Service Worker, Offline Mode? This blog has all of them">
<meta property="og:url" content="https://blog.feedscoin.com/my-setup-for-this-blog">
<meta property="og:site_name" content="逐流小站">
<meta property="og:description" content="Some background on the hidden features of this blog. Static site, progressive images, AMP, HTTP&#x2F;2, SSL...">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://blog.feedscoin.com/assets/images/posts/jmperez-filmstrip.png">
<meta property="og:image" content="https://blog.feedscoin.com/assets/images/posts/jmperezperez-lighthouse.png">
<meta property="article:published_time" content="2017-02-06T23:30:00.000Z">
<meta property="article:modified_time" content="2024-01-15T07:11:20.000Z">
<meta property="article:author" content="Laird Lau">
<meta property="article:tag" content="sw">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.feedscoin.com/assets/images/posts/jmperez-filmstrip.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://blog.feedscoin.com/my-setup-for-this-blog"/>





  <title>SSL, HTTP/2, Service Worker, Offline Mode? This blog has all of them | 逐流小站</title>
  





<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MW47YH6RH0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MW47YH6RH0');
</script>





<meta name="generator" content="Hexo 7.0.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">逐流小站</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">想回到那个能随便跳槽的年代</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            Sitemap
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/my-setup-for-this-blog">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">SSL, HTTP/2, Service Worker, Offline Mode? This blog has all of them</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-07T07:30:00+08:00">
                2017-02-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          
              <div class="post-description">
                  Some background on the hidden features of this blog. Static site, progressive images, AMP, HTTP/2, SSL...
              </div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      

        <p>I usually see myself spending more time migrating from one setup to another one than writing valuable content. After all, I consider my blog a playground where I try some concepts.</p>
<p>It is still <a target="_blank" rel="noopener" href="http://jlongster.com/Presenting-The-Most-Over-Engineered-Blog-Ever">not very over-engineered</a> and <a target="_blank" rel="noopener" href="https://github.com/JMPerez/jmperez.github.com">being open sourced and available on GitHub</a> I thought someone could benefit from it.</p>
<span id="more"></span>

<h2 id="Static-Site"><a href="#Static-Site" class="headerlink" title="Static Site"></a>Static Site</h2><p>The blog is a set of static pages. Before that it used to be a Wordpress site and eventually <a href="/migrating-wordpress-jekyll-github-pages/">I migrated to Jekyll and GitHub Pages</a>. This worked really well because I could take advantage of GitHub’s distributed storage to serve the assets, and there is nothing that can beat a static site in terms of performance, which I care about.</p>
<p>In October 2016 I migrated to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>. Hexo is fast, and the posts are written in the same Markdown format I like and I used with Jekyll, so moving to Hexo was really easy.</p>
<p>Migrating to Hexo was a bit of a trade-off. Now I need to generate the static site from my computer and then deploy the files, instead of just using the GitHub editor, which was handy to fix small typos. The advantage is that I can create plugins in Javascript (and understand and tweak existing ones) to customise the output, which is better overall.</p>
<h2 id="Progressive-Images"><a href="#Progressive-Images" class="headerlink" title="Progressive Images"></a>Progressive Images</h2><p>The few JPG images on this site are progressive JPGs, <a href="/ssim-jpeg-io/">generated using Jpeg.io</a>. Having a more custom technique to load images, like <a href="/medium-image-progressive-loading-placeholder/">Medium’s approach</a>, is overkill. Progressive JPGs start rendering soon, and as the browser downloads more of the file it shows a better version of the image. You can see an example on <a target="_blank" rel="noopener" href="https://www.webpagetest.org/result/170207_N3_1794c7ee69d5a1a3eb92842504f01a7b/">this WebPageTest run</a>.</p>
<p><a href="/assets/images/posts/jmperez-filmstrip.png"><img src="/assets/images/posts/jmperez-filmstrip.png" alt="Filmstrip for jmperezperez.com"></a></p>
<p>Something in my to-do list is to prevent <a target="_blank" rel="noopener" href="https://css-tricks.com/content-jumping-avoid/">content jumping</a> by using some <a target="_blank" rel="noopener" href="http://blog.learningspaces.io/flexible-cover-images-using-intrinsic-ratio/">intrinsic ratio placeholders</a> for the images, and lazy-load them.</p>
<h2 id="SSL-and-HTTP-2"><a href="#SSL-and-HTTP-2" class="headerlink" title="SSL and HTTP&#x2F;2"></a>SSL and HTTP&#x2F;2</h2><p>This site is served on HTTPS. I already talked about <a href="/github-pages-ssl-custom-domain/">how and why I migrated to SSL</a>. A good thing about using Cloudflare for SSL is that I also get HTTP&#x2F;2 support, so I can start investigating it a bit more. I would like to give Server Push a try though, but for that I would need to run my own server. Maybe some time in the future.</p>
<p>Finally, Cloudflare also allows me to set the browser cache expiration, increasing the short one that GitHub Pages set by default.</p>
<h2 id="Accelerated-Mobile-Pages-aka-AMP"><a href="#Accelerated-Mobile-Pages-aka-AMP" class="headerlink" title="Accelerated Mobile Pages (aka AMP)"></a>Accelerated Mobile Pages (aka AMP)</h2><p>I’m not a big fan of <a target="_blank" rel="noopener" href="https://www.ampproject.org/">Google’s AMP</a>, <a target="_blank" rel="noopener" href="https://instantarticles.fb.com/">Facebook’s Instant Articles</a> and <a target="_blank" rel="noopener" href="https://developer.apple.com/news-publisher/">Apple News</a>. I think developers can create experiences on the web with a good performance without having to resort to a subset of the language nor a specific markup for a proprietary crawler.</p>
<p>Still, I wanted to give AMP a try, so I now generate an AMP version of every post on build time. Does it have any impact in traffic? Well, not much yet. Only around 2% of the page views to this site are for AMP’d pages.</p>
<h2 id="Service-Worker-and-Offline-content"><a href="#Service-Worker-and-Offline-content" class="headerlink" title="Service Worker and Offline content"></a>Service Worker and Offline content</h2><p>The last addition to the site is a Service Worker which caches the main sections of this blog (home, projects, about) plus an offline page linking to those three. Additionally, if you visit a page it will be available when offline. I think it is a good trade-off.</p>
<p><a href="/sw.js">The implementation</a> is based on <a target="_blank" rel="noopener" href="https://serviceworke.rs/strategy-cache-and-update_service-worker_doc.html">the cache and update strategy</a> with a small variation. In my case I check the network, then the cache, and finally serve the <code>offline</code> page if no hit.</p>
<p>If you are thinking of making your site available when offline, be a good citizen. I have seen Service Workers that download all the posts from a blog. To be honest, this doesn’t do any good for your users. By doing so you might be killing their data plan or using precious space in their devices. If you still want to preload&#x2F;prefetch&#x2F;download content, do it wisely.</p>
<p>When browsing the App Store&#x2F;Play Store, the user has an indication of the size of the app, so they might choose not to download it when they are using roaming or tethering. On the web we don’t have something like this.</p>
<h2 id="Performance"><a href="#Performance" class="headerlink" title="Performance"></a>Performance</h2><p>I like talking about web performance so my own site has to be a good example of what I advocate for. I use <a target="_blank" rel="noopener" href="https://developers.google.com/speed/pagespeed/insights/?url=https://jmperezperez.com">PageSpeed Insights</a> to check the performance and usability on mobile (score &gt;&#x3D;99&#x2F;100 for most pages) and <a target="_blank" rel="noopener" href="https://developers.google.com/web/tools/lighthouse/">Lighthouse</a> (100&#x2F;100).</p>
<p><a href="/assets/images/posts/jmperezperez-lighthouse.png"><img src="/assets/images/posts/jmperezperez-lighthouse.png" alt="Screenshot from Lighthouse for jmperezperez.com"></a></p>
<p>I’m looking forward to more ideas that I can apply to this blog and then some real project at scale :)</p>

      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/sw/" rel="tag"># sw</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/Pandorabox-transparent-proxy/" rel="next" title="Pandorabox之透明代理">
                <i class="fa fa-chevron-left"></i> Pandorabox之透明代理
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/netease-music-api/" rel="prev" title="网易云音乐新API简述">
                网易云音乐新API简述 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">1451</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">71</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">889</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5358884258"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Static-Site"><span class="nav-number">1.</span> <span class="nav-text">Static Site</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Progressive-Images"><span class="nav-number">2.</span> <span class="nav-text">Progressive Images</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SSL-and-HTTP-2"><span class="nav-number">3.</span> <span class="nav-text">SSL and HTTP&#x2F;2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Accelerated-Mobile-Pages-aka-AMP"><span class="nav-number">4.</span> <span class="nav-text">Accelerated Mobile Pages (aka AMP)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Service-Worker-and-Offline-content"><span class="nav-number">5.</span> <span class="nav-text">Service Worker and Offline content</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Performance"><span class="nav-number">6.</span> <span class="nav-text">Performance</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Laird Lau</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
