<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="pwa," />










<meta name="description" content="Taking advantage of PWA functionality on your site is easy. You don&#39;t need to go all-in using all the features. Just take what is needed for your use case.">
<meta property="og:type" content="article">
<meta property="og:title" content="The different shades of Progressive Web Apps">
<meta property="og:url" content="https://blog.feedscoin.com/shades-of-pwa">
<meta property="og:site_name" content="逐流小站">
<meta property="og:description" content="Taking advantage of PWA functionality on your site is easy. You don&#39;t need to go all-in using all the features. Just take what is needed for your use case.">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2018-11-02T05:44:00.000Z">
<meta property="article:modified_time" content="2024-01-15T07:11:20.000Z">
<meta property="article:author" content="Laird Lau">
<meta property="article:tag" content="pwa">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://blog.feedscoin.com/shades-of-pwa"/>





  <title>The different shades of Progressive Web Apps | 逐流小站</title>
  





<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MW47YH6RH0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MW47YH6RH0');
</script>





<meta name="generator" content="Hexo 7.0.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">逐流小站</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">想回到那个能随便跳槽的年代</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            Sitemap
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/shades-of-pwa">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">The different shades of Progressive Web Apps</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-11-02T13:44:00+08:00">
                2018-11-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          
              <div class="post-description">
                  Taking advantage of PWA functionality on your site is easy. You don't need to go all-in using all the features. Just take what is needed for your use case.
              </div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      

        <p>Implementing a PWA or adapting an existing site to “become a PWA” can be daunting. There are many new technologies to learn about, but you don’t need to use all of them to improve your website performance and user experience greatly.</p>
<div style="position:relative;padding-bottom:66.6666%;margin-bottom:1rem">
<img
    loading="lazy"
    style="max-width:100%; border: 0;position:absolute;top:0;left:0"
    sizes="(max-width: 768px) 100vw, 684px"
    srcset="https://res.cloudinary.com/jmperez/image/upload/w_auto:100:400,f_auto/v1541172389/shades-of-pwa/header.jpg 400w, https://res.cloudinary.com/jmperez/image/upload/w_auto:100:800,f_auto/v1541172389/shades-of-pwa/header.jpg 800w, https://res.cloudinary.com/jmperez/image/upload/w_auto:100:1200,f_auto/v1541172389/shades-of-pwa/header.jpg 1200w, https://res.cloudinary.com/jmperez/image/upload/w_auto:100:1400,f_auto/v1541172389/shades-of-pwa/header.jpg 1400w"
    src="https://res.cloudinary.com/jmperez/image/upload/w_auto:100:684,f_auto/v1541172389/shades-of-pwa/header.jpg"
    alt="" />
</div>

<p>On this post I will describe several use cases where Progressive Web Apps (PWA) can be useful to make your website achieve better performance and be more reliable.</p>
<span id="more"></span>

<h2 id="What-are-Progressive-Web-Apps"><a href="#What-are-Progressive-Web-Apps" class="headerlink" title="What are Progressive Web Apps"></a>What are Progressive Web Apps</h2><p>If you are a web developer you have probably heard about Progressive Web Apps (PWA). Web sites that load quick, are reliable, feel smooth and take advantage of modern APIs.</p>
<p>There is a lot of buzz about them, partly because Google coined the term and has been leading the implementation of the bits and pieces that composed it.</p>
<p>Implementing a PWA or adapting an existing site to “become a PWA” looks like a big endeavor. The same powerful marketing that has made PWA known in the developer community can be a blessing and a curse. Developers might get the wrong idea that either they use everything and make installable offline-capable push notifications-enabled websites, or they bail out. After all, <strong>PWA is just a way to coin a set of recent browser APIs and techniques, not all or nothing</strong>.</p>
<p>Every website’s use case is different and that is alright. If installing your website as an app is not something a user would do for your site, you don’t need to build that capability. <strong>You can still take advantage of some of the technologies powering PWAs</strong>. The main requirement is that your site runs on HTTPS and, in most cases, creating a ServiceWorker, which is not more than a Javascript file.</p>
<p>I want to describe some of the typical scenarios where you can applied elements from PWAs.</p>
<h2 id="Common-Use-Cases-to-Apply-Service-Workers-and-other-PWA-related-functionality"><a href="#Common-Use-Cases-to-Apply-Service-Workers-and-other-PWA-related-functionality" class="headerlink" title="Common Use Cases to Apply Service Workers and other PWA-related functionality"></a>Common Use Cases to Apply Service Workers and other PWA-related functionality</h2><h3 id="Offline-mode-and-pre-caching"><a href="#Offline-mode-and-pre-caching" class="headerlink" title="Offline mode and pre-caching"></a>Offline mode and pre-caching</h3><p>To get your site to load without a connection, the user needs to visit it and the site needs to run a Service Worker (SW)that will make content available offline. The SW can follow different strategies (eg serving cache first, making a network request first, etc). You can find strategies on <a target="_blank" rel="noopener" href="https://jakearchibald.com/2014/offline-cookbook/">Jake Archibald’s Offline Cookbook</a> and <a target="_blank" rel="noopener" href="https://serviceworke.rs/">serviceworke.rs</a>.</p>
<div style="position:relative;padding-bottom:49%;margin-bottom:1rem">
<img
    style="max-width:100%; border: 0; position: absolute; top: 0; left: 0"
    sizes="(max-width: 768px) 100vw, 684px"
    srcset="https://res.cloudinary.com/jmperez/image/upload/w_auto:100:400,f_auto/v1541172749/shades-of-pwa/stale-while-revalidate-sw.png 400w, https://res.cloudinary.com/jmperez/image/upload/w_auto:100:800,f_auto/v1541172749/shades-of-pwa/stale-while-revalidate-sw.png 800w, https://res.cloudinary.com/jmperez/image/upload/w_auto:100:1200,f_auto/v1541172749/shades-of-pwa/stale-while-revalidate-sw.png 1200w, https://res.cloudinary.com/jmperez/image/upload/w_auto:100:1400,f_auto/v1541172749/shades-of-pwa/stale-while-revalidate-sw.png 1400w"
    src="https://res.cloudinary.com/jmperez/image/upload/w_auto:100:684,f_auto/v1541172749/shades-of-pwa/stale-while-revalidate-sw.png"
    alt="Stale-while-revalidate” strategy, of the many explained on Jake Archibald’s Offline Cookbook" />
</div>

<p><small class="caption">“Stale-while-revalidate” strategy, of the many explained on <a target="_blank" rel="noopener" href="https://jakearchibald.com/2014/offline-cookbook/">Jake Archibald’s Offline Cookbook</a>. If there’s a cached version available, use it, but fetch an update for next time.</small></p>
<p>The strategies that check the cache first can be used to fetch and pre-cache top-level navigation routes and other critical resources. Thus, the user gets a faster loading and rendering experience as they click around the PWA.</p>
<p>Offline support is something that can be added pretty much to any site, big or small. I run <a target="_blank" rel="noopener" href="https://jmperezperez.com/sw.js">a simple SW</a> <a target="_blank" rel="noopener" href="https://jmperezperez.com/">on my blog</a> to download the main sections and the posts that the user reads.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// the cache version gets updated every time there is a new deployment</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CACHE_VERSION</span> = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CURRENT_CACHE</span> = <span class="string">`main-<span class="subst">$&#123;CACHE_VERSION&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// these are the routes we are going to cache for offline support</span></span><br><span class="line"><span class="keyword">const</span> cacheFiles = [<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;/about-me/&#x27;</span>, <span class="string">&#x27;/projects/&#x27;</span>, <span class="string">&#x27;/offline/&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// on activation we clean up the previously registered service workers</span></span><br><span class="line">self.<span class="title function_">addEventListener</span>(<span class="string">&#x27;activate&#x27;</span>, <span class="function"><span class="params">evt</span> =&gt;</span></span><br><span class="line">  evt.<span class="title function_">waitUntil</span>(</span><br><span class="line">    caches.<span class="title function_">keys</span>().<span class="title function_">then</span>(<span class="function"><span class="params">cacheNames</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>(</span><br><span class="line">        cacheNames.<span class="title function_">map</span>(<span class="function"><span class="params">cacheName</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (cacheName !== <span class="variable constant_">CURRENT_CACHE</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> caches.<span class="title function_">delete</span>(cacheName);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">      );</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// on install we download the routes we want to cache for offline</span></span><br><span class="line">self.<span class="title function_">addEventListener</span>(<span class="string">&#x27;install&#x27;</span>, <span class="function"><span class="params">evt</span> =&gt;</span></span><br><span class="line">  evt.<span class="title function_">waitUntil</span>(</span><br><span class="line">    caches.<span class="title function_">open</span>(<span class="variable constant_">CURRENT_CACHE</span>).<span class="title function_">then</span>(<span class="function"><span class="params">cache</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> cache.<span class="title function_">addAll</span>(cacheFiles);</span><br><span class="line">    &#125;)</span><br><span class="line">  )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// fetch the resource from the network</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">fromNetwork</span> = (<span class="params">request, timeout</span>) =&gt;</span><br><span class="line">  <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">fulfill, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> timeoutId = <span class="built_in">setTimeout</span>(reject, timeout);</span><br><span class="line">    <span class="title function_">fetch</span>(request).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">clearTimeout</span>(timeoutId);</span><br><span class="line">      <span class="title function_">fulfill</span>(response);</span><br><span class="line">      <span class="title function_">update</span>(request);</span><br><span class="line">    &#125;, reject);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// fetch the resource from the browser cache</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">fromCache</span> = request =&gt;</span><br><span class="line">  caches</span><br><span class="line">    .<span class="title function_">open</span>(<span class="variable constant_">CURRENT_CACHE</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">cache</span> =&gt;</span></span><br><span class="line">      cache</span><br><span class="line">        .<span class="title function_">match</span>(request)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">matching</span> =&gt;</span> matching || cache.<span class="title function_">match</span>(<span class="string">&#x27;/offline/&#x27;</span>))</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line"><span class="comment">// cache the current page to make it available for offline</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">update</span> = request =&gt;</span><br><span class="line">  caches</span><br><span class="line">    .<span class="title function_">open</span>(<span class="variable constant_">CURRENT_CACHE</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">cache</span> =&gt;</span></span><br><span class="line">      <span class="title function_">fetch</span>(request).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> cache.<span class="title function_">put</span>(request, response))</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line"><span class="comment">// general strategy when making a request (eg if online try to fetch it</span></span><br><span class="line"><span class="comment">// from the network with a timeout, if something fails serve from cache)</span></span><br><span class="line">self.<span class="title function_">addEventListener</span>(<span class="string">&#x27;fetch&#x27;</span>, <span class="function"><span class="params">evt</span> =&gt;</span> &#123;</span><br><span class="line">  evt.<span class="title function_">respondWith</span>(</span><br><span class="line">    <span class="title function_">fromNetwork</span>(evt.<span class="property">request</span>, <span class="number">10000</span>).<span class="title function_">catch</span>(<span class="function">() =&gt;</span> <span class="title function_">fromCache</span>(evt.<span class="property">request</span>))</span><br><span class="line">  );</span><br><span class="line">  evt.<span class="title function_">waitUntil</span>(<span class="title function_">update</span>(evt.<span class="property">request</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>With great power comes great responsibility. Do not use SWs to abuse the user’s data connection, downloading content they will never need, just in case.</p>
<h3 id="Service-Workers-for-Multi-page-Applications"><a href="#Service-Workers-for-Multi-page-Applications" class="headerlink" title="Service Workers for Multi-page Applications"></a>Service Workers for Multi-page Applications</h3><p>In a multi-page app (MPA), every route that a user navigates to triggers a full request of the page, along with associated scripts and styles needed, to the server.</p>
<p>A good example is <a target="_blank" rel="noopener" href="https://ele.me/">ele.me</a>, the biggest food ordering and delivery company in mainland China. They used a SW to precache the main routes from their site, and implemented skeleton screens that are immediately shown while loading routes that aren’t cached.</p>
<div>
<img
src="https://res.cloudinary.com/jmperez/image/upload/w_auto:100:350,f_auto,c_scale,w_600/v1541171672/shades-of-pwa/ele-me-skeleton-page.png"
sizes="(max-width: 768px) 50vw, 350px" alt="Processing a picture through Primitive using 10 shapes" style="width:48%;float:left;margin-right:2%;padding-bottom:10px" />
<img
src="https://res.cloudinary.com/jmperez/image/upload/w_auto:100:350,f_auto,c_scale,w_600/v1541171587/shades-of-pwa/ele-me-full-load.png"
sizes="(max-width: 768px) 50vw, 350px" alt="Processing a picturethrough Primitive using 100 shapes" style="width:48%;float:left;margin-right:2%;padding-bottom:10px" />
</div>

<p>You can read more about their approach on <a target="_blank" rel="noopener" href="https://developers.google.com/web/showcase/2017/eleme">Google Developers site</a> and <a target="_blank" rel="noopener" href="https://medium.com/elemefe/upgrading-ele-me-to-progressive-web-app-2a446832e509">this in-depth post</a>.</p>
<h3 id="Bridging-the-gap-between-SPAs-and-server-side-rendered-sites"><a href="#Bridging-the-gap-between-SPAs-and-server-side-rendered-sites" class="headerlink" title="Bridging the gap between SPAs and server-side rendered sites"></a>Bridging the gap between SPAs and server-side rendered sites</h3><p>Web development has gone through different stages</p>
<ol>
<li>Old sites used to be server-side rendered. Only minor interactions used Javascript in the client. Every page navigation meant a full page load.</li>
<li>Then we started creating more complex web experiences and moved all the logic (and templates) to client-side land. Everything was amazing as long as you waited a bit while staring at a blank page whose main purpose was to load a large JS bundle.</li>
<li>We realized that maybe we needed a hybrid solution. First request server-side rendered, then the rest happening client-side.</li>
</ol>
<p><strong>Reaching the third step involves doing server-side rendering.</strong> If you don’t want to duplicate templates and logic, the usual solution is to use NodeJS on the server. This is fun for web developers because we get to use the same language both on server and browser. In medium and large web projects it means rewriting existing working code from python&#x2F;java&#x2F;PHP&#x2F;others to Javascript, and the typical nuances of adopting something different from the existing solution.</p>
<p>Server-side rendered sites have also a largely underestimated drawback. <strong>Putting content early on the screen is one thing. Making the content interactive is another.</strong> A page that renders quickly but then doesn’t respond to click&#x2F;touch for seconds, while loads and executes the JS behemoth, results in frustration.</p>
<p>In web dev terms we are improving the <a target="_blank" rel="noopener" href="https://developers.google.com/web/tools/lighthouse/audits/first-meaningful-paint">First Meaningful Paint</a> (‘FMP’), but we aren’t making any improvement in the <a target="_blank" rel="noopener" href="https://developers.google.com/web/tools/lighthouse/audits/time-to-interactive">Time to Interactive</a> (‘TTI’).</p>
<p>This short version of Addy Osmani’s “The cost of JavaScript“ explains it very well:</p>
<div class="videoWrapper">
    <iframe width="1764" height="1080" src="https://www.youtube.com/embed/qUFA1pAMfj4" frameborder="0" allowfullscreen loading="lazy"></iframe>
</div>

<p><small class="caption">“<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=qUFA1pAMfj4">The cost of JavaScript</a>” by Addy Osmani. If you like it, there is also <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=63I-mEuSvGA">a longer version of the talk.</small></p>
<p>Paul Lewis also described the situation in his post “<a target="_blank" rel="noopener" href="https://aerotwist.com/blog/when-everything-is-important-nothing-is/">When everything is important nothing is</a>”, and describes it as the <em>Uncanny Valley.</em></p>
<p><img
    style="max-width:100%; border: 0"
    sizes="(max-width: 768px) 100vw, 684px"
    srcset="https://res.cloudinary.com/jmperez/image/upload/w_auto:100:400,f_auto/v1541171412/shades-of-pwa/uncanny-valley.jpg 400w, https://res.cloudinary.com/jmperez/image/upload/w_auto:100:800,f_auto/v1541171412/shades-of-pwa/uncanny-valley.jpg 800w, https://res.cloudinary.com/jmperez/image/upload/w_auto:100:1200,f_auto/v1541171412/shades-of-pwa/uncanny-valley.jpg 1200w, https://res.cloudinary.com/jmperez/image/upload/w_auto:100:1400,f_auto/v1541171412/shades-of-pwa/uncanny-valley.jpg 1400w"
    src="https://res.cloudinary.com/jmperez/image/upload/w_auto:100:684,f_auto/v1541171412/shades-of-pwa/uncanny-valley.jpg"
    alt="Spotify web player shows an offline page when there is no internet connection" /><br><small class="caption">Rendering your app server-side. An image from “<a target="_blank" rel="noopener" href="https://aerotwist.com/blog/when-everything-is-important-nothing-is/">When everything is important nothing is</a>”.</small></p>
<p>I have seen many cases when server-side rendering was proposed as the first step to improve the performance in a SPA. This left off the table ideas like bundle-splitting, which would have likely reduced both FMP and TTI.</p>
<blockquote>
<p>[…] <strong>you should avoid SSR if you don’t need it.</strong> Most modern web apps require sophisticated interaction with the UI that has to be driven by non-trivial amounts of JavaScript. If you need to write all of that JS anyway, and you <em>don’t</em> need the first page load benefits that SSR gives you, you’ll be better off just building a <a target="_blank" rel="noopener" href="https://developers.google.com/web/fundamentals/architecture/app-shell">static app shell</a> and avoiding the headaches of client-server code reuse, data re-hydration, and dynamic content cache invalidation. — <a target="_blank" rel="noopener" href="https://blog.usejournal.com/when-should-i-server-side-render-c2a383ff2d0f">When should I Server-Side Render?</a> by <a target="_blank" rel="noopener" href="https://blog.usejournal.com/@mbleigh">Michael Bleigh</a></p>
</blockquote>
<p>Single Page Applications that are not server-side rendered can take great advantage from using Service Workers. In most cases the browser requests some data and injects it in a JS template or component. This means that the browser can cache the JS code and the data independently.</p>
<p>The site can then follow different strategies. For instance, it can load immediately with stale data, similar to what usually happens with native apps. It can also decide to render a skeleton while the data is fetched. In any case, it makes an approach like <a target="_blank" rel="noopener" href="https://developers.google.com/web/fundamentals/performance/prpl-pattern/">PRPL</a>, easy to implement.</p>
<h3 id="Installable-Website"><a href="#Installable-Website" class="headerlink" title="Installable Website"></a>Installable Website</h3><p>You might want to make your website installable, close to what everyone knows as an “app”. For this you don’t need many to use many capabilities from the web. As long as your site runs on HTTPS you just need a web manifest, an icon and a ServiceWorker. You can find documentation on <a target="_blank" rel="noopener" href="https://developers.google.com/web/fundamentals/app-install-banners/">Google’s Developer site</a> and <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/Apps/Progressive/Installable_PWAs">MDN</a>.</p>
<p>Your site doesn’t need to be fully functional offline to make it installable. Take for instance Spotify’s Progressive Web App.</p>
<div class="videoWrapper">
    <iframe width="560" height="315" src="https://www.youtube.com/embed/EvcjSldzQ1E" frameborder="0" allowfullscreen loading="lazy"></iframe>
</div>

<p><small class="caption">Spotify’s Web Player works as an installable PWA.</small></p>
<p>As you see, the PWA is installable, yet it doesn’t have support for offline navigation nor playback. When there is no connection, the PWA shows this custom page:</p>
<p><img
    style="max-width:100%; border: 0"
    sizes="(max-width: 768px) 100vw, 684px"
    srcset="https://res.cloudinary.com/jmperez/image/upload/w_auto:100:400,f_auto/v1541171689/shades-of-pwa/spotify-offline.png 400w, https://res.cloudinary.com/jmperez/image/upload/w_auto:100:800,f_auto/v1541171689/shades-of-pwa/spotify-offline.png 800w, https://res.cloudinary.com/jmperez/image/upload/w_auto:100:1200,f_auto/v1541171689/shades-of-pwa/spotify-offline.png 1200w, https://res.cloudinary.com/jmperez/image/upload/w_auto:100:1400,f_auto/v1541171689/shades-of-pwa/spotify-offline.png 1400w"
    src="https://res.cloudinary.com/jmperez/image/upload/w_auto:100:684,f_auto/v1541171689/shades-of-pwa/spotify-offline.png"
    alt="Spotify web player shows an offline page when there is no internet connection" /></p>
<p>Installable PWAs are not limited to mobile. They are already supported on <a target="_blank" rel="noopener" href="https://developers.google.com/web/progressive-web-apps/desktop">ChromeOS, Windows and Linux</a>, and pretty soon on Mac too (Chrome 72+).</p>
<h4 id="More-features-enabled-by-Service-Workers"><a href="#More-features-enabled-by-Service-Workers" class="headerlink" title="More features enabled by Service Workers"></a>More features enabled by Service Workers</h4><p>I have only talked about some use cases for ServiceWorkers and other elements of PWAs, but there are more. Browsers can show <a target="_blank" rel="noopener" href="https://developers.google.com/web/fundamentals/push-notifications/">push notifications</a> after the user has enabled it for a certain site, and the push notifications are delivered even when the site is not opened. This makes it ideal for reengage with users without having to wait for them to visit your site again.</p>
<p>You can also use <a target="_blank" rel="noopener" href="https://developers.google.com/web/updates/2015/12/background-sync">background sync</a>, ideally for schedule data sending beyond the life of the page. Think of uploading pictures or sending chat messages even after the user leaves the page.</p>
<h3 id="More-Resources"><a href="#More-Resources" class="headerlink" title="More Resources"></a>More Resources</h3><p>I love reading about real sites that have adopted PWAs and have shared their findings. I particularly like <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=aCMbSyngXB4">Addy Osmani’s talk “Production Progressive Web Apps With JavaScript Frameworks”</a>, showcasing some case studies from large web sites that have been integrating these technologies to improve their key metrics.</p>
<div class="videoWrapper">
    <iframe width="1764" height="1080" src="https://www.youtube.com/embed/aCMbSyngXB4" frameborder="0" allowfullscreen loading="lazy"></iframe>
</div>

<p>They are good examples to demonstrate that you don’t need to re-architecture an existing site to use PWA goodness, and that you can apply some of these concepts and see improvements in perceived performance very quickly.</p>

      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/pwa/" rel="tag"># pwa</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/setup-nginx-php-on-windows/" rel="next" title="Windows 下手动搭建 PHP + Nginx/Apache 开发环境">
                <i class="fa fa-chevron-left"></i> Windows 下手动搭建 PHP + Nginx/Apache 开发环境
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018-11-03-the-big-questions-summary/" rel="prev" title="《大问题-简明哲学导论》读书笔记">
                《大问题-简明哲学导论》读书笔记 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">1451</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">71</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">889</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5358884258"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#What-are-Progressive-Web-Apps"><span class="nav-number">1.</span> <span class="nav-text">What are Progressive Web Apps</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Common-Use-Cases-to-Apply-Service-Workers-and-other-PWA-related-functionality"><span class="nav-number">2.</span> <span class="nav-text">Common Use Cases to Apply Service Workers and other PWA-related functionality</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Offline-mode-and-pre-caching"><span class="nav-number">2.1.</span> <span class="nav-text">Offline mode and pre-caching</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Service-Workers-for-Multi-page-Applications"><span class="nav-number">2.2.</span> <span class="nav-text">Service Workers for Multi-page Applications</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bridging-the-gap-between-SPAs-and-server-side-rendered-sites"><span class="nav-number">2.3.</span> <span class="nav-text">Bridging the gap between SPAs and server-side rendered sites</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Installable-Website"><span class="nav-number">2.4.</span> <span class="nav-text">Installable Website</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#More-features-enabled-by-Service-Workers"><span class="nav-number">2.4.1.</span> <span class="nav-text">More features enabled by Service Workers</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#More-Resources"><span class="nav-number">2.5.</span> <span class="nav-text">More Resources</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Laird Lau</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
