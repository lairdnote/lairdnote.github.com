<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Liunx Python Rust Goalng DevOPS" />










<meta name="description" content="ä¸ªäººéšæƒ³ï¼Œçå­çš„ä¸–ç•Œ">
<meta property="og:type" content="website">
<meta property="og:title" content="é€æµå°ç«™">
<meta property="og:url" content="https://blog.feedscoin.com/page/21/index.html">
<meta property="og:site_name" content="é€æµå°ç«™">
<meta property="og:description" content="ä¸ªäººéšæƒ³ï¼Œçå­çš„ä¸–ç•Œ">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Laird Lau">
<meta property="article:tag" content="Liunx Python Rust Goalng DevOPS">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://blog.feedscoin.com/page/21/"/>





  <title>é€æµå°ç«™</title>
  





<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MW47YH6RH0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MW47YH6RH0');
</script>





<meta name="generator" content="Hexo 7.0.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">é€æµå°ç«™</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">æƒ³å›åˆ°é‚£ä¸ªèƒ½éšä¾¿è·³æ§½çš„å¹´ä»£</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            Sitemap
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/post/7b1778ee.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/7b1778ee.html" itemprop="url">å‡çº§ IOS 14 çš„ä¸€äº›å‘</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-19T15:37:23+08:00">
                2020-09-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>IOS 14 æ­£å¼ç‰ˆå·²ç»å‘å¸ƒå·®ä¸å¤šä¸€ä¸ªæ˜ŸæœŸäº†ï¼Œä¹Ÿçœ‹åˆ°ç¤¾åŒºä¸å°‘äººå¼€å§‹è®¨è®ºæ–°ç‰¹æ€§ï¼Œæˆ‘å½“ç„¶ä¹Ÿè¦è·Ÿä¸Šè„šæ­¥ï¼Œäºæ˜¯ä¹Ÿå¼€å§‹æŠŠæˆ‘çš„ iPhone å’Œ iPad æ›´æ–°äº†ï¼Œä½†è¿™è¿‡ç¨‹ä¸­å´æ˜¯è¸©äº†ä¸å°‘çš„å‘ï¼Œå…ˆè®°å½•ä¸‹æ¥ï¼Œè®©åæ¥è€…å°‘èŠ±ä¸€äº›æ—¶é—´ã€‚</p>
<h2 id="å…ˆè¯´ç»“è®º"><a href="#å…ˆè¯´ç»“è®º" class="headerlink" title="å…ˆè¯´ç»“è®º"></a>å…ˆè¯´ç»“è®º</h2><p>æˆ‘æœ€ç»ˆæˆåŠŸæ›´æ–°çš„è¿‡ç¨‹æ˜¯ï¼š</p>
<ol>
<li>åœ¨ Windows ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ iTunes</li>
<li>åœ¨ <a target="_blank" rel="noopener" href="https://www.iplaysoft.com/item/ios-ipsw-download">å¼‚æ¬¡å…ƒ</a> ä¸‹è½½ IOS 14 å›ºä»¶</li>
<li>æ‰“å¼€ <code>Service.msc</code> ï¼Œå°† <code>Remote Desktop Services</code> è®¾ç½®ä¸ºå¯ç”¨å’Œè‡ªåŠ¨</li>
<li>Windows è¿æ¥æ‰‹æœºçƒ­ç‚¹ï¼Œä¸è¦è¿æ¥å®½å¸¦ç½‘ç»œ</li>
<li>åœ¨ iTunes è¿æ¥æ‰‹æœºï¼ŒæŒ‰ä½ Shift ç‚¹å‡»æ›´æ–°ï¼Œé€‰æ‹©å›ºä»¶ï¼Œç­‰å¾…æ›´æ–°</li>
</ol>
<p>PSï¼šå…ˆå¤‡ä»½å¥½æ‰‹æœºæ•°æ®ï¼Œä»¥é˜²ä¸‡ä¸€ï¼</p>
<h2 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h2><p>æ”¶åˆ°æ¨é€çš„å½“å¤©æ™šä¸Šç¡è§‰å‰æˆ‘å°±åœ¨æ‰‹æœºå’Œå¹³æ¿ä¸Šéƒ½ç‚¹äº†æ›´æ–°ï¼Œç„¶è€Œç­‰æˆ‘æ—©ä¸Šèµ·åºŠæ‰“ç®—æ„‰å¿«åœ°ä½“éªŒæ–°ç³»ç»Ÿæ—¶ï¼Œå´å‘ç°æ²¡æœ‰æ›´æ–°ï¼Œè¿›å…¥æ›´æ–°ç•Œé¢æ‰å‘ç°ä¸‹è½½äº†ä¸åˆ°ä¸€åŠï¼Œæ˜¾ç¤ºã€Œæ­£åœ¨é¢„ä¼°å‰©ä½™æ—¶é—´ã€ï¼Œç¬¬äºŒå¤©æ™šä¸Šå†è¯•äº†ä¸€ä¸‹ï¼Œç»“æœè¿˜æ˜¯ä¸€æ ·ã€‚</p>
<p>æ—¢ç„¶åœ¨æ‰‹æœºä¸Šæ›´æ–°ä¸äº†ï¼Œé‚£å°±åœ¨ç”µè„‘æ›´æ–°ï¼Œäºæ˜¯è¿æ¥åˆ° Macï¼Œç‚¹å‡»æ›´æ–°ï¼Œåˆ°æœ€åä¸€æ­¥å‡ºç°ã€ŒiPad â€œ4Ark çš„ iPadâ€ çš„è½¯ä»¶ä¸‹è½½æ—¶è¢«æŸåï¼Œæ–­å¼€åå†æ¬¡è¿æ¥â€¦ã€ï¼Œæ¢äº† Windows ä¹Ÿæ˜¯ä¸€æ ·çš„é—®é¢˜ã€‚</p>
<p>äºæ˜¯æˆ‘è‡ªå·±åœ¨ç½‘ä¸Šæ‰¾ IOS 14 çš„å›ºä»¶ï¼Œæœ€åˆæˆ‘æ‰“ç®—åœ¨å®˜æ–¹ï¼Œæƒ³ç€ç³»ç»Ÿå›ºä»¶è¿˜æ˜¯å®˜æ–¹çš„æ¯”è¾ƒå®‰å…¨ï¼Œç»“æœå‘ç°æœ€æ–°ç‰ˆæœ¬è¿˜æ˜¯åœç•™åœ¨ IOS 13.7ï¼Œäºæ˜¯åœ¨ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒé è°±çš„ <a target="_blank" rel="noopener" href="https://www.iplaysoft.com/item/ios-ipsw-download">å¼‚æ¬¡å…ƒ</a> é‡ŒæŠŠ IOS å’Œ iPadOs å›ºä»¶ä¸‹è½½å›æ¥ã€‚</p>
<p>å› ä¸ºæˆ‘æ˜¯åœ¨ Windows ä¸‹è½½çš„ï¼Œæ‰€ä»¥ä¹Ÿå°±åœ¨ Windows æœ€æ–°ç‰ˆçš„ iTunes ä¸Šé¢æ›´æ–°ï¼Œè¿æ¥ä¸Šæ‰‹æœºï¼ŒæŒ‰ä½ Shift ç‚¹å‡»æ›´æ–°ï¼Œé€‰æ‹©å›ºä»¶ï¼Œç»“æœå‡ºç°ã€Œæœªèƒ½æ›´æ–° iPhoneï¼Œå‘ç”ŸæœªçŸ¥é”™è¯¯ 53ã€ï¼Œåœ¨ <a target="_blank" rel="noopener" href="https://discussionschinese.apple.com/thread/251504194">è¿™é‡Œ</a> æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆï¼Œä¸»è¦æ˜¯ç”µè„‘ä¸Šçš„ç½‘ç»œä¸è¦è¿æ¥å®½å¸¦ï¼Œè€Œæ˜¯è¿æ¥ç§»åŠ¨ç½‘ç»œçš„çƒ­ç‚¹ã€‚</p>
<p>ç»“æœåœ¨æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œä¸€ç›´åœç•™åœ¨ã€Œæ­£åœ¨å‡†å¤‡ iPhone ä»¥è¿›è¡Œè½¯ä»¶æ›´æ–°ã€åå‡ åˆ†é’Ÿï¼Œæ ¹æ®ä»¥å¾€çš„æŠ˜è…¾ç»éªŒï¼Œå‡†å¤‡å·¥ä½œè¶…è¿‡ååˆ†é’ŸåŸºæœ¬å°±æ˜¯æœ‰é—®é¢˜çš„äº†ï¼Œäºæ˜¯æœç„¶åœ¨ <a target="_blank" rel="noopener" href="https://hcwang.pixnet.net/blog/post/40515550">è¿™é‡Œ</a> æ‰¾åˆ°äº†è§£å†³æ–¹æ¡ˆï¼Œä¸»è¦å°±æ˜¯ï¼šæ‰“å¼€ <code>Service.msc</code> ï¼Œå°† <code>Remote Desktop Services</code> è®¾ç½®ä¸ºå¯ç”¨å’Œè‡ªåŠ¨ï¼Œé‡å¯ iTunesï¼Œé‡æ–°è¿æ¥æ‰‹æœºï¼Œè¿™æ—¶å€™ç»ˆäºå¯ä»¥æ›´æ–°äº†ã€‚</p>
<h2 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h2><p>å‰ä¸¤å¤©è¿˜çœ‹åˆ°ç¤¾åŒºé‡Œçš„äººéƒ½æ˜¯æ‰‹æœºä¸Šç›´æ¥å‡çº§çš„ï¼Œä¸€ç¡é†’å°±å¥½äº†ï¼Œæ€ä¹ˆåˆ°æˆ‘è¿™é‡Œå°±ä¸€å¤§å †é—®é¢˜ ğŸ˜©</p>
<p>ä½†ä¸ç®¡æ€ä¹ˆè¯´ï¼Œè¿™äº›é—®é¢˜æˆ‘è‚¯å®šä¸æ˜¯ç¬¬ä¸€ä¸ªï¼Œæ›´ä¸å¯èƒ½æ˜¯æœ€åä¸€ä¸ªï¼Œæœ¬æ–‡å°±æ˜¯ä¸ºäº†è®©å¤§å®¶ä¸è¦å†æµªè´¹æ—¶é—´ã€‚</p>
<p>æ¯•ç«Ÿï¼Œå‘¨æœ«ç¾å¥½æ—¶å…‰ï¼Œä¸èƒ½ç™½ç™½æµªè´¹å˜›ã€‚</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/09/08/2020/airpods-2-are-great/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/08/2020/airpods-2-are-great/" itemprop="url">AirPods 2 åˆ°æ‰‹åŠä¸ªæœˆï¼Œæˆ‘çš„å®é™…ä½“éªŒå¦‚ä½•ï¼Ÿ</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-08T19:51:00+08:00">
                2020-09-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%9A%8F%E7%AC%94/" itemprop="url" rel="index">
                    <span itemprop="name">éšç¬”</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>å…ˆè¯´å¥½ï¼Œè¿™ä¸æ˜¯å®‰åˆ©æ–‡ï¼šæˆ‘æ²¡æœ‰æ¨èä»»ä½•äººè´­ä¹° AirPods 2 çš„æ„æ€ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« ä»…æ—¨åœ¨å‘å„ä½åˆ†äº«æˆ‘å…¥æ‰‹ AirPods 2 åçš„<strong>çœŸå®ä½¿ç”¨ä½“éªŒ</strong>ï¼Œæœ‰åæ§½ä¹Ÿæœ‰çœŸé¦™ã€‚</p>
<p>æ•°ç åœˆæœ‰ä¸ªå¾ˆå¥‡æ€ªçš„ç°è±¡ï¼Œæ€»æœ‰é‚£ä¹ˆäº›äººæŠ¢ç€å½“ã€Œå‚å•†å­å­ã€ã€Œç²¾ç¥è‚¡ä¸œã€ï¼Œæ‰¹è¯„ä¸€å¥äº§å“å¥½åƒè¦äº†ä»–ä»¬çš„å‘½ä¼¼çš„ï¼ˆæ›´å¥½ç¬‘çš„æ˜¯è¿˜ä¼šäº’ç›¸æ‰£å¸½å­ï¼‰ï¼Œå¯¹æ­¤æˆ‘å®åœ¨æ˜¯éš¾ä»¥ç†è§£ã€‚åæ­£æˆ‘å¯¹æ•°ç äº§å“çš„æ€åº¦ä¸€ç›´éƒ½æ˜¯ï¼šå–œæ¬¢å°±ä¹°ï¼Œå¼€å¿ƒå°±å¥½ã€‚</p>
<p>å¦‚æœä½ æ°å·§åœ¨è€ƒè™‘æ˜¯å¦è¦å…¥æ‰‹ AirPods 2ï¼Œå¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2020/09/08/2020/airpods-2-are-great/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/09/08/2020/dont-buy-a-gaming-laptop-for-college/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/08/2020/dont-buy-a-gaming-laptop-for-college/" itemprop="url">ä¸Šå¤§å­¦ä¹°æ¸¸æˆæœ¬ï¼Œä½ å¯èƒ½ä¼šåæ‚”</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-08T03:50:00+08:00">
                2020-09-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%9A%8F%E7%AC%94/" itemprop="url" rel="index">
                    <span itemprop="name">éšç¬”</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>å¦‚æœè®©æˆ‘å›åˆ°ä¸¤å¹´å‰ï¼Œæˆ‘è‚¯å®šä¼šå‘Šè¯‰å½“æ—¶çš„è‡ªå·±ï¼šä¸è¦ä¹°æ¸¸æˆæœ¬ã€‚</p>
<p>å¥½å§æˆ‘çŸ¥é“ï¼Œç°åœ¨éƒ½ä¹æœˆä»½äº†ï¼Œå‡†å¤§å­¦ç”Ÿä»¬ç”µè„‘ä¼°è®¡æ—©å°±åˆ°æ‰‹äº†ï¼Œæˆ‘è¿™é‡Œå•°å—¦å‡ å¥ä¹Ÿæ²¡ç”¨ã€‚è™½ç„¶ä¼°è®¡ä¹Ÿæ²¡äººçœ‹ï¼Œä¸è¿‡å°±å½“ç»™ä»¥åçš„åŒå­¦åšä¸ªå‚è€ƒå§ã€‚</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2020/09/08/2020/dont-buy-a-gaming-laptop-for-college/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/09/05/Dapper.Contrib%E5%9C%A8Oracle%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%BC%95%E5%8F%91ORA-00928%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/09/05/Dapper.Contrib%E5%9C%A8Oracle%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%BC%95%E5%8F%91ORA-00928%E5%BC%82%E5%B8%B8%E9%97%AE%E9%A2%98%E7%9A%84%E8%A7%A3%E5%86%B3/" itemprop="url">Dapper.Contrib åœ¨ Oracle ç¯å¢ƒä¸‹å¼•å‘ ORA-00928 å¼‚å¸¸é—®é¢˜çš„è§£å†³</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-09-05T14:28:20+08:00">
                2020-09-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/" itemprop="url" rel="index">
                    <span itemprop="name">æ•°æ®å­˜å‚¨</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <p>è¯è¯´æœ€è¿‘è¿™ä¸¤å‘¨é‡Œï¼Œè¢«è¿«å®˜å®£<strong>996</strong>çš„ç”Ÿæ´»å®åœ¨æ˜¯æ— è¶£ï¼Œåœ¨ä¸¤å‘¨æ—¶é—´é‡Œå®‰æ’ä¸‰å‘¨çš„å·¥ä½œé‡ï¼Œå€˜è‹¥ç”¨ä¸ç›¸çš„å£å»æ¥è¯´ï¼Œé‚£ä¾¿æ˜¯: <strong>æˆ‘ä»æœªè§è¿‡æœ‰å¦‚æ­¤åšé¢œæ— è€»ä¹‹äºº</strong>ã€‚æ— æ³•ä¸ºå·¥ä½œçš„ç´§æ€¥ç¨‹åº¦æ’å‡ºä¼˜å…ˆçº§ï¼Œè¿™ä¾¿æ˜¯èº«ä¸ºè‚‰é£Ÿè€…ä»¬çš„<strong>é„™</strong>ã€‚å¤äººäº‘ï¼š<strong>è‚‰é£Ÿè€…é„™ï¼Œæœªèƒ½è¿œè°‹</strong>ï¼Œè¯šä¸æ¬ºæˆ‘ä¹Ÿã€‚ä¸€å‘³åœ°è¿½æ±‚å¿«é€Ÿè¿­ä»£ï¼Œâ€œå±â€å±±è¶Šæ»šè¶Šé«˜æ²¡æœ‰äººåœ¨ä¹ï¼›ä¸€å‘³åœ°è¿½æ±‚åŠŸèƒ½å åŠ ï¼ŒæŠ€æœ¯å€ºåŠ¡è¶Šæ¥è¶Šå¤šæ²¡æœ‰äººåœ¨ä¹ã€‚æ‰€ä»¥ï¼Œæœ¬ç€â€œå¤šä¸€äº‹ä¸å¦‚å°‘ä¸€äº‹â€çš„åŸåˆ™ï¼Œç›´æ¥é€šè¿‡ Dapper å†™ SQL è¯­å¥ä¸€æ ·æ²¡æœ‰é—®é¢˜ï¼Œå› ä¸ºè¢«å‹æ¦¨å®Œä»¥åçš„æ—¶é—´åªèƒ½å†™è¿™ä¸ªã€‚åœ¨ä»Šå¤©çš„è¿™ç¯‡åšå®¢é‡Œï¼Œæˆ‘æƒ³å’Œå¤§å®¶åˆ†äº«çš„æ˜¯ï¼Œ<code>Dapper.Contrib</code>åœ¨æ“ä½œ Oracle æ•°æ®åº“æ—¶å¼•å‘ <strong>ORA-00928: ç¼ºå¤± SELECT å…³é”®å­—</strong> è¿™ä¸€é”™è¯¯èƒŒåçš„æ ¹æœ¬åŸå› ï¼Œä»¥åŠ Dapper ä½œä¸ºä¸€ä¸ªè½»é‡çº§ ORM åœ¨è®¾è®¡ä¸Šåšå‡ºçš„å–èˆã€‚</p>
<h1 id="é—®é¢˜å›é¡¾"><a href="#é—®é¢˜å›é¡¾" class="headerlink" title="é—®é¢˜å›é¡¾"></a>é—®é¢˜å›é¡¾</h1><p>åœ¨ä½¿ç”¨ <code>Dapper.Contrib</code> æ“ä½œ Oracle æ•°æ®åº“çš„æ—¶å€™ï¼Œé€šè¿‡ Insert() æ–¹æ³•æ¥æ’å…¥ä¸€ä¸ªå®ä½“å¯¹è±¡ï¼Œæ­¤æ—¶ï¼Œä¼šå¼•å‘ <strong>ORA-00928: ç¼ºå¤± SELECT å…³é”®å­—</strong> è¿™ç§å…¸å‹çš„ Oracle æ•°æ®åº“é”™è¯¯ï¼Œå¯¹äºç»å¸¸ä½¿ç”¨ Dapper çš„åšä¸»è€Œè¨€ï¼Œå¯¹äº <code>@</code> è¿˜æ˜¯ <code>:</code> è¿™ç§æ— èŠçš„è¯­æ³•è¿˜æ˜¯æœ‰ä¸€ç‚¹ç»éªŒçš„ï¼Œåœ¨å°è¯•æ‰‹å†™ SQL è¯­å¥åï¼Œå‘ç°ä½¿ç”¨ Dapper æä¾›çš„ <code>Execute()</code> æ‰©å±•æ–¹æ³•ä¸€ç‚¹é—®é¢˜éƒ½æ²¡æœ‰ï¼Œåˆæ­¥åˆ¤å®šåº”è¯¥æ˜¯ <code>Dapper.Contrib</code> è¿™ä¸ªæ‰©å±•åº“çš„é—®é¢˜ï¼Œåœ¨ç¿»é˜… <code>Dapper</code> çš„æºä»£ç ä»¥åï¼Œç»ˆäºæ‰¾åˆ°äº†é—®é¢˜çš„æ ¹æºæ‰€åœ¨ï¼Œæ‰€ä»¥ï¼Œä¸‹é¢è¯·è·Ÿéšåšä¸»çš„ç›®å…‰ï¼Œæ¥ä¸€èµ·è§£è¯»è§£è¯» <code>Dapper.Contrib</code> è¿™ä¸ªæ‰©å±•åº“ï¼Œç›¸ä¿¡ä½ çœ‹å®Œä»¥åå°±ä¼šæ˜ç™½ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œä¼šè¢« Oracle æ•°æ®åº“æ‘†ä¸Šä¸€é“ï¼Œä»¥åŠä¸ºä»€ä¹ˆå®ƒè‡³ä»Šéƒ½ä¸è€ƒè™‘åˆå¹¶ Oracle æ•°æ®åº“ç›¸å…³çš„ PRã€‚</p>
<h1 id="åŸå› åˆ†æ"><a href="#åŸå› åˆ†æ" class="headerlink" title="åŸå› åˆ†æ"></a>åŸå› åˆ†æ</h1><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œ<code>Dapper</code> çš„æ ¸å¿ƒå…¶å®å°±æ˜¯ä¸€ä¸ª SqlMapper ï¼Œå®ƒæä¾›çš„ Query() å’Œ Execute() æ¥å£æœ¬èº«éƒ½æ˜¯é™„åŠ åœ¨ <code>IDbConnection</code> æ¥å£ä¸Šçš„æ‰©å±•æ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œæœ€åŸºç¡€çš„ <code>Dapper</code> ç”¨æ³•å…¶å®æ˜¯ä¼´éšç€ SQL è¯­å¥å’Œä»¥åŒ¿åå¯¹è±¡ä¸ºä¸»çš„å‚æ•°åŒ–æŸ¥è¯¢ï¼Œè¿™å¯ä»¥è¯´æ˜¯ Dapper çš„æ ¸å¿ƒï¼Œè€Œ <code>Dapper.Contrib</code> åœ¨è¿™ä¸ªåŸºç¡€ä¸Šæä¾›äº† Get()ã€Insert()ã€Delete() å’Œ Update() ç­‰ç­‰å¸¸è§çš„ CRUD æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•éƒ½é’ˆå¯¹çš„æ˜¯å•ä¸»é”®çš„è¡¨ï¼Œè®© <code>Dapper</code>æœ‰äº†ä¸€ç‚¹ ORM çš„æ„Ÿè§‰ï¼Œå¯æƒœçš„æ˜¯ <code>Dapper.Contrib</code> çš„å®ç°æ˜¯ä¸å®Œæ•´çš„ï¼Œä¸»è¦æ˜¯æŒ‡ä¸‹é¢ä¸¤ä¸ªæ–¹é¢ï¼Œå³ï¼šç¬¬ä¸€ï¼Œå®˜æ–¹æœªèƒ½æä¾› Oracle ç‰ˆæœ¬çš„ <code>ISqlAdapter</code>ã€‚ç¬¬äºŒï¼Œå…¼å®¹ä¸åŒæ•°æ®åº“è‡ªå¢ ID çš„å®ç°ï¼Œè®©å®˜æ–¹åœ¨å¤„ç† Id çš„å‚æ•°åŒ–æŸ¥è¯¢æ—¶æŸæ‰‹æŸè„šï¼Œå¯¹ <code>ISqlAdapter</code> çš„è®¾è®¡å¹¶ä¸å…¨é¢ã€‚</p>
<h2 id="Oracle-ç‰ˆæœ¬çš„-ISqlAdapter"><a href="#Oracle-ç‰ˆæœ¬çš„-ISqlAdapter" class="headerlink" title="Oracle ç‰ˆæœ¬çš„ ISqlAdapter"></a>Oracle ç‰ˆæœ¬çš„ ISqlAdapter</h2><p>é¦–å…ˆï¼Œç¬¬ä¸€ä¸ªç»“è®ºï¼Œ<code>Dapper.Contrib</code> æ²¡æœ‰å®ç° Oracle ç‰ˆæœ¬çš„ <code>ISqlAdapter</code> ã€‚å…³äºè¿™ä¸ªæ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>SqlMapperExtensions</code> è¿™ä¸ªç±»ä¸­æ‰¾åˆ°å®šä¹‰ï¼Œè€Œ <code>Dapper.Contrib</code> å†…éƒ¨å®é™…ä¸Šæ˜¯ç»´æŠ¤äº†ä¸€ä¸ªå­—å…¸ <code>AdapterDictionary</code> ï¼Œåœ¨ <code>SqlMapperExtensions.cs</code> æ–‡ä»¶çš„ç¬¬ 62 è¡Œ ~ ç¬¬ 73 è¡Œï¼Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ï¼Œå…¶å†…éƒ¨æä¾›äº† 6 ç§ <code>ISqlAdapter</code> çš„å®ç°ï¼Œä¸”é»˜è®¤ä¸º <code>SqlServerAdapter</code> ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> ISqlAdapter DefaultAdapter = <span class="keyword">new</span> SqlServerAdapter();</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> Dictionary&lt;<span class="built_in">string</span>, ISqlAdapter&gt; AdapterDictionary</span><br><span class="line">    = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, ISqlAdapter&gt;(<span class="number">6</span>)</span><br><span class="line">      &#123;</span><br><span class="line">          [<span class="string">&quot;sqlconnection&quot;</span>] = <span class="keyword">new</span> SqlServerAdapter(),</span><br><span class="line">          [<span class="string">&quot;sqlceconnection&quot;</span>] = <span class="keyword">new</span> SqlCeServerAdapter(),</span><br><span class="line">          [<span class="string">&quot;npgsqlconnection&quot;</span>] = <span class="keyword">new</span> PostgresAdapter(),</span><br><span class="line">          [<span class="string">&quot;sqliteconnection&quot;</span>] = <span class="keyword">new</span> SQLiteAdapter(),</span><br><span class="line">          [<span class="string">&quot;mysqlconnection&quot;</span>] = <span class="keyword">new</span> MySqlAdapter(),</span><br><span class="line">          [<span class="string">&quot;fbconnection&quot;</span>] = <span class="keyword">new</span> FbAdapter()</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªè‡ªç„¶è€Œç„¶çš„é—®é¢˜æ˜¯ï¼Œè¿™ä¸ª <code>ISqlAdapter</code> æ¥å£æ˜¯åšä»€ä¹ˆçš„å‘¢ï¼Ÿä¸ºä»€ä¹ˆè¯´ <code>Dapper.Contrib</code> æ²¡æœ‰å®ç° Oracle ç‰ˆæœ¬çš„ ISqlAdapter å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬çœ‹ä¸€ä¸‹ <code>ISqlAdapter</code> çš„å®šä¹‰ï¼Œå°±å¯ä»¥äº†è§£åˆ°å…¶ä½œç”¨æ˜¯å‘Šè¯‰ Dapper ï¼Œåº”è¯¥æ€ä¹ˆæ ·å¤„ç†æ•°æ®åº“é‡Œçš„è‡ªå¢ IDã€æ€ä¹ˆæ ·è¡¨ç¤º <code>Column = Value</code> è¿™æ ·çš„ç»“æ„ï¼Œä»¥åŠæ€ä¹ˆæ ·å¤„ç†åˆ—åï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">interface</span> <span class="title">ISqlAdapter</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="built_in">int</span> <span class="title">Insert</span>(<span class="params">IDbConnection connection, IDbTransaction transaction, </span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="built_in">int</span>? commandTimeout, <span class="built_in">string</span> tableName, <span class="built_in">string</span> columnList, </span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="built_in">string</span> parameterList, IEnumerable&lt;PropertyInfo&gt; keyProperties, </span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="built_in">object</span> entityToInsert</span></span></span><br><span class="line"><span class="params"><span class="function">    </span>)</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AppendColumnName</span>(<span class="params">StringBuilder sb, <span class="built_in">string</span> columnName</span>)</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AppendColumnNameEqualsValue</span>(<span class="params">StringBuilder sb, <span class="built_in">string</span> columnName</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä»¥ <code>MySqlAdapter</code> çš„å®ç°ä¸ºä¾‹ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">MySqlAdapter</span> : <span class="title">ISqlAdapter</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Insert</span>(<span class="params">IDbConnection connection, IDbTransaction transaction, </span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="built_in">int</span>? commandTimeout, <span class="built_in">string</span> tableName, <span class="built_in">string</span> columnList, </span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="built_in">string</span> parameterList, IEnumerable&lt;PropertyInfo&gt; keyProperties, </span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="built_in">object</span> entityToInsert</span></span></span><br><span class="line"><span class="params"><span class="function">    </span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> cmd = <span class="string">$&quot;insert into <span class="subst">&#123;tableName&#125;</span> (<span class="subst">&#123;columnList&#125;</span>) values (<span class="subst">&#123;parameterList&#125;</span>)&quot;</span>;</span><br><span class="line">        connection.Execute(cmd, entityToInsert, transaction, commandTimeout);</span><br><span class="line">        <span class="keyword">var</span> r = connection.Query(<span class="string">&quot;Select LAST_INSERT_ID() id&quot;</span>, transaction: transaction, commandTimeout: commandTimeout);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> id = r.First().id;</span><br><span class="line">        <span class="keyword">if</span> (id == <span class="literal">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">var</span> propertyInfos = keyProperties <span class="keyword">as</span> PropertyInfo[] ?? keyProperties.ToArray();</span><br><span class="line">        <span class="keyword">if</span> (propertyInfos.Length == <span class="number">0</span>) <span class="keyword">return</span> Convert.ToInt32(id);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> idp = propertyInfos[<span class="number">0</span>];</span><br><span class="line">        idp.SetValue(entityToInsert, Convert.ChangeType(id, idp.PropertyType), <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Convert.ToInt32(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AppendColumnName</span>(<span class="params">StringBuilder sb, <span class="built_in">string</span> columnName</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        sb.AppendFormat(<span class="string">&quot;`&#123;0&#125;`&quot;</span>, columnName);</span><br><span class="line">    ï½</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AppendColumnNameEqualsValue</span>(<span class="params">StringBuilder sb, <span class="built_in">string</span> columnName</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        sb.AppendFormat(<span class="string">&quot;`&#123;0&#125;` = @&#123;1&#125;&quot;</span>, columnName, columnName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç›¸ä¿¡çœ‹åˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œå¤§å®¶ä¼šå’Œæˆ‘ä¸€æ ·æ„Ÿåˆ°å¤±æœ›ï¼Œå› ä¸º Dapper çš„åº•å±‚ä¾ç„¶æ˜¯åœ¨æ‹¼ SQL ï¼Œå°¤å…¶æ˜¯çœ‹åˆ° <code>AppendColumnNameEqualsValue()</code> è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€ç§æç„¶å¤§æ˜ç™½çš„æ„Ÿè§‰ï¼Œå› ä¸º @ è¿™ä¸ªç¬¦å·å¯¹äº Dapper çš„å‚æ•°åŒ–æŸ¥è¯¢è€Œè¨€ï¼Œå®åœ¨æ˜¯ç†Ÿæ‚‰å¾—ä¸èƒ½å†ç†Ÿæ‚‰äº†ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ä¸º Dapper å†™ SQL è¯­å¥çš„æ—¶å€™ï¼Œè¦å¯¹ Oracle åŒºåˆ«å¯¹å¾…ï¼Œå› ä¸ºè¿™ä¸ªå¥‡è‘©éè¦ç”¨ <code>:</code> è¿™ä¸ªå¥‡æ€ªçš„ç¬¦å·ã€‚å›åˆ°æˆ‘ä»¬ä¸€å¼€å§‹çš„é—®é¢˜ï¼Œä¸ºå•¥ <code>Dapper.Contrib</code> åœ¨ Oracle ç¯å¢ƒä¸‹ä¼šæç¤º <code>ORA-XXXXX</code> è¿™ç§é¬¼éƒ½çœ‹ä¸æ˜ç™½çš„é”™è¯¯ï¼Œå› ä¸ºå®ƒåœ¨å¤„ç† SQL çš„è¯­å¥çš„æ—¶å€™ä¾ç„¶ä½¿ç”¨çš„æ˜¯ <code>@</code> è¿™ä¸ªç¬¦å·ã€‚è¿™åˆæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºå½“æŒ‡å®šçš„ <code>IDbConnection</code> åœ¨ <code>AdapterDictionary</code> ä¸­ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œå®ƒä¼šä½¿ç”¨é»˜è®¤çš„ <code>SqlServerAdapter</code> ï¼Œæ˜¾ç„¶ï¼Œå…¨ä¸–ç•Œåªæœ‰ Oracle è¿™ä¸ªå¥‡è‘©ä¼šç”¨ <code>:</code> è¿™ä¸ªå¥‡æ€ªçš„ç¬¦å·ã€‚æˆ‘ä»¬ä¸æ˜¯åœ¨è°ƒç”¨ Insert() æ–¹æ³•çš„æ—¶å€™æç¤ºè¿™ä¸ªé”™è¯¯å—ï¼Ÿé‚£ä¹ˆ <code>Dapper.Contrib</code> æ˜¯æ€ä¹ˆå®ç° <code>Insert()</code> æ–¹æ³•çš„å‘¢ï¼Ÿè¿™ä¸ªéƒ¨åˆ†å®ç°ä¸»è¦åœ¨ç¬¬ 352 è¡Œ ~ ç¬¬ 360 è¡Œï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> adapter = GetFormatter(connection);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; allPropertiesExceptKeyAndComputed.Count; i++)</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="keyword">var</span> property = allPropertiesExceptKeyAndComputed[i];</span><br><span class="line">    adapter.AppendColumnName(sbColumnList, property.Name);  <span class="comment">//fix for issue #336</span></span><br><span class="line">    <span class="keyword">if</span> (i &lt; allPropertiesExceptKeyAndComputed.Count - <span class="number">1</span>)</span><br><span class="line">       sbColumnList.Append(<span class="string">&quot;, &quot;</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>æ˜¾ç„¶ï¼Œè¿™éƒ¨åˆ†æ˜¯æŒ‰ç…§å±æ€§åå»ç»„ç»‡ <code>columnList</code> å’Œ <code>parameterList</code> çš„è¿‡ç¨‹ï¼Œå¯¹äº Oracle ï¼Œæ°¸è¿œæ˜¯å……æ»¡åæ§½çš„ï¼Œæ¯”å¦‚ä¸åŠ åŒå¼•å·åˆ™å¼ºåˆ¶å¤§å†™çš„è®¾å®šï¼Œè¿™æ„å‘³ç€å¦‚æœä½ çš„è¡¨åæˆ–è€…å­—æ®µåæ˜¯åŒºåˆ†å¤§å°å†™çš„è¯ï¼Œåœ¨ Oracle è¿™é‡Œéƒ½è¦åŠ ä¸ŠåŒå¼•å·ï¼Œè¿™å¯¹ <code>Dapper.Contrib</code> æœ‰ä»€ä¹ˆå½±å“å‘¢ï¼ŸåŸæœ¬æˆ‘ä»¬åªéœ€è¦ç»™å®ä½“æ·»åŠ <code>[Table]</code>æ ‡ç­¾å³å¯ï¼Œè€Œç°åœ¨ä½ ä¸å¾—ä¸è€ƒè™‘å¸¦ä¸Šåæ–œæ è½¬ä¹‰ï¼Œç”šè‡³å½“ä½ éœ€è¦ä¸º <code>DBeaver</code> ä¸‹è½½ä¸€ä¸ª JDBC çš„é©±åŠ¨çš„æ—¶å€™ï¼Œç”²éª¨æ–‡è¿™å®¶å…¬å¸å±…ç„¶è¦å¼ºåˆ¶ä½ å»æ³¨å†Œï¼Œå¯¹äºä¸€ä¸ªä¹ æƒ¯åƒ<code>Â·.NET Core</code>ã€<code>GCC</code>ã€<code>Python</code>ã€<code>Lua</code> å’Œ <code>Node</code> è¿™æ ·å¼€ç®±å³ç”¨çš„äººæ¥è¯´ï¼Œè¿™å°±åƒå¼ºè¿«ä½ æ³¨å†Œä¸€å¤§å †çœŸå®ä¿¡æ¯ï¼Œç„¶åå‘ç° API æ¥å£å®Œå…¨æ— æ³•åŒ¹é…ä½ çš„éœ€æ±‚ä¸€æ ·ç—›è‹¦ã€‚å…³äº <code>GetFormatter()</code> æ–¹æ³•ï¼Œå®ƒå’Œæˆ‘ä»¬çŒœæƒ³çš„å®Œå…¨ä¸€è‡´ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> ISqlAdapter <span class="title">GetFormatter</span>(<span class="params">IDbConnection connection</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">var</span> name = GetDatabaseType?.Invoke(connection).ToLower() ?? connection.GetType().Name.ToLower();</span><br><span class="line">   <span class="keyword">return</span> AdapterDictionary.TryGetValue(name, <span class="keyword">out</span> <span class="keyword">var</span> adapter) ? adapter : DefaultAdapter;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¥½äº†ï¼Œåœ¨æ˜ç™½äº†ä»¥ä¸Šç§ç§å› æœå…³ç³»ä»¥åï¼Œæˆ‘ä»¬ç°åœ¨æ¥è€ƒè™‘å¦‚ä½•è§£å†³ Oracle çš„é—®é¢˜ã€‚æŒ‰ç…§äººç±»æœ€ç›´è§‚çš„æ€ç»´ï¼Œæ—¢ç„¶å®ƒæ²¡æœ‰å®ç° Oracle ç‰ˆæœ¬çš„ <code>ISqlAdapter</code> ï¼Œæˆ‘è‡ªå·±å®ç°ä¸€ä¸ªä¸å°±å¥½å•¦ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OracleSqlAdapter</span> : <span class="title">ISqlAdapter</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AppendColumnName</span>(<span class="params">StringBuilder sb, <span class="built_in">string</span> columnName</span>)</span></span><br><span class="line">   &#123;</span><br><span class="line">        sb.AppendFormat(<span class="string">&quot;&#123;0&#125;&quot;</span>, columnName);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AppendColumnNameEqualsValue</span>(<span class="params">StringBuilder sb, <span class="built_in">string</span> columnName</span>)</span></span><br><span class="line">   &#123;</span><br><span class="line">        sb.AppendFormat(<span class="string">&quot;&#123;0&#125; = :&#123;1&#125;&quot;</span>, columnName, columnName);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Insert</span>(<span class="params">IDbConnection connection, IDbTransaction transaction, <span class="built_in">int</span>? commandTimeout, <span class="built_in">string</span> tableName, </span></span></span><br><span class="line"><span class="params"><span class="function">            <span class="built_in">string</span> columnList, <span class="built_in">string</span> parameterList, IEnumerable&lt;PropertyInfo&gt; keyProperties, <span class="built_in">object</span> entityToInsert</span>)</span></span><br><span class="line">   &#123;</span><br><span class="line">        <span class="keyword">var</span> sql = <span class="string">$&quot;insert into <span class="subst">&#123;tableName&#125;</span> (<span class="subst">&#123;columnList&#125;</span>) values (<span class="subst">&#123;parameterList&#125;</span>)&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> connection.Execute(sql, entityToInsert, transaction, commandTimeout);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task&lt;<span class="built_in">int</span>&gt; <span class="title">InsertAsync</span>(<span class="params">IDbConnection connection, IDbTransaction transaction, <span class="built_in">int</span>? commandTimeout, <span class="built_in">string</span> tableName, </span></span></span><br><span class="line"><span class="params"><span class="function">            <span class="built_in">string</span> columnList, <span class="built_in">string</span> parameterList, IEnumerable&lt;PropertyInfo&gt; keyProperties, <span class="built_in">object</span> entityToInsert</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">         <span class="keyword">var</span> sql = <span class="string">$&quot;insert into <span class="subst">&#123;tableName&#125;</span> (<span class="subst">&#123;columnList&#125;</span>) values (<span class="subst">&#123;parameterList&#125;</span>)&quot;</span>;</span><br><span class="line">         <span class="keyword">return</span> connection.ExecuteAsync(sql, entityToInsert, transaction, commandTimeout);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦ç™½è¯´ï¼Œ <code>Dapper.Contrib</code> è¿™ç§çº¯é™æ€ç±»çš„è®¾è®¡ï¼Œå®Œå…¨å°±ä¸ç»™åˆ«äººç•™æ‰©å±•çš„å£å­ï¼Œä¸ºæ­¤ï¼Œæ‰©å±•æ–¹æ³• + åå°„æä¸€ä¸ªçªç ´å£ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">SqlAdapterrExtensions</span></span><br><span class="line"> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">UseSqlAdapter</span>&lt;<span class="title">TSqlAdapter</span>&gt;(<span class="params"><span class="keyword">this</span> IDbConnection connection, TSqlAdapter sqlAdapter</span>)</span></span><br><span class="line"><span class="function">        <span class="keyword">where</span> TSqlAdapter : ISqlAdapter, <span class="keyword">new</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> adapters = (Dictionary&lt;<span class="built_in">string</span>, ISqlAdapter&gt;)</span><br><span class="line">            <span class="keyword">typeof</span>(SqlMapperExtensions)</span><br><span class="line">            .GetField(<span class="string">&quot;AdapterDictionary&quot;</span>, BindingFlags.NonPublic | BindingFlags.Instance | BindingFlags.Static)</span><br><span class="line">            ?.GetValue(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> connectionType = connection.GetType().Name.ToLower();</span><br><span class="line">        <span class="keyword">if</span> (adapters != <span class="literal">null</span> &amp;&amp; !adapters.ContainsKey(connectionType))</span><br><span class="line">            adapters?.Add(connectionType, sqlAdapter);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ï¼Œæˆ‘ä»¬ä¸ä½†å¯ä»¥æ»¡è¶³çœ¼ä¸‹ï¼Œè¿˜å¯ä»¥ç€çœ¼æœªæ¥ï¼Œè™½ç„¶æœªæ¥æœ‰æ—¶å€™æŒºé¥è¿œï¼Œä½†æ¢¦æƒ³è¿˜æ˜¯è¦æœ‰çš„ï¼Œå¼€é—­åŸåˆ™ï¼Œæˆ‘åšåˆ°äº†ï¼æ”¹è¿›åï¼Œæˆ‘ä»¬è¿™æ ·å¤„ç†å³å¯ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">connection = <span class="keyword">new</span> OracleConnection(ConnectionStrings.Default);</span><br><span class="line">connection.UseSqlAdapter(<span class="keyword">new</span> OracleSqlAdapter());</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å‘ç°ï¼Œæˆ‘ä»¬è§£å†³äº† Insert() çš„é—®é¢˜ï¼Œä½†éšä¹‹è€Œæ¥çš„ï¼ŒGet()ã€Delete()ã€Update() è¿™ä¸€ç³»åˆ—å’Œä¸»é”®ç›¸å…³çš„æ–¹æ³•ï¼Œéƒ½å› ä¸º <code>Dapper.Contrib</code> ä¸­çš„ä¸»é”®è®¾è®¡è€Œå‡ºç°äº†é—®é¢˜ï¼Œè€Œè¿™å°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦è®²çš„ä¸»é”® Id å‚æ•°åŒ–é—®é¢˜ã€‚</p>
<h2 id="ä¸»é”®-Id-å‚æ•°åŒ–é—®é¢˜"><a href="#ä¸»é”®-Id-å‚æ•°åŒ–é—®é¢˜" class="headerlink" title="ä¸»é”® Id å‚æ•°åŒ–é—®é¢˜"></a>ä¸»é”® Id å‚æ•°åŒ–é—®é¢˜</h2><p>å½“æˆ‘è°ˆèµ·è¿™ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘å¯¹äº <code>Dapper.Contrib</code> ä¸­æ”¯æŒè‡ªå¢ ID çš„åšæŒæ˜¯æ€€ç–‘çš„ï¼Œå› ä¸ºåœ¨åˆ†å¸ƒå¼ç››è¡Œçš„ä»Šå¤©ï¼Œæœ‰å¤§é‡çš„åˆ†å¸ƒå¼ ID ç”Ÿæˆæ–¹æ¡ˆä¾›æˆ‘ä»¬é€‰æ‹©ï¼Œæ¯”å¦‚åŸºäº <code>Redis</code> çš„å·æ®µç­–ç•¥ï¼ŒåŸºäºé›ªèŠ±ç®—æ³•çš„ ID ç”Ÿæˆç­‰ç­‰ã€‚å¤§å®¶ä¼šæ³¨æ„åˆ°æˆ‘å®ç°çš„ OracleSqlAdapter åœ¨å®ç° Insert() æ–¹æ³•çš„æ—¶å€™ç®€åŒ–äº†å¤§é‡ä»£ç ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘çœŸçš„ä¸çŸ¥é“ï¼Œæ€ä¹ˆä» Oracle ä¸­è·å–ä¸€ä¸ªæ–°ç”Ÿæˆçš„ IDï¼Œå°¤å…¶æ˜¯è¿™ä¸ª ID å±…ç„¶è¿˜è¦ä¾èµ–ä¸€ä¸ªæˆ‘å¬éƒ½æ²¡æœ‰å¬è¯´è¿‡çš„â€œåºåˆ—â€ï¼Œè€Œä¹‹æ‰€ä»¥è¦åœ¨ ISqlAdapter ä¸­å®ç° Insert() æ–¹æ³•ï¼Œæœ€æ ¹æœ¬çš„åŸå› å°±æ˜¯ï¼Œå„ä¸ªæ•°æ®åº“å¯¹äºè‡ªå¢ ID çš„å®ç°æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ¯”å¦‚ MySQL ä¸­ä½¿ç”¨çš„æ˜¯ <code>SCOPE_IDENTITY()</code>ï¼Œè€Œ MSSQL ä¸­ä½¿ç”¨çš„åˆ™æ˜¯ <code>SCOPE_IDENTITY()</code> ï¼Œå°±å› ä¸ºè¿™ä¸€ç‚¹ç‚¹å·®å¼‚ï¼Œæˆ‘ä»¬å°±å¿…é¡»è¦å»æŠ˜è…¾ä¸€éï¼Œå¯ä»¥è¯´ï¼Œ Dapper.Contrib ä¸æ”¯æŒ Oracle çš„ä¸€ä¸ªé‡è¦åŸå› ï¼Œå°±æ˜¯åœ¨ Oracle ä¸‹å®ç°è‡ªå¢ ID å¤ªéº»çƒ¦äº†ã€‚</p>
<p>æ—¢ç„¶å¤§å®¶éƒ½ä¸ç”¨è‡ªå¢ ID äº†ï¼Œä¸ºä»€ä¹ˆè¿˜è¦åœ¨ä¸€ä¸ªé€šç”¨çš„ ORM é‡ŒæŠ˜è…¾è¿™ä¸ªå‘¢ï¼Ÿè¯´å®è¯ï¼Œæˆ‘çœŸæ‹…å¿ƒæœ‰ä¸€å¤©è‡ªå¢ ID ä¼šæº¢å‡ºï¼Œè°è®©æ¯ä¸ªæ•°æ®åº“é‡Œçš„ä¸Šé™éƒ½ä¸ä¸€æ ·å‘¢ï¼Ÿå¦ä¸€æ–¹é¢ï¼Œæ—¢ç„¶ Id åœ¨æ¯ä¸ªæ•°æ®åº“çš„å®ç°éƒ½ä¸ä¸€æ ·ï¼Œé‚£ä¹ˆï¼Œä½œä¸º Id æœ¬èº«åº”è¯¥è€ƒè™‘æ”¾åˆ° <code>ISqlAdapter</code> æ¥å£ä¸­ç”±ä½¿ç”¨è€…æ¥å®ç°å•Šï¼Œå¯åå ISqlAdapter é‡Œåªå®šä¹‰äº†ä¸€ä¸ª Insert() æ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œå°±ç®—æˆ‘ä»¬å®ç°äº† OracleSqlAdapter ï¼Œä¸€æ ·æ— æ³•è§£å†³ Insert() æ–¹æ³•ä»¥å¤–çš„å…¶å®ƒæ–¹æ³•åœ¨ Oracle ä¸‹é¢çš„é—®é¢˜ï¼Œæ­£å› ä¸ºå¦‚æ­¤ï¼Œé»˜è®¤çš„ @ ç¬¦å·åœ¨ Oracle ç¯å¢ƒä¸‹ä¸‹æ²¡æœ‰è¢«å®Œå…¨æ›¿æ¢æ‰ï¼Œè¿™å°±éœ€è¦ä¿®æ”¹ Dapper.Contrib çš„åº•å±‚ä»£ç ï¼Œè¿™çœŸçš„æ˜¯ä¸€ä¸ªä¸å¥½çš„è®¾è®¡ï¼Œå› ä¸ºä½¿ç”¨è€…å®Œå…¨æ²¡æœ‰åŠæ³•é€šè¿‡é‡å†™æ¥è¦†ç›–æŸäº›é»˜è®¤è¡Œä¸ºï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹ï¼Œéœ€è¦ä¿®æ”¹å“ªäº›åœ°æ–¹ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> T <span class="title">Get</span>&lt;<span class="title">T</span>&gt;(<span class="params"><span class="keyword">this</span> IDbConnection connection, <span class="built_in">dynamic</span> id, </span></span></span><br><span class="line"><span class="params"><span class="function">IDbTransaction transaction = <span class="literal">null</span>, <span class="built_in">int</span>? commandTimeout = <span class="literal">null</span></span>) <span class="keyword">where</span> T : <span class="keyword">class</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> type = <span class="keyword">typeof</span>(T);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!GetQueries.TryGetValue(type.TypeHandle, <span class="keyword">out</span> <span class="built_in">string</span> sql))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> key = GetSingleKey&lt;T&gt;(<span class="keyword">nameof</span>(Get));</span><br><span class="line">        <span class="keyword">var</span> name = GetTableName(type);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ä¸ªåäº‹å„¿çš„åœ°æ–¹ï¼Œä¸ºä»€ä¹ˆä¸ç”¨AppendColumnName()æ–¹æ³•?</span></span><br><span class="line">        sql = <span class="string">$&quot;select * from <span class="subst">&#123;name&#125;</span> where <span class="subst">&#123;key.Name&#125;</span> = @id&quot;</span>;</span><br><span class="line">        GetQueries[type.TypeHandle] = sql;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> dynParams = <span class="keyword">new</span> DynamicParameters();</span><br><span class="line">    <span class="comment">//ç¬¬äºŒä¸ªåäº‹çš„åœ°æ–¹ï¼Œä»€ä¹ˆä¸ç”¨AppendColumnName()æ–¹æ³•??</span></span><br><span class="line">    dynParams.Add(<span class="string">&quot;@id&quot;</span>, id);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä»¥ä¸‹ä»£ç å·²çœç•¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">long</span> <span class="title">Insert</span>&lt;<span class="title">T</span>&gt;(<span class="params"><span class="keyword">this</span> IDbConnection connection, T entityToInsert,</span></span></span><br><span class="line"><span class="params"><span class="function">IDbTransaction transaction = <span class="literal">null</span>, <span class="built_in">int</span>? commandTimeout = <span class="literal">null</span></span>) <span class="keyword">where</span> T : <span class="keyword">class</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//ä»¥ä¸Šä»£ç å·²çœç•¥</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> sbParameterList = <span class="keyword">new</span> StringBuilder(<span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; allPropertiesExceptKeyAndComputed.Count; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//ç¬¬ä¸‰ä¸ªåäº‹çš„åœ°æ–¹ï¼Œä»€ä¹ˆä¸ç”¨AppendColumnName()æ–¹æ³•???</span></span><br><span class="line">        <span class="keyword">var</span> property = allPropertiesExceptKeyAndComputed[i];</span><br><span class="line">        sbParameterList.AppendFormat(<span class="string">&quot;@&#123;0&#125;&quot;</span>, property.Name);</span><br><span class="line">        <span class="keyword">if</span> (i &lt; allPropertiesExceptKeyAndComputed.Count - <span class="number">1</span>)</span><br><span class="line">            sbParameterList.Append(<span class="string">&quot;, &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä»¥ä¸‹ä»£ç å·²çœç•¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶å®ï¼Œä»”ç»†é˜…è¯» Update() å’Œ Delete() ä¸¤ä¸ªæ–¹æ³•çš„å®ç°ï¼Œå°±ä¼šå‘ç°å®ƒä»¬éƒ½éå¸¸å®Œç¾åœ°é¿å¼€äº†è¿™ä¸€ç‚¹ï¼Œå°±æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆåªæœ‰ä¸¤ä¸ªæ–¹æ³•é‡‡ç”¨äº†ä¸åŒåœ°æ–¹å¼å»æ‹¼æ¥ SQL ï¼Œå½“ç„¶ï¼Œè¿™é‡Œæˆ‘ä»¬ä¼šæ„è¯†åˆ°æœ‰ä¸ªåˆ—åçš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦åŒºåˆ†å¤§å°å†™çš„æƒ…å†µä¸‹ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å»å®šä¹‰ä¸€ä¸ª ColumnAttributeï¼Œè¿˜èƒ½è¯´ä»€ä¹ˆå‘¢ï¼Ÿè¯·å’Œæˆ‘å¤§å£°åœ°åæ§½ï¼š<strong>åƒåœ¾ Oracle ï¼</strong>ä½ çœ‹ï¼Œå°±ä¸ºäº†è¿™ä¸€ç‚¹ç‚¹å·®å¼‚ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å»é¢å¤–å†™ä¸€ç‚¹ä»£ç ï¼Œæ‰€ä»¥ï¼Œå–Šäº†å¾ˆå¤šå¹´çš„å» IOEï¼Œæˆ‘è¡¨ç¤ºä¸¾åŒæ‰‹èµæˆã€‚</p>
<p>äº‹å®ä¸Šï¼Œç¤¾åŒºé‡Œå·²ç»æœ‰ç±»ä¼¼çš„PRï¼Œå¯å› ä¸ºæ”¹åŠ¨çš„èŒƒå›´æ¯”è¾ƒå¤§ï¼Œå®˜æ–¹è‡³ä»Šéƒ½æ²¡æœ‰è€ƒè™‘è¿‡å°†å…¶åˆå¹¶åˆ°ä¸»å¹²åˆ†æ”¯ä¸Šï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªé—®é¢˜ä¸€ç›´æ²¡æœ‰è§£å†³ï¼Œè¿™æ˜¯ä¸€ä¸ªæ‚²ä¼¤çš„æ•…äº‹ã€‚</p>
<h1 id="ç›¸å…³æ€è€ƒ"><a href="#ç›¸å…³æ€è€ƒ" class="headerlink" title="ç›¸å…³æ€è€ƒ"></a>ç›¸å…³æ€è€ƒ</h1><p>åœ¨é˜…è¯» Dapper æºç çš„åŒæ—¶ï¼Œæˆ‘æŸ¥é˜…äº†ä¸€ä¸ªå’Œ Dapper.Contrib ç±»ä¼¼çš„é¡¹ç›®ï¼šDapperExtensionï¼Œæˆ‘å‘ç°è¿™ä¸ªé¡¹ç›®ç›®å‰å¤„åœ¨â€œè’åºŸâ€çš„çŠ¶æ€ï¼Œå› ä¸ºå®ƒé‡åˆ°äº†ç›¸åŒçš„é—®é¢˜ï¼Œå³ SQL è¿™é—¨çœ‹èµ·æ¥ç»Ÿä¸€å®åˆ™ç›¸å½“ä¸ç»Ÿä¸€çš„è¯­è¨€ï¼Œå› ä¸ºæ¯ä¸€ä¸ªæ•°æ®åº“å‚å•†å‡ ä¹éƒ½åœ¨ç»™æ ‡å‡†â€œæ·»ç –åŠ ç“¦â€œï¼Œå°±ä»¥è‡ªå¢ ID ä¸ºä¾‹ï¼ŒMySQLã€MSSQLã€Oracle å±…ç„¶æ˜¯ä¸‰ç§ä¸åŒçš„å®ç°æ–¹å¼ï¼Œå°¤å…¶æ˜¯ Oracle è¿™ä¸ªå¥‡è‘©ï¼Œå±…ç„¶è¿˜éœ€è¦å®šä¹‰ä¸€ä¸ªåºåˆ—æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªå¥‡è‘©ç»™æ•°æ®åº“åŠ æ³¨é‡Šéƒ½é‚£ä¹ˆå¦ç±»ï¼Œè¿™å¸¦æ¥çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼ŸDapper.Contrib æ— åŠ›å»å®ç° Oracle çš„è‡ªå¢ ID è€Œæ”¾å¼ƒäº† Oracle ï¼Œæ‰€ä»¥ï¼Œå³ä½¿ç¤¾åŒºé‡Œæäº¤äº† PRï¼Œå› ä¸ºå®ç°æ–¹å¼æœ‰ç‚¹è„ï¼Œå®˜æ–¹ä¸€ç›´æ²¡æœ‰åˆå¹¶åˆ°ä¸»å¹²ä¸Šå»ã€‚</p>
<p>å†å›è¿‡å¤´æ¥çœ‹ Dapper.Contrib æ”¯æŒè‡ªå¢ ID çš„ä¸¾åŠ¨ï¼Œæ€»ä¼šè§‰å¾—æœ‰ç‚¹ä¸åˆæ—¶å®œï¼Œå› ä¸ºä¸åŒæ•°æ®åº“è‡ªå¢ ID çš„ä¸Šé™ä¸ä¸€æ ·ä¸è¯´ï¼Œç°åœ¨éƒ½æ™®éåœ¨åˆ†å¸ƒå¼çš„ç¯å¢ƒä¸­ï¼Œæ•°æ®åº“çš„è‡ªå¢ ID å…¶å®æ˜¯éå¸¸é¸¡è‚‹çš„åŠŸèƒ½ï¼Œè€Œå®é™…åº”ç”¨ä¸­å¸¸å¸¸ä¼šç”¨ <code>Redis</code> ã€é›ªèŠ±ç®—æ³•ç­‰æ¥å®ç°åˆ†å¸ƒå¼ IDï¼Œæ‰€ä»¥ï¼Œå½“ä½ å›é¡¾å†å²å‘å±•çš„è¶‹åŠ¿çš„æ—¶å€™ï¼Œå°±ä¼šæ„Ÿæ…¨æœ‰æ ‡å‡†åŒ–çš„ä¸œè¥¿è¯¥å¤šå¥½ï¼Œå¹¶ä¸æ˜¯è¯´è¿™ä¸ªä¸–ç•Œä¸éœ€è¦å¤šæ ·æ€§ï¼Œæ˜¾ç„¶è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çº¦æŸæ€§ä¸å¼ºçš„é¢†åŸŸï¼Œçœ‹èµ·æ¥å¤§å®¶éƒ½å®ç°äº† SQLï¼Œæ— ä¸€ä¾‹å¤–åœ°éƒ½å¤¹è—äº†ç§è´§ï¼Œå¯¹äºå•†ä¸šè¡Œä¸ºè€Œè¨€ï¼Œè¿™æ— å¯åšéï¼›å¯å¯¹äºè¿™ä¸ªä¸–ç•Œè€Œè¨€ï¼Œè¿™æ— ç–‘å¢åŠ äº†å·¥ä½œé‡ã€‚</p>
<p>æœ‰æ—¶å€™ï¼Œå½“ä¸€ä¸ªè¡Œä¸šæ²¡æœ‰ä»€ä¹ˆæ ‡å‡†çš„æ—¶å€™ï¼Œåˆ°åº•æ˜¯çªç ´å‹‡æ°”å»ç‡å…ˆåˆ¶å®šæ ‡å‡†ï¼Œè¿˜æ˜¯æ”¾å¼ƒè‡ªæˆ‘å»è¿åˆå„ç§ä¸æˆæ–‡çš„è§„åˆ™ï¼Œå¯¹äºä¼ä¸šè€Œè¨€ï¼Œæ˜¯æˆ˜ç•¥ä¸Šçš„ä¸€ç§é€‰æ‹©ï¼›è€Œå¯¹äºä¸ªäººè€Œè¨€ï¼Œå…¶å®æ˜¯äººç”Ÿçš„ä¸€ç§é€‰æ‹©ã€‚å½“å½¼æ—¶é’æ˜¥å¹´å°‘çš„äººä»¬ï¼Œç«ç›¸ä»¥æ ‡æ–°ç«‹å¼‚ä¸ºè£çš„æ—¶å€™ï¼Œå¦‚æœæƒ³åˆ°æœ‰ä¸€å¤©ï¼Œç»ˆç©¶è¦æ´»æˆåƒç¯‡ä¸€å¾‹çš„äººç”Ÿï¼Œä¸ºäº†ç”Ÿæ´»è€Œé€‰æ‹©è·ªç€çš„æ—¶å€™ï¼Œå†…å¿ƒåˆä¼šæœ‰ä»€ä¹ˆä¸ä¸€æ ·çš„ä¸¾åŠ¨å‘¢ï¼Ÿ</p>
<h1 id="æœ¬æ–‡å°ç»“"><a href="#æœ¬æ–‡å°ç»“" class="headerlink" title="æœ¬æ–‡å°ç»“"></a>æœ¬æ–‡å°ç»“</h1><p>æœ¬æ–‡åˆ†æäº† Dapper.Contrib è¿™ä¸ªæ‰©å±•åº“ï¼Œåœ¨æ­é… Oracle æ•°æ®åº“ä½¿ç”¨æ—¶é‡åˆ° ORA-XXXXX ç³»åˆ—é”™è¯¯çš„åŸå› åŠç›¸åº”åœ°å¤„ç†æ–¹æ³•ï¼Œè¿™ä¸ªé—®é¢˜çš„è¡¨è±¡æ˜¯ Dapper.Contrib æ²¡æœ‰å®ç° OracleSqlAdapter ï¼Œè€Œæ›´æ·±å±‚çš„åŸå› ï¼Œå®é™…ä¸Šæ˜¯ Dapper.Contrib é€‰æ‹©æ”¯æŒè‡ªå¢ ID è€Œå¸¦æ¥çš„ SQL æ ‡å‡†å·®å¼‚åŒ–é—®é¢˜ã€‚å› ä¸ºä¸åŒçš„æ•°æ®åº“åœ¨å®ç°è‡ªå¢ ID æ—¶çš„æœºåˆ¶ä¸åŒï¼ŒOracle ç”šè‡³éœ€è¦å¼•å…¥åºåˆ—è¿™ä¸ªæ¦‚å¿µï¼Œè¿™ç§å·®å¼‚åŒ–ï¼Œå¢åŠ äº† Dapper å„ä¸ªæ‰©å±•åº“ç»´æŠ¤çš„å·¥ä½œé‡ï¼Œè¿™æ˜¯å®˜æ–¹ä¸€ç›´ä¸æ„¿æ„å®ç° OracleSqlAdapter çš„åŸå› ï¼Œå…¶æ¬¡ï¼Œ Dapper.Contrib åº•å±‚è®¾è®¡ä¸åˆç†ï¼Œé™¤äº† Insert() æ–¹æ³•ä»¥å¤–ï¼Œå…¶å®ƒä¾èµ–ä¸»é”®çš„æ–¹æ³•éƒ½æ²¡æœ‰æä¾›æ‰©å±•æ¥å£ï¼Œå¯¼è‡´ä½¿ç”¨è€…åªèƒ½é€šè¿‡ä¿®æ”¹åº•å±‚ä»£ç çš„æ–¹å¼è§£å†³é—®é¢˜ï¼Œè¿™ä¸¥é‡è¿åå¼€é—­åŸåˆ™ã€‚å¥½äº†ï¼Œè¿™æ˜¯ä¸€ç¯‡åˆ©ç”¨ 996 é—²æš‡(å¯èƒ½æ˜¯æŒ‡åšæ¢¦)å†™çš„ä¸€ç¯‡åšå®¢ï¼Œå¦‚æœæ–‡ç« ä¸­æœ‰ä»€ä¹ˆä¸å‘¨åˆ°çš„åœ°æ–¹ï¼Œæ¬¢è¿å¤§å®¶åœ¨åšå®¢ä¸‹é¢ç»™æˆ‘ç•™è¨€ï¼Œè°¢è°¢ï¼Œæ™šå®‰ï¼</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/post/f05d518.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/f05d518.html" itemprop="url">å…«æœˆæ€»ç»“</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-28T00:05:48+08:00">
                2020-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <h2 id="èƒŒå•è¯"><a href="#èƒŒå•è¯" class="headerlink" title="èƒŒå•è¯"></a>èƒŒå•è¯</h2><p><img src="https://i.loli.net/2020/08/28/OCf79JkXbP4vQUw.png" alt="image.png"></p>
<p>æœˆåˆå‘ç°è¿™ä¸ªè½¯ä»¶ï¼Œå‘ç°æ¯”æˆ‘ä¹‹å‰ä½¿ç”¨è¿‡çš„æ‰€æœ‰èƒŒå•è¯è½¯ä»¶éƒ½å¥½ç”¨ï¼ŒåŸºäºè‰¾å®¾æµ©æ–¯è®°å¿†æ›²çº¿ï¼Œæˆ‘çš„æ–¹æ³•æ˜¯åŒæ—¶æ‰“å¼€ä¸‰ä¸ªè½¯ä»¶ï¼š</p>
<ul>
<li>List èƒŒå•è¯ï¼ˆä¸Šå›¾è½¯ä»¶</li>
<li>æ¬§è·¯è¯å…¸ï¼ˆç”¨æ¥ç»ƒå‘éŸ³</li>
<li>è¯æ ¹è¯ç¼€å­—å…¸ï¼ˆç”¨æ¥è®°è¯æ ¹ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªâ€œä¸æ‹˜ä¸€æ ¼èƒŒå•è¯â€æ¨¡å—ï¼Œæœ‰è¶£è¿˜æ–¹ä¾¿è®°å¿†</li>
</ul>
<p>æ¯å¤©æ™šä¸ŠæŠ½ä¸€ä¸ªå°æ—¶ï¼Œæ•ˆæœè¿˜æ˜¯æŒºä¸é”™çš„ï¼Œå¸Œæœ›èƒ½ç»§ç»­åšæŒä¸‹å»ã€‚</p>
<h2 id="æ‰‹æœºæ¢å±å¹•"><a href="#æ‰‹æœºæ¢å±å¹•" class="headerlink" title="æ‰‹æœºæ¢å±å¹•"></a>æ‰‹æœºæ¢å±å¹•</h2><h3 id="èµ·å› "><a href="#èµ·å› " class="headerlink" title="èµ·å› "></a>èµ·å› </h3><p>ä¹‹å‰çš„å°ç±³ 8 çš„å±å¹•æ‘”åäº†ï¼Œç„¶åæ¢æ‰‹æœºåå°±ä¸€ç›´è¢«é—²ç½®ï¼Œæœ€è¿‘è€æ¯äº²æåˆ°å¥¹çš„æ‰‹æœºç”µæ± ä¸å¤ªç¨³å®šï¼Œå°±å¿ƒæƒ³ç€è‡ªå·±åŠ¨æ‰‹æŠŠè¿™å°å°ç±³çš„å±å¹•æ¢äº†ç»™å¥¹ç”¨ï¼Œä¹‹å‰è¿˜æ²¡æœ‰äº²è‡ªæ¢è¿‡å±å¹•ï¼Œè¿˜æ˜¯å¾—è‡ªå·±åŠ¨æ‰‹æŠ˜è…¾ä¸€æ³¢ã€‚</p>
<h3 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h3><p>ä¹‹å‰å°±çœ‹è¿‡åœ¨å®˜æ–¹æ¢éœ€è¦ 740 å…ƒï¼Œè§‰å¾—è¿™å°æ‰‹æœºç”¨äº†è¿™ä¹ˆä¹…äº†ï¼Œä¸å€¼å¾—èŠ±è¿™ä¸ªé’±æ¥â€œç»­å‘½â€ï¼Œè€Œä¸”å¯¹å±å¹•è¦æ±‚ä¹Ÿä¸é«˜ï¼Œèƒ½ç”¨å°±è¡Œã€‚æ‰€ä»¥åœ¨æŸå®ä¸Šæ‰¾äº†ä¸€ä¸ªåå¼ºåŒ—çš„å¸¦æ¡†å±å¹•æ€»æˆï¼Œè·Ÿç€ç½‘ä¸Šçš„è§†é¢‘æ•™ç¨‹ä¸€æ­¥ä¸€æ­¥æ¢ï¼Œç»“æœåœ¨ç¬¬ä¸€æ­¥ï¼ˆæ‹†åå£³ï¼‰å¡äº†è¿‘ä¸¤ä¸ªå°æ—¶ï¼Œå·®ç‚¹æŠŠæˆ‘æ•´ç–¯äº†ã€‚</p>
<p>æœŸé—´è¿˜æŠŠå¼€æœºæ’çº¿æ‰¯æ–­äº†ï¼Œç„¶ååˆåœ¨æŸå®ä¸Šä¹°äº†ä¸¤æ¡æ’çº¿ï¼ˆå¤‡ç”¨ï¼‰ï¼Œå°±è¿™æ ·ç­‰äº†ä¸€å¤©æ‰èƒ½ç»§ç»­æ›´æ¢ã€‚</p>
<p>æœ€åæ›´æ¢å®Œå¼€æœºä¹Ÿæ˜¯å„ç§é—®é¢˜ï¼Œæ¯”å¦‚å› ä¸ºéŸ³é‡é”®å¡ä½å¯¼è‡´å¼€æœºè¿›å…¥ fastboot ç•Œé¢ï¼Œè¿˜æœ‰å› ä¸ºæŒ‡çº¹æ¨¡å—æ²¡æ’å¥½å¯¼è‡´æ— æ³•ä½¿ç”¨æŒ‡çº¹ã€‚</p>
<p>è§£å†³ä¸Šè¿°é—®é¢˜åï¼Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ— æ³•è§£å†³ï¼Œå°±æ˜¯åå£³æ— æ³•å®Œå…¨è´´åˆï¼Œæ®ç½‘ä¸Šè¯´æ˜¯å› ä¸ºé‡Œé¢æ²¡æ”¾å¹³ï¼Œä½†è§‰å¾—è¿™ä¸ªæ²¡ä»€ä¹ˆå¤§ç¢ï¼Œåæ­£å¹³æ—¶ä¹Ÿæ˜¯æˆ´æ‰‹æœºå£³ï¼Œåªè¦ä¸é‡æ‘”å°±æ²¡äº‹ã€‚</p>
<h3 id="æ„Ÿæƒ³"><a href="#æ„Ÿæƒ³" class="headerlink" title="æ„Ÿæƒ³"></a>æ„Ÿæƒ³</h3><p>ç»è¿‡ä¸‰å¤©çš„æŠ˜è…¾ï¼Œæ€»ç®—æ˜¯æ¢å¥½äº†ï¼Œè™½ç„¶æœ€åå„ç§é—®é¢˜ï¼Œä½†ä¸ç®¡æ€ä¹ˆè¯´ä¹Ÿæ˜¯å°è¯•è¿‡ï¼Œå½“ç„¶æœ€é‡è¦ä¸€ä¸ªåŸå› ä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ªæ‰‹æœºæœ¬èº«å¹¶ä¸è´µé‡ï¼Œå°±å½“ç»ƒç»ƒæ‰‹ï¼Œå¦åˆ™æˆ‘è¿˜æ˜¯ä¼šé€‰æ‹©é€å»ç»´ä¿®åº—çš„ï¼Œæ¯•ç«Ÿä¸“ä¸šçš„äº‹å°±åº”è¯¥äº¤ç»™ä¸“ä¸šçš„äººåšã€‚</p>
<h2 id="RSS-é˜…è¯»"><a href="#RSS-é˜…è¯»" class="headerlink" title="RSS é˜…è¯»"></a>RSS é˜…è¯»</h2><p>ä»Šå¹´æœ€å¤§ä¸€ä¸ªæ”¹å˜ï¼Œå°±æ˜¯å¼€å§‹ä¹ æƒ¯ RSS é˜…è¯»ï¼Œè¿™å¤§å¤§å‡å°‘æˆ‘éœ€è¦åœ¨ä¸åŒå¹³å°åˆ‡æ¢çš„ç¹çï¼Œæ”¹ç”¨ RSS è®¢é˜…åï¼Œèƒ½è‡ªç”±è®¢é˜…è‡ªå·±æ„Ÿå…´è¶£çš„å†…å®¹ï¼Œä¸å—ç®—æ³•æ¨èçš„å½±å“ï¼Œä¸”å¯¹å„å¤§å¹³å°çš„æ–‡ç« æ‹¥æœ‰ä¸€è‡´çš„é˜…è¯»ä½“éªŒã€‚</p>
<h3 id="é˜…è¯»å™¨"><a href="#é˜…è¯»å™¨" class="headerlink" title="é˜…è¯»å™¨"></a>é˜…è¯»å™¨</h3><p>é¦–å…ˆæ˜¯è¦æ‰¾ä¸€ä¸ªç”¨å¾—èˆ’æœçš„ RSS é˜…è¯»å™¨ï¼Œæˆ‘åœ¨å‰å‡ ä¸ªæœˆéƒ½ä¸€ç›´åœ¨ä½¿ç”¨ RSS Reader Primeï¼Œè¿™ä¸ªé˜…è¯»å™¨çš„ä¼˜ç‚¹æ˜¯ï¼šé…è‰²å¥½çœ‹ï¼Œé˜…è¯»ä½“éªŒå¾ˆå¥½ã€æ”¯æŒæœç´¢ä»¥å‰é˜…è¯»è¿‡çš„æ–‡ç« ã€‚</p>
<p>ä½†æ˜¯åæ¥éšç€æˆ‘å¯¹ RSS çš„éœ€æ±‚è¶Šæ¥è¶Šå¤§ï¼Œç»å¸¸éœ€è¦åœ¨ä¸åŒè®¾å¤‡é—´åŒæ­¥è®¢é˜…æºå’Œé˜…è¯»å†å²ï¼Œè™½ç„¶è¯¥è½¯ä»¶è‡ªå¸¦æœ‰ iCloud åŒæ­¥ï¼Œä½†æ˜¯æŒºæ‰æ€¥çš„ï¼Œç»å¸¸å‡ºç°æ— æ³•åŒæ­¥çš„é—®é¢˜ï¼Œäºæ˜¯å‰æ®µæ—¶é—´è¶ Reeder 4 é™å…ï¼Œèµ¶ç´§åœ¨ä¸‰ä¸ªè®¾å¤‡ä¸­å®‰è£…ï¼Œç„¶åå¼€å§‹æˆ‘çš„ RSS æŠ˜è…¾ä¹‹æ—…ã€‚</p>
<h3 id="äº‘æœåŠ¡"><a href="#äº‘æœåŠ¡" class="headerlink" title="äº‘æœåŠ¡"></a>äº‘æœåŠ¡</h3><p>é¦–å…ˆ Reeder æ”¯æŒä½¿ç”¨ç¬¬ä¸‰æ–¹è´¦å·ç™»å½•ï¼Œå¦‚ Feedlyã€Inoreader ç­‰ï¼Œä½†æ˜¯æˆ‘å°è¯•è¿‡è¿™ä¸¤è€…çš„æœåŠ¡ï¼Œæ€»è§‰å¾—æœ‰è®¢é˜…æºé™åˆ¶ï¼Œèµ¶ç´§ä¸å¤ªèˆ’æœï¼Œä¸”æˆ‘ç°åœ¨å·²ç»è®¢é˜…è¶…è¿‡ 100 ä¸ª RSS æºï¼Œäºæ˜¯åœ¨ <a target="_blank" rel="noopener" href="https://diygod.me/ohmyrss/">æˆ‘æœ‰ç‰¹åˆ«çš„ RSS ä½¿ç”¨æŠ€å·§</a> è¿™ç¯‡æ–‡ç« çš„å®‰åˆ©ä¸­ï¼Œæˆ‘ä¹Ÿè‡ªå·±æ­äº†ä¸€ä¸ª <a target="_blank" rel="noopener" href="https://github.com/HenryQW/docker-ttrss-plugins">Tiny Tiny RSS</a>ï¼Œä»æ­¤ä¸å†æ‹…å¿ƒæœ‰é™åˆ¶ã€‚</p>
<h3 id="å®šåˆ¶è®¢é˜…æº"><a href="#å®šåˆ¶è®¢é˜…æº" class="headerlink" title="å®šåˆ¶è®¢é˜…æº"></a>å®šåˆ¶è®¢é˜…æº</h3><p>è‡ªå»º ttrss åï¼Œå°±å¼€å§‹æŠ˜è…¾å¦‚ä½•è®¢é˜…ä¸€äº›ä¸æ”¯æŒ rss çš„ç½‘ç«™ï¼Œé‚£å°±ä¸å¾—ä¸æ <a target="_blank" rel="noopener" href="https://docs.rsshub.app/">RSSHub</a> è¿™ä¸ªå¼€æºé¡¹ç›®äº†ï¼ˆä¸å‰é¢é‚£ç¯‡æ–‡ç« æ˜¯åŒä¸€ä¸ªä½œè€…ï¼‰ï¼Œæˆ‘è‡ªå·± fork äº†ä¸€ä»½éƒ¨ç½²åœ¨è‡ªå·±çš„ vps ä¸Šï¼Œæ ¹æ®è‡ªå·±å…´è¶£æ·»åŠ  RSS è®¢é˜…æºï¼Œå…¶å®å¤§éƒ¨åˆ†ä¸ªäººåšå®¢éƒ½æ˜¯æ”¯æŒ RSS è®¢é˜…çš„ï¼Œä¸»è¦æ˜¯ä¸€äº›æ¯”è¾ƒå¥‡æ€ªçš„éœ€æ±‚ï¼Œæ¯”å¦‚ï¼šå…¨æ–‡è¾“å‡ºå†…å®¹ã€ç­›é€‰åˆ†ç±»ç­‰ã€‚</p>
<p>æˆ‘è¿˜æœ‰ä¸€ä¸ªæƒ³æ³•ï¼Œå°±æ˜¯æŠŠä¸€äº›è‹±æ–‡è®¢é˜…æºçš„æ ‡é¢˜ç¿»è¯‘æˆä¸­æ–‡ï¼Œæ¯•ç«Ÿè‹±æ–‡è¿˜æ˜¯æ¯”è¾ƒçƒ‚ï¼Œè¿™æ ·æˆ‘å°±èƒ½å¿«é€Ÿå¯»æ‰¾æ„Ÿå…´è¶£çš„æ–‡ç« é˜…è¯»ï¼Œè€Œä¸ç”¨ä¸€ä¸ªä¸€ä¸ªç»†çœ‹ï¼Œäºæ˜¯æˆ‘æ‰¾åˆ°ä¸€ä¸ªå¯ç”¨çš„ google translate åº“ <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/google-translate-open-api">google-translate-open-api</a>ï¼Œä½†åœ¨æˆ‘çš„å¥—è·¯äº‘ä¸Šä¼šè¶…æ—¶ï¼Œè€Œåœ¨è°·æ­Œäº‘åˆ™æ²¡é—®é¢˜ï¼Œåæ¥æƒ³æƒ³è¿™æ ·å¯¹æˆ‘è‹±æ–‡æå‡æ˜¯æ— å¸®åŠ©çš„ï¼Œæ‰€ä»¥ä¹Ÿå°±æ”¾å¼ƒäº†ã€‚</p>
<p>å³ä¾¿ RSSHub å·²ç»è¶³å¤Ÿå¼ºå¤§ï¼Œä½†ç”±äºéƒ¨ç½²åœ¨å›½å†…çš„ vps ä¸Šï¼Œå³ä¾¿æˆ‘è®¾ç½®äº†ä»£ç†ï¼Œä¹Ÿä¼šå‡ºç°æ— æ³•è®¿é—®éƒ¨åˆ†éœ€è¦ç§‘å­¦ä¸Šç½‘çš„ç½‘ç«™ï¼Œè¿™æ—¶å€™æˆ‘ä¼šä½¿ç”¨ <a target="_blank" rel="noopener" href="https://feed43.com/">Feed43</a> å®šåˆ¶è¿™äº›æºï¼Œè™½ç„¶æ¯”è¾ƒåœŸï¼Œä½†ä¹Ÿèƒ½å‡‘åˆç”¨ã€‚</p>
<h2 id="é—¯è¶Šè‡ªåŠ¨ç­¾åˆ°"><a href="#é—¯è¶Šè‡ªåŠ¨ç­¾åˆ°" class="headerlink" title="é—¯è¶Šè‡ªåŠ¨ç­¾åˆ°"></a>é—¯è¶Šè‡ªåŠ¨ç­¾åˆ°</h2><p>æˆ‘ä»¬å­¦æ ¡å®ä¹ æœŸéœ€è¦æ¯å¤©åœ¨ä¸€ä¸ªå«åš ã€Œé—¯è¶Šé¡¶å²—å®ä¹ ç®¡ç†ç³»ç»Ÿã€ çš„è½¯ä»¶ä¸Šé¢å†™æ—¥å¿—ç­¾åˆ°ï¼Œä¸ªäººå¯¹äºè¿™ç§ç¹çä¸”çº¯å±åº”ä»˜çš„æ“ä½œå®åœ¨ä¸èƒ½å¿å—ï¼Œä¸è¿‡ä¹‹å‰æœ‰ä¸ªæœ‹å‹åšäº†ä¸ªè‡ªåŠ¨ç­¾åˆ°çš„è„šæœ¬ï¼Œæˆ‘ä¹Ÿå°±ç›´æ¥ç”¨ä»–çš„ï¼Œæ‡’å¾—é‡å¤é€ è½®å­ã€‚</p>
<p>æœ€è¿‘çªç„¶æƒ³æç‚¹ä¸šä½™é¡¹ç›®ï¼Œå°±ä¼°æ‘¸ç€åœ¨ä»–çš„åŸºç¡€ä¸Šåšä¸ªæ›´å®Œå–„çš„è‡ªåŠ¨ç­¾åˆ°ç³»ç»Ÿï¼Œä¸ä»…é™äºå­¦ç”Ÿè‡ªåŠ¨ç­¾åˆ°ï¼Œè¿˜æ‰“ç®—åšä¸€ä¸ªå¯ä»¥è®©æ•™å¸ˆå¿«æ·ç‚¹è¯„çš„æ“ä½œï¼Œæ®æˆ‘äº†è§£ï¼Œæ•™å¸ˆåœ¨ä¸Šé¢è¦é€ä¸€å¯¹å­¦ç”Ÿçš„æ—¥å¿—ç‚¹è¯„ï¼Œæ“ä½œè¦æ›´åŠ ç¹çï¼Œã€‚</p>
<p>è€Œä¸”æ ¹æ®è¯¥è½¯ä»¶å®˜ç½‘ä¸Šæè¿°ï¼Œåœ¨å¹¿ä¸œçœå°±æœ‰åå‡ å®¶åˆä½œæŠ€æ ¡ï¼Œå¦‚æœæˆ‘åšçš„è¿™ä¸ªç³»ç»Ÿèƒ½è®©å¤§å®¶èŠ‚çœè¿™äº›æ—¶é—´ï¼Œè¿˜æ˜¯æŒºæœ‰æˆå°±æ„Ÿçš„ã€‚</p>
<p>åˆæ­¥æƒ³æ³•æ˜¯åšä¸€ä¸ª web çš„ç®¡ç†åå° + å°ç¨‹åºç”¨æˆ·ç«¯ ï¼Œåé¢æ ¹æ®å®é™…ç”¨æˆ·é‡å†è€ƒè™‘è¦ä¸è¦åšæˆ SASS ç‰ˆã€‚</p>
<p>ç›®å‰åŸºæœ¬æ ¸å¿ƒç­¾åˆ°åŠŸèƒ½å·²ç»å®ç°ï¼Œå‰©ä¸‹çš„å°±æ˜¯åšæˆä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿï¼Œè‡³äºæŠ€æœ¯æ ˆï¼Œå°è¯•ä¸€ä¸‹ä½¿ç”¨ nest.js + react ã€‚</p>
<h2 id="å…«ä½°"><a href="#å…«ä½°" class="headerlink" title="å…«ä½°"></a>å…«ä½°</h2><p><a target="_blank" rel="noopener" href="https://4ark.me/posts/ba-bai-review.html">ã€Šå…«ä½°ã€‹è¯»åæ„Ÿ</a></p>
<h2 id="ä¸‹æœˆè®¡åˆ’"><a href="#ä¸‹æœˆè®¡åˆ’" class="headerlink" title="ä¸‹æœˆè®¡åˆ’"></a>ä¸‹æœˆè®¡åˆ’</h2><ol>
<li>å¾®ä¿¡å…¬ä¼—å· RSS è®¢é˜…æº</li>
<li>åœ¨è¯­é›€æ„å»ºè‡ªå·±çš„çŸ¥è¯†åº“</li>
<li>è¯»å®Œã€Šæ¸…é†’æ€è€ƒçš„è‰ºæœ¯ã€‹</li>
</ol>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/posts/ba-bai-review.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/posts/ba-bai-review.html" itemprop="url">ã€Šå…«ä½°ã€‹è§‚åæ„Ÿ</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-28T00:03:45+08:00">
                2020-08-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <p>è¿™å‡ å¤©åœ¨å¾ˆå¤šç¤¾åŒºç½‘ç«™éƒ½çœ‹åˆ°å…³äºã€Šå…«ä½°ã€‹çš„è¯„è®ºï¼Œè¶ç€å‘¨æœ«å’Œå¥³æœ‹å‹å»è§‚çœ‹ï¼Œä¹Ÿç®—äº†å´å¥¹ä¸€ç›´è¯´ä»Šå¹´å› ä¸ºç–«æƒ…æœŸé—´æ²¡æœ‰å»çœ‹è¿‡ç”µå½±çš„é—æ†¾ã€‚</p>
<p>å…¶å®åœ¨ä¹‹å‰æœ‰äº†è§£è¿‡è¿™éƒ¨ç”µå½±ï¼Œä¸»è¦è®²è¿°çš„æ˜¯ 1937 å¹´æ·æ²ªä¼šæˆ˜çš„æœ€åä¸€å½¹ï¼Œâ€œå…«ç™¾å£®å£«â€å¥‰å‘½åšå®ˆä¸Šæµ·å››è¡Œä»“åº“ï¼Œä»¥å°‘æ•Œå¤šé¡½å¼ºæŠµæŠ—å››å¤©å››å¤œçš„è¿™æ®µçœŸå®å†å²äº‹ä»¶ã€‚</p>
<p>å› ä¸ºæ€»æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œè¿™éƒ¨ç”µå½±ä»å»å¹´ä¸€ç›´æ‹–åˆ°ä»Šå¹´æ‰ç»ˆäºä¸Šæ˜ ï¼Œæœ€åä¸å¯é¿å…åœ°è¦åšä¸€äº›å¦¥åï¼Œä½†æ˜¯å°±ä¸Šæ˜ åçš„å‰§æƒ…æ¥è¯´è¿˜æ˜¯å¯ä»¥æ¥å—çš„ï¼Œè€Œä¸”æ®ç½‘ä¸Šèµ„æ–™æ‰€è¯´ï¼Œç”µå½±åŸæœ¬çš„é¾™æ ‡æ˜¯ 2019 ç¬¬ 88 å·ï¼ˆå…«åå…«å¸ˆï¼‰ï¼Œä½†æ˜¯åæ¥æ”¹ä¸º 2019 ç¬¬ 800 å·ï¼ˆå…«ç™¾å£®å£«ï¼‰ï¼Œä»è¿™ä¸¤ä¸ªå®šåˆ¶çš„é¾™æ ‡ï¼Œèƒ½çœ‹å‡ºå›½å®¶ç”µå½±å±€ç¡®å®æ˜¯ç»™äº†ç‰¹åˆ«ä¼˜å¾…çš„ã€‚</p>
<p>æš‚æ—¶æŠ›å¼€å†å²ï¼Œå°±ç”µå½±æœ¬èº«çš„è´¨é‡è€Œè¨€ï¼Œæˆ‘è§‰å¾—å¯ä»¥ç»™ä¸ª 4 æ˜Ÿï¼Œå…¶ä¸­æœ‰å¾ˆå¤šåœºæˆ˜æ–—æˆï¼Œä¸ä¹ä¸€äº›è¡€è…¥çš„ç”»é¢ï¼Œä¸”æ•´ä½“å‰§æƒ…ç›¸å¯¹ç´§å‡‘ï¼Œæˆ˜æ–—æ€»æ˜¯æ¥å¾—å¾ˆçªç„¶ï¼Œå‰ä¸€ç§’è¿˜æ˜¯æ´»ç”Ÿç”Ÿçš„äººï¼Œä¸‹ä¸€ç§’å°±å€’ä¸‹ï¼Œèƒ½å¦‚æ­¤è¿‘è·ç¦»è§‚çœ‹æˆ˜äº‰çš„æ®‹é…·ï¼Œè®©æˆ‘å¯¹ä»Šå¤©èƒ½å¤„åœ¨å’Œå¹³çš„å¹´ä»£æ„Ÿåˆ°å¹¸è¿ï¼Œä¹Ÿè®©æŸäº›æ•´å¤©æƒ³ç€å¼€æˆ˜çš„äººçœ‹çœ‹ï¼Œè¿˜æ˜¯æŒºæœ‰æ•™è‚²æ„ä¹‰çš„ã€‚</p>
<p>å› ä¸ºå¤ªå…³æ³¨å‰§æƒ…æœ¬èº«ï¼Œæˆ‘ä»å¤´åˆ°å°¾å¹¶æ²¡æœ‰å¾ˆå…³æ³¨å“ªä¸ªè§’è‰²æ˜¯è°æ‰®æ¼”çš„ï¼Œä»¥è‡³äºåæ¥æˆ‘ç”šè‡³æ²¡æœ‰å‘ç°é‚£ä¸ªç‰¹æ´¾å‘˜å±…ç„¶æ˜¯é»„æ™“æ˜æ‰®æ¼”çš„ï¼Œå…¶ä¸­ä¹Ÿæœ‰ä¸€äº›æˆ‘ä¹‹å‰ä¸å¤ªæ„Ÿå…´è¶£çš„æ¼”å‘˜ï¼Œä½†è¿™éƒ¨æˆæˆ‘è®¤ä¸ºæ˜¯è¶…å‡ºäº†ä»–ä»¬ä¹‹å‰çš„æ°´å¹³çš„ã€‚</p>
<p>è¿‘å‡ å¹´æˆ‘å›½çš„æŠ—æ—¥ç‰‡ï¼Œæœ‰ä¸€ä¸ªé€šç—…ï¼Œé‚£å°±æ˜¯æ•…æ„ä¸‘åŒ–æ—¥æœ¬å†›äººï¼Œè€Œä¸€å‘³å¤¸å¤§è‡ªå·±ï¼Œä»¥æ­¤é¼“å¹æ°‘æ—ä¸»ä¹‰ã€‚ä½†è¿™éƒ¨ç”µå½±å¹¶æ²¡æœ‰ï¼Œå½±ç‰‡ä¸­ï¼Œä¸€åè®°è€…å»åˆ°æ—¥å†›è¥åœ°æ—¶ï¼Œçœ‹è§æ—¥å†›æˆ’å¤‡æ£®ä¸¥ã€è¨€è¡Œå¾‹å·±ï¼Œä¸”å¯¹ç‰ºç‰²å†›äººç»™äºˆåšè‘¬ï¼Œè¯´æ˜æ—¥å†›çš„å®åŠ›ä¸å®¹å°è§‘ï¼Œæ²¡æœ‰æ•…æ„è´¬ä½æ•Œäººçš„æ‹æ‘„æ–¹å¼å¾ˆå€¼å¾—å¤§å®¶å­¦ä¹ ã€‚è¿™ä¹Ÿå‡¸æ˜¾ä¸­å›½å†›æ–¹çš„è‹±å‹‡æŠ—æˆ˜å’Œä¸ºèƒœåˆ©æ‰€ä»˜å‡ºçš„ä»£ä»·ã€‚</p>
<p>è¿™éƒ¨ç”µå½±ä¸æ˜¯è¦æ¿€èµ·æ°‘æ—ä¸»ä¹‰ï¼Œæ›´ä¸æ˜¯è®©æˆ‘ä»¬æ•Œè§†æ—¥æœ¬è¿™ä¸ªå›½å®¶ï¼Œè€Œæ˜¯è®©æˆ‘ä»¬ä¸è¦å¿˜è®°é‚£æ®µå†å²ï¼Œä»è€Œæ›´åŠ çæƒœç°åœ¨å’Œå¹³çš„æ—¶ä»£ï¼Œé‚£æ—¶å€™æˆ‘ä»¬ä¹‹æ‰€ä»¥è¢«æ‰“å¾—è¿™ä¹ˆæƒ¨ï¼Œé™¤äº†è·Ÿæ—¥æœ¬å®åŠ›æ‚¬æ®Šä¹‹å¤–ï¼Œæ›´å¤šçš„æ˜¯å›½äººè‡ªå·±ä¸å›¢ç»“ï¼Œå½±ç‰‡ä¸­æœ‰ä¸€å¹•ç»™æˆ‘å¾ˆå¤§å†²å‡»ï¼Œå½“æ—¶æ—¥å†›æ­£åœ¨æ”»æ¥¼ï¼Œè€Œå›½å†›è‡ªè¡Œç»„æˆæ•¢æ­»é˜Ÿé«˜å–Šè‡ªå·±çš„å®¶ä¹¡å’Œåå­—ï¼Œèº«ç»‘æ‰‹æ¦´å¼¹å‰ä»†åç»§è·³æ¥¼ä¸æ•ŒäººåŒå½’äºå°½ï¼Œå½“æ—¶å¯¹å²¸å›´è§‚çš„äººè¯´çš„ä¸€å¥è¯ï¼šâ€œå›½äººçš†å¦‚æ­¤ï¼Œå€­å¯‡ä½•æ•¢ï¼Ÿâ€ã€‚</p>
<p>å½±ç‰‡ç»“æŸæ—¶ï¼Œè°¢æ™‹å…ƒå›¢é•¿æŒ‰ç…§å†›é˜Ÿé«˜å±‚å‘½ä»¤ï¼Œç‡é¢†å‰©ä½™çš„â€œå…«ç™¾å£®å£«â€ï¼Œå†²è¿‡æ—¥å†›ç«åŠ›å°é”çš„è¿å‘è‹±ç§Ÿç•Œçš„æ¡¥ã€‚å½±ç‰‡åˆ°è¿™é‡Œå°±ç»“æŸäº†ã€‚å®é™…ä¸Šï¼Œåé¢å†²è¿‡è‹±ç§Ÿç•Œçš„â€œå…«ç™¾å£®å£«â€ç»“å±€æ›´åŠ æ‚²å‡‰ï¼Œæœ‰å…´è¶£å¯ä»¥è‡ªè¡Œæœå¯»ã€‚è¿™é‡Œæˆ‘æƒ³è¯´çš„å¸Œæœ›ä»¥åæˆ‘ä»¬èƒ½æ­£è§†æˆ‘ä»¬çš„å†å²ï¼Œæ›´ä¸è¦æ‰­æ›²äº‹å®ï¼Œæ•¢äºæ­£è§†è‡ªèº«å†å²æ±¡ç‚¹çš„æ°‘æ—ï¼Œå‹‡äºæ‰¿è®¤é”™è¯¯ï¼Œæ‰æ˜¯ä¼Ÿå¤§çš„æ°‘æ—ã€‚</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/08/15/NET-Core%E4%B8%AD%E5%AF%B9%E8%B1%A1%E6%B1%A0-Object-Pool-%E7%9A%84%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/08/15/NET-Core%E4%B8%AD%E5%AF%B9%E8%B1%A1%E6%B1%A0-Object-Pool-%E7%9A%84%E4%BD%BF%E7%94%A8/" itemprop="url">.NET Core ä¸­å¯¹è±¡æ± (Object Pool)çš„ä½¿ç”¨</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-15T16:37:23+08:00">
                2020-08-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" itemprop="url" rel="index">
                    <span itemprop="name">ç¼–ç¨‹è¯­è¨€</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <p>åœ¨æ­¤å‰çš„åšå®¢ä¸­ï¼Œåšä¸»å‚è€ƒ <a target="_blank" rel="noopener" href="https://github.com/dotnet-architecture/eShopOnContainers">eShopOnContainers</a> å®ç°äº†ä¸€ä¸ªåŸºäº RabbitMQ çš„äº‹ä»¶æ€»çº¿(EventBus)ã€‚åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæŒä¹…åŒ–è¿æ¥çš„ç±»<code>DefaultRabbitMQPersistentConnection</code>ï¼Œä¸»è¦è§£å†³äº† RabbitMQ åœ¨è¿æ¥æ–­å¼€åè‡ªåŠ¨é‡è¿çš„é—®é¢˜ï¼Œå¯å®é™…ä¸Šæˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒRabbitMQ æä¾›çš„è¿æ¥æ•°æ˜¯æœ‰ä¸€ä¸ªä¸Šé™çš„ï¼Œå¦‚æœé¢‘ç¹åœ°ä½¿ç”¨çŸ­è¿æ¥çš„æ–¹å¼ï¼Œå³é€šè¿‡<code>ConnectionFactory</code>çš„<code>CreateConnection()</code>æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªè¿æ¥ï¼Œä»æœ¬è´¨ä¸Šè®²ï¼Œä¸€ä¸ª<code>Connection</code>å¯¹è±¡å°±æ˜¯ä¸€ä¸ª TCP è¿æ¥ï¼Œè€Œ<code>Channel</code>åˆ™æ˜¯æ¯ä¸ª<code>Connection</code>å¯¹è±¡ä¸‹æœ‰é™çš„è™šæ‹Ÿè¿æ¥ï¼Œæ³¨æ„â€œæœ‰é™â€è¿™ä¸ªé™å®šè¯ï¼Œè¿™æ„å‘³ç€<code>Channel</code>å’Œ<code>Connection</code>ä¸€æ ·ï¼Œéƒ½ä¸èƒ½æ¯«æ— èŠ‚åˆ¶çš„åˆ›å»ºä¸‹å»ã€‚æ­¤æ—¶ï¼Œå®˜æ–¹æ¨èçš„åšæ³•æœ‰ä¸¤ç§ï¼š(1)ï¼šä¸€ä¸ª<code>Connection</code>å¯¹åº”å¤šä¸ª<code>Channel</code>åŒæ—¶ä¿è¯æ¯ä¸ª<code>Channel</code>çº¿ç¨‹ç‹¬å ï¼›(2)ï¼šåˆ›å»ºä¸€ä¸ª<code>Connection</code>æ± åŒæ—¶å®šæœŸæ¸…é™¤æ— æ•ˆè¿æ¥ã€‚è¿™é‡Œçš„ç¬¬äºŒç§åšæ³•ï¼Œæ˜¾ç„¶å°±æ˜¯æˆ‘ä»¬ä»Šå¤©è¦è¯´çš„å¯¹è±¡æ± (Object Pool)å•¦ï¼Œæˆ‘ä»¬å°†ä»è¿™é‡Œæ‹‰å¼€è¿™ç¯‡åšå®¢çš„å¸·å¹•ã€‚</p>
<h1 id="ä»€ä¹ˆæ˜¯å¯¹è±¡æ± "><a href="#ä»€ä¹ˆæ˜¯å¯¹è±¡æ± " class="headerlink" title="ä»€ä¹ˆæ˜¯å¯¹è±¡æ± "></a>ä»€ä¹ˆæ˜¯å¯¹è±¡æ± </h1><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥å›ç­”ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä»€ä¹ˆæ˜¯å¯¹è±¡æ± ï¼Ÿç®€å•æ¥è¯´ï¼Œå®ƒå°±æ˜¯ä¸€ç§ä¸ºå¯¹è±¡æä¾›å¯å¤ç”¨æ€§èƒ½åŠ›çš„è½¯ä»¶è®¾è®¡æ€è·¯ã€‚ä¿—è¯è¯´<strong>â€œæœ‰å€Ÿæœ‰è¿˜ï¼Œå†å€Ÿä¸éš¾â€</strong>ï¼Œè€Œå¯¹è±¡æ± å°±æ˜¯é€šè¿‡â€œå€Ÿâ€å’Œâ€œè¿˜â€è¿™æ ·ä¸¤ä¸ªåŠ¨ä½œæ¥ä¿è¯å¯¹è±¡å¯ä»¥è¢«é‡å¤ä½¿ç”¨ï¼Œè¿›è€ŒèŠ‚çœé¢‘ç¹åˆ›å»ºå¯¹è±¡çš„æ€§èƒ½å¼€é”€ã€‚å¯¹è±¡æ± åœ¨æ¸¸æˆè®¾è®¡ä¸­ä½¿ç”¨çš„æ›´æ™®éä¸€ç‚¹ï¼Œå› ä¸ºæ¸¸æˆä¸­å¤§é‡å­˜åœ¨ç€åƒå­å¼¹ã€æ€ªç‰©ç­‰ç­‰è¿™ç±»å¯å¤ç”¨çš„å¯¹è±¡ï¼Œä½ åœ¨ç©ç¬¬ä¸€äººç§°å°„å‡»æ¸¸æˆ(FPS)æ—¶ï¼Œæ€»æ˜¯æœ‰æºæºä¸æ–­çš„å­å¼¹æˆ–è€…ä¸§å°¸å‡ºç°ï¼Œå¯äº‹å®ä¸Šè¿™ä¸è¿‡æ˜¯æ•°å­—ä¸–ç•Œçš„å¾ªç¯å†ç”Ÿï¼Œå› ä¸ºç©å®¶çš„ç”µè„‘å†…å­˜å§‹ç»ˆéƒ½æœ‰ä¸€ä¸ªä¸Šé™ã€‚è€Œåœ¨æ•°æ®åº“çš„ä¸–ç•Œé‡Œï¼Œåˆ™å­˜åœ¨ç€ä¸€ä¸ªè¢«ç§°ä¸ºâ€œè¿æ¥æ± â€çš„ä¸œè¥¿ï¼Œæ¯å½“å‡ºç°æ•°æ®åº“æ— æ³•è¿æ¥çš„æƒ…å†µæ—¶ï¼Œç»éªŒä¸°å¯Œçš„å¼€å‘äººå‘˜å¾€å¾€ä¼šå…ˆæ£€æŸ¥â€œè¿æ¥æ± â€æ˜¯å¦æ»¡äº†ï¼Œè¿™å…¶å®å°±æ˜¯å¯¹è±¡æ± æ¨¡å¼åœ¨ç‰¹å®šé¢†åŸŸçš„å…·ä½“å®ç°å•¦ï¼Œæ‰€ä»¥ï¼Œå¯¹è±¡æ± æœ¬è´¨ä¸Šå°±æ˜¯è´Ÿè´£ä¸€ç»„å¯¹è±¡åˆ›å»ºå’Œé”€æ¯çš„å®¹å™¨ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªåŸºæœ¬çš„å¯¹è±¡æ± ç¤ºæ„å›¾ï¼š</p>
<p><img src="https://i.loli.net/2020/08/22/lReo7LQa1SODZpc.png" alt="å¯¹è±¡æ± ç¤ºæ„å›¾"></p>
<p>å¯ä»¥æ³¨æ„åˆ°ï¼Œ å¯¹è±¡æ± æœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯å¯ä»¥è‡ªä¸»åœ°ç®¡ç†â€œæ± å­â€å†…çš„æ¯ä¸ªå¯¹è±¡ï¼Œå†³å®šå®ƒä»¬æ˜¯éœ€è¦è¢«å›æ”¶è¿˜æ˜¯å¯ä»¥é‡å¤ä½¿ç”¨ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œéœ€è¦æ¶ˆè€—ä¸€å®šçš„ç³»ç»Ÿèµ„æºï¼Œè€Œä¸€æ—¦è¿™äº›å¯¹è±¡å¯ä»¥é‡å¤åœ°ä½¿ç”¨ï¼Œå°±èƒ½æœ‰æ•ˆåœ°èŠ‚çœç³»ç»Ÿèµ„æºçš„å¼€é”€ï¼Œè¿™å¯¹äºæˆ‘ä»¬æé«˜ç³»ç»Ÿæ€§èƒ½ä¼šéå¸¸æœ‰å¸®åŠ©ã€‚ä¹Ÿè®¸ï¼Œç°åœ¨è®¡ç®—æœºçš„ç¡¬ä»¶æ°´å¹³è¶Šæ¥è¶Šå¥½ï¼Œå¯æˆ‘ä»¬è¿˜æ˜¯è¦é‡æ–°æ‹¾èµ·è¿™ä¸ªé¢†åŸŸçš„åŸºç¡€çŸ¥è¯†ï¼Œå³æ•°æ®ç»“æ„ã€ç®—æ³•ã€æ•°å­¦å’Œè‹±è¯­ã€‚å¦‚æœä½ å®Œå…¨ç†è§£äº†å¯¹è±¡æ± æ¨¡å¼ï¼Œä½ åº”è¯¥å¯ä»¥éå¸¸è½»æ¾åœ°ç»™å‡ºä½ çš„å®ç°ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ObjectPool</span>&lt;<span class="title">T</span>&gt; : <span class="title">IObjectPool</span>&lt;<span class="title">T</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">private</span> Func&lt;T&gt; _instanceFactory;</span><br><span class="line">  <span class="keyword">private</span> ConcurrentBag&lt;T&gt; _instanceItems;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">ObjectPool</span>(<span class="params">Func&lt;T&gt; instanceFactory</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">    _instanceFactory = instanceFactory ?? </span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(instanceFactory));</span><br><span class="line">    _instanceItems = <span class="keyword">new</span> ConcurrentBag&lt;T&gt;();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> T <span class="title">Get</span>()</span></span><br><span class="line">  &#123;</span><br><span class="line">    T item;</span><br><span class="line">    <span class="keyword">if</span> (_instanceItems.TryTake(<span class="keyword">out</span> item)) <span class="keyword">return</span> item;</span><br><span class="line">    <span class="keyword">return</span> _instanceFactory();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Return</span>(<span class="params">T item</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">    _instanceItems.Add(item);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šä»¥ä¸Šä»£ç ç‰‡æ®µæ¥è‡ªå¾®è½¯çš„ä¸€ç¯‡æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/dotnet/standard/collections/thread-safe/how-to-create-an-object-pool">How to: Create an Object Pool by Using a ConcurrentBag</a>ã€‚å®é™…ä¸Šï¼Œé™¤äº†<code>ConcurrentBag&lt;T&gt;</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©çš„æ•°æ®ç»“æ„è¿˜å¯ä»¥æ˜¯<code>Stack&lt;T&gt;</code>ã€<code>Queue&lt;T&gt;</code>ä»¥åŠ<code>BlockingCollection&lt;T&gt;</code>ï¼Œæ­¤ä¸­å·®åˆ«ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±å»ä½“ä¼šã€‚</p>
<h1 id="NET-Core-ä¸­çš„å¯¹è±¡æ± "><a href="#NET-Core-ä¸­çš„å¯¹è±¡æ± " class="headerlink" title=".NET Core ä¸­çš„å¯¹è±¡æ± "></a>.NET Core ä¸­çš„å¯¹è±¡æ± </h1><p>åœ¨.NET Core ä¸­ï¼Œå¾®è½¯å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†å¯¹è±¡æ± çš„å®ç°ï¼Œå³<code>Microsoft.Extensions.ObjectPool</code>ã€‚å®ƒä¸»è¦æä¾›äº†ä¸‰ä¸ªæ ¸å¿ƒçš„ç»„ä»¶ï¼Œåˆ†åˆ«æ˜¯<code>ObjectPool</code>ã€<code>ObjectPoolProvider</code>å’Œ<code>IPooledObjectPolicy</code>ï¼Œå…³äºè¿™ä¸‰è€…é—´çš„å…³ç³»ï¼Œæˆ‘ç»˜åˆ¶äº†ä¸‹é¢çš„ UML å›¾æ¥ä½œä¸ºè¯´æ˜ï¼š</p>
<p><img src="https://i.loli.net/2020/08/22/M6ojLtqgKc5pfCA.png" alt="ObjectPoolæ ¸å¿ƒç»„ä»¶åŠå…¶å…³ç³»"></p>
<p>å¯ä»¥æ³¨æ„åˆ°ï¼Œ<code>ObjectPool&lt;T&gt;</code>æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒå¯¹å¤–æä¾›äº† Get()å’Œ Return()ä¸¤ä¸ªæ–¹æ³•ï¼Œæ‰€è°“çš„â€œæœ‰å€Ÿæœ‰è¿˜â€ï¼Œè¿™ä¸€ç‚¹æ²¡ä»€ä¹ˆå¯è¯´çš„ã€‚æ¥ä¸‹æ¥ï¼Œ<code>ObjectPoolProvider</code>åŒæ ·æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒçš„èŒè´£å°±æ˜¯åˆ›å»º<code>ObjectPool&lt;T&gt;</code>ï¼Œæ‰€ä»¥ï¼Œå®ƒæä¾›äº†ä¸¤ä¸ª<code>Create&lt;T&gt;()</code>æ–¹æ³•ï¼Œä¸¤è€…çš„åŒºåˆ«æ˜¯ï¼Œæ— å‚æ•°ç‰ˆæœ¬æœ¬è´¨ä¸Šä½¿ç”¨çš„æ˜¯<code>DefaultPooledObjectPolicy&lt;T&gt;</code>ã€‚é¡¾åæ€ä¹‰ï¼Œå®ƒåŒ<code>DefaultObjectPool&lt;T&gt;</code>ã€<code>DefaultObjectPoolProvider</code>ä¸€æ ·ï¼Œéƒ½æ˜¯å¾®è½¯æä¾›çš„é»˜è®¤å®ç°ï¼Œå…¶ä¸­<code>IPooledObjectPolicy&lt;T&gt;</code>å¯ä»¥ä¸ºä¸åŒçš„å¯¹è±¡æ± å®šä¹‰ä¸åŒçš„ç­–ç•¥ï¼Œæ¥å†³å®šå¯¹è±¡å¦‚ä½•â€œå€Ÿâ€ã€æ˜¯å¦å¯ä»¥â€œè¿˜â€ã€‚é»˜è®¤çš„å¯¹è±¡æ± <code>DefaultObjectPool&lt;T&gt;</code>å†…éƒ¨ä½¿ç”¨<code>ObjectWrapper[]</code>è¿™ä¸ªæ•°ç»„æ¥ç®¡ç†å¯¹è±¡ï¼Œæ•°ç»„çš„å¤§å°ç­‰äº maximumRetained - 1ï¼Œå› ä¸ºå®ƒå•ç‹¬æŒ‡å®šäº†é¦–é¡¹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ª maximumRetained ç­‰äº<code>Environment.ProcessorCount * 2</code>ï¼Œè¿™é‡Œä¸»è¦ç”¨åˆ°äº†<code>Interlocked.CompareExchange()</code>æ–¹æ³•ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> T <span class="title">Get</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> item = _firstItem;</span><br><span class="line">  <span class="keyword">if</span> (item == <span class="literal">null</span> || Interlocked.CompareExchange(<span class="keyword">ref</span> _firstItem, <span class="literal">null</span>, item) != item)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">var</span> items = _items;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; items.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">      item = items[i].Element;</span><br><span class="line">      <span class="keyword">if</span> (item != <span class="literal">null</span> &amp;&amp; Interlocked.CompareExchange(<span class="keyword">ref</span> items[i].Element, <span class="literal">null</span>, item) == item)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    item = Create();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> item;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Non-inline to improve its code quality as uncommon path</span></span><br><span class="line">[<span class="meta">MethodImpl(MethodImplOptions.NoInlining)</span>]</span><br><span class="line"><span class="function"><span class="keyword">private</span> T <span class="title">Create</span>()</span> =&gt; _fastPolicy?.Create() ?? _policy.Create();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Return</span>(<span class="params">T obj</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (_isDefaultPolicy || (_fastPolicy?.Return(obj) ?? _policy.Return(obj)))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> (_firstItem != <span class="literal">null</span> || Interlocked.CompareExchange(<span class="keyword">ref</span> _firstItem, obj, <span class="literal">null</span>) != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">var</span> items = _items;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; items.Length &amp;&amp; Interlocked.CompareExchange(<span class="keyword">ref</span> items[i].Element, obj, <span class="literal">null</span>) != <span class="literal">null</span>; ++i)</span><br><span class="line">      &#123;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œä¸»è¦ç”¨åˆ°<code>Interlocked.CompareExchange()</code>è¿™ä¸ªæ–¹æ³•ï¼Œå¯¹äº<code>Get()</code>æ–¹æ³•è€Œè¨€ï¼Œå®ƒå°†<code>items[i].Element</code>å’Œ<code>null</code>è¿›è¡Œäº¤æ¢ï¼Œç›¸å½“äºå°†æŒ‡å®šå…ƒç´ è®¾ä¸º null å¹¶è¿”å›åŸå§‹å€¼ï¼›è€Œå¯¹äº<code>Return()</code>æ–¹æ³•è€Œè¨€ï¼Œå¦‚æœå°†<code>items[i].Element</code>å’Œ<code>obj</code>äº¤æ¢åçš„å€¼ä¸ä¸º nullï¼Œåˆ™è¡¨ç¤ºæŒ‡å®šå…ƒç´ å·²ç»â€œå½’è¿˜â€ï¼Œå› ä¸ºè¿™ä¸ªæ–¹æ³•åªæœ‰åœ¨ç¬¬ä¸€ä¸ªå‚æ•°å’Œç¬¬ä¸‰ä¸ªå‚æ•°ç›¸ç­‰æ—¶æ‰ä¼šå‘ç”Ÿäº¤æ¢ã€‚å¥½äº†ï¼Œäº†è§£äº†.NET Core ä¸­å¯¹è±¡æ± çš„å®ç°ä»¥åï¼Œæˆ‘ä»¬æ¥ä¸€èµ·çœ‹çœ‹å…·ä½“çš„ä½¿ç”¨ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> service = <span class="keyword">new</span> ServiceCollection();</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨DefaultObjectPoolProvider</span></span><br><span class="line">service.AddSingleton&lt;ObjectPoolProvider, DefaultObjectPoolProvider&gt;();</span><br><span class="line"><span class="comment">//ä½¿ç”¨é»˜è®¤ç­–ç•¥</span></span><br><span class="line">service.AddSingleton&lt;ObjectPool&lt;Foo&gt;&gt;(serviceProvider =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> objectPoolProvider = serviceProvider.GetRequiredService&lt;ObjectPoolProvider&gt;();</span><br><span class="line">  <span class="keyword">return</span> objectPoolProvider.Create&lt;Foo&gt;();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//ä½¿ç”¨è‡ªå®šä¹‰ç­–ç•¥</span></span><br><span class="line">service.AddSingleton&lt;ObjectPool&lt;Foo&gt;&gt;(serviceProvider =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> objectPoolProvider = serviceProvider.GetRequiredService&lt;ObjectPoolProvider&gt;();</span><br><span class="line">  <span class="keyword">return</span> objectPoolProvider.Create(<span class="keyword">new</span> FooObjectPoolPolicy());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> serviceProvider = _service.BuildServiceProvider();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> objectPool = _serviceProvider.GetService&lt;ObjectPool&lt;Foo&gt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">//æœ‰å€Ÿæœ‰è¿˜ï¼Œä¸¤æ¬¡æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="keyword">var</span> item1 = objectPool.Get();</span><br><span class="line">objectPool.Return(item1);</span><br><span class="line"><span class="keyword">var</span> item2 = objectPool.Get();</span><br><span class="line">Assert.AreEqual(item1, item2);<span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æœ‰å€Ÿæ— è¿˜ï¼Œä¸¤æ¬¡æ˜¯ä¸åŒçš„å¯¹è±¡</span></span><br><span class="line"><span class="keyword">var</span> item3 = objectPool.Get();</span><br><span class="line"><span class="keyword">var</span> item4 = objectPool.Get();</span><br><span class="line">Assert.AreEqual(item3, item4);<span class="comment">//false</span></span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<code>Foo</code>å’Œ<code>FooObjectPoolPolicy</code>æ˜¯ä¸¤ä¸ªéå¸¸å…¸å‹çš„â€œå·¥å…·ç±»â€ï¼Œç±»ä¼¼æˆ‘ä»¬æ‰€è¯´çš„â€œå·¥å…·äººâ€ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Foo</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">string</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">  <span class="keyword">public</span> DateTime? CreatedAt &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">string</span> CreatedBy &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">FooObjectPoolPolicy</span> : <span class="title">IPooledObjectPolicy</span>&lt;<span class="title">Foo</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Foo <span class="title">Create</span>()</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Foo()</span><br><span class="line">    &#123;</span><br><span class="line">      Id = Guid.NewGuid().ToString(<span class="string">&quot;N&quot;</span>),</span><br><span class="line">      CreatedAt = DateTime.Now,</span><br><span class="line">      CreatedBy = <span class="string">&quot;Ezio&quot;</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">Return</span>(<span class="params">Foo obj</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“ä½ éœ€è¦æ§åˆ¶å¯¹è±¡æ± å†…çš„å¯¹è±¡å¦‚ä½•è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œä½ å¯ä»¥è€ƒè™‘å®ç°è‡ªå®šä¹‰çš„<code>IPooledObjectPolicy&lt;T&gt;</code>ï¼Œå¦åˆ™ï¼Œ<code>DefaultPooledObjectPolicy&lt;T&gt;</code>è¿™ä¸ªé»˜è®¤å®ç°å®Œå…¨å¯ä»¥æ»¡è¶³ä½ çš„ä½¿ç”¨ï¼Œè€Œè¿™å°±æ˜¯.NET Core ä¸­å¯¹è±¡æ± çš„æ‰€æœ‰ç”¨æ³•ï¼Œä¸€ä¸ªå®ç°èµ·æ¥å¹¶ä¸å¤æ‚ä½†æ˜¯åœ¨æŸäº›åœºæ™¯ä¸‹éå¸¸æœ‰ç”¨çš„è½¯ä»¶è®¾è®¡æ¨¡å¼ã€‚</p>
<h1 id="å›åˆ°èµ·ç‚¹"><a href="#å›åˆ°èµ·ç‚¹" class="headerlink" title="å›åˆ°èµ·ç‚¹"></a>å›åˆ°èµ·ç‚¹</h1><p>å¥½äº†ï¼Œå›åˆ°æˆ‘ä»¬ä¸€å¼€å§‹çš„é—®é¢˜ï¼Œå³ï¼šå¦‚ä½•è§£å†³ RabbitMQ åœ¨å¤šæ¬¡é‡è¿åæç¤ºè¿æ¥æ•°ä¸è¶³çš„é—®é¢˜ã€‚ç”±äº Channel å¯¹è±¡æœ¬è´¨ä¸Šæ˜¯ Connection å¯¹è±¡ä¸Šçš„ TCP è¿æ¥çš„è½¯è¿æ¥ï¼Œæ‰€ä»¥ï¼Œæ¯å½“åˆ›å»ºä¸€ä¸ªæ–°çš„ Channel çš„æ—¶å€™ï¼Œå®é™…ä¸Šä¼šç‹¬å ä¸€ä¸ª TCP è¿æ¥ã€‚è€ƒè™‘åˆ°åœ¨ä½¿ç”¨ RabbitMQ çš„æ—¶å€™ï¼Œå‘å¸ƒæ¶ˆæ¯&#x2F;æ¶ˆè´¹æ¶ˆæ¯æ¯æ¬¡éƒ½æ˜¯åˆ›å»ºä¸€ä¸ª Channelï¼Œåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹å¯èƒ½ä¼šå¯¼è‡´ TCP è¿æ¥æ•°è¢«ç”¨å®Œï¼Œè¿›è€Œå‡ºç°æ— æ³•è¿æ¥æˆ–è€…å“åº”è¿‡æ…¢ç­‰ä¸€ç³»åˆ—é—®é¢˜ã€‚æ—¢ç„¶ TCP è¿æ¥æ•°æ˜¯æœ‰é™çš„ï¼Œä¸ºä»€ä¹ˆä¸è€ƒè™‘å¤ç”¨è¿™äº› TCP è¿æ¥å‘¢ï¼Ÿä»è¿™ä¸ªè§’åº¦ä¸Šæ¥çœ‹ï¼Œæ•°æ®åº“è¿æ¥æ± æ‰¿æ‹…äº†ç›¸åŒçš„è§’è‰²ï¼Œå¢åŠ è¿æ¥æ•°è¯´åˆ°åº•æ˜¯ä¸€ç§â€œæ²»æ ‡ä¸æ²»æœ¬â€çš„åšæ³•ã€‚åœ¨å…·ä½“å®ç°ä¸Šï¼Œå¯ä»¥è€ƒè™‘ Connectionâ€œæ± â€å’Œ Channelâ€œæ± â€ï¼Œæˆ‘ä»¬æˆ‘ä»¬åƒå®˜æ–¹æ¨èçš„åšæ³•ä¸€æ ·ï¼Œä¸€ä¸ª Connection å¯¹åº”å¤šä¸ª Channelï¼Œå®é™…ä¸Šåªéœ€è¦å®ç° Channelâ€œæ± â€ã€‚é™¤éåœ¨å¤šä¸ª Connection å¯¹åº”å¤šä¸ª Channel çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘åŒæ—¶å®ç° Connectionâ€œæ± â€å’Œ Channelâ€œæ± â€ã€‚å¦ç™½è¯´ï¼Œæˆ‘è¿™é‡Œä¸€ç›´æ²¡èƒ½æ‰¾åˆ°å®ç° Connectionâ€œæ± â€çš„ç›¸å…³èµ„æ–™ï¼Œé«˜å†·çš„ <a target="_blank" rel="noopener" href="https://www.cnblogs.com/catcher1994/">Catcher</a> å¤§ç¥åªæ˜¯è®©æˆ‘å»è®¤çœŸè¯»å®˜æ–¹æ–‡æ¡£ï¼Œææ¸…æ¥š Connection å’Œ Channel çš„å…³ç³»ã€‚è€Œè¿™ä¸ª Channelâ€œæ± â€çš„å®ç°ï¼Œç»“åˆè¿™ç¯‡åšå®¢é‡Œçš„å†…å®¹ï¼Œå®ç°èµ·æ¥æ˜¯éå¸¸ç®€å•çš„ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ChannelObjectPoolPolicy</span> : <span class="title">IPooledObjectPolicy</span>&lt;<span class="title">IModel</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> IConnectionFactory _connectionFactory;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">ChannelObjectPoolPolicy</span>(<span class="params">IConnectionFactory connectionFactory</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">    _connectionFactory = connectionFactory;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> IModel <span class="title">Create</span>()</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">var</span> connection = _connectionFactory.CreateConnection();</span><br><span class="line">    <span class="keyword">return</span> connection.CreateModel();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">Return</span>(<span class="params">IModel obj</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> (!obj.IsOpen)</span><br><span class="line">    &#123;</span><br><span class="line">      obj?.Dispose();</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€æ­¥æ˜¯å®ç°<code>IPooledObjectPolicy&lt;IModel&gt;</code>ï¼Œæ³¨æ„åˆ°ï¼Œè¿™é‡Œé€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥äº†<code>ConnectionFactory</code>ï¼Œæ‰€ä»¥ï¼Œé™¤äº†å¸¸è§„çš„æ³¨å…¥é¡¹ä»¥å¤–ï¼Œè¿™é‡Œè¿˜éœ€è¦æ³¨å…¥<code>ConnectionFactory</code>:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">services.AddSingleton&lt;IConnectionFactory, ConnectionFactory&gt;(sp =&gt; <span class="keyword">new</span> ConnectionFactory() &#123; </span><br><span class="line">    HostName = <span class="string">&quot;localhost&quot;</span>, </span><br><span class="line">    UserName = <span class="string">&quot;guest&quot;</span>, </span><br><span class="line">    Password = <span class="string">&quot;guest&quot;</span> </span><br><span class="line">&#125;);</span><br><span class="line">services.AddSingleton&lt;ObjectPoolProvider, DefaultObjectPoolProvider&gt;();</span><br><span class="line">services.AddSingleton&lt;ObjectPool&lt;IModel&gt;&gt;(serviceProvider =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> objectPoolProvider = serviceProvider.GetRequiredService&lt;ObjectPoolProvider&gt;();</span><br><span class="line">  <span class="keyword">var</span> connectionFactory = serviceProvider.GetRequiredService&lt;ConnectionFactory&gt;();</span><br><span class="line">  <span class="keyword">return</span> objectPoolProvider.Create(<span class="keyword">new</span> ChannelObjectPoolPolicy(connectionFactory));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>ç„¶åï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ EventBus é‡Œæ³¨å…¥<code>ObjectPool&lt;IModel&gt;</code>å³å¯ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬è°ƒç”¨ Channel çš„ç”»é£æ˜¯ä¸‹é¢è¿™æ ·å­çš„ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> channel = _channelPool.Get();</span><br><span class="line"><span class="keyword">try</span> &#123;  <span class="comment">//åœ¨è¿™é‡Œåšç‚¹ä»€ä¹ˆå§  &#125;</span></span><br><span class="line"><span class="keyword">finally</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//å¥½å€Ÿå¥½è¿˜ï¼Œå†å€Ÿä¸éš¾</span></span><br><span class="line">  _channelPool.Return(channel);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…³äº Connectionâ€œæ± â€çš„å®ç°ï¼Œæˆ‘è®¤ä¸ºæˆ‘çš„æƒ³æ³•è¿˜ä¸å¤ªæˆç†Ÿï¼Œæš‚æ—¶åˆ—å…¥æœªæ¥çš„æ€è€ƒè®¡åˆ’ä¸­ï¼Œæ‰€ä»¥ï¼Œè¿™ç¯‡åšå®¢å°±å…ˆå†™åˆ°è¿™é‡Œã€‚</p>
<h1 id="æœ¬æ–‡å°ç»“"><a href="#æœ¬æ–‡å°ç»“" class="headerlink" title="æœ¬æ–‡å°ç»“"></a>æœ¬æ–‡å°ç»“</h1><p>å¯¹è±¡æ± (ObjectPool)æ˜¯ä¸€ç§é€šè¿‡å¤ç”¨å¯¹è±¡æ¥å‡å°‘èµ„æºå¼€é”€è¿›è€Œå®ç°æé«˜ç³»ç»Ÿæ€§èƒ½çš„è½¯ä»¶è®¾è®¡æ¨¡å¼ï¼Œå…¶æ ¸å¿ƒæ˜¯æ§åˆ¶å®¹å™¨å†…å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸæ¥è§„é¿ç³»ç»Ÿçš„ä¸»åŠ¨å›æ”¶ï¼Œä»å¯¹è±¡æ± ä¸­(ObjectPool)â€œå€Ÿâ€å‡ºçš„å¯¹è±¡å¿…é¡»è¦åŠæ—¶â€œå½’è¿˜â€ï¼Œå¦åˆ™ä¼šé€ æˆå¯¹è±¡æ± (ObjectPool)ä¸­æ²¡æœ‰å¯ç”¨èµ„æºã€‚å®ç°å¯¹è±¡æ± å¯ä»¥è€ƒè™‘<code>ConcurrentBag&lt;T&gt;</code>ã€<code>Stack&lt;T&gt;</code>ã€<code>Queue&lt;T&gt;</code>ä»¥åŠ<code>BlockingCollection&lt;T&gt;</code>ç­‰å¤šç§æ•°æ®ç»“æ„ï¼Œè€Œå¾®è½¯åœ¨.NET Core ä¸­å·²ç»ä¸ºæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªç®€å•çš„å¯¹è±¡æ± ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰è‡ªå·±çš„<code>IPooledObjectPolicy&lt;T&gt;</code>å»å†³å®šå¯¹è±¡åº”è¯¥æ€ä¹ˆæ ·â€œå€Ÿâ€ã€æ€ä¹ˆæ ·â€œè¿˜â€ã€‚å› ä¸ºæ­¤å‰å®ç°åŸºäº RabbitMQ çš„ EventBus çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯æ¯æ¬¡åˆ›å»ºä¸€ä¸ª Channelï¼Œå³å®˜æ–¹æ‰€è°“çš„â€œçŸ­è¿æ¥â€çš„æ–¹å¼ï¼Œå› ä¸º Channel æœ¬è´¨ä¸Šæ˜¯ Connection åœ¨ TCP è¿æ¥ä¸Šçš„ä¸€ä¸ªè™šæ‹Ÿè¿æ¥ï¼Œæ‰€ä»¥ï¼Œæ¯æ¬¡åˆ›å»º Channel éƒ½ä¼šå ç”¨ä¸€ä¸ª TCP è¿æ¥ï¼Œå½“æˆ‘ä»¬ç³»ç»Ÿä¸­çš„ TCP è¿æ¥è¢«ç”¨å®Œçš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç°æ— æ³•è¿æ¥ã€è¿æ¥è¿‡æ…¢çš„é—®é¢˜ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æœ€ç»ˆå¼•å…¥äº†å¯¹è±¡æ± ï¼Œå®é™…ä¸Šè¿™é‡Œæ˜¯å®ç°äº†ä¸€ä¸ª Channelâ€œæ± â€ï¼Œå…³äºæ˜¯å¦åº”è¯¥å®ç° Connectionâ€œæ± â€ï¼Œè¿™ä¸€ç‚¹æˆ‘è¿˜æ²¡æœ‰æƒ³å¥½ï¼Œæ€»è€Œè¨€ä¹‹ï¼Œæ¸¸æˆä¸–ç•Œé‡Œå¯ä»¥å¤ç”¨çš„ GameObjectã€å„ç§æ•°æ®åº“é‡Œçš„è¿æ¥æ± ï¼Œéƒ½æ˜¯å¯¹è±¡æ± æ¨¡å¼åœ¨å„è‡ªé¢†åŸŸä¸­çš„å…·ä½“å®ç°ï¼Œè¿™å°±æ˜¯è¿™ç¯‡åšå®¢çš„å†…å®¹å•¦ï¼Œæ¬¢è¿å¤§å®¶åœ¨è¯„è®ºä¸­ç•™è¨€ï¼Œè°¢è°¢å¤§å®¶ï¼</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/post/834cbf1e.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/834cbf1e.html" itemprop="url">æˆ‘ä»¥ä¸ºæˆ‘ä¸ä¼šæˆä¸ºé‚£æ ·çš„ç…ç¬”</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-12T00:37:51+08:00">
                2020-08-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <p>å¤šå¹´å‰åœ¨å¸å§çœ‹è¿‡ä¸€ç¯‡æ–‡ç« ï¼Œé¢˜ç›®å¤§æ¦‚çš„æ„æ€å°±æ˜¯æœ¬æ–‡çš„æ ‡é¢˜ï¼Œä½œè€…è²Œä¼¼å«æ“ç¬”å¸ï¼Œä½†ä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘è®°å¿†é”™ä¹±è¿˜æ˜¯æ€ä¹ˆçš„ï¼Œæˆ‘å±…ç„¶æ²¡æœ‰åœ¨äº’è”ç½‘ä¸Šæ‰¾åˆ°è¿™ç¯‡æ–‡ç« ï¼Œä»Šæ™šçªç„¶æƒ³èµ·äº†è¿™ç¯‡æ–‡ç« ï¼Œ è§‰å¾—å¾ˆé€‚åˆæ­¤åˆ»çš„å¿ƒæƒ…ï¼Œå°±æ¥å†™ä¸€ç¯‡å·®ä¸å¤šçš„å§ã€‚</p>
<p>å½“æˆ‘å°æ—¶å€™çœ‹åˆ°åˆ«äººå®¶é‡Œåµæ¶ï¼Œæˆ‘å¿ƒæƒ³æˆ‘ä»¥åä¸€å®šä¸ä¼šåƒä»–ä»¬è¿™ä¹ˆç…ç¬”ï¼Œç›´åˆ°æˆ‘ç°åœ¨ä¸ºå¤¹åœ¨å¥¹ä»¬ä¸­é—´è€Œæ„Ÿåˆ°å¿ƒç´¯ã€‚</p>
<p>å½“æˆ‘å°æ—¶å€™çœ‹åˆ°åˆ«äººè„¾æ°”æš´èºï¼Œæˆ‘å¿ƒæƒ³æˆ‘ä»¥åä¸€å®šä¸ä¼šåƒä»–ä»¬è¿™ä¹ˆç…ç¬”ï¼Œç›´åˆ°æˆ‘ç°åœ¨è¿˜ç»å¸¸æ— æ³•æ§åˆ¶è‡ªå·±çš„è„¾æ°”ã€‚</p>
<p>å½“æˆ‘å°æ—¶å€™çœ‹åˆ°åˆ«äººè‡ªç§è‡ªåˆ©ï¼Œæˆ‘å¿ƒæƒ³æˆ‘ä»¥åä¸€å®šä¸ä¼šåƒä»–ä»¬è¿™ä¹ˆç…ç¬”ï¼Œç›´åˆ°æˆ‘ç°åœ¨åšä»€ä¹ˆéƒ½å…ˆè€ƒè™‘è‡ªå·±ã€‚</p>
<p>å½“æˆ‘å°æ—¶å€™çœ‹åˆ°åˆ«äººç²¾æ‰“ç»†ç®—ï¼Œæˆ‘å¿ƒæƒ³æˆ‘ä»¥åä¸€å®šä¸ä¼šåƒä»–ä»¬è¿™ä¹ˆç…ç¬”ï¼Œç›´åˆ°æˆ‘ç°åœ¨ä¹Ÿç»å¸¸ç›˜ç®—å¦‚ä½•æ‰ä¸åƒäºã€‚</p>
<p>å½“æˆ‘å°æ—¶å€™çœ‹åˆ°åˆ«äººæœ‰éš¾ä¸å¸®ï¼Œæˆ‘å¿ƒæƒ³æˆ‘ä»¥åä¸€å®šä¸ä¼šåƒä»–ä»¬è¿™ä¹ˆç…ç¬”ï¼Œç›´åˆ°æˆ‘ç°åœ¨å®³æ€•è€åŒå­¦æ‰¾æˆ‘å€Ÿé’±ã€‚</p>
<p>å½“æˆ‘å°æ—¶å€™çœ‹åˆ°åˆ«äººå†·æ¼ æ— æƒ…ï¼Œæˆ‘å¿ƒæƒ³æˆ‘ä»¥åä¸€å®šä¸ä¼šåƒä»–ä»¬è¿™ä¹ˆç…ç¬”ï¼Œç›´åˆ°æˆ‘ç°åœ¨çœ‹åˆ°æœ‰äººæ™•å€’ä¹Ÿä¸æ•¢ä¸Šå»æ‰¶ã€‚</p>
<p>å½“æˆ‘å°æ—¶å€™çœ‹åˆ°åˆ«äººæ²¡æœ‰é“å¾·ï¼Œæˆ‘å¿ƒæƒ³æˆ‘ä»¥åä¸€å®šä¸ä¼šåƒä»–ä»¬è¿™ä¹ˆç…ç¬”ï¼Œç›´åˆ°æˆ‘ç°åœ¨åå…¬äº¤éƒ½ä¼šå…ˆæ‰¾åé¢çš„ä½ç½®ã€‚</p>
<p>å½“æˆ‘å°æ—¶å€™çœ‹åˆ°åˆ«äººä¸åˆç¾¤ï¼Œæˆ‘å¿ƒæƒ³æˆ‘ä»¥åä¸€å®šä¸ä¼šåƒä»–ä»¬è¿™ä¹ˆç…ç¬”ï¼Œç›´åˆ°æˆ‘ç°åœ¨å–œæ¬¢ä¸€ä¸ªäººå®‰é™çš„åšè‡ªå·±çš„äº‹ã€‚</p>
<p>æˆ‘ä»¬ç”Ÿæ´»ä¸­æœ‰å½¢å½¢è‰²è‰²çš„ç…ç¬”ï¼Œä½†æˆ‘ä»¬æ€»æ˜¯åœ¨ä¸åŒçš„æ—¶é—´é‡Œæ‰®æ¼”ç€ä»–ä»¬ã€‚</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/posts/tai-jiu-mei-geng-xin-blog-de-yi-xie-fan-si.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/posts/tai-jiu-mei-geng-xin-blog-de-yi-xie-fan-si.html" itemprop="url">å¤ªä¹…æ²¡æ›´æ–°åšå®¢çš„åŸå› å’Œåæ€</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-03T00:00:00+08:00">
                2020-08-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <p>è·ç¦»ä¸Šä¸€ç¯‡æ–‡ç«  <a target="_blank" rel="noopener" href="https://4ark.me/post/72566ae3.html">æˆ‘çš„ 2019 å¹´åº¦æ€»ç»“</a> å‘å¸ƒæ—¶é—´ï¼Œå·²ç»è¿‡å»å¤§åŠå¹´äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ 2020 å¹´æˆ‘æŠŠå†™åšå®¢çš„ä¹ æƒ¯å¼„ä¸¢äº†ï¼Œå…¶å®åŸå› å¾ˆç®€å•ï¼Œé‚£å°±æ˜¯æˆ‘å˜æ‡’äº†ã€‚</p>
<p>æˆ‘æ›¾ç»™è‡ªå·±æ‰¾è¿‡å€Ÿå£ï¼Œå†™æŠ€æœ¯æ–¹é¢çš„æˆ‘æ€»è§‰å¾—è‡ªå·±å†™çš„å¤ªç²—æµ…ï¼Œå…¶å®è¿™ç±»æ–‡ç« åœ¨ç›®å‰å›½å†…å¹³å°å·²ç»å¤Ÿå¤šäº†ï¼Œæ²¡å¿…è¦é‡å¤äº§å‡ºè¿™ç±»æ–‡ç« ï¼Œä½†æ˜¯ä¸€ç¯‡è´¨é‡å¥½ã€æœ‰æ·±åº¦çš„æ–‡ç« ï¼Œåˆè¦èŠ±è´¹å¤§é‡çš„æ—¶é—´ï¼Œè¿™è®©æˆ‘æ€»æ˜¯æœ›è€Œå´æ­¥ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§ç”Ÿæ´»ç±»æ–‡ç« ï¼Œæˆ‘ä¹Ÿè€ƒè™‘è¿‡è¦ä¸è¦æŠŠç”Ÿæ´»ä¸Šä¸€äº›æ„Ÿæƒ³è®°å½•ä¸‹æ¥ï¼Œä½†æ˜¯åæ¥æ€»æ˜¯å› ä¸ºå„ç§åŸå› æ²¡æœ‰è¿™æ ·åšï¼Œæ‰€ä»¥å¯¹æ¯”å»å¹´ï¼Œä»Šå¤©æˆ‘åœ¨å†™åšå®¢æ–¹é¢å˜æ‡’æƒ°äº†ï¼Œä½†æ˜¯æˆ‘çŸ¥é“å†™åšå®¢æ˜¯å¥½ä¹ æƒ¯ï¼Œæ‰€ä»¥ä»ç°åœ¨å¼€å§‹æˆ‘è¦é‡æ–°åšæŒè¿™ä¸ªä¹ æƒ¯ã€‚</p>
<p>æˆ‘è§‰å¾—æˆ‘æŠŠå†™åšå®¢è¿™ä»¶äº‹è¿˜æ˜¯çœ‹å¾—å¤ªåŠŸåˆ©ï¼Œè¿˜æ²¡å†™ä¹‹å‰å°±å¼€å§‹æƒ³ç€ä¼šä¸ä¼šæœ‰äººçœ‹ï¼Œå…¶å®åšå®¢æ›´å¤šæ˜¯ç»™ä»¥åçš„è‡ªå·±çœ‹ã€‚</p>
<p>è‡ªå‹‰ã€‚</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/08/02/2020/the-idolmaster/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/08/02/2020/the-idolmaster/" itemprop="url">THE IDOLM@STER å¶åƒå¤§å¸ˆç³»åˆ—ä¸ªäººå…¥å‘å¿ƒå¾—</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-08-02T19:23:00+08:00">
                2020-08-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%9A%8F%E7%AC%94/" itemprop="url" rel="index">
                    <span itemprop="name">éšç¬”</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><img src="/the-idolmaster/imas-15th-banner.jpg" alt="imas-15th-banner"></p>
<p>è¯´èµ·æ¥æˆ‘æœ‰å¤šä¹…æ²¡å†™è¿‡äºŒæ¬¡å…ƒç›¸å…³çš„åšå®¢äº†ï¼Ÿæ°é€¢çˆ±é©¬ä»• 15 å‘¨å¹´ï¼Œå‰å‡ å¤©è¿½ç€å®˜æ–¹ç”Ÿæ”¾é‡æ¸©äº† 2011 ç‰ˆã€Šå¶åƒå¤§å¸ˆã€‹åŠ¨ç”»å’Œå‰§åœºç‰ˆï¼Œè¿˜æœ‰ 5 åœº LIVE BD çœ‹äº†ä¸ªçˆ½ï¼ˆæ‹œæ­¤æ‰€èµç¡çœ å‘¨æœ«æ—¶é—´åªæœ‰å…­å°æ—¶ï¼‰ï¼Œæ­£å¥½å€Ÿæ­¤æœºä¼šå†™ç‚¹ä¸œè¥¿ã€‚</p>
<p><del>å› ä¸ºä»¥å¾€çš„ç»éªŒå‘Šè¯‰æˆ‘ï¼Œå¦‚æœç°åœ¨æ‹–ç€ä¸å†™ä»¥åå°±æ›´å†™ä¸å‡ºæ¥äº†ï¼ˆ</del></p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2020/08/02/2020/the-idolmaster/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/07/31/%E5%88%A9%E7%94%A8MySQL%E7%9A%84Binlog%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E4%B8%8E%E8%AE%A2%E9%98%85-%E4%B8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/07/31/%E5%88%A9%E7%94%A8MySQL%E7%9A%84Binlog%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E4%B8%8E%E8%AE%A2%E9%98%85-%E4%B8%8B/" itemprop="url">åˆ©ç”¨ MySQL çš„ Binlog å®ç°æ•°æ®åŒæ­¥ä¸è®¢é˜…(ä¸‹)ï¼šEventBus ç¯‡</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-31T12:01:14+08:00">
                2020-07-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/" itemprop="url" rel="index">
                    <span itemprop="name">æ•°æ®å­˜å‚¨</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <p>ç»ˆäºåˆ°è¿™ä¸ªç³»åˆ—çš„æœ€åä¸€ç¯‡ï¼Œåœ¨å‰ä¸¤ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«äº†ä»‹ç»äº†<strong>Binlog</strong>çš„æ¦‚å¿µå’Œäº‹ä»¶æ€»çº¿(<strong>EventBus</strong>)çš„å®ç°ï¼Œåœ¨å®Œæˆå‰é¢è¿™å°†è¿‘å¥½å‡ åƒå­—çš„é“ºå«ä»¥åï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥è¿›å…¥æ­£é¢˜ï¼Œå³é€šè¿‡ EventBus å‘å¸ƒ Binlogï¼Œå†é€šè¿‡ç¼–å†™å¯¹åº”çš„ EventHandler æ¥è®¢é˜…è¿™äº› Binlogï¼Œè¿™æ ·å°±å®ç°äº†æˆ‘ä»¬â€œæœ€åˆçš„æ¢¦æƒ³â€ã€‚å¦ç™½è¯´ï¼Œè¿™ä¸ªè¿‡ç¨‹å®åœ¨æœ‰ä¸€ç‚¹æ¼«é•¿ï¼Œåº†å¹¸çš„æ˜¯ï¼Œå®ƒç»ˆäºè¿˜æ˜¯æ¥äº†ã€‚</p>
<h1 id="Binlog-è¯»å–ä¸è§£æ"><a href="#Binlog-è¯»å–ä¸è§£æ" class="headerlink" title="Binlog è¯»å–ä¸è§£æ"></a>Binlog è¯»å–ä¸è§£æ</h1><p>é¦–å…ˆï¼Œæˆ‘ä»¬é€šè¿‡ <a target="_blank" rel="noopener" href="https://github.com/noplay/python-mysql-replication">Python-Mysql-Replication</a> è¿™ä¸ªé¡¹ç›®æ¥è¯»å– Binlogï¼Œç›´æ¥é€šè¿‡<code>pip install mysql-replication</code>å®‰è£…å³å¯ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç®€å•çš„è„šæœ¬æ–‡ä»¶ï¼Œè¿™å†æ¬¡å°è¯é‚£å¥åè¨€â€”â€”äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨ Pythonï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">readBinLog</span>():</span><br><span class="line">    stream = BinLogStreamReader(</span><br><span class="line">        <span class="comment"># å¡«å†™IPã€è´¦å·ã€å¯†ç å³å¯</span></span><br><span class="line">        connection_settings = &#123;</span><br><span class="line">            <span class="string">&#x27;host&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;port&#x27;</span>: <span class="number">3306</span>, </span><br><span class="line">            <span class="string">&#x27;user&#x27;</span>: <span class="string">&#x27;&#x27;</span>, </span><br><span class="line">            <span class="string">&#x27;passwd&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment"># æ¯å°æœåŠ¡å™¨å”¯ä¸€</span></span><br><span class="line">        server_id = <span class="number">3</span>, </span><br><span class="line">        <span class="comment"># ä¸»åº“Binlogè¯»å†™å®Œæ¯•æ—¶æ˜¯å¦é˜»å¡è¿æ¥</span></span><br><span class="line">        blocking = <span class="literal">True</span>, </span><br><span class="line">        <span class="comment"># ç­›é€‰æŒ‡å®šçš„è¡¨</span></span><br><span class="line">        only_tables = [<span class="string">&#x27;order_info&#x27;</span>, <span class="string">&#x27;log_info&#x27;</span>], </span><br><span class="line">        <span class="comment"># ç­›é€‰æŒ‡å®šçš„äº‹ä»¶</span></span><br><span class="line">        only_events = [DeleteRowsEvent, WriteRowsEvent, UpdateRowsEvent]) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> binlogevent <span class="keyword">in</span> stream:</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> binlogevent.rows:</span><br><span class="line">            event = &#123;</span><br><span class="line">                <span class="string">&quot;schema&quot;</span>: binlogevent.schema,</span><br><span class="line">                <span class="string">&quot;table&quot;</span>: binlogevent.table,</span><br><span class="line">                <span class="string">&quot;log_pos&quot;</span>: binlogevent.packet.log_pos</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(binlogevent, DeleteRowsEvent):</span><br><span class="line">                event[<span class="string">&quot;action&quot;</span>] = <span class="string">&quot;delete&quot;</span></span><br><span class="line">                event[<span class="string">&quot;origin&quot;</span>] = <span class="built_in">dict</span>(row[<span class="string">&quot;values&quot;</span>].items())</span><br><span class="line">                event[<span class="string">&quot;current&quot;</span>] = <span class="literal">None</span></span><br><span class="line">                event = <span class="built_in">dict</span>(event.items())</span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">isinstance</span>(binlogevent, UpdateRowsEvent):</span><br><span class="line">                event[<span class="string">&quot;action&quot;</span>] = <span class="string">&quot;update&quot;</span></span><br><span class="line">                event[<span class="string">&quot;origin&quot;</span>] = <span class="built_in">dict</span>(row[<span class="string">&quot;before_values&quot;</span>].items())</span><br><span class="line">                event[<span class="string">&quot;current&quot;</span>] = <span class="built_in">dict</span>(row[<span class="string">&quot;after_values&quot;</span>].items())</span><br><span class="line">                event = <span class="built_in">dict</span>(event.items())</span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">isinstance</span>(binlogevent, WriteRowsEvent):</span><br><span class="line">                event[<span class="string">&quot;action&quot;</span>] = <span class="string">&quot;insert&quot;</span></span><br><span class="line">                event[<span class="string">&quot;origin&quot;</span>] = <span class="literal">None</span></span><br><span class="line">                event[<span class="string">&quot;current&quot;</span>] = <span class="built_in">dict</span>(row[<span class="string">&quot;values&quot;</span>].items())</span><br><span class="line">                event = <span class="built_in">dict</span>(event.items())</span><br><span class="line">    stream.close()</span><br></pre></td></tr></table></figure>

<h1 id="å‘å¸ƒ-Binlog"><a href="#å‘å¸ƒ-Binlog" class="headerlink" title="å‘å¸ƒ Binlog"></a>å‘å¸ƒ Binlog</h1><p>åœ¨è¯»å–åˆ° Binlog ä»¥åï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶å‘å¸ƒåˆ° EventBus é‡Œï¼Œä¸ºæ­¤ï¼Œåœ¨.NET Core è¿™è¾¹æä¾›ä¸€ä¸ª Web API æ¥å£ï¼Œåªéœ€è¦æ³¨å…¥<code>IEventBus</code>ç„¶åè°ƒç”¨<code>Publish()</code>å³å¯ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Post: /&lt;controller&gt;/Publish</span></span><br><span class="line">[<span class="meta">HttpPost</span>]</span><br><span class="line">[<span class="meta">Route (<span class="string">&quot;PublishBinLog&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> Task <span class="title">PublishBinLog</span> (<span class="params">BinLogEventModel&lt;<span class="built_in">dynamic</span>&gt; eventModel</span>)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (eventModel.action == <span class="string">&quot;insert&quot;</span> &amp;&amp; eventModel.table.StartsWith (<span class="string">&quot;log_&quot;</span>))</span><br><span class="line">        _eventBus.Publish (eventModel.MapTo&lt;WriteLogEvent&gt; ());</span><br><span class="line">    <span class="keyword">if</span> (eventModel.action == <span class="string">&quot;insert&quot;</span> &amp;&amp; eventModel.table == <span class="string">&quot;order_info&quot;</span>)</span><br><span class="line">        _eventBus.Publish (eventModel.MapTo&lt;OrderInfoCreateEvent&gt; ());</span><br><span class="line">    <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç›¸åº”åœ°ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è„šæœ¬ä¸­æ·»åŠ è°ƒç”¨ Web API çš„é€»è¾‘ä»£ç ï¼Œä½¿ç”¨æˆ‘ä»¬æœ€ç†Ÿæ‚‰çš„<code>requests</code>åº“å³å¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sendBinLog</span>(<span class="params">event</span>):</span><br><span class="line">    url = <span class="string">&quot;https://localhost:44348/EventBus/PublishBinLog&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        payload = json.dumps(event,cls=ComplexEncoder)</span><br><span class="line">        response = session.request(<span class="string">&quot;POST&quot;</span>, url, data=payload, headers=headers, verify=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œï¼Œåœ¨å¤„ç† Binlog çš„åºåˆ—åŒ–çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°é»˜è®¤çš„ JSON åºåˆ—åŒ–å™¨æ— æ³•å¯¹ event è¿›è¡Œåºåˆ—åŒ–çš„é—®é¢˜ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªè‡ªå®šä¹‰çš„åºåˆ—åŒ–å™¨ï¼Œä¸‹é¢æ˜¯åšä¸»ç›®å‰åœ¨ä½¿ç”¨çš„åºåˆ—åŒ–å™¨ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ComplexEncoder</span>(json.JSONEncoder):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">default</span>(<span class="params">self, obj</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(obj, datetime):</span><br><span class="line">            <span class="keyword">return</span> obj.strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(obj, date):</span><br><span class="line">            <span class="keyword">return</span> obj.strftime(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(obj, decimal.Decimal):</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">str</span>(obj)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(obj, <span class="built_in">bytes</span>):</span><br><span class="line">            <span class="keyword">return</span> obj.decode(<span class="string">&#x27;utf-8&#x27;</span>)  </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> json.JSONEncoder.default(self, obj)</span><br></pre></td></tr></table></figure>

<h1 id="è®¢é˜…-Binlog"><a href="#è®¢é˜…-Binlog" class="headerlink" title="è®¢é˜… Binlog"></a>è®¢é˜… Binlog</h1><p>ç°åœ¨ï¼Œä¸ºäº†è®¢é˜…è¿™äº› Binlogï¼Œæˆ‘ä»¬æ¥ç¼–å†™å¯¹åº”çš„ EventHandlerï¼Œè¿™é‡Œæˆ‘ä»¬å®šä¹‰ä¸¤ä¸ª EventHandlerï¼Œä¸€ä¸ªç”¨äºæ‰“å°æ—¥å¿—ç¼–å·ã€æ—¥å¿—å†…å®¹ã€æ—¥å¿—çº§åˆ«ç­‰ä¿¡æ¯ï¼Œä¸€ä¸ªç”¨äºç»Ÿè®¡ä¸åŒçº§åˆ«çš„æ—¥å¿—çš„æ•°ç›®ã€‚ä»£ç å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‰“å°æ—¥å¿—çš„EventHandler</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WriteLogEventHandler</span> : <span class="title">IEventHandler</span>&lt;<span class="title">WriteLogEvent</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> ILogger&lt;WriteLogEventHandler&gt; _logger;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WriteLogEventHandler</span> (<span class="params">ILogger&lt;WriteLogEventHandler&gt; logger</span>)</span> &#123;</span><br><span class="line">        _logger = logger;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">Handle</span> (<span class="params">WriteLogEvent @<span class="keyword">event</span></span>)</span> &#123;</span><br><span class="line">        _logger.LogInformation (<span class="string">$&quot;æ—¥å¿—ç¼–å·ï¼š<span class="subst">&#123;@<span class="keyword">event</span>.TRANSACTION_ID&#125;</span>ï¼Œæ—¥å¿—çº§åˆ«ï¼š<span class="subst">&#123;@<span class="keyword">event</span>.LOG_LEVEL&#125;</span>ï¼Œä¸»æœºï¼š<span class="subst">&#123;@<span class="keyword">event</span>.HOST_NAME&#125;</span>ï¼ŒIPï¼š<span class="subst">&#123;@<span class="keyword">event</span>.HOST_IP&#125;</span>ï¼Œå†…å®¹ï¼š<span class="subst">&#123;@<span class="keyword">event</span>.CONTENT&#125;</span>&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ†ææ—¥å¿—çš„EventHandler</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AnalyseLogEventHandler</span> : <span class="title">IEventHandler</span>&lt;<span class="title">WriteLogEvent</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;AnalyseLogEventHandler&gt; _logger;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IDistributedCache _cache;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AnalyseLogEventHandler</span> (<span class="params">ILogger&lt;AnalyseLogEventHandler&gt; logger, IDistributedCache cache</span>)</span> &#123;</span><br><span class="line">        _logger = logger;</span><br><span class="line">        _cache = cache;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">Handle</span> (<span class="params">WriteLogEvent @<span class="keyword">event</span></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> cacheCount = _cache.GetString (@event.LOG_LEVEL);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty (cacheCount))</span><br><span class="line">            cacheCount = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            cacheCount = (<span class="built_in">int</span>.Parse (cacheCount) + <span class="number">1</span>).ToString ();</span><br><span class="line">        _cache.SetString (@event.LOG_LEVEL, cacheCount);;</span><br><span class="line">        <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œè¿™é‡Œéœ€è¦åœ¨<code>Startup</code>ä¸­æ³¨å…¥<code>EventHandler</code>ã€<code>EventBus</code>ä»¥åŠå„ç§å¿…è¦çš„ä¾èµ–é¡¹ï¼Œä½ å¯ä»¥æ‰‹åŠ¨æ³¨å†Œï¼Œæˆ–è€…å‚è€ƒä¸‹é¢çš„ä»£ç ï¼Œå®ç°æ‰«ææ³¨å†Œï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">services.AddSingleton&lt;IRabbitMQPersistentConnection, DefaultRabbitMQPersistentConnection&gt; ();</span><br><span class="line">services.AddSingleton&lt;IEventBusSubscriptionManager, EventBusSubscriptionManager&gt; (sp =&gt; <span class="keyword">new</span> EventBusSubscriptionManager ());</span><br><span class="line">services.AddSingleton&lt;IConnectionFactory, ConnectionFactory&gt; (sp =&gt; <span class="keyword">new</span> ConnectionFactory () &#123; HostName = <span class="string">&quot;localhost&quot;</span>, UserName = <span class="string">&quot;guest&quot;</span>, Password = <span class="string">&quot;guest&quot;</span> &#125;);</span><br><span class="line">services.AddSingleton&lt;ObjectPoolProvider, DefaultObjectPoolProvider&gt; ();</span><br><span class="line">services.AddControllers ().AddNewtonsoftJson ();</span><br><span class="line">services.AddDistributedMemoryCache (options =&gt; &#123;</span><br><span class="line">    options.ExpirationScanFrequency = TimeSpan.FromMinutes (<span class="number">5</span>);</span><br><span class="line">    options.SizeLimit = <span class="number">10</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è‡ªåŠ¨æ³¨å†Œ</span></span><br><span class="line">services.AddEventBus();</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰‹åŠ¨æ³¨å†Œ</span></span><br><span class="line">services.AddSingleton&lt;IEventBus, RabbitMQEventBus&gt; (sp =&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span> eventBus = <span class="keyword">new</span> RabbitMQEventBus (sp.GetRequiredService&lt;IRabbitMQPersistentConnection&gt; (), sp.GetRequiredService&lt;IEventBusSubscriptionManager&gt; (), sp.GetRequiredService&lt;ILogger&lt;RabbitMQEventBus&gt;&gt; (), sp, <span class="string">&quot;eventbus-exchange&quot;</span>, <span class="string">&quot;eventbus-queue&quot;</span>);</span><br><span class="line">    eventBus.Subscribe&lt;WriteLogEvent, WriteLogEventHandler&gt;():</span><br><span class="line">    eventBus.Subscribe&lt;WriteLogEvent, AnalyseLogEventHandler&gt;();</span><br><span class="line">    <span class="keyword">return</span> eventBus;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">services.AddTransient&lt;WriteLogEventHandler&gt;();</span><br><span class="line">services.AddTransient&lt;AnalyseLogEventHandler&gt;();</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ä¸€èµ·æ¥çœ‹çœ‹æ•ˆæœï¼Œç®€ç›´å¤ªå®Œç¾äº†ï¼Œæˆ‘å°±æ˜¯ä¸æƒ³å†™ä¸­é—´è¡¨å•Šï¼Œè¿™æ ·å¤šå¥½ï¼ï¼ï¼<br><img src="https://i.loli.net/2020/07/31/PRjfiYpWNqHxI7Z.gif" alt="Python è¯»å– Binlog æ¼”ç¤º"><br><img src="https://i.loli.net/2020/07/31/yVZgIn9NifpxTXa.gif" alt=".NET Core æ¶ˆè´¹ Binlogæ¼”ç¤º"><br><img src="https://i.loli.net/2020/07/31/iMX5PFCoak7VDv9.png" alt="RabbitMQ Dashboard æ¼”ç¤º"></p>
<h1 id="æœ¬æ–‡å°ç»“"><a href="#æœ¬æ–‡å°ç»“" class="headerlink" title="æœ¬æ–‡å°ç»“"></a>æœ¬æ–‡å°ç»“</h1><p>é€šè¿‡ä¸‰ç¯‡åšå®¢çš„ç¯‡å¹…ï¼Œæˆ‘ä»¬å®ç°äº†â€œåˆ©ç”¨ MySQL çš„ Binlog å®ç°æ•°æ®åŒæ­¥ä¸è®¢é˜…â€çš„æƒ³æ³•ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº† Binlog çš„ç›¸å…³æ¦‚å¿µï¼Œå‚è€ƒå¾®è½¯çš„ <a target="_blank" rel="noopener" href="https://github.com/dotnet-architecture/eShopOnContainers">eShopOnContainers</a> é¡¹ç›®å®ç°äº†ä¸€ä¸ªåŸºäº RabbitMQ çš„ EventBusï¼Œè€Œè¿™ä¸€åˆ‡éƒ½åœ¨è¿™ç¯‡åšå®¢ä¸­å®Œæˆäº†æœ€ç»ˆçš„â€œæ‹¼åˆâ€ï¼Œé€šè¿‡ <a target="_blank" rel="noopener" href="https://github.com/noplay/python-mysql-replication">Python-Mysql-Replication</a> å®ç°äº† Binlog è§£æï¼Œè€Œ EventBus åˆ™ä½œä¸ºæ•´ä¸ªäº‹ä»¶ç³»ç»Ÿçš„â€œä¸Šå¸â€å¯¹æ‰€æœ‰äº‹ä»¶å¤„ç†å™¨(<strong>EventHandler</strong>)è¿›è¡Œç»Ÿä¸€è°ƒåº¦ï¼Œæœ€ç»ˆæˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒè¿™äº›äº‹ä»¶æ˜¯å¦‚ä½•è¢«å‘å¸ƒåˆ° EventBus ä¸­çš„ï¼Œåªéœ€è¦çŸ¥é“å®ƒå¯¹åº”å“ªä¸€ä¸ª Event å¹¶ä¸ºå®ƒç¼–å†™å¯¹åº”çš„ EventHandler å³å¯ï¼Œé™¤äº†è¿™ç¯‡åšå®¢ä¸­æåˆ°çš„ Binlog ä»¥å¤–ï¼Œå®é™…ä¸Šå®ƒè¿˜å¯ä»¥ä½œä¸ºç³»ç»Ÿå†…çš„â€œé¢†åŸŸäº‹ä»¶â€æ¥å®ç°ä¸šåŠ¡ä¸Šçš„äº‹ä»¶é©±åŠ¨ï¼Œè­¬å¦‚<code>OrderInfoCreateEvent</code>è¿™ä¸ªäº‹ä»¶å¯ä»¥è¡¨ç¤ºä¸€ä¸ªè®¢å•è¢«åˆ›å»ºï¼Œè€Œå…³å¿ƒè®¢å•çŠ¶æ€çš„äººåˆ™å¯ä»¥é€šè¿‡ EventHandler æ¥å®ç°è®¢é˜…ï¼Œå®ç°ç±»ä¼¼å‘çŸ­ä¿¡ã€å‘é‚®ä»¶ã€å‘å¾®ä¿¡ç­‰ç­‰çš„åŠŸèƒ½ï¼Œæˆ–è€…å¯ä»¥è®©ç¬¬ä¸‰æ–¹çš„ Web API æ¥æ¶ˆè´¹äº‹ä»¶ä¸­æºå¸¦çš„ä¿¡æ¯ã€‚åŒç†ï¼Œç¬¬ä¸‰æ–¹çš„æ•°æ®åœ¨æµå…¥ç³»ç»Ÿæ—¶ï¼Œå¯ä»¥å…ˆå‘å¸ƒåˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œå†é€šè¿‡å¯¹åº”çš„ EventHandler æ¥è¿›è¡Œå¼‚æ­¥å¤„ç†ï¼Œæå¤§åœ°æ”¹å–„ç³»ç»Ÿæ¥å£çš„ååæ€§èƒ½ï¼Œè€Œå¦‚æœåœ¨è¿™ä¸­é—´æŠ½è±¡å‡ºæ¥ä¸€ä¸ªæ•°æ®äº¤æ¢å±‚å‡ºæ¥ï¼Œé‚£ä¹ˆå°±èƒ½æ”¶è·æ›´å¤šä¸ä¸€æ ·çš„ä¸œè¥¿ï¼Œå°±åœ¨å†™è¿™ç¯‡åšå®¢çš„æ—¶å€™ï¼Œæˆ‘åœ¨ Github ä¸Šçš„ä»£ç è¢«æ”¶å…¥äº†å¾®è½¯çš„â€åŒ—æå†°å·ç«ç§è®¡åˆ’â€ï¼Œè™½ç„¶æ•°å­—ä¸–ç•Œè¿œæ¯”ç°å®ä¸–ç•Œå®½å¹¿å¾—å¤šï¼Œå¯èƒ½ä¸ºè¿™ä¸ªä¸–ç•Œå‡å°‘ä¸€ç‚¹â€œæ— ç”¨â€çš„æ•°æ®æˆ–è€…ä»£ç ï¼Œåº”è¯¥ä¸€æ ·å¯ä»¥ç®—ä½œæ˜¯ç¯ä¿è¡Œä¸ºå§ï¼</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/07/28/2020-07-28-about-user-research/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/07/28/2020-07-28-about-user-research/" itemprop="url">å…³äºç”¨ç ”å²—ä½çš„æ€è€ƒ</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-28T09:13:21+08:00">
                2020-07-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <h2 id="ä»€ä¹ˆæ˜¯ç”¨ç ”å²—ä½"><a href="#ä»€ä¹ˆæ˜¯ç”¨ç ”å²—ä½" class="headerlink" title="ä»€ä¹ˆæ˜¯ç”¨ç ”å²—ä½"></a>ä»€ä¹ˆæ˜¯ç”¨ç ”å²—ä½</h2><p>ç”¨æˆ·ç ”ç©¶ç®€ç§°â€œç”¨ç ”â€ï¼Œæ˜¯ä¸€ç§ä¸»è¦é€šè¿‡é¢å‘ç”¨æˆ·çš„å„ç§ç ”ç©¶æ–¹æ³•ï¼Œè¾¾æˆå¯¹å…³é”®é—®é¢˜çš„ä¿¡æ¯æ”¶é›†å’Œç†è§£çš„ç›®æ ‡ã€‚</p>
<p>è¿™äº›å…³é”®é—®é¢˜å¯å¤§å¯å°ã€‚å¤§çš„æ–¹é¢å¯èƒ½æ˜¯ç¡®å®šæŸä¸ªå¸‚åœºéœ€æ±‚ï¼Œå°çš„æ–¹é¢å¯èƒ½æ˜¯éªŒè¯æŸä¸ªäº§å“çš„å¸‚åœºå—æ¬¢è¿ç¨‹åº¦ï¼Œä¹Ÿå¯èƒ½æ˜¯ç¡®è®¤äº§å“çš„æŸä¸ªé—®é¢˜ã€‚</p>
<h2 id="ç”¨ç ”å¸¸ç”¨çš„æ‰‹æ®µ"><a href="#ç”¨ç ”å¸¸ç”¨çš„æ‰‹æ®µ" class="headerlink" title="ç”¨ç ”å¸¸ç”¨çš„æ‰‹æ®µ"></a>ç”¨ç ”å¸¸ç”¨çš„æ‰‹æ®µ</h2><p>ç”¨ç ”å¸¸ç”¨çš„æ‰‹æ®µåŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼šç”¨æˆ·è®¿è°ˆï¼ˆåŒ…æ‹¬ä¸€å¯¹ä¸€å’Œä¸€å¯¹å¤šï¼‰ã€ç”¨æˆ·ä½¿ç”¨åœºæ™¯çš„ç°åœºè§‚å¯Ÿã€ä»¥åŠç”¨æˆ·é—®å·è°ƒæŸ¥ã€ç”¨æˆ·åé¦ˆæ”¶é›†ç­‰ã€‚</p>
<p>æˆ‘æŠŠè¿™äº›æ‰‹æ®µåˆ†æˆ 2 ç±»ï¼š</p>
<ul>
<li>å®¢è§‚æ•°æ®åˆ†æç±»ã€‚åŒ…æ‹¬ç”¨æˆ·ä½¿ç”¨åœºæ™¯ã€‚</li>
<li>ä¸»è§‚æ•°æ®åˆ†æç±»ã€‚åŒ…æ‹¬ç”¨æˆ·è®¿è°ˆå’Œç”¨æˆ·é—®å·ã€‚</li>
</ul>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‰å®šæ€§å’Œå®šé‡åˆ†æï¼ŒæŠŠç”¨ç ”æ‰‹æ®µåˆ†ç±»ï¼š</p>
<ul>
<li>å®šæ€§åˆ†æã€‚åŒ…æ‹¬ç”¨æˆ·è®¿è°ˆå’Œç”¨æˆ·ä½¿ç”¨åœºæ™¯çš„åˆ†æã€‚</li>
<li>å®šé‡åˆ†æã€‚åŒ…æ‹¬ç”¨æˆ·é—®å·ï¼Œä»¥åŠç”¨æˆ·æ“ä½œæ—¥å¿—åˆ†æã€‚</li>
</ul>
<p>ä¸‹é¢æˆ‘ç¨å¾®å±•å¼€ä»‹ç»ä¸€ä¸‹ã€‚</p>
<h3 id="ç”¨æˆ·è®¿è°ˆ"><a href="#ç”¨æˆ·è®¿è°ˆ" class="headerlink" title="ç”¨æˆ·è®¿è°ˆ"></a>ç”¨æˆ·è®¿è°ˆ</h3><p>æˆ‘è®¤ä¸ºç”¨æˆ·è®¿è°ˆæ˜¯æœ€å¥½çš„å®šæ€§åˆ†ææ‰‹æ®µï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚ä¸»è¦æ˜¯æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ç€ç‹¬ç‰¹çš„ä¸ªä½“å·®å¼‚ã€‚å¦‚æœæˆ‘ä»¬åœ¨è®¿è°ˆå‰ä¸è®¾ç½®å¤ªå¤šè®¿è°ˆç›®æ ‡çš„è¯ï¼Œå°±å¯ä»¥è·å¾—æ¯”è¾ƒå¤šçš„æ–°çš„ä¿¡æ¯ç‚¹ã€‚</p>
<p>è¿™äº›ä¿¡æ¯ç‚¹å¯èƒ½æš´éœ²å‡ºä¸€äº›æœªè¢«å‘æ˜çš„ç”¨æˆ·éœ€æ±‚ã€‚ä¹Ÿå¯èƒ½å‘ç°äº§å“è®¾è®¡å½“ä¸­çš„ä¸åˆé€‚çš„æµç¨‹ã€‚</p>
<p>å½“ç„¶ï¼Œå¤§éƒ¨åˆ†æ—¶å€™ï¼Œç”¨æˆ·æåˆ°çš„é—®é¢˜è¦ä¹ˆæ˜¯å¤ªç‰¹æ®Šï¼Œè¦ä¹ˆæ˜¯å¹¶ä¸åˆç†ï¼Œä½†è¿™æ²¡æœ‰å…³ç³»ï¼Œå¦‚æœç”¨æˆ·è®¿è°ˆä¸­åªæœ‰ä¸€ä¸ªç”¨æˆ·æåˆ°ï¼Œæˆ‘ä»¬å°±ç®€å•è®°å½•ä¸‹æ¥å³å¯ã€‚å¤§éƒ¨åˆ†æ—¶å€™ç”¨æˆ·æçš„ä¸œè¥¿éƒ½ä¸èƒ½ç›´æ¥æ‹¿æ¥ç”¨ï¼Œéœ€è¦æ¶ˆåŒ–ã€‚</p>
<p>ä½†å¦‚æœæ¯ä¸ªç”¨æˆ·éƒ½æåˆ°åŒæ ·çš„é—®é¢˜ï¼Œé‚£æˆ‘ä»¬å°±è¦å°å¿ƒäº†ï¼Œå¾ˆå¯èƒ½æ˜¯æˆ‘ä»¬äº§å“çš„é—®é¢˜ã€‚</p>
<h3 id="ç”¨æˆ·ä½¿ç”¨åœºæ™¯çš„ç°åœºè§‚å¯Ÿ"><a href="#ç”¨æˆ·ä½¿ç”¨åœºæ™¯çš„ç°åœºè§‚å¯Ÿ" class="headerlink" title="ç”¨æˆ·ä½¿ç”¨åœºæ™¯çš„ç°åœºè§‚å¯Ÿ"></a>ç”¨æˆ·ä½¿ç”¨åœºæ™¯çš„ç°åœºè§‚å¯Ÿ</h3><p>åšäº§å“ä¸€ç›´è®²è¦â€œè¿˜åŸç”¨æˆ·åœºæ™¯â€ï¼Œè€Œç”¨ç ”å°±æ˜¯æœ€ç›´æ¥çš„å‘ˆç°å‡ºç”¨æˆ·åœºæ™¯ã€‚è¿™ä¸ªä¿¡æ¯éå¸¸éå¸¸å…³é”®ã€‚å› ä¸ºç”¨æˆ·å¯ä»¥éšä¾¿è¯´ï¼Œä½†æ˜¯æ€ä¹ˆåšæ‰æ˜¯æœ€é‡è¦çš„ï¼Œâ€œèº«ä½“ä¸ä¼šæ’’è°â€ã€‚</p>
<p>æœ‰ä¸€ä¸ªæ•…äº‹ï¼Œæœ‰ä¸€ä¸ªå…¬å¸åšç”¨ç ”ï¼Œè®©ç”¨æˆ·æŒ‘ä»–ä»¬æœ€å–œæ¬¢çš„æ¯å­é¢œè‰²ï¼Œç»“æœå¤§å®¶éƒ½æŠ•çš„çº¢è‰²ã€‚ç”¨æˆ·åšå®Œç”¨ç ”ï¼Œè¿™ä¸ªå…¬å¸è¯´ï¼Œä½ ä»¬å¯ä»¥èµ°çš„æ—¶å€™å¸¦èµ°ä¸€ä¸ªæ¯å­ã€‚ç»“æœï¼Œå¤§å®¶èµ°çš„æ—¶å€™éƒ½å¸¦èµ°çš„æ˜¯ç™½è‰²çš„æ¯å­ã€‚</p>
<p>è¿™å°±æ˜¯ä¸€ä¸ªç”¨æˆ·è¯´çš„å’Œåšçš„ä¸ä¸€æ ·çš„æ•…äº‹ã€‚ç±»ä¼¼çš„æ•…äº‹æœ‰å¾ˆå¤šï¼Œåƒå¯å£å¯ä¹æ¢å£å‘³äº‹ä»¶å°±æ˜¯å†å²ä¸Šæˆæœ¬æœ€å¤§çš„è¢«ç”¨æˆ·è¯´çš„æ¬ºéª—çš„æ•…äº‹ï¼Œè¯¦è§ï¼š<a target="_blank" rel="noopener" href="https://wenku.baidu.com/view/e847c601cc175527072208b9.html">https://wenku.baidu.com/view/e847c601cc175527072208b9.html</a>ã€‚</p>
<h3 id="ç”¨æˆ·é—®å·"><a href="#ç”¨æˆ·é—®å·" class="headerlink" title="ç”¨æˆ·é—®å·"></a>ç”¨æˆ·é—®å·</h3><p>ç”¨æˆ·é—®å·ç”¨äºå®šä½ä¸€ä¸ªé—®é¢˜åï¼Œå®šé‡åˆ†æç”¨æˆ·çš„ä¸€äº›çœ‹æ³•ã€‚é—®å·çš„è®¾è®¡å¤§å¤šæ—¶å€™éƒ½å¸¦æœ‰è°ƒç ”è€…çš„å€¾å‘æ€§ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“è®¾ç½®å¾—ä¸åˆç†ï¼Œè¿™ä¹Ÿæ˜¯ä¹”å¸ƒæ–¯è¯´ä»–ä»æ¥ä¸çœ‹ç”¨æˆ·é—®å·çš„åŸå› ã€‚</p>
<p>ä½†æ˜¯ NPSï¼ˆç”¨æˆ·å‡€æ¨èå€¼ï¼‰æ˜¯ä¸€ä¸ªå¾ˆå€¼å¾—åšçš„é—®å·ï¼Œä¸»è¦æ˜¯è¿™ä¸ªæŒ‡æ ‡éå¸¸æ ‡å‡†åŒ–ï¼Œæˆ‘ä»åœ¨å·¥ä½œçš„ç¬¬ä¸€å¤©å°±æ¥è§¦ NPSï¼Œè¿™ä¸ªå€¼çš„é•¿æœŸå˜åŒ–è¿˜æ˜¯èƒ½æœ‰æ•ˆååº”å‡ºäº§å“çš„æ”¹å–„ã€‚</p>
<h2 id="ç”¨ç ”çš„æ ¸å¿ƒæŒ‘æˆ˜"><a href="#ç”¨ç ”çš„æ ¸å¿ƒæŒ‘æˆ˜" class="headerlink" title="ç”¨ç ”çš„æ ¸å¿ƒæŒ‘æˆ˜"></a>ç”¨ç ”çš„æ ¸å¿ƒæŒ‘æˆ˜</h2><p>ç”¨æˆ·ç ”ç©¶åœ¨å¾ˆå¤šå…¬å¸éƒ½æœ‰å²—ä½ï¼Œä½†æ˜¯è¿™ä¸ªå²—ä½å¦‚æœåªåšç”¨æˆ·ç ”ç©¶ï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“åšå¾—å¾ˆå·®ã€‚æ‰€ä»¥å¤§å¤šæ•°å…¬å¸éƒ½å°†è¿™ä¸ªå·¥ä½œç»¼åˆæ”¾åˆ°äº§å“ç»ç†çš„å·¥ä½œä¸­ã€‚</p>
<p>æˆ‘ä¹Ÿè§è¿‡å¾ˆå¤šç¬¬ä¸‰æ–¹çš„ç”¨ç ”å…¬å¸ï¼Œè¯·ä¸€äº›ç”¨æˆ·åšè®¿è°ˆï¼Œç„¶åæä¸€äº›é—®å·ï¼Œå‡ºä¸€ä¸ªæ»¡æ˜¯å›¾è¡¨å’Œæ•°æ®çš„æŠ¥å‘Šã€‚çœ‹èµ·æ¥å¾ˆç‰›é€¼ï¼Œä½†æ˜¯èƒ½å¤Ÿç»™å†³ç­–å¸¦æ¥æ”¯æŒçš„ä¿¡æ¯æå°‘ï¼Œä¿¡æ¯æœ¬èº«çš„è´¨é‡ä¹Ÿå€¼å¾—å•†æ¦·ã€‚</p>
<h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>æˆ‘è®¤ä¸ºå®¢è§‚æ•°æ®åˆ†æç±»ï¼šç”¨æˆ·ä½¿ç”¨åœºæ™¯çš„ç°åœºè§‚å¯Ÿã€ç”¨æˆ·æ“ä½œæ—¥å¿—åˆ†ææ˜¯æœ€æœ‰ä»·å€¼çš„ç”¨ç ”å·¥ä½œã€‚</p>
<p>ç”¨ç ”è¦åšå¾—å¥½ï¼Œè¿˜æ˜¯åº”è¯¥æ˜¯æœ€æ ¸å¿ƒçš„äººã€Œäº²è‡ªå‚ä¸ã€æˆ–è€…ã€Œé‡åº¦å‚ä¸ã€ã€‚</p>
<p>æ‰€è°“çš„äº²è‡ªå‚ä¸ï¼Œå³æ ¸å¿ƒçš„äººè‡ªå·±åšç”¨ç ”ã€‚å¦‚æœæ˜¯å†³å®šäº§å“éœ€æ±‚æˆ–åŠŸèƒ½ï¼Œå°±è®©äº§å“ç»ç†è‡ªå·±åšç”¨ç ”ã€‚æˆ‘ä»¬çŒ¿è¾…å¯¼çš„æ•™å­¦ç«¯äº§å“ç»ç†ï¼Œå°±éœ€è¦è‡ªå·±æ·±å…¥æ•™å­¦ç¯èŠ‚ä¸­å»äº†è§£è€å¸ˆçš„éœ€æ±‚ï¼Œä»¥ä¾¿æ”¹è¿›æ•™å­¦ç«¯çš„ä½“éªŒã€‚</p>
<p>å¦‚æœæƒ³èŠ‚çœä¸€äº›æ—¶é—´ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥é€‰æ‹©ã€Œé‡åº¦å‚ä¸ã€çš„æ–¹å¼ã€‚ã€Œé‡åº¦å‚ä¸ã€çš„æ ¸å¿ƒæ˜¯ï¼šå¿…é¡»äº²çœ¼çœ‹åˆ°åŸå§‹æ•°æ®ã€‚æ¯”å¦‚ï¼Œæˆ‘å¬è¯´åœ¨å¤´æ¡ï¼Œå½“ç”¨ç ”åœ¨ç»™ç”¨æˆ·è¯•ç”¨äº§å“çš„æ—¶å€™ï¼Œå±‹å­é‡Œæœ‰ä¸€é¢å•é¢ç»ç’ƒï¼Œåé¢æ˜¯ç›¸å…³çš„äº§å“ç»ç†åœ¨ç°åœºè§‚å¯Ÿã€‚è¿™ä¸ªæ—¶å€™ï¼Œç”¨ç ”åªæ˜¯å¸®å¿™è¿›è¡Œäº†ç»„ç»‡åè°ƒå·¥ä½œï¼Œæ ¸å¿ƒå·¥ä½œå’Œå†³ç­–äº§å“ç»ç†å¹¶æ²¡æœ‰ç¼ºå¸­ã€‚</p>
<p>æˆ‘ä»¬åœ¨åšä¸€äº›æ–°äº§å“ç”¨ç ”çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿè¦æ±‚ç”¨ç ”çš„åŒå­¦éœ€è¦æŠŠç°åœºå½•åƒä¸‹æ¥ã€‚è¿™äº›å½•åƒä¹Ÿéå¸¸æœ‰åŠ©äºå¤§å®¶ç ”ç©¶ç”¨æˆ·ä¸ºä»€ä¹ˆé‚£ä¹ˆæ“ä½œï¼Œåå¤è§‚çœ‹å’Œæ€è€ƒã€‚</p>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><ul>
<li>ç”¨ç ”æ˜¯ä¸€ç§é¢å‘ç”¨æˆ·è·å¾—å†³ç­–ä¿¡æ¯çš„ç ”ç©¶æ–¹æ³•ã€‚</li>
<li>ç”¨ç ”æœ€æœ‰ä»·å€¼çš„æ˜¯ç”¨æˆ·ç°åœºæ“ä½œçš„åŸå§‹æ•°æ®ã€‚</li>
<li>ç”¨ç ”çš„å¼€æ”¾æ€§è®¿è°ˆå¯ä»¥è·å¾—ä¸€äº›æ„å¤–çš„å‘ç°ã€‚</li>
<li>ç”¨ç ”é—®å·æ¯”è¾ƒéš¾ä»¥åšå†³ç­–æ”¯æŒï¼Œä½† NPS æœ‰ä¸€å®šä»·å€¼ã€‚</li>
<li>ç”¨ç ”æœ€å¥½æ˜¯å†³ç­–ç›¸å…³äººã€Œäº²è‡ªå‚ä¸ã€æˆ–è€…ã€Œé‡åº¦å‚ä¸ã€ï¼Œå¦åˆ™ç”¨ç ”ç»“æœå¾ˆéš¾è¢«åˆç†æ¶ˆåŒ–å¹¶å¾—åˆ°æ¨è¿›ã€‚</li>
</ul>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/07/15/2020/07/openapi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/07/15/2020/07/openapi/" itemprop="url">è‡ªå»ºä¸€ä¸ªç®€æ˜“çš„OpenAPIç½‘å…³</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-15T19:30:00+08:00">
                2020-07-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%AD%E8%A8%80/" itemprop="url" rel="index">
                    <span itemprop="name">è¯­è¨€</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%AD%E8%A8%80/Go/" itemprop="url" rel="index">
                    <span itemprop="name">Go</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>ç½‘å…³ï¼ˆAPI Gatewayï¼‰æ˜¯è¯·æ±‚æµé‡çš„å”¯ä¸€å…¥å£ï¼Œå¯ä»¥é€‚é…å„ç±»æ¸ é“å’Œä¸šåŠ¡ï¼Œå¤„ç†å„ç§åè®®æ¥å…¥ã€è·¯ç”±ä¸æŠ¥æ–‡è½¬æ¢ã€åŒæ­¥å¼‚æ­¥è°ƒç”¨ç­‰ï¼Œæ¥ç®¡ç† API æ¥å£å’Œè¿›è¡Œè¯·æ±‚æµé‡æ§åˆ¶ï¼Œåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œç½‘å…³å°¤ä¸ºé‡è¦ã€‚</p>
<p><img src="//www.fanhaobai.com/2020/07/openapi/ffc6e25d-7044-467d-8b7c-910831249968.jpeg" alt="é¢„è§ˆå›¾">
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2020/07/15/2020/07/openapi/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/07/15/%E5%88%A9%E7%94%A8MySQL%E7%9A%84Binlog%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E4%B8%8E%E8%AE%A2%E9%98%85-%E4%B8%AD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/07/15/%E5%88%A9%E7%94%A8MySQL%E7%9A%84Binlog%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E4%B8%8E%E8%AE%A2%E9%98%85-%E4%B8%AD/" itemprop="url">åˆ©ç”¨ MySQL çš„ Binlog å®ç°æ•°æ®åŒæ­¥ä¸è®¢é˜…(ä¸­)ï¼šRabbitMQ ç¯‡</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-15T14:39:07+08:00">
                2020-07-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/" itemprop="url" rel="index">
                    <span itemprop="name">æ•°æ®å­˜å‚¨</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <p>ç´§æ¥ä¸Šä¸€ç¯‡åšå®¢ä¸­çš„æ€è·¯ï¼Œè¿™æ¬¡æˆ‘ä»¬æ¥è¯´è¯´äº‹ä»¶æ€»çº¿(EventBus)ï¼Œå›é¦–å‘æ¥ï¼Œå…³äºè¿™ä¸ªè¯é¢˜ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè”æƒ³åˆ°å‘å¸ƒ-è®¢é˜…æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ã€IObservable<T>ä¸ IObserver<T>ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰ç­‰ä¸€ç³»åˆ—çš„æ¦‚å¿µã€‚æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬å°è¯•ç€å»è§£é‡Šè¿™ä¸ªæ¦‚å¿µçš„æ—¶å€™ï¼Œå®ƒåˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Ÿæ˜¯ä¸€ç»„ API æ¥å£ï¼Ÿè¿˜æ˜¯ä¸€ç§æ–°çš„æŠ€æœ¯ï¼Ÿæ˜¾è€Œæ˜“è§ï¼Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼å’Œè§‚å¯Ÿè€…æ¨¡å¼éƒ½æ˜¯è®¾è®¡æ¨¡å¼ï¼Œè€Œ IObservable<T>ä¸ IObserver<T>ã€æ¶ˆæ¯é˜Ÿåˆ—åˆ™æ˜¯å…·ä½“çš„å®ç°æ–¹å¼ï¼Œå°±åƒä½ å¯ä»¥ç”¨å§”æ‰˜æˆ–è€…äº‹ä»¶å»å®ç°ä¸€ä¸ªè§‚å¯Ÿè€…æ¨¡å¼ï¼Œè€Œ Redis é‡ŒåŒæ ·å†…ç½®äº†å‘å¸ƒ-è®¢é˜…æ¨¡å‹ï¼Œæ¢è¨€ä¹‹ï¼Œè¿™æ˜¯æŠ½è±¡ä¸å…·ä½“çš„åŒºåˆ«ï¼Œæ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥ç”¨æ¥å®ç° EventBusï¼Œè€Œ EventBus ä¸»è¦çš„ç”¨é€”åˆ™æ˜¯ç³»ç»Ÿé—´çš„è§£è€¦ï¼Œè¯´åˆ°è§£è€¦ï¼Œä½ å¯èƒ½ä¼šå¯¹è§‚å¯Ÿè€…æ¨¡å¼å’Œå‘å¸ƒ-è®¢é˜…æ¨¡å¼è¿™ä¸¤ç§æ¨¡å¼æ„Ÿåˆ°å›°æƒ‘ï¼Œå› ä¸ºå®ƒä»¬å®åœ¨æ˜¯å¤ªåƒäº†ï¼Œä¸€ä¸ªæœ€æœ¬è´¨çš„åŒºåˆ«åœ¨äºå‘å¸ƒè€…(ä¸»é¢˜)æ˜¯å¦ä¸è®¢é˜…è€…(è§‚å¯Ÿè€…)å­˜åœ¨å¼ºä¾èµ–å…³ç³»ï¼Œè€Œå‘å¸ƒ-è®¢é˜…å¼•å…¥äº†ç±»ä¼¼ä¸»é¢˜&#x2F;Topic&#x2F;Channel çš„ä¸­ä»‹è€…ï¼Œæ˜¾ç„¶ä»è§£è€¦çš„è§’åº¦è¦æ›´å½»åº•ä¸€äº›ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬ä»Šå¤©å°±æ¥ä¸€èµ·å®ç°ä¸€ä¸ªäº‹ä»¶æ€»çº¿(EventBus)ã€‚</p>
<h1 id="EventBus-æ•´ä½“è®¾è®¡"><a href="#EventBus-æ•´ä½“è®¾è®¡" class="headerlink" title="EventBus æ•´ä½“è®¾è®¡"></a>EventBus æ•´ä½“è®¾è®¡</h1><p>é€šè¿‡å‰é¢çš„æ¢è®¨ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼ŒEventBus å…¶å®æ˜¯é’ˆå¯¹äº‹ä»¶çš„<code>å‘å¸ƒ-è®¢é˜…</code>æ¨¡å¼çš„å®ç°ï¼Œæ‰€ä»¥ï¼Œåœ¨è®¾è®¡ EventBus çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç»“åˆ<code>å‘å¸ƒ-å®šé˜…</code>æ¨¡å¼æ¥ä½œä¸ºå¯¹ç…§ï¼Œè€Œä¸€ä¸ªå…¸å‹çš„<code>å‘å¸ƒ-è®¢é˜…</code>æ¨¡å¼è‡³å°‘éœ€è¦ä¸‰ä¸ªè§’è‰²ï¼Œå³<code>å‘å¸ƒè€…</code>ã€<code>è®¢é˜…è€…</code>å’Œ<code>æ¶ˆæ¯</code>ï¼Œæ‰€ä»¥ï¼Œä¸€èˆ¬åœ¨è®¾è®¡ EventBus çš„æ—¶å€™ï¼ŒåŸºæœ¬éƒ½ä¼šä»è¿™ä¸‰ä¸ªæ–¹é¢å…¥æ‰‹ï¼Œæä¾›<strong>å‘å¸ƒæ¶ˆæ¯</strong>ã€<strong>è®¢é˜…æ¶ˆæ¯</strong>ã€<strong>é€€è®¢æ¶ˆæ¯</strong>çš„æ¥å£ã€‚ç”±äº EventBus æœ¬èº«å¹¶ä¸è´Ÿè´£æ¶ˆè´¹æ¶ˆæ¯ï¼Œæ‰€ä»¥ï¼Œè¿˜éœ€è¦å€ŸåŠ©<code>IEventHandler&lt;T&gt;</code>æ¥ç¼–å†™å¯¹åº”çš„äº‹ä»¶å¤„ç†å™¨ï¼Œè¿™æ˜¯ EventBus å¯ä»¥å®ç°ä¸šåŠ¡è§£è€¦çš„é‡è¦åŸå› ã€‚è€Œä¸ºäº†ç»´æŠ¤äº‹ä»¶å’Œäº‹ä»¶å¤„ç†å™¨çš„å…³ç³»ï¼Œé€šå¸¸éœ€è¦å€ŸåŠ© IoC å®¹å™¨æ¥æ³¨å†Œè¿™äº› EventHandlerï¼Œæä¾›ç±»ä¼¼<code>Castle</code>æˆ–è€…<code>Autofac</code>ä»ç¨‹åºé›†ä¸­æ‰¹é‡æ³¨å†Œçš„æœºåˆ¶ï¼Œä¸‹é¢æ˜¯åšä¸»å€Ÿé‰´ <a target="_blank" rel="noopener" href="https://github.com/dotnet-architecture/eShopOnContainers">eShopOnContainers</a> è®¾è®¡çš„ EventBusï¼Œé¦–å…ˆæ˜¯ IEventBus æ¥å£ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IEventBus</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Publish</span>&lt;<span class="title">TEvent</span>&gt; (<span class="params">TEvent @<span class="keyword">event</span></span>) <span class="keyword">where</span> TEvent : EventBase</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Subscribe</span>&lt;<span class="title">T</span>, <span class="title">TH</span>&gt; ()</span></span><br><span class="line"><span class="function">        <span class="keyword">where</span> T : EventBase</span></span><br><span class="line"><span class="function">        <span class="keyword">where</span> TH : <span class="title">IEventHandler</span>&lt;<span class="title">T</span>&gt;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Unsubscribe</span>&lt;<span class="title">T</span>, <span class="title">TH</span>&gt; ()</span></span><br><span class="line"><span class="function">        <span class="keyword">where</span> TH : IEventHandler&lt;T&gt;</span></span><br><span class="line"><span class="function">        <span class="keyword">where</span> T : EventBase</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°ï¼Œè¿™é‡Œå¯¹äº‹ä»¶(<strong>EventBase</strong>)å’Œäº‹ä»¶å¤„ç†å™¨(<strong>EventHandler</strong>)å‡æœ‰ä¸€å®šçº¦æŸï¼Œè¿™æ˜¯ä¸ºäº†æ•´ä¸ª EventBus çš„å®ç°ï¼Œåœ¨æŸäº› EventBus çš„å®ç°ä¸­ï¼Œå¯èƒ½ä¼šæ”¯æŒéæ³›å‹çš„<code>EventHandler</code>ï¼Œä»¥åŠ<code>Func</code>è¿™æ ·çš„å§”æ‰˜ç±»å‹ï¼Œè¿™é‡Œä¸è€ƒè™‘è¿™ç§æƒ…å½¢ï¼Œå› ä¸ºä» Binlog ä¸­è·å–çš„æ•°æ®ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯æ ¼å¼å›ºå®šçš„ JSONã€‚å…³äºè¿™éƒ¨åˆ†ï¼Œä¸‹é¢ç»™å‡ºå¯¹åº”çš„å®šä¹‰ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IEventHandlerBase</span> &#123; &#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IEventHandler</span>&lt;<span class="title">TEvent</span>&gt; : <span class="title">IEventHandlerBase</span> <span class="keyword">where</span> <span class="title">TEvent</span> : <span class="title">EventBase</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">Task <span class="title">Handle</span> (<span class="params">TEvent @ebent</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EventBase</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> Guid EventId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = Guid.NewGuid ();</span><br><span class="line">    <span class="keyword">public</span> DateTime CreatedAt &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = DateTime.UtcNow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è€Œä¸ºäº†ç»´æŠ¤äº‹ä»¶(<strong>EventBase</strong>)å’Œäº‹ä»¶å¤„ç†å™¨(<strong>EventHandler</strong>)é—´çš„è®¢é˜…å…³ç³»ï¼Œåšä¸»è¿™é‡Œå®šä¹‰äº†<code>IEventBusSubscriptionManager</code>æ¥å£ï¼Œç›¸ä¿¡ä»¥ä½ å¯¹<code>å‘å¸ƒ-è®¢é˜…</code>æ¨¡å¼çš„ç†è§£ï¼Œä½ å¯ä»¥éå¸¸å®¹æ˜“åœ°æƒ³åˆ°ï¼Œè¿™é‡Œåº”è¯¥ä¼šç”¨åˆ°ä¸€ä¸ªå­—å…¸æ¥å­˜å‚¨æ¯ä¸€ä¸ªäº‹ä»¶ä»¥åŠè¯¥äº‹ä»¶å¯¹åº”çš„äº‹ä»¶å¤„ç†å™¨çš„ç±»å‹ä¿¡æ¯ã€‚ä½ çŒœå¯¹äº†ï¼Œäº‹å®ä¸Šå¤§å¤šæ•°çš„<code>EventBus</code>éƒ½æ˜¯è¿™æ ·å®ç°çš„ï¼Œå°¤å…¶å½“ä½ åœ¨å®ç°ä¸€ä¸ªåŸºäºå†…å­˜æˆ–è€…è¿›ç¨‹å†…é€šä¿¡çš„<code>EventBus</code>çš„æ—¶å€™, åˆ°è¿™ä¸€æ­¥å…¶å®å·²ç»å®Œæˆäº†å¤§å¤šæ•°çš„åŠŸèƒ½ã€‚ç†è®ºä¸Šä½ è¿˜åº”è¯¥å®šä¹‰ä¸€ä¸ª<code>IEventStore</code>æ¥å£ï¼Œæ˜¾è€Œæ˜“è§ï¼Œè¿™æ˜¯é’ˆå¯¹äº‹ä»¶çš„æŒä¹…åŒ–æ¥å£ï¼Œä¸è¿‡å½“æˆ‘ä»¬é€‰æ‹©<code>RabbitMQ</code>çš„æ—¶å€™ï¼Œå®ƒæ— å½¢ä¸­å°±è‡ªåŠ¨å¸®æˆ‘ä»¬å®ç°äº†è¿™ä¸ªæ¥å£ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IEventBusSubscriptionManager</span> </span><br><span class="line">&#123;</span><br><span class="line">    EventHandler&lt;EventBusSubscriptionEventArgs&gt; OnSubscribe &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    EventHandler&lt;EventBusSubscriptionEventArgs&gt; OnUnsubscribe &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Subscribe</span>&lt;<span class="title">T</span>, <span class="title">TH</span>&gt; ()</span></span><br><span class="line"><span class="function">        <span class="keyword">where</span> T : EventBase</span></span><br><span class="line"><span class="function">        <span class="keyword">where</span> TH : <span class="title">IEventHandler</span>&lt;<span class="title">T</span>&gt;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Unsubscribe</span>&lt;<span class="title">T</span>, <span class="title">TH</span>&gt; ()</span></span><br><span class="line"><span class="function">        <span class="keyword">where</span> T : EventBase</span></span><br><span class="line"><span class="function">        <span class="keyword">where</span> TH : <span class="title">IEventHandler</span>&lt;<span class="title">T</span>&gt;</span>;</span><br><span class="line">    <span class="function"><span class="built_in">bool</span> <span class="title">IsEventSubscribed</span>&lt;<span class="title">T</span>&gt; () <span class="keyword">where</span> T : EventBase</span>;</span><br><span class="line">    <span class="function"><span class="built_in">bool</span> <span class="title">IsEventSubscribed</span> (<span class="params"><span class="built_in">string</span> eventName</span>)</span>;</span><br><span class="line">    <span class="function">Type <span class="title">GetEventTypeByName</span> (<span class="params"><span class="built_in">string</span> eventName</span>)</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Clear</span> ()</span>;</span><br><span class="line">    <span class="function"><span class="title">IEnumerable</span>&lt;<span class="title">Type</span>&gt; <span class="title">GetHandlersForEvent</span>&lt;<span class="title">T</span>&gt; () <span class="keyword">where</span> T : EventBase</span>;</span><br><span class="line">    <span class="function"><span class="title">IEnumerable</span>&lt;<span class="title">Type</span>&gt; <span class="title">GetHandlersForEvent</span> (<span class="params"><span class="built_in">string</span> eventName</span>)</span>;</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">GetEventKey</span>&lt;<span class="title">T</span>&gt; () <span class="keyword">where</span> T : EventBase</span>;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>IEventBusSubscriptionManager</code>æ¥å£ä¸»è¦æä¾›äº†ç»´æŠ¤äº‹ä»¶(Event)å’Œäº‹ä»¶å¤„ç†å™¨(EventHnadler)ä¸¤è€…å…³ç³»çš„ä¸€ç³»åˆ—æ–¹æ³•ï¼Œæˆ‘ä¸ªäººè®¤ä¸ºç†è§£èµ·æ¥ç›¸å¯¹å®¹æ˜“ä¸€ç‚¹ï¼Œå®é™…ä¸Šçœ‹ <a target="_blank" rel="noopener" href="https://github.com/dotnet-architecture/eShopOnContainers">eShopOnContainers</a> çš„æ—¶å€™ï¼Œæˆ‘æ¯æ¬¡éƒ½æ˜¯ä»å…¶ä¸­çš„ä¸€ä¸ªå¾®æœåŠ¡å¼€å§‹ç ”ç©¶çš„ï¼Œå› ä¸ºè¿™æ ·ä½ æ‰èƒ½å‘ç°å…¶ä¸­çš„ç¥ç§˜ä¹‹å¤„ï¼Œä¸å¾—ä¸è¯´ï¼Œå¹³æ—¶çœ‹é‚£ç§æµæ°´è´¦ä»£ç çœ‹æƒ¯äº†ï¼Œçœ‹åˆ°è¿™æ ·æ¸…æ™°ã€ä¼˜é›…çš„ä»£ç ï¼Œå†…å¿ƒè¿˜æ˜¯è§‰å¾—å¹¸ç¦å•Šï¼Œå¯¹æŠ€æœ¯çš„çƒ­çˆ±å†åº¦è¢«ç‡ƒèµ·ã€‚</p>
<h1 id="åŸºäº-RabbitMQ-çš„å®ç°"><a href="#åŸºäº-RabbitMQ-çš„å®ç°" class="headerlink" title="åŸºäº RabbitMQ çš„å®ç°"></a>åŸºäº RabbitMQ çš„å®ç°</h1><h2 id="Publish"><a href="#Publish" class="headerlink" title="Publish"></a>Publish</h2><p>å¥½äº†ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹å¦‚ä½•åŸºäº<code>RabbitMQ</code>å®ç°ä¸Šé¢å®šä¹‰çš„<code>IEventBus</code>æ¥å£ï¼Œé¦–å½“å…¶å†²çš„æ˜¯<code>Publish()</code>æ–¹æ³•çš„å®ç°ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Publish</span>&lt;<span class="title">TEvent</span>&gt; (<span class="params">TEvent @<span class="keyword">event</span></span>)</span></span><br><span class="line"><span class="function">    <span class="keyword">where</span> TEvent : EventBase</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!_persistentConnection.IsConnected) _persistentConnection.TryConnect ();</span><br><span class="line">    <span class="keyword">using</span> (<span class="keyword">var</span> channel = _persistentConnection.CreateModel ()) </span><br><span class="line">    &#123;</span><br><span class="line">        channel.ExchangeDeclare (_exchangeName, <span class="string">&quot;direct&quot;</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> eventName = @event.GetType ().FullName;</span><br><span class="line">        <span class="keyword">var</span> message = JsonConvert.SerializeObject (@event);</span><br><span class="line">        <span class="keyword">var</span> body = Encoding.UTF8.GetBytes (message);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> properties = channel.CreateBasicProperties ();</span><br><span class="line">        properties.DeliveryMode = <span class="number">2</span>;</span><br><span class="line">        channel.BasicPublish (exchange: _exchangeName, routingKey: eventName, mandatory: <span class="literal">true</span>, basicProperties: properties, body: body);</span><br><span class="line">        _logger.LogDebug (<span class="string">$&quot;Publish message with RabbmitMQ BasicPublish: <span class="subst">&#123;message&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œé¦–å…ˆä»‹ç»ä¸‹<code>RabbitMQ</code>ä¸­çš„ä¸¤ä¸ªæ¦‚å¿µï¼Œå³<code>Connection</code>å’Œ<code>Channel</code>ã€‚å…¶ä¸­ï¼Œ<code>Connection</code>æ˜¯æ“ä½œ<code>RabbitMQ</code>çš„åŸºç¡€ï¼Œå°±åƒæˆ‘ä»¬æ“ä½œæ•°æ®åº“çš„æ—¶å€™ï¼Œéœ€è¦é¦–å…ˆå»ºç«‹æ•°æ®åº“è¿æ¥ä¸€æ ·ã€‚é‚£ä¹ˆï¼Œ<code>Channel</code>åˆæ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿå®ƒæ˜¯çœŸæ­£å»æ“ä½œ<code>RabbitMQ</code>çš„ä¸œè¥¿ã€‚ç»§ç»­ä»¥æ•°æ®åº“ä½œä¸ºä¾‹å­ï¼Œé‚£ä¹ˆ<code>Channel</code>å¯ä»¥ç†è§£ä¸º<code>ADO.NET</code>ä¸­çš„<code>Command</code>ï¼Œå³ï¼Œé‚£ä¸ªçœŸæ­£è´Ÿè´£æ‰§è¡Œ SQL è¯­å¥çš„å®¶ä¼™ã€‚ä¸€ä¸ªå…¸å‹çš„ä½¿ç”¨<code>RabbitMQ</code>çš„è¿‡ç¨‹ï¼Œå¤§æ¦‚æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> connectionFactory = <span class="keyword">new</span> ConnectionFactory() &#123; HostName = <span class="string">&quot;Your IP&quot;</span>, UserName = <span class="string">&quot;You User&quot;</span>, Password = <span class="string">&quot;Your Pass&quot;</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> connection = connectionFactory.CreateConnection();</span><br><span class="line"><span class="keyword">var</span> channel = connection..CreateModel();</span><br></pre></td></tr></table></figure>
<p>å›åˆ°æˆ‘ä»¬çš„ EventBus ä¸­ï¼Œå› ä¸º<code>RabbitMQ</code>çš„é“¾æ¥å¯èƒ½ä¼šåœ¨ä¸€æ®µæ—¶é—´åè‡ªåŠ¨å…³é—­ï¼Œæ‰€ä»¥ï¼Œåœ¨å¾®è½¯çš„ <a target="_blank" rel="noopener" href="https://github.com/dotnet-architecture/eShopOnContainers">eShopOnContainers</a> é¡¹ç›®ï¼Œå®ƒè®¾è®¡äº†ä¸€ä¸ªæ”¯æŒè‡ªåŠ¨é‡è¿çš„é“¾æ¥æŒä¹…åŒ–ç±»ï¼Œæˆ‘ä»¬è¿™é‡ŒåŒæ ·æœ‰è¿™ä¸ªæœºåˆ¶ï¼Œå½“å‘ç°é“¾æ¥æ–­å¼€çš„æ—¶å€™ï¼Œè‡ªåŠ¨å°è¯•é‡è¿ï¼Œè€Œæ¥ä¸‹æ¥å°±ç”±æˆ‘ä»¬ç†Ÿæ‚‰çš„<code>Channel</code>ç™»åœºå•¦ï¼è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å‘ç°åˆå‡ºç°äº†ä¸€ä¸ªæ–°é¢å­”â€”â€”äº¤æ¢å™¨(<strong>Exchange</strong>)ï¼Œå¥½å§ï¼Œè¿™åˆè¦å¼•å‡º RabbitMQ ä¸­æ¶ˆæ¯æŠ•é€’çš„åŸç†ï¼Œå³ RabbitMQ ä¸­æ¶ˆæ¯å¹¶éç”±å‘å¸ƒè€…ç›´æ¥å‘é€ç»™æ¶ˆè´¹è€…ï¼Œè€Œæ˜¯éœ€è¦ç»è¿‡äº¤æ¢å™¨è¿™ä¸ªä¸­ä»‹è€…ï¼Œè™½ç„¶ä½ å¯ä»¥ç›´æ¥å»è¯»å†™é˜Ÿåˆ—ï¼Œä½†æ˜¯å®é™…åº”ç”¨ä¸­é€šå¸¸éƒ½ä¸ä¼šè¿™ä¹ˆåšã€‚å…¶å®ï¼Œåœ¨æŸç§æ„ä¹‰ä¸Šï¼Œæˆ‘ä»¬çš„ EventBus ä¸€æ ·æ‰¿æ‹…ç€ä¸­ä»‹è€…çš„è§’è‰²ï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨æ€ä¹ˆå‘å¸ƒæ¶ˆæ¯ï¼Œè¿™ä¸ªæ¶ˆæ¯å°†ç”±å“ªä¸€ä¸ªè®¢é˜…è€…æ¥æ¶ˆè´¹å®Œå…¨ä¸éœ€è¦æˆ‘æ¥å…³å¿ƒï¼Œä¸€ä¸ªå…¸å‹çš„æ¶ˆæ¯æŠ•é€’è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/07/31/geWGI6M39fcw2S1.png" alt="RabbitMQæ¶ˆæ¯æŠ•é€’ç¤ºæ„å›¾"></p>
<p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯¹æ¶ˆæ¯è¿›è¡Œåºåˆ—åŒ–ä»¥åï¼ŒæŒ‰ç…§äº‹ä»¶çš„ç±»å‹ä¿¡æ¯ç”Ÿæˆ<code>routingKey</code>ï¼Œå¹¶æŒ‡å®šäº¤æ¢å™¨çš„ç±»å‹ä¸º<code>direct</code>ï¼Œè¿™æ˜¯ä¸€ä¸ª RabbitMQ ä¸­è‡ªå¸¦çš„<code>å‘å¸ƒ-è®¢é˜…</code>å®ç°ï¼Œå› ä¸ºäº¤æ¢å™¨ä¼šæ ¹æ®<code>routingKey</code>æŠ•é€’æ¶ˆæ¯åˆ°å¯¹åº”çš„é˜Ÿåˆ—ä¸­ï¼Œå…³äº RabbitMQ ä¸­å››ç§äº¤æ¢å™¨çš„è¯´æ˜ï¼Œå¯ä»¥åœ¨ä¸‹ä¸€èŠ‚æ‰¾åˆ°ç­”æ¡ˆã€‚æ³¨æ„åˆ°åœ¨å£°æ˜äº¤æ¢å™¨çš„æ—¶å€™ï¼Œç¬¬äºŒä¸ªå‚æ•°è¢«è®¾ä¸º trueï¼Œè¿™æ˜¯åœ¨ RabbitMQ éœ€è¦å¯¹è¿™ä¸ªäº¤æ¢å™¨è¿›è¡ŒæŒä¹…åŒ–ï¼›è€Œç¬¬ä¸‰ä¸ªå‚æ•°è¢«è®¾ä¸º falseï¼Œè¿™æ˜¯åœ¨å‘Šè¯‰ RabbitMQ è¿™ä¸ªäº¤æ¢å™¨å†…çš„æ¶ˆæ¯ä¸å…è®¸è‡ªåŠ¨åˆ é™¤ï¼›DeliveryMode è®¾ä¸º 2 åˆ™è¡¨ç¤ºæ¶ˆæ¯éœ€è¦æŒä¹…åŒ–åˆ°ç£ç›˜ä¸Šï¼Œè¿™æ ·å³ä½¿ RabbitMQ å‘ç”Ÿæ„å¤–å®•æœºï¼Œä¾ç„¶å¯ä»¥ä»ç£ç›˜ä¸Šæ¢å¤æ¶ˆæ¯ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬è°ƒç”¨<code>BasicPublish()</code>å°†æ¶ˆæ¯æŠ•é€’åˆ°æŒ‡å®šçš„äº¤æ¢æœºä¸­ï¼Œè¿™æ ·å°±å®Œæˆäº†äº‹ä»¶çš„å‘å¸ƒåŠŸèƒ½ã€‚</p>
<h2 id="Subscribe-Unsubscribe"><a href="#Subscribe-Unsubscribe" class="headerlink" title="Subscribe&#x2F;Unsubscribe"></a>Subscribe&#x2F;Unsubscribe</h2><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹<code>Subscribe()</code>å’Œ<code>Unsubscribe()</code>ä¸¤ä¸ªæ–¹æ³•çš„å®ç°è¿‡ç¨‹ã€‚è¿™é‡Œå®é™…ä¸Šéœ€è¦å®ç°ä¸¤éƒ¨åˆ†çš„åŠŸèƒ½ï¼Œä¸€ä¸ªæ˜¯ç®¡ç†äº‹ä»¶(<strong>EventBase</strong>)ä¸äº‹ä»¶å¤„ç†å™¨(<strong>EventHandler</strong>)é—´çš„å…³ç³»ï¼Œä¸€ä¸ªæ˜¯ç®¡ç†æ¶ˆè´¹è€…ã€æ¶ˆè´¹è€…é˜Ÿåˆ—ä¸äº¤æ¢å™¨é—´çš„å…³ç³»ã€‚å› ä¸ºè€ƒè™‘åˆ°åç»­å¯èƒ½éœ€è¦å®ç°ç±»ä¼¼<code>MediatR</code>çš„è¿›ç¨‹å†…é€šä¿¡çš„åŠŸèƒ½ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è€ƒè™‘å°†è¿™ä¸¤éƒ¨åˆ†å‰¥ç¦»å¼€æ¥ï¼Œè¿™æ ·æ–¹ä¾¿å¯¹<code>EventBus</code>è¿›è¡Œæ‰©å±•ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å®šä¹‰äº†<code>IEventSubscriptionManager</code>è¿™ä¸ªæ¥å£ï¼Œå®ƒçš„å®šä¹‰æˆ‘ä»¬åœ¨å‰é¢å·²ç»è§è¿‡ï¼Œæœ€ç»ˆæˆ‘ä»¬ä¼šåœ¨<code>EventBus</code>é‡Œå¼•ç”¨è¿™ä¸ªä¸­é—´å±‚ï¼Œè¿™æ ·å¯ä»¥è®©<code>EventBus</code>æ˜¾å¾—æ›´åŠ æ¸…çˆ½ä¸€ç‚¹ï¼Œä¸€èµ·æ¥çœ‹å®ƒçš„å…·ä½“å®ç°ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Subscribe</span>&lt;<span class="title">T</span>, <span class="title">TH</span>&gt; ()</span></span><br><span class="line"><span class="function">    <span class="keyword">where</span> T : EventBase</span></span><br><span class="line"><span class="function">    <span class="keyword">where</span> TH : IEventHandler&lt;T&gt;</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> eventName = GetEventKey&lt;T&gt; ();</span><br><span class="line">    <span class="keyword">if</span> (_eventHandlers.ContainsKey (eventName) &amp;&amp; !_eventHandlers[eventName].Any (x =&gt; x == <span class="keyword">typeof</span> (TH))) &#123;</span><br><span class="line">        _eventHandlers[eventName].Add (<span class="keyword">typeof</span> (TH));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        _eventHandlers[eventName] = <span class="keyword">new</span> List&lt;Type&gt; () &#123; <span class="keyword">typeof</span> (TH) &#125;;</span><br><span class="line">        _eventTypes.Add (<span class="keyword">typeof</span> (T));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (OnSubscribe != <span class="literal">null</span>)</span><br><span class="line">        OnSubscribe (<span class="keyword">this</span>, <span class="keyword">new</span> EventBusSubscriptionEventArgs () &#123; EvenType = <span class="keyword">typeof</span> (T), HandlerType = <span class="keyword">typeof</span> (TH) &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Unsubscribe</span>&lt;<span class="title">T</span>, <span class="title">TH</span>&gt; ()</span></span><br><span class="line"><span class="function">    <span class="keyword">where</span> T : EventBase</span></span><br><span class="line"><span class="function">    <span class="keyword">where</span> TH : IEventHandler&lt;T&gt;</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">var</span> eventName = GetEventKey&lt;T&gt; ();</span><br><span class="line">        <span class="keyword">if</span> (_eventHandlers.ContainsKey (eventName) &amp;&amp; _eventHandlers[eventName].Any (x =&gt; x == <span class="keyword">typeof</span> (TH))) &#123;</span><br><span class="line">            _eventHandlers[eventName].Remove (<span class="keyword">typeof</span> (TH));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (_eventHandlers.ContainsKey (eventName) &amp;&amp; !_eventHandlers[eventName].Any ()) &#123;</span><br><span class="line">            _eventHandlers.Remove (eventName);</span><br><span class="line">            _eventTypes.RemoveAll (x =&gt; x.FullName == eventName);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (OnUnsubscribe != <span class="literal">null</span> &amp;&amp; !GetHandlersForEvent&lt;T&gt; ().Any ())</span><br><span class="line">            OnSubscribe (<span class="keyword">this</span>, <span class="keyword">new</span> EventBusSubscriptionEventArgs () &#123; EvenType = <span class="keyword">typeof</span> (T), HandlerType = <span class="keyword">typeof</span> (TH) &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥æ³¨æ„åˆ°ï¼Œ<strong>è®¢é˜…å°±æ˜¯æ³¨å†Œ EventHandler åˆ°å¯¹åº”çš„é”®çš„è¿‡ç¨‹ï¼Œè€Œå–æ¶ˆè®¢é˜…å°±æ˜¯ä»å¯¹åº”çš„é”®é‡Œç§»é™¤ EventHandler çš„è¿‡ç¨‹</strong>ã€‚ä¸ºäº†ç¡®ä¿åœ¨è®¢é˜…æˆ–è€…é€€è®¢çš„æ—¶å€™ï¼Œå¯ä»¥é€šçŸ¥åˆ°å…·ä½“çš„ EventBus å®ç°è€…ï¼Œè­¬å¦‚ RabbitMQã€Kafka ç­‰ï¼Œæˆ‘ä»¬å®šä¹‰äº†<code>OnSubscribe</code>å’Œ<code>OnUnsubscribe</code>ä¸¤ä¸ªå§”æ‰˜ï¼Œå®é™…è®¾è®¡ä¸­ï¼Œæˆ‘ä»¬ä¼šåœ¨ EventBus åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå°†è¿™ä¸¤ä¸ªå§”æ‰˜æŒ‡å‘ EventBus å†…éƒ¨è®¢é˜…å’Œé€€è®¢çš„æ–¹æ³•ã€‚å¯¹äºè®¢é˜…ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ° RabbitMQ çš„<code>BasicConsume()</code>æ–¹æ³•ï¼›è€Œå¯¹äºå–æ¶ˆè®¢é˜…ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ° RabbitMQ çš„<code>UnbindQueue()</code>æ–¹æ³•ã€‚ä¸‹é¢ç»™å‡ºå…³é”®éƒ¨åˆ†çš„ä»£ç å®ç°ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//RabbitMQä¸­è®¢é˜…æŒ‡å®šçš„routingKey</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">StartBasicConsume</span> (<span class="params"><span class="built_in">string</span> routingKey</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    _logger.LogTrace (<span class="string">&quot;Starting RabbitMQ BasicConsume...&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!_persistentConnection.IsConnected) _persistentConnection.TryConnect ();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> queueName = GetQueueName (routingKey);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> channel = _persistentConnection.CreateModel ();</span><br><span class="line">    channel.ExchangeDeclare (_exchangeName, <span class="string">&quot;direct&quot;</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">    channel.QueueDeclare (queueName, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">    channel.QueueBind (queueName, _exchangeName, routingKey, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> consumer = <span class="keyword">new</span> EventingBasicConsumer (channel);</span><br><span class="line">    consumer.Received += <span class="keyword">async</span> (s, e) =&gt; &#123;</span><br><span class="line">        <span class="keyword">var</span> routingKey = e.RoutingKey;</span><br><span class="line">        <span class="keyword">var</span> message = Encoding.UTF8.GetString (e.Body.ToArray ());</span><br><span class="line">        <span class="keyword">var</span> tasks = ProcessEvent (routingKey, message);</span><br><span class="line">        <span class="keyword">await</span> Task.WhenAll (tasks);</span><br><span class="line">        channel.BasicAck (e.DeliveryTag, <span class="literal">false</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    channel.BasicConsume (queue: <span class="string">$&quot;Q:<span class="subst">&#123;routingKey&#125;</span>&quot;</span>, autoAck : <span class="literal">false</span>, consumer : consumer);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨EventHandlerå¤„ç†äº‹ä»¶</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> IEnumerable&lt;Task&gt; <span class="title">ProcessEvent</span> (<span class="params"><span class="built_in">string</span> eventName, <span class="built_in">string</span> message</span>)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (_subscriptionManager.IsEventSubscribed (eventName)) &#123;</span><br><span class="line">       <span class="comment">//åŸºäºPollyæ„å»ºè¶…æ—¶åˆé‡è¯•ç­–ç•¥</span></span><br><span class="line">        <span class="keyword">var</span> policy = BuildProcessEventPolicy ();</span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">var</span> serviceScope = _serviceProvider.CreateScope ()) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> handlerType <span class="keyword">in</span> _subscriptionManager.GetHandlersForEvent (eventName)) </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> handler = serviceScope.ServiceProvider.GetRequiredService (handlerType);</span><br><span class="line">                <span class="keyword">if</span> (handler == <span class="literal">null</span>) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">var</span> eventType = _subscriptionManager.GetEventTypeByName (eventName);</span><br><span class="line">                <span class="keyword">var</span> integrationEvent = JsonConvert.DeserializeObject (message, eventType);</span><br><span class="line">                <span class="keyword">var</span> concreteType = <span class="keyword">typeof</span>(IEventHandler&lt;&gt;).MakeGenericType (eventType);</span><br><span class="line"></span><br><span class="line">                _logger.LogInformation (<span class="string">$&quot;Process event \&quot;<span class="subst">&#123;eventName&#125;</span>\&quot; with \&quot;<span class="subst">&#123;handler.GetType().Name&#125;</span>\&quot;...&quot;</span>);</span><br><span class="line">                <span class="function"><span class="keyword">yield</span> <span class="title">return</span> (<span class="params">Task</span>)policy.<span class="title">Execute</span>(<span class="params">(</span>)</span> =&gt; concreteType.GetMethod (<span class="string">&quot;Handle&quot;</span>).Invoke (handler, <span class="keyword">new</span> <span class="built_in">object</span>[] &#123; integrationEvent &#125;));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//RabbitMQä¸­é€€è®¢æŸä¸ªäº‹ä»¶</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">UnbindQueue</span> (<span class="params"><span class="built_in">string</span> routingKey</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!_persistentConnection.IsConnected) _persistentConnection.TryConnect ();</span><br><span class="line">    <span class="keyword">var</span> channel = _persistentConnection.CreateModel ();</span><br><span class="line">    <span class="keyword">var</span> queueName = GetQueueName (routingKey);</span><br><span class="line">    channel.QueueUnbind (queueName, _exchangeName, routingKey, <span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<code>ProcessEvent()</code>æ–¹æ³•æ˜¯ EventBus é€šè¿‡ä¸€ä¸ªæˆ–å¤šä¸ª EventHandler å¤„ç†ä¸šåŠ¡çš„æ ¸å¿ƒæ–¹æ³•ã€‚å½“ä» RabbitMQ ä¸­æ¥æ”¶åˆ°æ¶ˆæ¯æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥å½“å‰äº‹ä»¶æ˜¯å¦å·²æ³¨å†Œã€‚å¦‚æœå·²æ³¨å†Œï¼Œåˆ™è·å–å½“å‰äº‹ä»¶å¯¹åº”çš„ EventHandler é›†åˆï¼Œç„¶åé€šè¿‡ IoC å®¹å™¨é€ä¸ªåœ°å–å¾—å¯¹åº”å®ä¾‹ï¼Œå› ä¸ºåœ¨å®šä¹‰ EventHandler çš„æ—¶å€™ï¼Œæˆ‘ä»¬è®©<code>Handle()</code>æ–¹æ³•è¿”å›äº†ä¸€ä¸ª Taskï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é¡ºåˆ©æˆç« åœ°ä½¿ç”¨<code>Task.WhenAll()</code>ï¼Œè€Œå½“æ‰€æœ‰çš„ EventHandler éƒ½å¤„ç†å®Œæˆçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºè¿™æ¡æ¶ˆæ¯è¢«å¤„ç†å®Œäº†ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨è¿›è¡Œ ACKï¼Œè¿™æ ·è¿™æ¡æ¶ˆæ¯å°±ä¼šä»é˜Ÿåˆ—ä¸­ç§»é™¤ï¼Œè‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„ EventBusã€‚</p>
<h1 id="RabbitMQ-è¿›é˜¶ä¸é‡Šç–‘"><a href="#RabbitMQ-è¿›é˜¶ä¸é‡Šç–‘" class="headerlink" title="RabbitMQ è¿›é˜¶ä¸é‡Šç–‘"></a>RabbitMQ è¿›é˜¶ä¸é‡Šç–‘</h1><p>æˆ‘åœ¨å†™è¿™ç¯‡åšå®¢çš„æ—¶å€™ï¼Œå‘¨å›´æœ‰å¾ˆå¤šäººéƒ½åŠæˆ‘ä¸è¦ç”¨ RabbitMQï¼Œè€Œä¸»è¦çš„ç†ç”±åˆ™æ˜¯ RabbitMQ çš„ååé‡ä¸å¦‚ Kafkaã€‚æˆ‘æ€€ç–‘æˆ‘ä»¬æœ‰æ—¶å€™ä¼šä¸¥é‡åœ°é«˜ä¼°è‡ªå·±ï¼Œâ€œé¢è¯•é€ ç«ç®­ï¼Œå…¥èŒæ‹§èºä¸â€ï¼Œè¿™ç§äº‹æƒ…éš¾é“è¿˜å°‘å—ï¼Ÿä¸å…¶ä¸€å¼ å˜´å°±æ˜¯é«˜å¹¶å‘ã€é«˜å¯ç”¨ï¼Œä¸å¦‚è¯šå®ä¸€ç‚¹ç»“åˆå®é™…æ¥é€‰æ‹©ï¼Œæˆ‘ç›¸ä¿¡ RabbitMQ é‡Œé‡åˆ°çš„é—®é¢˜ï¼Œå¯èƒ½æœ‰ä¸€äº›åŒæ ·ä¼šåœ¨ Kafka é‡Œé‡åˆ°ï¼Œå› ä¸ºè¿™ä¸ªä¸–ç•Œä¸Šå°±æ²¡æœ‰æœ€å®Œç¾çš„è§£å†³æ–¹æ¡ˆï¼Œå¯¹äºæˆ‘å†™è¿™ç¯‡åšå®¢çš„åˆå¿ƒè€Œè¨€ï¼Œæˆ‘æ˜¯ä¸ºäº†æŠŠ Binlog å‘å¸ƒåˆ° RabbitMQ ä¸Šï¼Œæ–¹ä¾¿ç¬¬ä¸‰æ–¹æ¥è®¢é˜…è¿™äº›æ•°æ®çš„â€œå˜åŒ–â€ï¼Œæ‰€ä»¥ï¼Œå¯é æ€§æ˜¯ä¸æ˜¯è¦æ¯”ååé‡æ›´é‡è¦ä¸€ç‚¹å‘¢ï¼Ÿå¥½äº†ï¼Œä¸‹é¢ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€äº›â€œæäººå¿§å¤©â€å¼çš„ RabbitMQ çš„è¿›é˜¶è¯é¢˜ï¼Œå°±æ˜¯å½“ä½ ç†Ÿæ‚‰äº† RabbitMQ çš„ API ä»¥åï¼Œéœ€è¦å»ç€é‡è€ƒè™‘çš„ä¸œè¥¿ã€‚</p>
<h2 id="RabbitMQ-ä¸¢æ¶ˆæ¯æ€ä¹ˆåŠ"><a href="#RabbitMQ-ä¸¢æ¶ˆæ¯æ€ä¹ˆåŠ" class="headerlink" title="RabbitMQ ä¸¢æ¶ˆæ¯æ€ä¹ˆåŠ"></a>RabbitMQ ä¸¢æ¶ˆæ¯æ€ä¹ˆåŠ</h2><p>ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯æœ€æ™®éçš„ä¸€ä¸ªé—®é¢˜ï¼ŒæŒ‰ç…§â€œ<strong>ç”Ÿäº§è€… -&gt; äº¤æ¢å™¨ -&gt; é˜Ÿåˆ— -&gt; æ¶ˆè´¹è€…</strong>â€çš„æ¨¡å¼ï¼Œä¸€æ—¦å‘ç”Ÿä¸¢æ¶ˆæ¯çš„æƒ…å†µï¼Œæ— éæœ‰ä¸‰ç§æƒ…å†µï¼š<strong>ç”Ÿäº§è€…ä¸¢æ¶ˆæ¯</strong>ã€<strong>æ¶ˆæ¯é˜Ÿåˆ—ä¸¢æ¶ˆæ¯</strong>ã€<strong>æ¶ˆè´¹è€…ä¸¢æ¶ˆæ¯</strong>ã€‚ä¸‹é¢æˆ‘ä»¬é€ä¸ªè¿›è¡Œåˆ†æï¼š</p>
<p>1ã€å¯¹äºç”Ÿäº§è€…ä¸¢æ¶ˆæ¯ï¼ŒRabbitMQæä¾›çš„<code>transaction</code>å’Œ<code>confirm</code>æœºåˆ¶å¯ä»¥ä¿è¯ç”Ÿäº§è€…ä¸ä¸¢æ¶ˆæ¯ï¼Œ<code>transaction</code>æœºåˆ¶ç±»ä¼¼æ•°æ®åº“çš„äº‹åŠ¡ï¼Œåªæœ‰å½“æ¶ˆæ¯å‘é€æˆåŠŸï¼Œäº‹ç‰©æ‰ä¼šè¢«æäº¤ï¼Œå¦åˆ™äº‹åŠ¡è¢«è¢«å›æ»šã€‚å› ä¸ºæ¯æ¬¡å‘æ¶ˆæ¯éƒ½å¿…é¡»å¼€å¯äº‹ç‰©ï¼Œæ‰€ä»¥<code>transaction</code>æœºåˆ¶ä¼šå¯¼è‡´ RabbitMQ ååé‡é™ä½ï¼Œä¸€èˆ¬å»ºè®®ä½¿ç”¨<code>confirm</code>æœºåˆ¶ï¼Œå³æ¶ˆæ¯è¢«æ­£ç¡®æŠ•é€’åˆ™å‘é€ ACK ç»™ç”Ÿäº§è€…ï¼Œå¦åˆ™å‘é€ NACK ç»™ç”Ÿäº§è€…ã€‚</p>
<p>2ã€å¯¹äºæ¶ˆæ¯é˜Ÿåˆ—ä¸¢æ¶ˆæ¯ï¼Œè§£å†³æ–¹æ¡ˆæˆ‘ä»¬åœ¨å‰é¢æœ‰æåˆ°è¿‡ï¼Œä¸»è¦æœ‰ä¸¤ç‚¹ï¼Œ<strong>ç¬¬ä¸€ï¼Œå£°æ˜é˜Ÿåˆ—çš„æ—¶å€™è®¾ç½® durable ä¸º trueï¼Œè¿™è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ”¯æŒæŒä¹…åŒ–çš„é˜Ÿåˆ—ã€‚ç¬¬äºŒï¼Œå‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œè®¾ç½® DeliveryMode ä¸º 2</strong>ï¼Œè¿™è¡¨ç¤ºæ¶ˆæ¯æ”¯æŒæŒä¹…åŒ–çš„ç£ç›˜ï¼Œå¦‚æœæœ‰ä¸€å¤© RabbitMQ é­é‡ä¸å¹¸ï¼Œæ¶ˆæ¯ä¼šè¢«æŒä¹…åŒ–åˆ°ç£ç›˜ä¸Šï¼Œæ‰€ä»¥è¯´ï¼Œä¹ æƒ¯æ€§ä¿å­˜æ˜¯ä¸ªå¥½ä¹ æƒ¯å•Šâ€¦â€¦</p>
<p>3ã€å¯¹äºæ¶ˆè´¹è€…ä¸¢æ¶ˆæ¯ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯æ‰‹åŠ¨ ACKï¼Œå› ä¸ºåªæœ‰é˜Ÿåˆ—æ”¶åˆ° ACK æ—¶ï¼Œå®ƒæ‰ä¼šä»é˜Ÿåˆ—ä¸­åˆ é™¤è¿™æ¡æ¶ˆæ¯ï¼Œå¦åˆ™ï¼Œè¿™æ¡æ¶ˆæ¯ä¼šé‡æ–°å›åˆ°é˜Ÿåˆ—ä¸­ï¼Œåªè¦å®ƒèƒ½é‡æ–°å›åˆ°é˜Ÿåˆ—ã€é‡æ–°å¤„ç†ï¼Œå®ƒæ€ä¹ˆä¼šä¸¢å‘¢ï¼Ÿä½ è¯´å¯¹å§ï¼Ÿ</p>
<h2 id="RabbitMQ-é‡è¯•ä¸è¶…æ—¶"><a href="#RabbitMQ-é‡è¯•ä¸è¶…æ—¶" class="headerlink" title="RabbitMQ é‡è¯•ä¸è¶…æ—¶"></a>RabbitMQ é‡è¯•ä¸è¶…æ—¶</h2><p>å…ˆè¯´ç»“è®ºï¼Œå…³äºé‡è¯•ä¸è¶…æ—¶è¿™ä¸ªè¯é¢˜ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§å®ç°æ€è·¯ï¼Œä¸€ç§æ˜¯åƒåšä¸»è¿™æ ·ï¼Œé‡‡ç”¨ Polly å®šä¹‰è¶…æ—¶+é‡è¯•çš„ç»„åˆç­–ç•¥ï¼Œç„¶åå°†è¿™ä¸ªç­–ç•¥é™„åŠ åˆ°æ¯ä¸€ä¸ª Handle()æ–¹æ³•ä¸Šï¼Œé€šè¿‡ç¨‹åºæ¥å®ç°é‡è¯•ä¸è¶…æ—¶ã€‚è€Œç¬¬äºŒç§æ€è·¯ï¼Œåˆ™æ˜¯åˆ©ç”¨æ¶ˆæ¯&#x2F;é˜Ÿåˆ—çš„ TTL å®ç°è¶…æ—¶ï¼Œåˆ©ç”¨æ­»ä¿¡å®ç°é‡è¯•ï¼Œæ¶ˆæ¯ TTL å’Œé˜Ÿåˆ— TTL çš„ä¸åŒåœ¨äºï¼Œä¸€ä¸ªé˜Ÿåˆ—è¶…æ—¶åˆ™é˜Ÿåˆ—å†…çš„æ¶ˆæ¯ä¼šè¢«å…¨éƒ¨æ¸…ç©ºï¼Œè€Œä¸€ä¸ªæ¶ˆæ¯è¶…æ—¶åˆ™å¯ä»¥åœ¨æ¸…ç©ºå‰å†³å®šæ˜¯å¦è¦æ¸…ç©ºã€‚</p>
<p>é‡è¯•ä¸è¶…æ—¶æœ€å¤§çš„é—®é¢˜å…¶å®åœ¨äºå¹‚ç­‰æ€§ï¼Œå› ä¸ºåœ¨ä»¥å¾€çš„å®è·µä¸­ï¼Œå½“æˆ‘ä»¬çš„æ¶ˆè´¹è€…å˜æˆä¸€ä¸ªç¬¬ä¸‰æ–¹çš„ API æ¥å£çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾ˆéš¾çŸ¥é“ï¼Œä¸€ä¸ªæ¶ˆæ¯åˆ°åº•éœ€è¦å¤„ç†å¤šä¹…ï¼Œæˆ‘ä¸€ç›´ä¸æ˜ç™½ï¼Œä¸ºä»€ä¹ˆå®æ´è¿™æ ·çš„å…¬å¸ï¼Œå®ƒä¸€ä¸ª API æ¥å£å±…ç„¶èƒ½ç­‰å°†è¿‘ 30 åˆ†é’Ÿï¼Œè€Œæ›´åŠ ä»¤äººéš¾ä»¥å¿å—çš„ï¼Œæ˜¯å¤§é‡åªèƒ½è°ƒç”¨ä¸€æ¬¡çš„æ¥å£ï¼Œè¿™ç±»æ¥å£æ—¢æ— æ³•ä¿è¯èƒ½ 100%è°ƒç”¨æˆåŠŸï¼ŒåŒæ ·æ— æ³•ä¿è¯ï¼Œç¬¬äºŒæ¬¡è°ƒå’Œç¬¬ä¸€æ¬¡è°ƒæ•ˆæœå®Œå…¨ä¸€æ ·ï¼Œæ‰€ä»¥ï¼Œå…³äºé‡è¯•ä¸è¶…æ—¶è¿™éƒ¨åˆ†ï¼Œå…¶å®åº”è¯¥ç»“åˆå®é™…ä¸šåŠ¡å»è®¾è®¡ï¼Œå› ä¸ºæ¯ä¸ªäººçš„è¯‰æ±‚å¯èƒ½éƒ½ä¸ä¸€æ ·ã€‚</p>
<h2 id="RabbitMQ-çš„å››ç§æ¨¡å¼"><a href="#RabbitMQ-çš„å››ç§æ¨¡å¼" class="headerlink" title="RabbitMQ çš„å››ç§æ¨¡å¼"></a>RabbitMQ çš„å››ç§æ¨¡å¼</h2><p>åœ¨å®ç° EventBus çš„è¿‡ç¨‹ä¸­ï¼Œåšä¸»ç”¨åˆ°äº†<code>direct</code>ç±»å‹çš„äº¤æ¢å™¨ï¼Œå¹¶è¯´è¿™æ˜¯ RabbitMQ å†…ç½®çš„å‘å¸ƒ-è®¢é˜…å®ç°ï¼Œå®é™…ä¸Šï¼Œè¿™é‡Œåº”è¯¥æœ‰<code>direct</code>ã€<code>fanout</code>ã€<code>topic</code>å’Œ<code>head</code>å››ç§ç±»å‹çš„äº¤æ¢å™¨ï¼Œä¸‹é¢æˆ‘ä»¬æ¥é€ä¸ªåœ°è¿›è¡Œè¯´æ˜ã€‚</p>
<p>1ã€<code>fanout</code>ç›¸å½“äºå¹¿æ’­ï¼Œæ‰€æœ‰ç»‘å®šäº†è¯¥äº¤æ¢å™¨çš„é˜Ÿåˆ—éƒ½ä¼šæ”¶åˆ°æ¶ˆæ¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/07/30/I6Ape3W5C1nOvxV.gif" alt="RabbitMQ-fanoutæ¨¡å¼"></p>
<p>2ã€<code>direct</code>ç›¸å½“äºå‘å¸ƒè®¢é˜…ï¼Œåªæœ‰ç»‘å®šäº†è¯¥äº¤æ¢å™¨ä¸” routingKey å®Œå…¨åŒ¹é…çš„é˜Ÿåˆ—ä¼šæ”¶åˆ°æ¶ˆæ¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/07/31/xcNezCmHov3UL5D.gif" alt="RabbitMQ-driectæ¨¡å¼"></p>
<p>3ã€<code>topic</code>ç›¸å½“äº<code>direct</code> + æ¨¡ç³ŠåŒ¹é…ï¼Œæ‰€æœ‰ç»‘å®šäº†è¯¥äº¤æ¢å™¨çš„é˜Ÿåˆ—ï¼Œä¸” routingKey ç¬¦åˆç»™å®šçš„æ¨¡å¼ï¼Œå°±ä¼šæ”¶åˆ°æ¶ˆæ¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/07/31/j6H5dOX4FsJPgxC.gif" alt="RabbitMQ-topicæ¨¡å¼"></p>
<p>4ã€<code>header</code>ç›¸å½“äºç»™æ¯æ¡æ¶ˆæ¯å®šä¹‰äº†ä¸€ä¸ªâ€œå¤´â€ï¼Œåªæœ‰å½“å¤´ä¸­çš„ä¸€ä¸ªé”®å€¼å¯¹(Any)æˆ–è€…å…¨éƒ¨é”®å€¼å¯¹(All)åŒ¹é…çš„æ—¶å€™ï¼Œæ‰ä¼šæ”¶åˆ°æ¶ˆæ¯ï¼Œè¿™ç§å®é™…åº”ç”¨ä¸­éå¸¸å°‘ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/07/31/Q7CkMVsL4jFRtNT.png" alt="RabbitMQ-headeræ¨¡å¼"></p>
<h2 id="RaabitMQ-çš„æ­»ä¿¡æœºåˆ¶"><a href="#RaabitMQ-çš„æ­»ä¿¡æœºåˆ¶" class="headerlink" title="RaabitMQ çš„æ­»ä¿¡æœºåˆ¶"></a>RaabitMQ çš„æ­»ä¿¡æœºåˆ¶</h2><p>RabbitMQ ä¸­çš„æ­»ä¿¡(Dead Letter)æœºåˆ¶ï¼Œæˆ‘è®¤ä¸ºæ˜¯ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„ä¸œè¥¿ï¼Œå› ä¸ºä»å®ç”¨æ€§çš„è§’åº¦æ¥è®²ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°â€œå»¶æ—¶é˜Ÿåˆ—â€ï¼Œè™½ç„¶åœ¨æ›´å¤šçš„åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ¶ˆæ¯èƒ½è¢«ç«‹å³å¤„ç†ï¼Œå› ä¸ºè¿™æ ·çœ‹èµ·æ¥æ›´åƒä¸€ä¸ªâ€œå®æ—¶â€çš„è¡Œä¸ºã€‚å¯åœ¨å®é™…åº”ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éš¾å…ä¼šé‡åˆ°è¿™æ ·ä¸€ç§æƒ…å†µï¼Œä¸€æ¡æ¶ˆæ¯ç»è¿‡æ‰‹åŠ¨ ACK ä»¥åä»é˜Ÿåˆ—ä¸­ç§»é™¤ï¼Œç»“æœæ¶ˆè´¹è€…ç«¯é—®ä½ èƒ½ä¸èƒ½å†æ¶ˆè´¹ä¸€æ¬¡è¿™æ¡æ¶ˆæ¯ï¼Œæ‰€ä»¥ï¼ŒKafka é‡Œå°±æä¾›äº†ä¸¤ç§ç­–ç•¥ï¼Œå³æœ€å¤šä¸€æ¬¡å’Œè‡³å°‘ä¸€æ¬¡ï¼Œæœ€å¤šä¸€æ¬¡ä¿è¯çš„æ˜¯æ¶ˆæ¯ä¸ä¼šè¢«é‡å¤æ¶ˆè´¹ï¼Œè€Œè‡³å°‘ä¸€æ¬¡ä¿è¯çš„æ˜¯æ¶ˆæ¯ 100%è¢«æˆåŠŸæ¶ˆè´¹ã€‚æ‰€ä»¥ï¼Œç®€å•æ¥è¯´ï¼Œåœ¨ä¸º RabbitMQ é…ç½®äº†æ­»ä¿¡çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è®©éƒ¨åˆ†æ¶ˆæ¯æœ‰æœºä¼šé‡æ–°è¿›å…¥é˜Ÿåˆ—ã€é‡æ–°è¢«æ¶ˆè´¹ã€‚é‚£ä¹ˆï¼Œä»€ä¹ˆæƒ…å†µä¸‹ä¼šäº§ç”Ÿæ­»ä¿¡å‘¢ï¼Ÿä¸»è¦æœ‰ä¸‹é¢ä¸‰ç§æƒ…å†µï¼š</p>
<ul>
<li>æ¶ˆæ¯è¢«å¦å®šç¡®è®¤ï¼Œä½¿ç”¨<code>channel.basicNack</code>æˆ–<code>channel.basicReject</code>ï¼Œå¹¶ä¸”æ­¤æ—¶<code>requeue</code>å±æ€§è¢«è®¾ç½®ä¸º falseã€‚</li>
<li>æ¶ˆæ¯åœ¨é˜Ÿåˆ—çš„å­˜æ´»æ—¶é—´è¶…è¿‡è®¾ç½®çš„ TTL æ—¶é—´ã€‚</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—çš„æ¶ˆæ¯æ•°é‡å·²ç»è¶…è¿‡æœ€å¤§é˜Ÿåˆ—é•¿åº¦ã€‚</li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œä¸ºäº†é…åˆæ­»ä¿¡æœºåˆ¶ï¼Œæˆ‘ä»¬å¿…é¡»è¦å£°æ˜æ­»ä¿¡é˜Ÿåˆ—ï¼Œå»ºè®®ä¸ºæ¯ä¸€ä¸ªéœ€è¦é…ç½®æ­»ä¿¡çš„äº‹ä»¶å•ç‹¬å®šä¹‰ä¸€ä¸ªæ­»ä¿¡é˜Ÿåˆ—ï¼Œå£°æ˜æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å£°æ˜æ­»ä¿¡äº¤æ¢å™¨</span></span><br><span class="line">channel.ExchangeDeclare(<span class="string">&quot;exchange.with.dlx&quot;</span>, <span class="string">&quot;direct&quot;</span>, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å£°æ˜æ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line"><span class="keyword">var</span> args = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">object</span>&gt;();</span><br><span class="line"><span class="comment">//è¯¥é˜Ÿåˆ—ä¸­æ‰€æœ‰æ¶ˆæ¯éƒ½è¿›å…¥æ­»ä¿¡äº¤æ¢å™¨</span></span><br><span class="line">args.Add(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, <span class="string">&quot;exchange.with.dlx&quot;</span>);</span><br><span class="line"><span class="comment">//è¯¥é˜Ÿåˆ—ä¸­æŒ‡å®šroutingKeyçš„æ¶ˆæ¯è¿›å…¥æ­»ä¿¡äº¤æ¢å™¨</span></span><br><span class="line">args.Add(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, <span class="string">&quot;foo.bar&quot;</span>);</span><br><span class="line">channel.QueueDeclare(<span class="string">&quot;queue.with.dlx&quot;</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, args);</span><br></pre></td></tr></table></figure>
<h1 id="æœ¬æ–‡å°ç»“"><a href="#æœ¬æ–‡å°ç»“" class="headerlink" title="æœ¬æ–‡å°ç»“"></a>æœ¬æ–‡å°ç»“</h1><p>æœ¬æ–‡å‚è€ƒå¾®è½¯çš„ <a target="_blank" rel="noopener" href="https://github.com/dotnet-architecture/eShopOnContainers">eShopOnContainers</a> é¡¹ç›®ï¼Œå®ç°ä¸€ä¸ªåŸºäº RabbitMQ çš„äº‹ä»¶æ€»çº¿ï¼Œäº‹ä»¶æ€»çº¿æ˜¯å‘å¸ƒ-è®¢é˜…æ¨¡å¼çš„ä¸€ç§å»¶ä¼¸ï¼Œå¯ä»¥åœ¨åˆ†å¸ƒå¼çš„ç¯å¢ƒä¸­ä»¤æ¶ˆæ¯çš„å‘å¸ƒè€…ã€è®¢é˜…è€…å®Œç¾åœ°è§£è€¦ï¼Œæ˜¯é¢†åŸŸé©±åŠ¨è®¾è®¡(DDD)ä¸­é‡è¦çš„åŸºç¡€è®¾æ–½ä¹‹ä¸€ï¼Œå¯¹äºå®ç°ä¸šåŠ¡ä¸Šçš„â€œäº‹ä»¶é©±åŠ¨â€éå¸¸æœ‰å¸®åŠ©ã€‚è€Œå®ç° EventBus æœ€å…³é”®çš„ä¸‰ä¸ªæ–¹æ³•ï¼Œå³ Publish()ã€Subscribe()å’Œ Unsubscribe()ï¼Œè¿™å…¶ä¸­éœ€è¦äº†è§£ä¸€éƒ¨åˆ† RabbitMQ çš„çŸ¥è¯†ï¼Œæ‰€ä»¥ï¼Œåœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œä½ å¯ä»¥äº†è§£åˆ° RabbitMQ çš„å››ç§äº¤æ¢å™¨ã€æ­»ä¿¡æœºåˆ¶ã€é‡è¯•è¶…æ—¶æœºåˆ¶ç­‰ç­‰ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç¯‡åšå®¢ä¸­ï¼Œé€šè¿‡ <a target="_blank" rel="noopener" href="https://github.com/noplay/python-mysql-replication">Python-Mysql-Replication</a> å®ç° Binlog çš„å‘å¸ƒï¼Œè€Œä¸€æ—¦æˆ‘ä»¬å°† Binlog å‘å¸ƒåˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œæœ¬æ–‡å®ç°çš„ EventBus å°±å¯ä»¥ä½œä¸ºæ¶ˆæ¯çš„ä¸­ä»‹è€…è€Œç™»åœºå•¦ï¼Œæ¬¢è¿å¤§å®¶ç»§ç»­å…³æ³¨æˆ‘çš„åšå®¢ï¼Œæˆ‘ä»¬ä¸‹ä¸€ç¯‡è§ï¼</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/07/09/2020-07-09-dodging-energy-vampires-book/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/07/09/2020-07-09-dodging-energy-vampires-book/" itemprop="url">å¦‚ä½•è¯†åˆ«å’Œæ‘†è„±ç²¾ç¥æ§åˆ¶ - è¯»ã€Šæƒ…æ„Ÿå¸è¡€é¬¼ã€‹</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-09T08:40:29+08:00">
                2020-07-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/summary/" itemprop="url" rel="index">
                    <span itemprop="name">summary</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>ç¬¬ä¸€æ¬¡å¬åˆ° PUA è¿™ä¸ªè¯ï¼Œæ˜¯ä»å—æ–¹å‘¨æœ«ä¸Šçœ‹åˆ°ã€Šâ€ä¸å¯’è€Œæ —â€çš„çˆ±æƒ…ï¼šåŒ—å¤§è‡ªæ€å¥³ç”Ÿçš„èŠå¤©è®°å½•ã€‹çš„ <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%8C%85%E4%B8%BD%E8%87%AA%E6%9D%80%E4%BA%8B%E4%BB%B6">æŠ¥é“</a>ï¼Œç„¶ååˆæ¥è§¦åˆ°ç²¾ç¥æ§åˆ¶è¿™ä¸€ç±»çš„è¯æ±‡ï¼Œå½“æ—¶è§‰å¾—å¾ˆæƒŠå¥‡ï¼Œæ²¡æƒ³åˆ°ç²¾ç¥æ§åˆ¶èƒ½å¤Ÿåšåˆ°ç”¨è¨€è¯­æœ€ç»ˆè®©äººè‡ªæ€çš„åœ°æ­¥ã€‚</p>
<p>æœ€è¿‘çœ‹å®Œäº†ä¸€æœ¬åç²¾ç¥æ§åˆ¶çš„ä¹¦ã€Šæƒ…æ„Ÿå¸è¡€é¬¼ - å¦‚ä½•è¯†åˆ«å¹¶é€ƒç¦»ç—…æ€å…³ç³»ã€‹ï¼Œè¿™æœ¬ä¹¦ç³»ç»Ÿæ€§åœ°ä»‹ç»äº†è¢«æ§åˆ¶äººçš„æ€§æ ¼ç‰¹ç‚¹ï¼Œä»¥åŠå¦‚ä½•ä¿æŠ¤è‡ªå·±ï¼Œæ¯”è¾ƒæœ‰æ„æ€çš„ä¸€æœ¬ä¹¦ï¼Œç»™å¤§å®¶åˆ†äº«ä¸€ä¸‹ã€‚</p>
<img src="/images/energy-vampires-book.jpg" class="">


<h2 id="ä»€ä¹ˆæ ·çš„äººå®¹æ˜“è¢«ç²¾ç¥æ§åˆ¶"><a href="#ä»€ä¹ˆæ ·çš„äººå®¹æ˜“è¢«ç²¾ç¥æ§åˆ¶" class="headerlink" title="ä»€ä¹ˆæ ·çš„äººå®¹æ˜“è¢«ç²¾ç¥æ§åˆ¶"></a>ä»€ä¹ˆæ ·çš„äººå®¹æ˜“è¢«ç²¾ç¥æ§åˆ¶</h2><p>ä½œè€…å°†ç²¾ç¥æ§åˆ¶è€…æ¯”å–»æˆï¼šæƒ…æ„Ÿå¸è¡€é¬¼ï¼Œæˆ‘ä¸å¤ªå–œæ¬¢è¿™ä¸ªè¯ï¼Œæ‰€ä»¥ä¸‹æ–‡ä¸­æˆ‘è¿˜æ˜¯ç§°ä»–ä»¬ä¸ºç²¾ç¥æ§åˆ¶è€…ã€‚è¢«æ§åˆ¶çš„äººï¼Œæˆ‘ä»¬ç§°ä½œé«˜å…±æƒ…è€…ã€‚</p>
<p>ä½œè€…è®¤ä¸ºï¼šæ•æ„Ÿæ€§é«˜çš„å…±æƒ…è€…æœ€å¯èƒ½è¢«ç²¾ç¥æ§åˆ¶ï¼Œæˆä¸ºæƒ…æ„Ÿå¸è¡€é¬¼çš„å—å®³è€…ã€‚è€Œé«˜å…±æƒ…è€…é€šå¸¸æ˜¯æ¯”è¾ƒä¼šéšè—å’Œæ”¹å˜è‡ªå·±ï¼Œä»¥é€‚åº”ç¯å¢ƒçš„ã€‚è¿™ä¸€ç±»äººé€šå¸¸åœ¨ç«¥å¹´çš„æ—¶å€™ç»å†è¿‡ä¸€æ®µç—›è‹¦çš„ç»å†ã€‚å› ä¸ºç»å†è¿‡ç—›è‹¦ï¼Œæ‰€ä»¥å°±ä¼šæ¸´æœ›å…³å¿ƒï¼Œä¹Ÿæ›´å¤šæ—¶å€™ç«™åœ¨åˆ«äººçš„ç«‹åœºä¸Šè€ƒè™‘é—®é¢˜ï¼Œæ„¿æ„ç‰ºç‰²è‡ªå·±ã€‚</p>
<p>åŒ—å¤§åŒ…ä¸½ï¼ˆåŒ–åï¼‰å°±æ˜¯ä¸€ä¸ªé«˜å…±æƒ…è€…ï¼Œå¥¹å°±æ˜¯å› ä¸ºå¾ˆå¹³å¸¸çš„ä¸€ä¸ªäº‹æƒ…ï¼šä¸æ˜¯å¤„å¥³ï¼Œå°±å¾—æ¥å—ç”·å‹çš„å„ç§å˜æ€çš„è¦æ±‚ï¼šæŠŠè‡ªå·±ç§°ä½œç‹—ï¼Œæ‹è£¸ç…§ç»™ç”·å‹ï¼Œç­”åº”åšç»è‚²æ‰‹æœ¯ï¼Œæœ€åç”šè‡³æ„¿æ„è‡ªæ€ã€‚</p>
<p>äº¤å¾€çš„å¯¹è±¡ â€œä¸æ˜¯å¤„å¥³â€ åœ¨ç°åœ¨è¿™ä¸ªç¤¾ä¼šæ˜¯å¾ˆå¹³å¸¸çš„äº‹æƒ…ï¼Œä½†æ˜¯ç”±äºåŒ…ä¸½çš„é«˜å…±æƒ…ï¼Œæ„¿æ„ç«™åœ¨ç”·æœ‹å‹çš„è§’åº¦è€ƒè™‘ä»–çš„æ„Ÿå—ï¼Œæ‰€ä»¥æ„¿æ„ä¸ºç”·æœ‹å‹çš„æ„Ÿå—åšå‡ºæ˜æ˜¾è¿‡åˆ†çš„è‡ªæˆ‘æƒ©ç½šã€‚</p>
<p>æƒ³æƒ³ä½ æœ‰æ²¡æœ‰ä¸€æ®µä¸æ„¿æ„å›å¿†çš„ç«¥å¹´ç»å†ï¼Ÿä½ æœ‰æ²¡æœ‰åœ¨ç«¥å¹´ç¼ºå°‘æ”¯æŒå’Œè®¤åŒï¼Ÿæœ‰æ²¡æœ‰éœ€è¦ä»˜å‡ºï¼Œæ‰å¯èƒ½å¾—åˆ°çˆ¶æ¯çš„çˆ±ï¼Ÿæœ‰æ²¡æœ‰ä¸ºäº†è®¨å¥½åˆ«äººè€Œæ”¹å˜æˆ–è€…éšè—è‡ªå·±çœŸå®çš„æƒ³æ³•ï¼Ÿå¦‚æœæœ‰çš„è¯ï¼Œé‚£ä¹ˆå…¶å®ä½ ä¹Ÿæ˜¯å®¹æ˜“è¢«ç²¾ç¥æ§åˆ¶çš„é«˜å…±æƒ…è€…ã€‚</p>
<p>å¦ç™½è¯´ï¼Œæˆ‘è‡ªå·±å°±æ˜¯ä¸€ä¸ªé«˜å…±æƒ…è€…ã€‚æ•æ„Ÿï¼Œå–œæ¬¢ç«™åœ¨å¯¹æ–¹è§’åº¦æ€è€ƒé—®é¢˜ï¼Œä¸å–œæ¬¢å†²çªï¼Œå®¹æ˜“å¦¥åã€‚</p>
<h2 id="ç²¾ç¥æ§åˆ¶çš„å¥—è·¯"><a href="#ç²¾ç¥æ§åˆ¶çš„å¥—è·¯" class="headerlink" title="ç²¾ç¥æ§åˆ¶çš„å¥—è·¯"></a>ç²¾ç¥æ§åˆ¶çš„å¥—è·¯</h2><p>ç²¾ç¥æ§åˆ¶çš„å¥—è·¯å…¶å®åœ¨åŒ—å¤§åŒ…ä¸½äº‹ä»¶ä¸Šæ¼”ç»å¾—å¾ˆå®Œæ•´ã€‚é¦–å…ˆï¼Œå®æ–½ç²¾ç¥æ§åˆ¶çš„äººé€šå¸¸éƒ½å¾ˆä¼˜ç§€ï¼Œä¹¦ä¸­çš„æ¡ˆä¾‹åŒ…æ‹¬å…¬å¸çš„ CEOï¼Œé«˜ç®¡ç­‰ã€‚æ§åˆ¶åŒ…ä¸½çš„ç‰Ÿæ—ç¿°åœ¨åŒ—å¤§ä¹Ÿæ˜¯å­¦ç”Ÿä¼šå‰¯ä¸»å¸­ï¼Œä½†è¿™å¹¶ä¸ä»£è¡¨ä»–ä»¬å–„è‰¯ã€‚</p>
<p>ç²¾ç¥æ§åˆ¶è€…é¦–å…ˆæ˜¯ä¸é«˜å…±æƒ…è€…å»ºç«‹ä¿¡ä»»å…³ç³»ï¼Œåœ¨è¿™ä¸ªæœŸé—´ï¼Œä»–ä»¬ä¼šè¡¨ç°å¾—éå¸¸å‹å¥½ï¼Œè®©ä½ æ„Ÿå—åˆ°æ‰¾åˆ°äº†ç†æƒ³çš„äººã€‚ä½†æ˜¯å…¶å®ï¼Œè¿™åªæ˜¯ç²¾ç¥æ§åˆ¶è€…çš„å¥—è·¯ã€‚ä»–ä»¬çœŸå®çš„ç›®çš„æ˜¯åˆ©ç”¨ä½ ä¸ä»–å»ºç«‹çš„ä¿¡ä»»ï¼Œæ¥æ·±å…¥åœ°äº†è§£ä½ çš„ä¸€åˆ‡ï¼Œä»è€Œè·å¾—ä½ çš„ç¼ºç‚¹ï¼Œè¿™å°±æ˜¯ä½ çš„ä¼¤å£ã€‚</p>
<p>è¿™ä¸ªç¼ºç‚¹æ˜¯ä»€ä¹ˆä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯ç²¾ç¥æ§åˆ¶è€…ä¼šå£°ç§°è¿™ä¸ªç¼ºç‚¹æ¯äº†ä»–ï¼Œè®©ä»–é­å—äº†å·¨å¤§çš„æ‰“å‡»ï¼Œè¿™ä¼šè®©é«˜å…±æƒ…è€…æ„Ÿè§‰åˆ°å†…ç–šã€‚äºæ˜¯ï¼Œæ—¥å¤ä¸€æ—¥åœ°ï¼Œç²¾ç¥æ§åˆ¶è€…å¾€å…±æƒ…è€…çš„è¿™ä¸ªä¼¤å£ä¸Šæ’’ç›ï¼Œè®©å…±æƒ…è€…äººæ ¼æ…¢æ…¢æ‰­æ›²ã€‚æ‰­æ›²çš„æ•ˆæœå°±æ˜¯ï¼Œå…±æƒ…è€…ä¼šçœŸçš„è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„ç¼ºç‚¹ï¼Œåº”è¯¥ä¸ºäº†è¿™ä¸ªç¼ºç‚¹è¡¥å¿ç²¾ç¥æ§åˆ¶è€…ã€‚</p>
<p>å½“å…±æƒ…è€…æ„¿æ„ä¸ºäº†ä¸€ä¸ªè¢«å¤¸å¤§çš„ç¼ºç‚¹è¡¥å¿ç²¾ç¥æ§åˆ¶è€…ä¹‹åï¼Œå…±æƒ…è€…å°±å å…¥äº†è¢«æ§åˆ¶çš„æ·±æ¸Šã€‚ç²¾ç¥æ§åˆ¶è€…çš„è¦æ±‚ä¼šé€æ­¥å‡çº§ï¼Œä»å†™å¿æ‚”ä¹¦ï¼Œåˆ°ä¸‹è·ªï¼Œåˆ°èº«ä½“æƒ©ç½šï¼Œåˆ°ç²¾ç¥æƒ©ç½šï¼Œæœ€ç»ˆå˜æˆç²¾ç¥æ§åˆ¶è€…çš„å¥´éš¶ã€‚</p>
<p>åŒ—å¤§çš„åŒ…ä¸½å…ˆå’Œç‰Ÿæ—ç¿°å»ºç«‹äº†æ‹çˆ±å…³ç³»ï¼Œè®©ç‰Ÿæ—ç¿°çŸ¥é“äº†è‡ªå·±çš„éšç§ï¼Œä»è€Œè¢«ç‰Ÿæ—ç¿°æŠ“ä½ç¼ºç‚¹ä¸æ–­å¼ºè°ƒï¼Œè¿›è€Œè®¤ä¸ºè‡ªå·±çœŸçš„åº”è¯¥ â€œè®¤é”™å¹¶ä¸”å¿æ‚”â€ï¼Œä»è€Œä»åˆšå¼€å§‹çš„å‘æ¯’èª“ï¼Œåˆ°åé¢çº¹èº«ç§°è‡ªå·±æ˜¯ç‹—ï¼ŒæŠŠç‰Ÿæ—ç¿°çš„å¾®ä¿¡æ˜µç§°æ”¹æˆä¸»äººï¼Œå†åˆ°åé¢æ¥å—å»åšç»è‚²æ‰‹æœ¯ã€‚ä»ç²¾ç¥æ§åˆ¶æ¥è¯´ï¼Œç‰Ÿæ—ç¿°çœŸçš„åƒæ˜¯æ•™ç§‘ä¹¦èˆ¬çš„å­˜åœ¨ã€‚</p>
<h2 id="å¦‚ä½•è¯†åˆ«å’Œé€ƒç¦»ç²¾ç¥æ§åˆ¶"><a href="#å¦‚ä½•è¯†åˆ«å’Œé€ƒç¦»ç²¾ç¥æ§åˆ¶" class="headerlink" title="å¦‚ä½•è¯†åˆ«å’Œé€ƒç¦»ç²¾ç¥æ§åˆ¶"></a>å¦‚ä½•è¯†åˆ«å’Œé€ƒç¦»ç²¾ç¥æ§åˆ¶</h2><h3 id="è¯†åˆ«ç²¾ç¥æ§åˆ¶"><a href="#è¯†åˆ«ç²¾ç¥æ§åˆ¶" class="headerlink" title="è¯†åˆ«ç²¾ç¥æ§åˆ¶"></a>è¯†åˆ«ç²¾ç¥æ§åˆ¶</h3><p>ç²¾ç¥æ§åˆ¶è€…é¦–å…ˆè‡ªå·±çš„å¿ƒç†å°±ä¸æ˜¯å¥åº·çš„ï¼Œé€šå¸¸ä»–ä»¬çš„è¡Œä¸ºæ¨¡å¼æ ‡ç­¾åŒ…æ‹¬å¿ƒç†å˜æ€ã€è‡ªæ‹ã€è¾¹ç¼˜å‹äººæ ¼æˆ–åç¤¾ä¼šçš„è¡Œä¸ºå€¾å‘ï¼Œè¿™äº›äººæ ¼ç±»å‹ä¸º B ç±»ã€‚åœ¨ç¾å›½ç²¾ç¥ç—…å­¦åä¼šå‡ºç‰ˆçš„ã€Šç²¾ç¥ç–¾ç—…è¯Šæ–­ä¸ç»Ÿè®¡æ‰‹å†Œã€‹ä¸­ï¼ŒB ç±»äººæ ¼ç‰¹å¾åŒ…æ‹¬ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%8F%8D%E7%A4%BE%E4%BC%9A%E5%9E%8B%E4%BA%BA%E6%A0%BC%E9%9A%9C%E7%A2%8D">åç¤¾ä¼šå‹äººæ ¼éšœç¢</a></li>
<li><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%BE%B9%E7%BC%98%E5%9E%8B%E4%BA%BA%E6%A0%BC%E9%9A%9C%E7%A2%8D">è¾¹ç¼˜å‹äººæ ¼éšœç¢</a></li>
<li><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%A1%A8%E6%BC%94%E5%9E%8B%E4%BA%BA%E6%A0%BC%E9%9A%9C%E7%A2%8D">è¡¨æ¼”å‹äººæ ¼éšœç¢</a></li>
<li><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%87%AA%E6%81%8B%E5%9E%8B%E4%BA%BA%E6%A0%BC%E9%9A%9C%E7%A2%8D">è‡ªæ‹å‹äººæ ¼éšœç¢</a></li>
</ul>
<p>æˆ‘æŸ¥äº†ä¸€ä¸‹ç™¾åº¦ç™¾ç§‘ï¼Œç‰Ÿæ—ç¿°å¯èƒ½æœ‰ä¸€éƒ¨åˆ† è¾¹ç¼˜å‹äººæ ¼éšœç¢ å’Œ è‡ªæ‹å‹äººæ ¼éšœç¢ çš„ç‰¹å¾ã€‚å‰è€…å–œæ¬¢ç”¨è¡¨ç°å¼ºçƒˆçš„æƒ…ç»ªååº”ï¼Œè´¬ä½ã€æ”»å‡»æˆ–æŒ–è‹¦å¯¹æ–¹ï¼ŒåŒæ—¶ç”¨è‡ªæ€ã€è‡ªæ®‹è‡ªä¼¤ç­‰æ¥é˜»æ­¢è¢«æŠ›å¼ƒã€‚åè€…åœ¨æ„ç¤¾ä¼šæˆå°±ï¼Œå¯èƒ½åœ¨å·¥ä½œä¸Šæ¯”è¾ƒæˆåŠŸã€‚</p>
<p>å½“ç²¾ç¥æ§åˆ¶è€…æ‹¿è‡ªæ€æ¥å¨èƒä½ çš„æ—¶å€™ï¼Œä½ å°±è¦ç‰¹åˆ«å°å¿ƒäº†ï¼Œä»–å¾ˆå¯èƒ½ä¸æ˜¯çœŸçš„æƒ³è‡ªæ€ï¼Œè€Œæ˜¯æƒ³è¦æ‹¿è‡ªæ€è¦æŒŸä½ ã€‚</p>
<h3 id="é€ƒç¦»ç²¾ç¥æ§åˆ¶"><a href="#é€ƒç¦»ç²¾ç¥æ§åˆ¶" class="headerlink" title="é€ƒç¦»ç²¾ç¥æ§åˆ¶"></a>é€ƒç¦»ç²¾ç¥æ§åˆ¶</h3><p>ç²¾ç¥æ§åˆ¶è€…æƒ¯ç”¨çš„ä¼ä¿©å°±æ˜¯è¿‡åº¦å¤¸å¤§å…±æƒ…è€…çš„ç¼ºç‚¹ï¼Œå½“å‡ºç°è¿™ç§æƒ…å†µçš„æ—¶å€™ï¼Œå°±åº”è¯¥å°½å¿«æƒ³åŠæ³•é€ƒç¦»è¿™ç§å…³ç³»ã€‚</p>
<p>ä¹¦ä¸­æåˆ°å¾ˆå¤šå…±æƒ…è€…ä¼šç»å†å¤šæ¬¡åå¤ï¼Œå› ä¸ºå†…å¿ƒæ·±å¤„è§‰å¾—å¯¹æ–¹å¯èƒ½æ”¹å˜ã€‚ä½†æ˜¯äº‹å®ä¸Šè¿™ç§äººæ ¼éšœç¢å¿ƒç†é—®é¢˜å¯èƒ½æ˜¯æ¥è‡ªäºé—ä¼ æˆ–è€…é•¿æœŸçš„ç”Ÿæ´»ï¼Œæ”¹å˜çš„å¯èƒ½æ€§æä½ã€‚ä½œè€…å»ºè®®å¤§å®¶é€‰æ‹©å°½å¿«ç»“æŸæ‰è¿™ç§å…³ç³»ï¼Œä¸è¦æŠ±å¸Œæœ›ã€‚</p>
<p>å…±æƒ…è€…å› ä¸ºå·²ç»è¶³å¤Ÿä¸ºåˆ«äººç€æƒ³äº†ï¼Œæ‰€ä»¥åœ¨é¢å¯¹è¿™ç§å…³ç³»æ—¶åº”è¯¥è¦æ³¨æ„å®ˆä½è‡ªå·±çš„è¾¹ç•Œï¼Œä¸èƒ½è®©è‡ªå·±çš„ä¸€ç‚¹ç‚¹å°é—®é¢˜è¢«æ— é™æ”¾å¤§ã€‚åŒæ—¶ä¸“æ³¨äºè‡ªå·±çš„æ„Ÿå—ï¼Œå¦‚æœè‡ªå·±æ„Ÿå—å·²ç»å¾ˆæœ‰å‹åŠ›äº†ï¼Œé‚£ä¹ˆè¿™ç§å…³ç³»å°±æ˜¯ä¸å¯¹çš„ã€‚</p>
<h2 id="å¦‚ä½•ä¿®å¤è‡ªå·±å†…å¿ƒçš„ç«¥å¹´åˆ›ä¼¤"><a href="#å¦‚ä½•ä¿®å¤è‡ªå·±å†…å¿ƒçš„ç«¥å¹´åˆ›ä¼¤" class="headerlink" title="å¦‚ä½•ä¿®å¤è‡ªå·±å†…å¿ƒçš„ç«¥å¹´åˆ›ä¼¤"></a>å¦‚ä½•ä¿®å¤è‡ªå·±å†…å¿ƒçš„ç«¥å¹´åˆ›ä¼¤</h2><p>ä½œè€…åœ¨æœ€åä¹Ÿæåˆ°ï¼Œå¤§å¤šæ•°å…±æƒ…è€…ä¸ç²¾ç¥æ§åˆ¶è€…ä¸€æ ·ï¼Œéƒ½æœ‰ç€ä¸€å®šçš„å¿ƒç†é—®é¢˜ï¼Œå…±æƒ…è€…çš„é—®é¢˜ä¸»è¦æ¥è‡ªäºç«¥å¹´çš„åˆ›ä¼¤ï¼Œç”±äºç¼ºå°‘çˆ±è€Œæ¸´æœ›å…³å¿ƒã€‚ä½œè€…åœ¨ä¹¦ä¸­ä¹Ÿæåˆ°äº†å„ç§å¿ƒç†æ²»ç–—çš„æ–¹å¼ã€‚æˆ‘è¿™é‡Œæ‘˜å½•ä¸¤ä¸ªå°è±¡è¾ƒæ·±çš„ã€‚</p>
<h3 id="è¡¨è¾¾æƒ…ç»ª"><a href="#è¡¨è¾¾æƒ…ç»ª" class="headerlink" title="è¡¨è¾¾æƒ…ç»ª"></a>è¡¨è¾¾æƒ…ç»ª</h3><p>å…±æƒ…è€…å¸¸å¸¸å‹æŠ‘è‡ªå·±çš„è´Ÿé¢æƒ…ç»ªï¼Œä½†åƒæ„¤æ€’ã€æ‚²ä¼¤è¿™ä¸€ç±»æƒ…ç»ªï¼Œéƒ½æ˜¯èº«ä½“çš„éœ€è¦ï¼Œåº”è¯¥è¡¨è¾¾å‡ºæ¥ã€‚å¦‚æœä¸è¡¨è¾¾å‡ºæ¥ï¼Œå°±ä¼šå‡ºç°ä¸€äº›ç”Ÿç†æˆ–å¿ƒç†çš„é—®é¢˜ã€‚å½“ä½ ç»å†ç—›è‹¦çš„æ—¶å€™ï¼Œä½ å¿…é¡»é€šè¿‡åŠ¨ä½œã€å£°éŸ³å’Œçœ¼æ³ªæ¥è¿›è¡Œæ²»æ„ˆï¼Œè¿™æ˜¯èº«ä½“æ²»ç–—ç—›è‹¦çš„å¤©ç”Ÿæ–¹æ³•ã€‚å¦åˆ™ï¼Œæ‰€æœ‰è¿™äº›èƒ½é‡ä¼šå¡åœ¨ä½ çš„èº«ä½“é‡Œï¼Œå¯¼è‡´å„ç§å„æ ·çš„å¥åº·é—®é¢˜ã€‚</p>
<p>ä¹¦ä¸­ä»‹ç»äº†å¿ƒç†æ²»ç–—å¸ˆå¯¹å—å®³è€…çš„ä¸€ä¸ªå£°éŸ³æ²»ç–—æ–¹æ¡ˆï¼Œè®©å—å®³è€…å‡æƒ³é¢å¯¹ç²¾ç¥æ§åˆ¶è€…ï¼Œè¯´ï¼šâ€æŸæŸï¼Œä½ è¿™ä¸ª XX çš„ XXï¼Œä½ çœŸæ˜¯ä¸ªæ··è›‹ï¼Œæˆ‘é€ä½ è¸ä¸Šç–—å…»ä¹‹è·¯â€ã€‚</p>
<h3 id="è‡ªæˆ‘æ²Ÿé€šæ³•"><a href="#è‡ªæˆ‘æ²Ÿé€šæ³•" class="headerlink" title="è‡ªæˆ‘æ²Ÿé€šæ³•"></a>è‡ªæˆ‘æ²Ÿé€šæ³•</h3><p>ä¹¦ä¸­ä»‹ç»äº†ä¸€ç§é€šè¿‡å’Œå¹¼å¹´çš„è‡ªå·±å‡æƒ³â€å¯¹è¯â€çš„æ²»ç–—æ–¹æ¡ˆï¼Œæˆ‘æ„Ÿè§‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¡¨è¾¾å®£æ³„å¼çš„æ²»ç–—ï¼Œå…·ä½“åšæ³•æ˜¯ï¼š</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼šåœæ­¢ã€‚æƒ³åƒä¸€ä¸ªåœæ­¢çš„æ ‡å¿—ã€‚</li>
<li>ç¬¬äºŒæ­¥ï¼šç”¨é¼»å­æ·±å‘¼å¸ã€‚è®©è‡ªå·±æ”¾æ¾ã€‚</li>
<li>ç¬¬ä¸‰æ­¥ï¼šæ‰¿è®¤ï¼šâ€å“‡ï¼Œæˆ‘åˆæ¥äº†â€ã€‚å¸®åŠ©è‡ªå·±æ„è¯†åˆ°ä½ çš„æ•…äº‹ã€‚</li>
<li>ç¬¬å››æ­¥ï¼šè·å¾—ä¸€ä¸ªæ•°å­—ã€‚æƒ³ä¸€ä¸ªæ•°å­—ï¼Œè¿™ä¸ªæ•°å­—è¡¨ç¤ºä½ å°†é‡åˆ°çš„è¿‡å»çš„è‡ªå·±çš„å¹´é¾„ã€‚</li>
<li>ç¬¬äº”æ­¥ï¼šä¸è¿™ä¸ªâ€å†…åœ¨å°å­©â€ç›¸é‡ã€‚åˆ›é€ ä¸€ä¸ªç¥å¥‡çš„èŠ±å›­ï¼Œä½ å’Œè¿‡å»çš„è‡ªå·±ç›¸é‡ï¼Œçœ‹çœ‹ä»–åœ¨åšä»€ä¹ˆï¼Œä½ èƒ½ä¸èƒ½ç»™ä»–çˆ±å’Œå®‰æ…°ã€‚</li>
<li>ç¬¬å…­æ­¥ï¼šå‘Šåˆ«å­©å­ã€‚è®©å­©å­æ”¾å¿ƒï¼Œç„¶åä½ ç¦»å¼€ï¼ŒæŠŠå­©å­ç•™åœ¨èŠ±å›­ã€‚</li>
<li>ç¬¬ä¸ƒæ­¥ï¼šä½ ä½œä¸ºä¸€ä¸ªæˆå¹´äººå›åˆ°ç°åœ¨ã€‚</li>
</ul>
<p>æˆ‘ä¼°è®¡è¿™ä¸ªæ–¹æ³•æ˜¯å¸®åŠ©é‚£äº›æ·±å—ä¼¤å®³çš„å…±æƒ…è€…è§£å‹çš„æ–¹æ³•ï¼Œä¹¦ä¸­çš„ä½œè€…ä»¥è‡ªå·±ä¸ºæ¡ˆä¾‹ï¼ŒèŠ±äº† 40 å¤©å’Œè¿‡å»çš„è‡ªå·±å’Œè§£ã€‚</p>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><ul>
<li>é«˜å…±æƒ…è€…å®¹æ˜“æˆä¸ºç²¾ç¥æ§åˆ¶çš„å¯¹è±¡ã€‚</li>
<li>é«˜å…±æƒ…è€…é€šå¸¸åœ¨ç«¥å¹´æœ‰ä¸€äº›ä¸å¹¸ï¼Œä½¿å¾—ä»–ä»¬æ„¿æ„æ”¹å˜å’Œéšè—è‡ªå·±ï¼Œè·å¾—å…³çˆ±ã€‚</li>
<li>ç²¾ç¥æ§åˆ¶è€…é€šè¿‡å»ºç«‹ä¿¡ä»»ã€æ”¾å¤§å…±æƒ…è€…çš„ç¼ºç‚¹æ¥è·å¾—è¿‡åˆ†çš„è¡¥å¿ï¼Œæœ€ç»ˆæ¶ˆè€—å°½å…±æƒ…è€…çš„èº«å¿ƒã€‚</li>
<li>å…±æƒ…è€…éœ€è¦è¯†åˆ«å‡ºç²¾ç¥æ§åˆ¶è€…å¹¶ä¸”é€ƒç¦»è¿™ç§å…³ç³»ï¼Œå¹¶ä¸”é€šè¿‡å„ç§æ–¹å¼ç¼“è§£æƒ…ç»ªï¼Œå¹¶ä¸è‡ªå·±çš„è¿‡å»å’Œè§£ã€‚</li>
</ul>
<p>è¿™å°±æ˜¯ã€Šæƒ…æ„Ÿå¸è¡€é¬¼ã€‹ä¸€ä¹¦çš„å°ç»“ï¼Œæ¨èç»™å¤§å®¶ã€‚</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/07/07/%E5%88%A9%E7%94%A8MySQL%E7%9A%84Binlog%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E4%B8%8E%E8%AE%A2%E9%98%85-%E4%B8%8A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/07/07/%E5%88%A9%E7%94%A8MySQL%E7%9A%84Binlog%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E4%B8%8E%E8%AE%A2%E9%98%85-%E4%B8%8A/" itemprop="url">åˆ©ç”¨ MySQL çš„ Binlog å®ç°æ•°æ®åŒæ­¥ä¸è®¢é˜…(ä¸Š)ï¼šåŸºç¡€ç¯‡</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-07T09:23:59+08:00">
                2020-07-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8/" itemprop="url" rel="index">
                    <span itemprop="name">æ•°æ®å­˜å‚¨</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <p>ç»ˆäºç­‰åˆ°äº†å‘¨æœ«ï¼Œåœ¨ç»å†äº†ä¸€å‘¨çš„å¿™ç¢Œåï¼Œç»ˆäºå¯ä»¥åˆ©ç”¨ç©ºé—²å†™ç¯‡åšå®¢ã€‚å…¶å®ï¼Œåšä¸»æœ‰ä¸€ç‚¹å›°æƒ‘ï¼Œå›°æƒ‘äºè¿™ä¸ªä¸–ç•Œæ—©å·²â€œå †ç§¯â€èµ·äººç±»éš¾ä»¥æƒ³è±¡çš„â€œå¤§â€æ•°æ®ï¼Œè€Œæˆ‘ä»¬åˆå¥½åƒæ‰§ç€äºå»â€œé€ â€ä¸€ä¸ªåˆä¸€ä¸ªâ€œå·®ä¸å¤šâ€çš„â€œå†…å®¹ç®¡ç†ç³»ç»Ÿâ€ï¼Œä»å‰æˆ‘ä»¬è¯´äº’è”ç½‘çš„ç²¾ç¥æ˜¯å¼€æ”¾å’Œåˆ†äº«ï¼Œå¯ä¸çŸ¥ä»ä»€ä¹ˆæ—¶å€™èµ·ï¼Œæˆ‘ä»¬äº²æ‰‹æ‰“é€ äº†ä¸€ä¸ªåˆä¸€ä¸ªçš„â€œä¿¡æ¯å­¤å²›â€ã€‚è€Œä¸ºäº†æ‰“é€šè¿™äº›â€œå…³èŠ‚â€ï¼Œå°±ä¸å¾—ä¸å»é€ ä¸€å¼ å·¨å¤§æ— æ¯”çš„èœ˜è››ç½‘ï¼Œä½ è¯´è¿™å°±æ˜¯äº’è”ç½‘çš„æœ¬è´¨ï¼Œå¯¹æ­¤æˆ‘è¡¨ç¤ºæ— æ³•åé©³ã€‚æˆ‘æ›´å…³å¿ƒçš„æ˜¯è¿™å…¶ä¸­æœ€è„†å¼±çš„éƒ¨åˆ†ï¼Œå³ï¼šä¸€æ¡æ•°æ®æ€ä¹ˆä» A ç³»ç»Ÿæµè½¬åˆ° B ç³»ç»Ÿã€‚å¯èƒ½ä½ ä¼šæƒ³åˆ°<code>API</code>æˆ–è€…<code>ETL</code>è¿™æ ·çš„å…³é”®è¯ï¼Œè€Œæˆ‘ä»Šå¤©æƒ³è¯´çš„å…³é”®è¯åˆ™æ˜¯<code>Binlog</code>ã€‚å‡å¦‚ä½ ç»å¸¸éœ€è¦è®©æ•°æ®è¿‘ä¹å®æ—¶åœ°åœ¨ä¸¤ä¸ªç³»ç»Ÿé—´æµè½¬ï¼Œé‚£ä¹ˆä½ åº”è¯¥åœä¸‹æ¥å¬æˆ‘â€”â€”ä¸€ä¸ªä¸ç”˜å¿ƒæ•´å¤©å†™<code>CRUD</code>æ¢å–<code>996</code>ç¦æŠ¥çš„ç¨‹åºå‘˜ï¼Œè®²è®²å¦‚ä½•é€šè¿‡<code>Binlog</code>å®ç°æ•°æ®åŒæ­¥å’Œè®¢é˜…çš„æ•…äº‹ã€‚</p>
<h1 id="ä»€ä¹ˆæ˜¯-Binlog"><a href="#ä»€ä¹ˆæ˜¯-Binlog" class="headerlink" title="ä»€ä¹ˆæ˜¯ Binlog"></a>ä»€ä¹ˆæ˜¯ Binlog</h1><p>é¦–å…ˆï¼Œæ¥å›ç­”ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä»€ä¹ˆæ˜¯ Binlogï¼ŸBinlog å³ <code>Binary Log</code>ï¼Œæ˜¯ MySQL ä¸­çš„ä¸€ç§äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ã€‚å®ƒå¯ä»¥è®°å½•<code>MySQL</code>å†…éƒ¨å¯¹æ•°æ®åº“çš„æ‰€æœ‰ä¿®æ”¹ï¼Œæ•…ï¼Œè®¾è®¡ Binlog æœ€ä¸»è¦çš„ç›®çš„æ˜¯æ»¡è¶³æ•°æ®åº“ä¸»ä»å¤åˆ¶å’Œå¢é‡æ¢å¤çš„éœ€è¦ã€‚å¯¹äºä¸»ä»å¤åˆ¶ï¼Œæƒ³å¿…å¤§å®¶éƒ½è€³ç†Ÿèƒ½è¯¦å‘¢ï¼Œå› ä¸ºä½†å‡¡æåŠæ•°æ®åº“æ€§èƒ½ä¼˜åŒ–ï¼Œå¤§å®¶é¦–å…ˆæƒ³åˆ°çš„æ‰€è°“çš„â€œè¯»å†™åˆ†ç¦»â€ï¼Œè€Œæ— è®ºæ˜¯ç‰©ç†å±‚é¢çš„ä¸€ä¸»å¤šä»ï¼Œè¿˜æ˜¯æ¶æ„å±‚é¢çš„<code>CQRS</code>ï¼Œè¿™èƒŒåæœ€å¤§çš„åŠŸè‡£å½“å±<code>ä¸»ä»å¤åˆ¶</code>ï¼Œè€Œå®ç°ä¸»ä»å¤åˆ¶çš„æ›´åº•å±‚åŸå› ï¼Œåˆ™è¦ä» Binlog è¯´èµ·ã€‚è€Œå¯¹äºæ•°æ®åº“æ¢å¤ï¼Œèº«ä¸ºäº’è”ç½‘ä»ä¸šè€…ï¼Œå¯¹äºåƒ<code>â€œrm -fâ€</code>å’Œ<code>â€œåˆ åº“â€</code>ã€<code>â€œè·‘è·¯â€</code>è¿™äº›æ¢—ï¼Œæ›´æ˜¯å–œé—»ä¹è§ï¼Œæ¯”å¦‚åƒä»Šå¹´çš„ç»¿ç›Ÿåˆ åº“äº‹ä»¶ï¼Œåœ¨æ•°æ®è¢«åˆ é™¤ä»¥åï¼Œå·¥ç¨‹å¸ˆèŠ±äº†å¥½å‡ å¤©æ—¶é—´å»æŠ¢æ•‘æ•°æ®ï¼Œè¿™å…¶ä¸­å°±ç”¨åˆ°äº† Binlogã€‚</p>
<p>å¯èƒ½å¤§å®¶ä¼šå¥½å¥‡ï¼Œä¸ºä»€ä¹ˆ Binlog å¯ä»¥åšåˆ°è¿™äº›äº‹æƒ…ã€‚å…¶å®ï¼Œä» Binlog çš„ä¸‰ç§æ¨¡å¼ä¸Šï¼Œæˆ‘ä»¬å°±å¯ä»¥çª¥å…¶ä¸€äºŒï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š<code>Statement</code>ã€<code>Row</code>ã€<code>Mixed</code>ï¼Œå…¶ä¸­<code>Statement</code>æ¨¡å¼è®°å½•çš„æ˜¯æ‰€æœ‰æ•°æ®åº“æ“ä½œå¯¹åº”çš„ SQL è¯­å¥ï¼Œå¦‚ INSERTã€UPDATE ã€DELETE ç­‰ DML è¯­å¥ï¼ŒCREATE ã€DROP ã€ALTER ç­‰ DDLï¼Œæ‰€ä»¥ï¼Œä»ç†è®ºä¸Šè®²ï¼Œåªè¦æŒ‰é¡ºåºæ‰§è¡Œè¿™äº› SQL è¯­å¥ï¼Œå°±å¯ä»¥å®ç°ä¸åŒæ•°æ®åº“é—´çš„æ•°æ®å¤åˆ¶ã€‚è€Œ<code>Row</code>æ¨¡å¼æ›´å…³å¿ƒæ¯ä¸€è¡Œçš„å˜æ›´ï¼Œè¿™ç§åœ¨å®é™…åº”ç”¨ä¸­ä¼šæ›´æ™®éä¸€ç‚¹ï¼Œå› ä¸ºæœ‰æ—¶å€™æ›´å…³å¿ƒæ•°æ®çš„å˜åŒ–æƒ…å†µï¼Œä¾‹å¦‚ä¸€ä¸ªè®¢å•è¢«åˆ›å»ºå‡ºæ¥ï¼Œå¸æœºé€šè¿‡ App æ¥æ”¶äº†æŸä¸ªè¿è¾“ä»»åŠ¡ç­‰ã€‚è€Œ<code>Mixed</code>æ¨¡å¼å¯ä»¥è®¤ä¸ºæ˜¯<code>Statement</code>æ¨¡å¼å’Œ<code>Row</code>æ¨¡å¼çš„æ··åˆä½“ï¼Œå› ä¸º<code>Statement</code>æ¨¡å¼å’Œ<code>Row</code>æ¨¡å¼éƒ½æœ‰å„è‡ªçš„ä¸è¶³ï¼Œå‰è€…å¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ï¼Œè€Œåè€…åˆ™ä¼šå ç”¨å¤§é‡çš„å­˜å‚¨ç©ºé—´ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šå€ŸåŠ©å„ç§å„æ ·çš„å·¥å…·ï¼Œè­¬å¦‚å®˜æ–¹è‡ªå¸¦çš„<code>mysqlbinlog</code>ã€æ”¯æŒ Binlog è§£æçš„<code>StreamSets</code>ç­‰ç­‰ã€‚</p>
<p>å¥½äº†ï¼Œä¸‹é¢æˆ‘ä»¬ç®€å•ä»‹ç»ä¸‹ Binlog ç›¸å…³çš„çŸ¥è¯†ç‚¹ã€‚åœ¨ä½¿ç”¨ Binlog å‰ï¼Œé¦–å…ˆéœ€è¦ç¡®è®¤æ˜¯å¦å¼€å¯äº† Binlogï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW VARIABLES LIKE &#x27;LOG_BIN&#x27;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœå¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ç»“æœï¼Œåˆ™è¡¨ç¤º Binlog åŠŸèƒ½å·²å¼€å¯ã€‚<br><img src="https://i.loli.net/2020/07/19/IRX3DzsPkG1MgnW.png" alt="Binlogå·²å¼€å¯ç¤ºæ„å›¾"><br>å¦‚æœ Binlog æ²¡æœ‰å¼€å¯æ€ä¹ˆåŠå‘¢ï¼Ÿæ­¤æ—¶ï¼Œå°±éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ¥å¼€å¯ï¼Œä¸ºæ­¤æˆ‘ä»¬éœ€è¦ä¿®æ”¹ MySQL çš„<code>my.conf</code>æ–‡ä»¶ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œè¯¥æ–‡ä»¶ä½äº<code>/etc/my.cnf</code>è·¯å¾„ï¼Œåœ¨<code>[mysqld]</code>ä¸‹å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®Binlogå­˜å‚¨ç›®å½•</span></span><br><span class="line">log_bin                      =    /var/lib/mysql/bin-log</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®Binlogç´¢å¼•å­˜å‚¨ç›®å½•</span></span><br><span class="line">log_bin_index              =    /var/lib/mysql/mysql-bin.index</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤7å¤©å‰çš„Binlog</span></span><br><span class="line">expire_logs_days          = 7</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é›†ç¾¤å†…MySQLæœåŠ¡å™¨çš„ID</span></span><br><span class="line">server_id                 = 0002</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®Binlogæ—¥å¿—æ¨¡å¼</span></span><br><span class="line">binlog_format              = ROW</span><br></pre></td></tr></table></figure>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è®¾ç½®ä¸‹é¢è¿™äº›é€‰é¡¹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®Binlogæ–‡ä»¶æœ€å¤§çš„å¤§å°</span></span><br><span class="line">max_binlog_size</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®å½“å‰å¤šå°‘ä¸ªäº‹åŠ¡ç¼“å­˜åœ¨å†…å­˜ä¸­</span></span><br><span class="line">binlog_cache_size</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®å½“å‰å¤šå°‘ä¸ªäº‹åŠ¡æš‚å­˜åœ¨ç£ç›˜ä¸Š</span></span><br><span class="line">binlog_cache_disk_use</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®æœ€å¤§æœ‰å¤šå°‘ä¸ªäº‹åŠ¡ç¼“å­˜åœ¨å†…å­˜ä¸­</span></span><br><span class="line">max_binlog_cache_size</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®é€‰å–æˆ–è€…å¿½ç•¥çš„æ•°æ®åº“</span></span><br><span class="line">binlog_do_db/binlog_ingore_db</span><br></pre></td></tr></table></figure>
<p>è®¾ç½®å®Œä»¥åï¼Œé€šè¿‡ä¸‹é¢çš„å‘½ä»¤é‡å¯ MySQL å³å¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysql restart</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysqld restart</span><br></pre></td></tr></table></figure>
<p>é€šå¸¸ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥è·å– Binlog çš„å½“å‰çŠ¶æ€ï¼Œè¯·æ³¨æ„ï¼Œ<strong>è¯¥å‘½ä»¤å¿…é¡»è¦åœ¨ä¸»åº“ä¸Šæ‰§è¡Œ</strong>ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW MASTER STATUS</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸‹é¢çš„ç»“æœï¼š<br><img src="https://i.loli.net/2020/07/19/Xc4B7KZltr9MjAP.png" alt="æŸ¥çœ‹BinlogçŠ¶æ€"><br>è¿™é‡Œå¯ä»¥å¾—åˆ°ä¸‰ä¸ªé‡è¦çš„ä¿¡æ¯ï¼Œå³ä»æ—¥å¿—æ–‡ä»¶<code>mysql-bin.000388</code>çš„ç‰¹å®šä½ç½®<code>135586062</code>å¼€å§‹ï¼Œå¯ä»¥è·å¾—ä¸€ç»„æ–°çš„æ—¥å¿—ä¿¡æ¯ï¼Œè€Œè¿™äº›æ—¥å¿—ä¿¡æ¯éƒ½æ˜¯æ¥è‡ªæ•°æ®åº“å®ä¾‹<code>b1328d03-0b5c-11ea-8ee8-005056a1616f:1-27768340</code>ã€‚æœ‰äº†è¿™ä¸‰ä¸ªä¿¡æ¯ä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥å»æŸ¥çœ‹å¯¹åº”çš„ BinLogï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ°ä¸‹é¢çš„å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW BINLOG EVENTS IN &#x27;MYSQL-BIN.000388&#x27; FROM 135586062</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶ï¼ŒROW æ¨¡å¼ä¸‹çš„ Binlog å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://i.loli.net/2020/07/19/YFAb8POCyf4EM3c.png" alt="ROWæ¨¡å¼ä¸‹çš„Binlog"><br>å¯ä»¥æ³¨æ„åˆ°ï¼Œè¿™äº› Binlog ç”±ä¸åŒçš„äº‹ä»¶æ„æˆã€‚å¦‚æœä½ æ˜¯åœ¨ MySQL ç»ˆç«¯ä¸‹è¾“å…¥å‘½ä»¤ï¼Œé‚£ä¹ˆï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨å®˜æ–¹è‡ªå¸¦çš„å·¥å…·<code>mysqlbinlog</code>ï¼Œåšä¸»è¿™é‡Œä½¿ç”¨çš„å¼€æºçš„æ•°æ®åº“å·¥å…·<a target="_blank" rel="noopener" href="https://dbeaver.io/">DBeaver</a>ï¼Œå¦‚æœä½ ç»å¸¸éœ€è¦å’Œä¸åŒçš„æ•°æ®åº“æ‰“äº¤é“ï¼Œè€Œåˆä¸æƒ³æ¯ä¸€ç§æ•°æ®åº“éƒ½å»å®‰è£…ä¸€ä¸ªå®¢æˆ·ç«¯çš„è¯ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªéå¸¸ä¸é”™çš„é€‰æ‹©ã€‚å…³äº Binlog çš„ä½¿ç”¨æˆ‘ä»¬å°±å…ˆæš‚æ—¶è¯´åˆ°è¿™é‡Œï¼Œå› ä¸ºè¿˜æœ‰æ›´é‡è¦çš„äº‹æƒ…è¦åšã€‚</p>
<h1 id="Binlog-æœ‰ä»€ä¹ˆç”¨"><a href="#Binlog-æœ‰ä»€ä¹ˆç”¨" class="headerlink" title="Binlog æœ‰ä»€ä¹ˆç”¨"></a>Binlog æœ‰ä»€ä¹ˆç”¨</h1><h2 id="å®ç°æ•°æ®åº“å®¡è®¡"><a href="#å®ç°æ•°æ®åº“å®¡è®¡" class="headerlink" title="å®ç°æ•°æ®åº“å®¡è®¡"></a>å®ç°æ•°æ®åº“å®¡è®¡</h2><p>ä½ å¯èƒ½è§‰å¾—æˆ‘æ˜çŸ¥æ•…é—®ï¼Œä½ åˆšåˆšä¸æ˜¯è¯´ Binlog ä¸»è¦ç”¨æ¥åšä¸»ä»å¤åˆ¶å’Œå¢é‡æ¢å¤å—ï¼Ÿè‡ªç„¶ï¼Œè¿™æ˜¯ Binlog åœ¨è®¾è®¡ä¹‹åˆçš„ä¸»è¦ç”¨é€”ã€‚å¯æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œäº‹ç‰©æœ‰æ—¶å€™å¹¶ä¸ä¼šæƒ³ç€æˆ‘ä»¬æœŸå¾…çš„æ–¹å‘å‘å±•ï¼Œè­¬å¦‚åŸå­å¼¹æˆä¸ºæˆ˜äº‰æœºå™¨ã€ç¤¾äº¤è½¯ä»¶æˆä¸ºâ€œçº¦ç‚®ç¥å™¨â€ã€å…±äº«å•è½¦æˆä¸ºâ€œåŸå¸‚åƒåœ¾â€ç­‰ç­‰ã€‚è¿˜è®°å¾—åšä¸»æ›¾ç»å†™è¿‡ä¸€ç¯‡å…³äºæ•°æ®åº“å®¡è®¡çš„[åšå®¢](<a target="_blank" rel="noopener" href="https://blog.yuanpei.me/posts/1289244227/%E5%90%97%EF%BC%9F%E5%BD%93%E6%97%B6%EF%BC%8C%E6%88%91%E4%BB%AC%E6%98%AF%E9%87%8D%E5%86%99%E4%BA%86">https://blog.yuanpei.me/posts/1289244227/å—ï¼Ÿå½“æ—¶ï¼Œæˆ‘ä»¬æ˜¯é‡å†™äº†</a> EF&#x2F;EF Core ä¸­ DbContext çš„ SaveChanges()æ–¹æ³•ï¼Œå¹¶å€ŸåŠ© ChangeTracker å¯¹è·å–å®ä½“ä¿®æ”¹å‰åçš„å€¼ã€‚å…¶å®ï¼Œä»ç°åœ¨çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬æœ‰æ›´å¥½çš„é€‰æ‹©ï¼Œæ¯«æ— ç–‘é—®ï¼ŒRow æ¨¡å¼ä¸‹çš„ Binlog æœ¬èº«å°±æ˜¯å¤©ç„¶çš„æ•°æ®åº“å®¡è®¡ï¼Œæ¯ä¸€è¡Œæ•°æ®å˜åŒ–å‰åçš„æƒ…å†µï¼Œæˆ‘ä»¬éƒ½å¯ä»¥è·å¾—ï¼Œå¹¶ä¸”å¯ä»¥åŒºåˆ†å‡ºå®ƒæ˜¯ Insert ï¼Œè¿˜æ˜¯ Updateï¼Œè¿˜æ˜¯ Deleteï¼Œæ‰€ä»¥ï¼ŒBinlog çš„ç¬¬ä¸€ä¸ªç”¨é€”å°±æ˜¯å¯ä»¥ç”¨æ¥åšæ•°æ®åº“å®¡è®¡ï¼Œå› ä¸ºå®ƒå‘ç”Ÿåœ¨æ•°æ®åº“å±‚ï¼Œä»æŸç§æ„ä¹‰ä¸Šæ¥è®²ï¼Œæ¶ˆè§£äº† EF å’Œ Dapper è¿™ç§ ORM é—´çš„å·®å¼‚ã€‚</p>
<h2 id="å®ç°äº‹ä»¶é©±åŠ¨"><a href="#å®ç°äº‹ä»¶é©±åŠ¨" class="headerlink" title="å®ç°äº‹ä»¶é©±åŠ¨"></a>å®ç°äº‹ä»¶é©±åŠ¨</h2><p>å…¶æ¬¡ï¼Œæˆ‘ä»¬åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œå¸¸å¸¸éœ€è¦ç”¨åˆ°â€<strong>é¢†åŸŸäº‹ä»¶</strong>â€œè¿™ä¸ªæ¦‚å¿µï¼Œå³ä½¿é¡¹ç›®å¹¶æ²¡æœ‰é‡‡ç”¨<strong>é¢†åŸŸé©±åŠ¨è®¾è®¡(DDD)<strong>çš„æ€æƒ³ï¼Œå³ä½¿é¡¹ç›®ä¸­å¹¶æ²¡æœ‰é‡‡ç”¨â€</strong>äº‹ä»¶é©±åŠ¨</strong>â€œçš„ä¸šåŠ¡æ¨¡å¼ï¼Œå¯äº‹å®å°±æ˜¯ï¼Œæ€»æœ‰äººå…³å¿ƒç€æ•°æ®çš„äº§ç”Ÿå’Œå˜æ›´ï¼Œè€Œèƒ½æä¾›ç»™ç¬¬ä¸‰æ–¹ç³»ç»Ÿè®¢é˜…è‡ªå·±æ„Ÿå…´è¶£çš„äº‹ä»¶çš„èƒ½åŠ›ï¼Œæ— ç–‘è¦æ¯”å¼€å‘ä¸€ä¸ªåˆä¸€ä¸ªå¤§åŒå°å¼‚çš„åŒæ­¥æ¥å£è¦å¥½å¾—å¤šï¼Œæ¨(<strong>Push</strong>)æ¨¡å¼åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹è¦æ¯”æ‹‰(<strong>Pull</strong>)æ¨¡å¼è¦å¥½ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæ•°æ®ä¼ è¾“çš„å‹åŠ›æ›´å°ï¼Œæ›´èƒ½æ»¡è¶³æ•°æ®å®æ—¶æ€§çš„è¦æ±‚ã€‚ç„¶è€Œï¼Œç”±äºæ²¡æœ‰æŒ‰ç…§é¢†åŸŸæ¨¡å‹å»è®¾è®¡ä¸šåŠ¡ï¼Œå¯¼è‡´äº‹ä»¶ä»£ç ä¸ä¸šåŠ¡ä»£ç è€¦åˆéå¸¸ä¸¥é‡ï¼ŒåŸºäº Binlog çš„äº‹ä»¶åˆ†å‘æœºåˆ¶æ˜¾ç„¶æœ‰æ›´å¥½çš„æ™®é€‚æ€§ã€‚ä»¥åšä¸»æœ€è¿‘å¤„ç†çš„ä¸šåŠ¡ä¸ºä¾‹ï¼ŒA ç³»ç»Ÿä¸­çš„å¸æœºã€è®¾å¤‡ã€ç”¨æˆ·åœ¨æ–°å»º&#x2F;æ›´æ–°æ›´æ–°æ—¶ï¼Œéœ€è¦æŠŠæ–°æ•°æ®æ¨é€åˆ° B ç³»ç»Ÿï¼Œå› ä¸ºè¿™ç±»çº¯æ•°æ®ç±»çš„â€å˜åŒ–â€æ²¡æœ‰å®é™…ä¸šåŠ¡æ„ä¹‰ï¼Œæ‰€ä»¥ï¼Œäººä»¬ä¸èˆå¾—ä¸ºè¿™äº›å˜åŒ–å»åˆ†å‘äº‹ä»¶ï¼Œè€Œè¦æƒ³åˆ†å‘äº‹ä»¶ï¼Œåˆä¸å¾—ä¸å»é¢å¯¹å¼ºè€¦åˆå¸¦æ¥çš„é˜µç—›ï¼Œæ‰€ä»¥ï¼ŒBinlog çš„ç¬¬äºŒä¸ªç”¨é€”æ˜¯å¯ä»¥ä½œä¸ºäº‹ä»¶æºæ¥å®ç°äº‹ä»¶é©±åŠ¨ã€‚</p>
<h1 id="ä¸šå†…ä¸»æµæ–¹æ¡ˆ"><a href="#ä¸šå†…ä¸»æµæ–¹æ¡ˆ" class="headerlink" title="ä¸šå†…ä¸»æµæ–¹æ¡ˆ"></a>ä¸šå†…ä¸»æµæ–¹æ¡ˆ</h1><p>å¦‚æœä½ è§‰å¾—é€šè¿‡ç¬¬ä¸€èŠ‚çš„å†…å®¹ï¼Œå¯ä»¥éå¸¸å®¹æ˜“åœ°å®ç° Binlog çš„è§£æï¼Œé‚£ä¹ˆï¼Œæˆ‘è§‰å¾—ä½ å¹¶æ²¡æœ‰æƒ³æ¸…æ¥š Binlog å¤„ç†è¿‡ç¨‹ä¸­çš„éš¾ç‚¹åœ¨å“ªé‡Œï¼Ÿé¦–å…ˆï¼Œæ¯æ¬¡è¯»å– Binlogï¼Œå¿…é¡»è¦çŸ¥é“å¯¹åº”çš„æ—¥å¿—æ–‡ä»¶å’Œä½ç½®ï¼Œè€Œå¦‚æœåœ¨æ–°çš„ Binlog äº§ç”Ÿå‰ï¼Œæ²¡æœ‰å¤„ç†å®ŒåŸæ¥çš„ Binlogï¼Œå°±å¿…é¡»è¦è®°å½•å¯¹åº”çš„æ—¥å¿—æ–‡ä»¶å’Œä½ç½®ï¼Œè€Œä¸”ç»è¿‡åšä¸»æœ¬äººæµ‹è¯•ï¼ŒBinlog æ— æ³•ç›´æ¥ç»™æŸ¥è¯¢è¯­å¥è¿½åŠ è¿‡æ»¤æ¡ä»¶ï¼Œæ¥è¾¾åˆ°ç­›é€‰æŸäº›æ•°æ®åº“ã€è¡¨ä»¥åŠäº‹ä»¶çš„ç›®çš„ï¼Œè€Œä¸”æ—¥å¿—æ–‡ä»¶çš„æ ¼å¼ä¼šå› ä¸ºæ¨¡å¼çš„ä¸åŒè€Œä¸åŒï¼Œæœ€ä¸»è¦çš„ä¸€ç‚¹æ˜¯ï¼Œç›´æ¥åœ¨ä¸»åº“ä¸Šè¯»å– Binlog ä¼šç»™æ•°æ®åº“å¸¦æ¥è®¿é—®å‹åŠ›ï¼Œæ‰€ä»¥ï¼Œä¸»æµçš„æ–¹æ¡ˆï¼Œæ˜¯è®©å®¢æˆ·ç«¯ä¼ªè£…æˆâ€œä»åº“â€ï¼Œå…³äºä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥é…åˆä¸‹é¢çš„å›¾ç‰‡æ¥ç†è§£ã€‚<br><img src="https://i.loli.net/2020/07/20/N8A24sEK1RnjBdv.png" alt="MySQLä¸»ä»å¤åˆ¶åŸç†"><br>å¯ä»¥æ³¨æ„åˆ°ï¼Œå®Œæˆä¸»ä»å¤åˆ¶éœ€è¦ä¸€ä¸ª Relaylog + ä¸¤ä¸ªçº¿ç¨‹ï¼Œå³ï¼Œä¸»åº“äº§ç”Ÿçš„ Binlogï¼Œé¦–å…ˆç”±ä»åº“çš„ I&#x2F;O çº¿ç¨‹è¿›è¡Œè¯»å–ï¼Œè¿™ä¸€æ­¥ä¼šäº§ç”Ÿ Relaylogï¼Œé¡¾åæ€ä¹‰ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤„åœ¨ä¸­é—´çŠ¶æ€çš„ä¸­ç»§æ—¥å¿—ï¼Œè€Œä¸­ç»§æ—¥å¿—æœ€ç»ˆä¼šäº¤ç”±ä»åº“çš„ SQL çº¿ç¨‹æ¥å¤„ç†ï¼Œæ‰€ä»¥ï¼Œè¿™æ˜¯ä»åº“æ‰§è¡Œ SQL è¯­å¥çš„é˜¶æ®µï¼Œæ•´ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥åŒ–çš„æ“ä½œï¼Œæ‰€ä»¥ï¼Œä¸ä¼šå¯¹ä¸»åº“äº§ç”Ÿå¤ªå¤§çš„å‹åŠ›ã€‚å¦‚æœæˆ‘ä»¬ç›´æ¥è¯»å–ä¸»åº“çš„ Binlogï¼Œå®é™…ä¸Šæ˜¯æŠŠæ‰€æœ‰å‹åŠ›éƒ½è½¬ç§»åˆ°ä¸»åº“ï¼Œä¸ä»…éœ€è¦è´Ÿè´£â€œè¯»â€ï¼Œè¿˜éœ€è¦å¤æ‚â€œå†™â€ã€‚ä¸»æµçš„æ–¹æ¡ˆï¼Œç›®å‰æ¯”è¾ƒæ¨èçš„æ˜¯é˜¿é‡Œçš„<a target="_blank" rel="noopener" href="https://github.com/alibaba/canal">Canal</a>ã€Zendesk çš„<a target="_blank" rel="noopener" href="http://maxwells-daemon.io/">Maxwell</a>ã€ä»¥åŠæ¥è‡ªç¤¾åŒºçš„<a target="_blank" rel="noopener" href="https://github.com/noplay/python-mysql-replication">Python-Mysql-Replication</a>ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„å¯¹æ¯”ï¼Œæ–¹ä¾¿å¤§å®¶åšæŠ€æœ¯é€‰å‹ã€‚</p>
<table>
<thead>
<tr>
<th></th>
<th>Cancal</th>
<th>Maxwell</th>
<th>Python-Mysql-Rplication</th>
</tr>
</thead>
<tbody><tr>
<td>å¼€æºæ–¹</td>
<td>é˜¿é‡Œå·´å·´</td>
<td>Zendesk</td>
<td>ç¤¾åŒº</td>
</tr>
<tr>
<td>å¼€å‘è¯­è¨€</td>
<td>Java</td>
<td>Java</td>
<td>Python</td>
</tr>
<tr>
<td>æ´»è·ƒåº¦</td>
<td>æ´»è·ƒ</td>
<td>æ´»è·ƒ</td>
<td>æ´»è·ƒ</td>
</tr>
<tr>
<td>é«˜å¯ç”¨</td>
<td>æ”¯æŒ</td>
<td>æ”¯æŒ</td>
<td>ä¸æ”¯æŒ</td>
</tr>
<tr>
<td>å®¢æˆ·ç«¯</td>
<td>Java&#x2F;Go&#x2F;PHP&#x2F;Python&#x2F;Rust</td>
<td>æ— </td>
<td>Python</td>
</tr>
<tr>
<td>æ¶ˆæ¯è½åœ°</td>
<td>Kafka&#x2F;RocketMQ ç­‰</td>
<td>Kafka&#x2F;RabbitNQ&#x2F;Redis ç­‰</td>
<td>è‡ªå®šä¹‰</td>
</tr>
<tr>
<td>æ¶ˆæ¯æ ¼å¼</td>
<td>è‡ªå®šä¹‰</td>
<td>JSON</td>
<td>è‡ªå®šä¹‰</td>
</tr>
<tr>
<td>æ–‡æ¡£è¯¦ç•¥</td>
<td>è¯¦ç»†</td>
<td>è¯¦ç»†</td>
<td>è¯¦ç»†</td>
</tr>
<tr>
<td>Boostrap</td>
<td>ä¸æ”¯æŒ</td>
<td>æ”¯æŒ</td>
<td>ä¸æ”¯æŒ</td>
</tr>
</tbody></table>
<h1 id="è¯´è¯´æˆ‘çš„æ„æƒ³"><a href="#è¯´è¯´æˆ‘çš„æ„æƒ³" class="headerlink" title="è¯´è¯´æˆ‘çš„æ„æƒ³"></a>è¯´è¯´æˆ‘çš„æ„æƒ³</h1><p>ä¼—æ‰€çŸ¥å‘¨ï¼Œæˆ‘æ˜¯ä¸€ä¸ªæœ‰ä¸€ç‚¹â€œæ‡’æƒ°â€çš„äººï¼Œè€ƒè™‘åˆ°å‰é¢ä¸¤ç§æ–¹æ¡ˆéƒ½æ¯”è¾ƒé‡ï¼Œå³ä½¿é€šè¿‡ Docker æ¥å®‰è£…ã€‚å¯¹æˆ‘æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªéªŒè¯æƒ³æ³•çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥ï¼Œæˆ‘é€‰æ‹©çš„æ­é…æ˜¯ RabbitMQ + .NET Core + Python çš„æ–¹æ¡ˆï¼Œå› ä¸º Kafka éœ€è¦ ZooKeeperï¼Œè€Œåœ¨éªŒè¯æƒ³æ³•çš„é˜¶æ®µï¼Œè‡ªç„¶æ˜¯è¶Šç®€å•è¶Šå¥½ã€‚æˆ‘æ­£æ‰“ç®—å‚è€ƒå¾®è½¯çš„ eShopOnContainers çš„é¡¹ç›®ï¼Œ å®ç°ä¸€ä¸ªæ¶ˆæ¯æ€»çº¿(EventBus)ï¼Œæ°å¥½è¿™ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨äº† RabbitMQï¼Œè€Œä¸”ä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼ŒRabbitMQ æ›´æ¥è¿‘ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå®ƒæä¾›çš„é‡è¯•ã€ç¡®è®¤ã€æ­»ä¿¡ç­‰è¿™äº›æœºåˆ¶éƒ½æ¯”è¾ƒå®Œå–„ï¼Œå¯ä»¥è®©æˆ‘æŠŠç²¾åŠ›é›†ä¸­åœ¨å¿«é€Ÿå®ç°ä¸Šï¼Œæ¯•ç«Ÿä½ çœ‹åˆ°è¿™äº›åšå®¢ï¼Œéƒ½æ˜¯æˆ‘æŒ¤å‡ºæ—¶é—´æ¥å®Œæˆçš„ã€‚é€‰æ‹© Python å°±æ›´ç›´æ¥äº†ï¼Œå› ä¸ºå®‰è£…ã€è¿è¡Œéƒ½éå¸¸å®¹æ˜“ï¼Œæˆ–è®¸ Kafka çš„ååæ€§èƒ½æ›´å¥½ï¼Œä½†æˆ‘è§‰å¾—æŒæ¡æ ¸å¿ƒæ€æƒ³æ‰æ˜¯æœ€é‡è¦çš„å§ï¼</p>
<p>æ€»è€Œè¨€ä¹‹ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘é€‰æ‹©äº†è‡ªå·±æœ€ç†Ÿæ‚‰çš„æŠ€æœ¯æ ˆã€‚æ•´ä½“æ€è·¯æ˜¯ï¼Œé¦–å…ˆï¼Œ.NET Core + RabbitMQ å®ç°ä¸€ä¸ªæ¶ˆæ¯æ€»çº¿ï¼Œå¹¶å¯¹å¤–æä¾›å‘å¸ƒäº‹ä»¶çš„ API æ¥å£ã€‚å…¶æ¬¡ï¼Œåˆ©ç”¨ Python-Mysql-Replication å®ç°ä¸€ä¸ªè¯»å– Binlog çš„åå°ç¨‹åºï¼Œè¿™äº› Binlog æœ€ç»ˆä¼šä»¥ JSON çš„å½¢å¼å‘å¸ƒåˆ° RabbitMQ ä¸Šã€‚æœ€åï¼Œå®ç°é’ˆå¯¹ç‰¹å®šäº‹ä»¶çš„ IEventHandler<TEvent>æ¥å£ï¼Œæ¶ˆæ¯æ€»çº¿ä¼šè‡ªåŠ¨è°ƒç”¨è¿™äº› Handler å»å¤„ç†æ¶ˆæ¯ã€‚è‡³æ­¤ï¼Œå°±å®ç°äº†é’ˆå¯¹ Binlog çš„è®¢é˜…å’Œæ¶ˆè´¹ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œæ¶ˆæ¯æ€»çº¿çš„ä¸€å¤§ä¼˜ç‚¹å°±æ˜¯è§£è€¦ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‘†è„±ä»¥å¾€å®šæ—¶è½®è¯¢ + æ‰“æ ‡è®°(Flag)çš„å®¿å‘½è½®å›ï¼Œåªéœ€è¦ç¼–å†™å¯¹åº”çš„ Handler å³å¯ï¼Œå…¶å®æˆ‘è§‰å¾—è¿™æ˜¯ä¸€ç§æ€ç»´ä¸Šçš„è½¬å˜ï¼Œå°±æ˜¯â€ä¸»åŠ¨â€åˆ°â€è¢«åŠ¨â€çš„è½¬å˜ï¼Œå¹¶ä¸æ˜¯è¯´æˆ‘ä»¬å¸®å®¢æˆ·åšå¾—è¶Šå¤šè¶Šå¥½ï¼Œè€Œæ˜¯æˆ‘ä»¬èƒ½è®©å®¢æˆ·æ„è¯†åˆ°å®ƒå¯ä»¥åšå“ªäº›äº‹æƒ…ã€‚åŒæ ·çš„ï¼Œæˆ‘ç»˜åˆ¶äº†ä¸€ä¸ªç®€å•çš„æµç¨‹å›¾æ¥ä½œä¸ºè¯´æ˜ï¼š<br><img src="https://i.loli.net/2020/07/22/5irw4tcNnapVRbD.png" alt="åŸºäºRabbitMQçš„EventBuså®ç°"></p>
<h1 id="æœ¬æ–‡å°ç»“"><a href="#æœ¬æ–‡å°ç»“" class="headerlink" title="æœ¬æ–‡å°ç»“"></a>æœ¬æ–‡å°ç»“</h1><p>å…¶å®ï¼Œé‡å¤çš„å·¥ä½œåšä¹…äº†éƒ½ä¼šæ„Ÿåˆ°åŒçƒ¦çš„ï¼Œæ‰€ä»¥ï¼ŒçœŸæ­£è®©ä½ æ‘†è„±â€œä½“åŠ›åŠ³åŠ¨â€çš„åªèƒ½æ˜¯æ¢ä¸€ç§é«˜åº¦æ¥çœ‹é—®é¢˜ã€‚è¿™å‡ å¹´åš 2B ä¸šåŠ¡ä¸‹æ¥ï¼Œæœ€å¤§çš„ä½“ä¼šæ˜¯ä¼ä¸šçº§è½¯ä»¶æœ€éš¾çš„æ˜¯ï¼Œå¦‚ä½•åœ¨å„ç§ç§ç±»ç¹å¤šçš„è½¯ä»¶ï¼Œè­¬å¦‚ OA ã€é‡‘è¶ã€ç”¨å‹ã€SAP ã€ERP ã€CRM ç­‰ä¸­åšå¥½ä¸€ä¸ªâ€œé…è§’â€ï¼Œæ•°æ®å¦‚æœæ— æ³•åœ¨è¿™å¼ ç½‘ç»œä¸­æµé€šï¼Œåˆ™æ°¸è¿œéƒ½æ˜¯ä¸€æ½­æ­»æ°´ï¼Œè€Œå¦‚æœè¦æ‰“é€šå„ä¸ªç³»ç»Ÿé—´çš„æ•°æ®ï¼Œåˆ™å…ä¸äº†å†™ä¸€ä¸ªåˆä¸€ä¸ªçš„åŒæ­¥æ¥å£ã€‚è¿™ç¯‡åšå®¢ä»¥ MySQL çš„ Binlog ä¸ºåˆ‡å…¥ç‚¹ï¼Œè¯•å›¾é€šè¿‡ Binlog æ¥å®ç°ç‰¹å®šä¸šåŠ¡çš„â€œäº‹ä»¶é©±åŠ¨â€ã€‚Binlog æ˜¯å®ç°ä¸»ä»å¤åˆ¶çš„é‡è¦æœºåˆ¶ï¼Œè€ŒåŸºäºè¿™ä¸€æœºåˆ¶ï¼Œä¸šç•Œæ™®éçš„åšæ³•æ˜¯åˆ©ç”¨ MySQL çš„äº¤æ¢åè®®ï¼Œè®©å®¢æˆ·ç«¯â€ä¼ªè£…â€æˆä¸€ä¸ªä»åº“ï¼Œåœ¨æ¯”è¾ƒäº† Canal ã€Maxwell ä»¥åŠ Python-Mysql-Replication åï¼Œåšä¸»é€‰æ‹©äº†. NET Core  + RabbitMQ + Python çš„æ–¹æ¡ˆï¼Œç›®æ ‡æ˜¯è®© Binlog å¯ä»¥å‘å¸ƒåˆ°æ¶ˆæ¯æ€»çº¿(EventBus)ä¸­ä¾›æ¶ˆè´¹è€…è®¢é˜…å’Œæ¶ˆè´¹ã€‚åœ¨ä¸‹ä¸€ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬è®²ä»‹ç»åŸºäº RabbitMQ å®ç°ä¸€ä¸ªæ¶ˆæ¯æ€»çº¿(EventBus)çš„ç›¸å…³ç»†èŠ‚ï¼Œæ¬¢è¿å¤§å®¶ç»§ç»­å…³æ³¨æˆ‘çš„åšå®¢ï¼Œä»Šå¤©è¿™ç¯‡åšå®¢å°±å…ˆå†™åˆ°è¿™é‡Œï¼Œå¤§å®¶æ™šå®‰ï¼</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/07/05/2020-07-05-hardware-war-book/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/07/05/2020-07-05-hardware-war-book/" itemprop="url">ç¡¬ä»¶åˆ›æ–°çš„æ•…äº‹ä¸é€»è¾‘ - è¯»ã€Šç¡¬æˆ˜ã€‹</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-05T10:12:46+08:00">
                2020-07-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/summary/" itemprop="url" rel="index">
                    <span itemprop="name">summary</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <img src="/images/hardware-book.jpg" class="">

<p>åˆšåˆšçœ‹å®Œä¸€æœ¬æ™ºèƒ½ç¡¬ä»¶çš„ä¹¦ã€Šç¡¬æˆ˜ã€‹ï¼Œä½œè€…æ›¾ç»å°±èŒäºå¤§ç–†ï¼ŒUBTECH å’Œ IBMã€‚è¿™æœ¬ä¹¦ä¸»è¦è®²çš„æ˜¯ç¡¬ä»¶è¡Œä¸šçš„ç«äº‰æ¡ˆä¾‹ï¼Œè¯»èµ·æ¥ç›¸å¯¹è½»æ¾ï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„ä¸€äº›æ„Ÿå—ã€‚</p>
<h2 id="ç¡¬ä»¶äº§å“çš„ç‰¹ç‚¹"><a href="#ç¡¬ä»¶äº§å“çš„ç‰¹ç‚¹" class="headerlink" title="ç¡¬ä»¶äº§å“çš„ç‰¹ç‚¹"></a>ç¡¬ä»¶äº§å“çš„ç‰¹ç‚¹</h2><p>ç¡¬ä»¶äº§å“å’Œè½¯ä»¶äº§å“æœ‰å‡ ä¸ªå¾ˆå¤§çš„åŒºåˆ«ï¼š</p>
<ul>
<li>ã€ç ”å‘å‘¨æœŸã€‘ã€‚ç¡¬ä»¶äº§å“ç ”å‘å‘¨æœŸé•¿ï¼Œæ‹¿å„¿ç«¥ç±»çš„ç©æ•™å…·æ¥è¯´ï¼Œæ–°å“ç ”å‘é€šå¸¸å¾— 6 - 8 ä¸ªæœˆã€‚è€Œè½¯ä»¶çš„ç ”å‘å‘¨æœŸé€šå¸¸ä¹Ÿå°± 3 ä¸ªæœˆä»¥å†…ã€‚</li>
<li>ã€è¿­ä»£å‘¨æœŸã€‘ã€‚ç¡¬ä»¶äº§å“æ¶‰åŠå¼€æ¨¡ï¼Œä¸€ä¸ªæ¨¡å…·é€šå¸¸å¯ä»¥ä½¿ç”¨ 50 ä¸‡æ¬¡ï¼Œå‰æœŸæŠ•å…¥å·¨å¤§ã€‚æ‰€ä»¥ç¡¬ä»¶çš„è¿­ä»£é€šå¸¸ä¸èƒ½å¾ˆå¿«ï¼Œå³ä¾¿ä½ ä¸Šçº¿å°±ç«‹å³è¿­ä»£ï¼Œå› ä¸ºæ¶‰åŠå¼€æ¨¡ï¼Œä¹Ÿå¾—éœ€è¦è‡³å°‘ 3 ä¸ªæœˆå·¦å³ã€‚è€Œè½¯ä»¶çš„è¿­ä»£éƒ½æ˜¯ä»¥å‘¨ä¸ºå•ä½ï¼Œå¿«æ‰‹å°±æ¯å‘¨å‘å¸ƒä¸€ä¸ªç‰ˆæœ¬ã€‚</li>
<li>ã€ç®¡ç†éš¾åº¦ã€‘ã€‚ç¡¬ä»¶äº§å“é€šå¸¸éœ€è¦ä¾èµ–æ–¹æ¡ˆå•†å’Œç»„è£…å‚ã€‚è¿™äº›ä¹™æ–¹çš„é…åˆåº¦æ˜¯éå¸¸å…³é”®çš„ã€‚é”¤å­æ‰‹æœºå½“å¹´é‡äº§éš¾ï¼Œä¸€éƒ¨åˆ†åŸå› å°±æ˜¯è‡ªå·±çš„è®¢å•é‡ä¸å¤Ÿå¤§ï¼Œç»„è£…å‚æ²¡æœ‰å…¨åŠ›é…åˆã€‚è€Œè½¯ä»¶çš„ç ”å‘é€šå¸¸ä¸æ¶‰åŠå¤–éƒ¨åˆä½œï¼Œæ‰€ä»¥ç®¡ç†éš¾åº¦ä¼šå°å¾ˆå¤šã€‚</li>
<li>ã€èµ„é‡‘æŠ•å…¥ã€‘ã€‚ç¡¬ä»¶äº§å“çš„ç ”å‘å‘¨æœŸå¾ˆé•¿ï¼Œèµ„é‡‘æŠ•å…¥å¤§ï¼Œè¿™å°±ä½¿å¾—è¡Œä¸šå†…æ™®éä¸æ„¿æ„åˆ›æ–°ã€‚å› ä¸ºä½ åˆ›æ–°çš„æ—¶é—´å’Œé‡‘é’±æˆæœ¬éƒ½å¤ªé«˜ã€‚äºšé©¬é€Šåš Echo éŸ³ç®±åšäº†å‡ ä»£æ‰åšå¥½ï¼Œå¾®è½¯åš Surface å¤±è´¥äº†ä¸€ä»£ç»§ç»­åšä¸‹ä¸€ä»£ï¼Œè¿™éƒ½éœ€è¦å·¨å¤§çš„å†³ç­–æˆæœ¬ã€‚è½¯ä»¶çš„åˆ›æ–°é€šå¸¸åªéœ€è¦ä¸¤ä¸‰ä¸ªäººå°±å¯ä»¥åš MVP äº†ï¼ŒæŠ•å…¥å°±åªæœ‰å‡ ä¸ªäººçš„å·¥èµ„ã€‚</li>
<li>ã€ä½“éªŒéš¾åº¦ã€‘ã€‚ç¡¬ä»¶å› ä¸ºæ˜¯å®ä½“ï¼Œæ‰€ä»¥å®ƒçš„å”®å–éœ€è¦æ‹¿åˆ°æ‰‹é‡Œçœ‹æ‰èƒ½å¾ˆå¥½åœ°ä½“éªŒã€‚è¿™ä½¿å¾—å¤§éƒ¨åˆ†ç¡¬ä»¶æ˜¯é€šè¿‡ç»é”€å•†å–å‡ºå»çš„ï¼Œå› ä¸ºç»é”€å•†æœ‰çº¿ä¸‹çš„æ¸ é“å¯ä»¥è®©ç”¨æˆ·ä½“éªŒã€‚è½¯ä»¶å¯ä¸ä¸€æ ·ï¼Œè½¯ä»¶ä½ åœ¨æ‰‹æœºä¸Šå‡ ä¹å°±å¯ä»¥ä½“éªŒåˆ°å®Œæ•´çš„æœåŠ¡äº†ã€‚</li>
</ul>
<p>ä»¥ä¸‹æ˜¯æ•´ç†çš„è¡¨æ ¼ï¼š</p>
<table>
<thead>
<tr>
<th>é¡¹ç›®</th>
<th>ç¡¬ä»¶</th>
<th>è½¯ä»¶</th>
</tr>
</thead>
<tbody><tr>
<td>ç ”å‘å‘¨æœŸ</td>
<td>é•¿ã€‚6-8 ä¸ªæœˆ</td>
<td>é•¿ã€‚3ä¸ªæœˆ</td>
</tr>
<tr>
<td>è¿­ä»£å‘¨æœŸ</td>
<td>é•¿ã€‚3-6 ä¸ªæœˆ</td>
<td>çŸ­ã€‚1-2å‘¨</td>
</tr>
<tr>
<td>ç®¡ç†éš¾åº¦</td>
<td>é«˜</td>
<td>ä¸­</td>
</tr>
<tr>
<td>åˆ›æ–°éš¾åº¦</td>
<td>é«˜ã€‚æ—¶é—´å’Œé‡‘é’±æˆæœ¬é«˜ã€‚</td>
<td>ä½ã€‚å¯ä»¥åš MVPã€‚</td>
</tr>
<tr>
<td>ä½“éªŒéš¾åº¦</td>
<td>é«˜</td>
<td>ä½</td>
</tr>
</tbody></table>
<p>ç›¸å¯¹æ¥è¯´ï¼Œå› ä¸ºæ—¶é—´é•¿èµ„é‡‘æŠ•å…¥å¤§ï¼Œç¡¬ä»¶å¦‚æœç§¯ç´¯èµ·è§„æ¨¡æ•ˆåº”å’Œæ—¶é—´çª—å£ï¼Œä¹Ÿèƒ½ç§¯ç´¯èµ·è¶³å¤Ÿçš„å£å’ã€‚</p>
<h2 id="ç¡¬ä»¶çš„è·å®¢"><a href="#ç¡¬ä»¶çš„è·å®¢" class="headerlink" title="ç¡¬ä»¶çš„è·å®¢"></a>ç¡¬ä»¶çš„è·å®¢</h2><p>è½¯ä»¶çš„è·å®¢å¤§å¤šæ˜¯é€šè¿‡çº¿ä¸Šçš„æ–¹å¼ã€‚</p>
<p>ç¡¬ä»¶çš„è·å®¢æ–¹å¼å…¶å®åˆ†ä¸ºçº¿ä¸Šå’Œçº¿ä¸‹ä¸¤ç§ã€‚çº¿ä¸‹è·å®¢æ˜¯å¤§éƒ¨åˆ†ç¡¬ä»¶ä¸»æµçš„æ–¹å¼ï¼Œå³èµ°æ¸ é“å•†ï¼Œé€šè¿‡æ¸ é“æ¥è·å®¢ã€‚ä½†æ˜¯å•†å“éœ€è¦ç»™æ¸ é“å•†ç•™å¤Ÿåˆ©æ¶¦ã€‚çº¿ä¸‹è·å®¢ä¹Ÿå¯ä»¥æ˜¯åƒè‹¹æœè¿™æ ·çš„ç›´è¥åº—ï¼Œä½†æ˜¯é€šå¸¸åªæœ‰å“ç‰Œå¤§åˆ°ä¸€å®šç¨‹åº¦æ‰å¯ä»¥ã€‚</p>
<p>ç¡¬ä»¶çš„çº¿ä¸Šè·å®¢æœ€å¤šçš„ï¼Œå°±æ˜¯é€šè¿‡ç”µå•†å¹³å°äº†ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå› ä¸ºç”¨æˆ·æ— æ³•äº²æ‰‹æ‹¿åˆ°ç¡¬ä»¶ä½“éªŒï¼Œæ‰€ä»¥æ–‡æ¡ˆçš„èƒ½åŠ›ä»¥åŠ PS çš„èƒ½åŠ›å°±å˜å¾—é‡è¦äº†ï¼Œä»·æ ¼ä¹Ÿå˜å¾—å¾ˆé‡è¦ã€‚æ·˜å®ä¸Šå–å¾—å¥½çš„å•†å“ï¼Œéƒ½æ˜¯è´¨é‡ä¸€èˆ¬ï¼Œæ–‡æ¡ˆåšå¾—å¥½ï¼Œå›¾æ‹å¾—å¥½ï¼Œä»·æ ¼ä¹Ÿå¸å¼•äººçš„å•†å“ã€‚</p>
<p>ç›´æ’­å–è´§æ˜¯ç°åœ¨æ¯”è¾ƒç«çš„çº¿ä¸Šé”€å”®æ¨¡å¼ã€‚ç›¸å¯¹æ¥è¯´ï¼Œè¿™ç§æ¨¡å¼æ˜¯èƒ½é¼“åŠ±å¤§å®¶åšä¼˜è´¨å•†å“çš„ï¼Œå› ä¸ºå¸¦è´§çš„å¤§ V éœ€è¦å°†å•†å“å“è´¨ä¸è‡ªå·±çš„äººè®¾æ­é…ï¼Œè´¨é‡ä¸€èˆ¬çš„å•†å“åå€’ä¸é‚£ä¹ˆå—æ¬¢è¿ã€‚å¤§ V æœ€æ¬¢è¿çš„æ˜¯é‚£äº›å“ç‰ŒåŠ›æœ€å¥½çš„ï¼Œä»·æ ¼ç›¸å¯¹å…¬é“å³å¯ã€‚</p>
<p>å°ç±³å½“å¹´çš„è·å®¢ï¼Œç®—æ˜¯ä¸€ä¸ªç‹¬ç‰¹çš„å­˜åœ¨ã€‚å°ç±³æ ¸å¿ƒæ˜¯é äº§å“çš„æ€§ä»·æ¯”ï¼Œé€šè¿‡æ€§ä»·æ¯”æ¥è·å¾—å£ç¢‘ä¼ æ’­ï¼Œé€šè¿‡ä¼ æ’­æ¥è·å®¢ï¼Œè¿™èƒŒåæ˜¯å½“æ—¶å®‰å“æ‰‹æœºç»™å¸‚åœºç•™ä¸‹çš„ 2000 å…ƒä»¥å†…çš„ç©ºé—´ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼ä¸€æ–¹é¢ä¸å¤ªå¯å¤åˆ¶ï¼Œå¦ä¸€æ–¹é¢å¢é•¿ä¹Ÿä¼šæœ‰é—®é¢˜ï¼Œæ‰€ä»¥å°ç±³ç°åœ¨çš„è·å®¢å’Œåä¸ºï¼ŒOppoï¼ŒVivo æ²¡æœ‰å¤ªå¤§çš„å·®åˆ«ã€‚å°ç±³æ— ç–‘æ˜¯æˆåŠŸçš„ï¼Œä½†æ˜¯å°ç±³ä¸Šå¸‚åè‚¡ä»·ä¸€è·¯ä¸‹è·Œï¼Œæœªæ¥çš„ä¼°å€¼åˆ°åº•æ˜¯å¤šå°‘ï¼Œè¿˜è¦å†çœ‹ä¸€æ®µæ—¶é—´ã€‚</p>
<h2 id="æ™ºèƒ½ç¡¬ä»¶è½åœ°éš¾"><a href="#æ™ºèƒ½ç¡¬ä»¶è½åœ°éš¾" class="headerlink" title="æ™ºèƒ½ç¡¬ä»¶è½åœ°éš¾"></a>æ™ºèƒ½ç¡¬ä»¶è½åœ°éš¾</h2><p>äº’è”ç½‘æˆå°±äº† BATï¼Œç§»åŠ¨äº’è”ç½‘æˆå°±äº†ç¾å›¢ç‚¹è¯„ã€æ»´æ»´ã€æ‹¼å¤šå¤šã€‚é‚£ä¹ˆåˆ©ç”¨åˆ›æ–°èƒ½å¦é¢ è¦†ç¡¬ä»¶è¡Œä¸šï¼Œæˆä¸ºæ¯ä¸€ä¸ªåˆ›ä¸šè€…çš„æ¢¦æƒ³ï¼Œè€Œè¿™é‡Œé¢çš„æŠ€æœ¯å˜åŒ–å°±æ˜¯ï¼šAIã€‚</p>
<p>ä½†æ˜¯ï¼Œæ™ºèƒ½ç¡¬ä»¶ä»æ¦‚å¿µåˆ°è½åœ°ï¼Œä»æ¥éƒ½ä¸åƒè½¯ä»¶é‚£ä¹ˆå®¹æ˜“ã€‚å¦‚æœæˆ‘ä»¬çœ‹è¿™äº›å¹´æ™ºèƒ½ç¡¬ä»¶çš„åˆ›æ–°ï¼Œä»æ™ºèƒ½è·¯ç”±å™¨åˆ°æ™ºèƒ½éŸ³ç®±ï¼Œä»é™ªä¼´æœºå™¨äººåˆ°æ™ºèƒ½å®¶ç”µï¼ˆå°ç¯ã€é—¨é”ã€æ‘„åƒå¤´ï¼‰ï¼Œä»æ™ºèƒ½ç©¿æˆ´è®¾å¤‡ï¼ˆè€³æœºã€æ‰‹ç¯ã€VR&#x2F;ARçœ¼é•œã€è¿åŠ¨ç›¸æœºï¼‰åˆ°æ— äººæœºï¼Œç«äº‰å¯ä»¥ç”¨æƒ¨çƒˆæ¥å½¢å®¹ï¼Œä½†æ˜¯çœŸæ­£çš„èµ¢å®¶å´æ²¡æœ‰å‡ ä¸ªã€‚</p>
<h2 id="ä»æ™ºèƒ½è·¯ç”±å™¨åˆ°æ™ºèƒ½éŸ³ç®±"><a href="#ä»æ™ºèƒ½è·¯ç”±å™¨åˆ°æ™ºèƒ½éŸ³ç®±" class="headerlink" title="ä»æ™ºèƒ½è·¯ç”±å™¨åˆ°æ™ºèƒ½éŸ³ç®±"></a>ä»æ™ºèƒ½è·¯ç”±å™¨åˆ°æ™ºèƒ½éŸ³ç®±</h2><p>æ™ºèƒ½è·¯ç”±å™¨ä½œä¸ºç½‘ç»œå¸¦å®½çš„å‡ºå…¥å£ï¼Œæœ¬æ¥æƒ³æˆä¸ºå®¶åº­çš„æ§åˆ¶ä¸­å¿ƒï¼Œä½†æ˜¯æœ€åäººä»¬å‘ç°ï¼Œå…¶å®è¿™ä¸ªè§’è‰²åº”è¯¥æ˜¯æ™ºèƒ½éŸ³ç®±ã€‚</p>
<p>æ™ºèƒ½éŸ³ç®±è¿™ä¸ªè®¾å¤‡æœ¬èº«çš„æŠ€æœ¯éš¾åº¦åˆä¸é«˜ï¼Œè¯­éŸ³è¯†åˆ«æ—¢å¯ä»¥è‡ªå·±å®ç°ï¼Œä¹Ÿå¯ä»¥ç”¨è¿…é£çš„ APIã€‚äºæ˜¯ï¼Œè¿™ä¸ªç”Ÿæ„æ³¨å®šæ˜¯æœ‰å¸ƒå±€æ„è¯†ï¼Œç»å—å¾—ä½äºæŸè¡¥è´´çš„å¤§å‚ã€‚</p>
<p>ç»è¿‡å°çˆ±åŒå­¦ã€å°åº¦åœ¨å®¶ã€å¤©çŒ«ç²¾çµå‡ å®¶è¡¥è´´å¼çš„ç«äº‰ï¼Œæœ€åå°çš„ç©å®¶å…¨éƒ¨è¢«æŒ¤å‡ºå»äº†ã€‚</p>
<p>è€Œå°±ç®—è¿™æ ·ï¼Œæ™ºèƒ½éŸ³ç®±åœ¨å›½å†…çš„åº”ç”¨åœºæ™¯ä¹Ÿä¸ç®—é«˜ï¼Œåªèƒ½æ‹¿æ¥å¬å¬æ–°é—»å’ŒéŸ³ä¹ã€‚å®¶åº­çš„å„ä¸ªè®¾å¤‡è¿˜éœ€è¦å‡ å¹´çš„æ—¶é—´æ‰èƒ½å¤Ÿä¸€ä¸€è¿ä¸Šç½‘å¹¶ä¸”å¼€æ”¾ç»™éŸ³ç®±ã€‚</p>
<p>æˆ‘å®¶çš„å°åº¦åœ¨å®¶å’Œå¤©çŒ«ç²¾çµï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ç”¨æ¥å¬æ­Œå’Œå¬æ•…äº‹ã€‚å°åº¦åœ¨å®¶æˆ‘å¦å¤–é…äº†ä¸€ä¸ªçº¢å¤–é¥æ§å™¨ï¼Œå¯ä»¥é¥æ§ç”µè§†å¼€å…³ã€‚å¼€å…³çª—å¸˜ï¼Ÿæˆ‘å¤ªæ‡’äº†ï¼Œè¿˜æ²¡æœ‰å‹¤å¿«åˆ°ä¸“é—¨ä¸ºäº†è¿™ä¸ªæ›´æ¢çª—å¸˜çš„å¯¼è½¨ã€‚</p>
<h2 id="é™ªä¼´æœºå™¨äººåˆ°æ™ºèƒ½å®¶ç”µ"><a href="#é™ªä¼´æœºå™¨äººåˆ°æ™ºèƒ½å®¶ç”µ" class="headerlink" title="é™ªä¼´æœºå™¨äººåˆ°æ™ºèƒ½å®¶ç”µ"></a>é™ªä¼´æœºå™¨äººåˆ°æ™ºèƒ½å®¶ç”µ</h2><p>AI æœºå™¨äººä»å‚…ç››æˆç«‹<a target="_blank" rel="noopener" href="https://www.ainirobot.com/">çŒæˆ·æ˜Ÿç©º</a>çš„æ—¶å€™å°±è¢«åª’ä½“å’Œè¡Œä¸šå¯†åˆ‡å…³æ³¨ï¼Œä» 2014 å¹´å¼€å§‹æŒç»­ç«çˆ†åˆ° 2017 å¹´ã€‚</p>
<img src="/images/hardware-robot.jpg" class="">

<p>åæ¥äººä»¬å‘ç°ï¼Œæœºå™¨äººçš„èƒ½åŠ›å…¶å®å¯ä»¥æ‹†è§£æˆï¼š</p>
<ul>
<li>ç§»åŠ¨&#x2F;æ¬è¿</li>
<li>å¯¹è¯</li>
<li>å¸¦å±</li>
</ul>
<p>åœ¨ C ç«¯åœºæ™¯ä¸‹ï¼Œé™¤äº†æ‰«åœ°æœºå™¨äººï¼Œæ²¡æœ‰å“ªä¸ªå®¶åº­éœ€è¦ä¸€ä¸ªæ²¡äº‹è·‘æ¥è·‘å»çš„å¯ä»¥å¯¹è¯&#x2F;å¸¦å±çš„æœºå™¨ï¼Œå¦‚æœè¿™ä¸ªæœºå™¨ä¸è·‘æ¥è·‘å»ï¼Œé‚£ä¹ˆå®ƒå…¶å®åº”è¯¥æ˜¯ä¸ªæ™ºèƒ½éŸ³ç®±ã€‚</p>
<p>åœ¨æˆ·å¤–åœºæ™¯ä¸‹ï¼Œå•†åœºå¯èƒ½éœ€è¦ä¸€ä¸ªç§»åŠ¨çš„å¼•å¯¼æœºå™¨äººï¼Ÿä½†æ˜¯æˆ‘å‘ç°æ›´å¤šäººå¯¹å®ƒåªæ˜¯å¥½å¥‡ï¼Œå¥½çœ‹å¤§äºå®ç”¨ã€‚å› ä¸ºä½ åˆä¸èƒ½çœŸæ­£çš„ç»™åˆ«äººå¸¦è·¯ï¼Œæ— éè¿˜å°±æ˜¯æä¾›å±å¹•æŸ¥è¯¢æ“ä½œã€‚</p>
<p>é¤é¦†æ–¹é¢ï¼Œé€é¤æœºå™¨äººå¯èƒ½æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„åœºæ™¯ï¼Œå› ä¸ºé¤é¦†æœ‰ç§»åŠ¨é€é¤çš„éœ€æ±‚ã€‚ä½†æ˜¯å°±ç®—åœ¨æµ·åº•æï¼Œæˆ‘å‘ç°è¿™ä¸ªæœºå™¨äººä½¿ç”¨èµ·æ¥ä¹Ÿæœ‰è¯¸å¤šé™åˆ¶ï¼Œæ›´å¤šåªæ˜¯ä¸€ç§å°è¯•ã€‚</p>
<img src="/images/hardware-haidilao.jpg" class="">

<p>åœ¨æ•™è‚²åœºæ™¯ä¸‹ï¼Œå¾ˆå¤šäººæŠŠæ™ºèƒ½éŸ³ç®±å˜ä¸ªæœºå™¨äººçš„äººå½¢å¤–è§‚ï¼Œå°±å½“ä½œæ•™è‚²æœºå™¨äººæ¥å–ï¼Œè¯´ä»€ä¹ˆæƒ…æ„Ÿé™ªä¼´ï¼Œæ™ºèƒ½å¯¹è¯ã€‚è¦æ‰“ç ´è¿™ä¸ªè°è¨€ï¼Œåªéœ€è¦é—®æœºå™¨äººä¸¤å¥è¯å°±å¯ä»¥ï¼š</p>
<ul>
<li>ç¬¬ä¸€å¥ï¼šâ€œæœ›äº¬åœ¨å“ªå„¿ï¼Ÿâ€</li>
<li>ç¬¬äºŒå¥ï¼šâ€œæ€ä¹ˆè¿‡å»ï¼Ÿâ€</li>
</ul>
<p>è¿˜æ²¡æœ‰æœºå™¨äººèƒ½æå®šä¸Šä¸‹æ–‡è¿™ç§å¯¹äº 3 å²å°å­©æ¥è¯´éƒ½æ˜¯åŸºç¡€çš„å¯¹è¯è¦æ±‚ã€‚</p>
<p>æ™ºèƒ½å®¶ç”µæä¾›çš„èƒ½åŠ›ä¹Ÿè°ˆä¸ä¸Šé¢ è¦†ï¼Œå¤§éƒ¨åˆ†æ—¶å€™å°±æ˜¯æä¾›è“ç‰™å’Œ Wifi çš„è¿æ¥ï¼Œç„¶åæä¾›ä¸€äº› App æˆ–æ¥å£å¯ä»¥è¿œç¨‹æ§åˆ¶å®ƒã€‚æˆ‘æŠŠæˆ‘å®¶çš„å†°ç®±è¿ä¸Šç½‘ä¹‹åå°±åæ‚”äº†ï¼Œå› ä¸ºæˆ‘å®Œå…¨æ²¡å…´è¶£è¿œç¨‹è°ƒå®ƒçš„æ¸©åº¦ï¼Œè¿˜é¢å¤–å ç”¨æˆ‘çš„ä¸€ä¸ªè·¯ç”±å™¨çš„è¿æ¥æ•°ã€‚åæ¥æ¢æ´—è¡£æœºçš„æ—¶å€™æˆ‘å°±å­¦èªæ˜äº†ï¼Œéƒ½æ²¡æœ‰å°è¯•è”ç½‘è¿‡ã€‚</p>
<p>æˆ–è®¸æŠŠç©ºè°ƒè¿ä¸Šæ™ºèƒ½éŸ³ç®±ä¹‹åï¼Œç”¨è¯­éŸ³å¼€å…³ç©ºè°ƒå’Œè°ƒæ¸©åº¦æ˜¯ä¸€ä¸ªéœ€æ±‚ã€‚ä¸è¿‡æˆ‘çš„å°åº¦çº¢å¤–é¥æ§å™¨ç¦»ç©ºè°ƒå¤ªè¿œï¼Œé¥æ§å™¨çš„å­¦ä¹ åŠŸèƒ½ä¹Ÿæœ‰é—®é¢˜ã€‚ä¸ºäº†ç©ºè°ƒä¸“é—¨å†ä¹°ä¸€ä¸ªçº¢å¤–é¥æ§å™¨ï¼Œå¹¶ä¸”æ”¾åˆ°ç¦»ç©ºè°ƒè¿‘çš„åœ°æ–¹è¿˜æ˜¯å¤ªéº»çƒ¦äº†ã€‚æ‰€ä»¥åªèƒ½ç­‰æ¢ç©ºè°ƒçš„æ—¶å€™ï¼Œä¹°ä¸€ä¸ªå¯ä»¥è¿æ¥éŸ³ç®±çš„ç©ºè°ƒäº†ã€‚</p>
<h2 id="æ™ºèƒ½ç©¿æˆ´è®¾å¤‡"><a href="#æ™ºèƒ½ç©¿æˆ´è®¾å¤‡" class="headerlink" title="æ™ºèƒ½ç©¿æˆ´è®¾å¤‡"></a>æ™ºèƒ½ç©¿æˆ´è®¾å¤‡</h2><p>å¤§å®¶å¯¹ç©¿æˆ´è®¾å¤‡å…´è¶£ç‰¹åˆ«é«˜ï¼Œä½†æœ€ç»ˆè½åœ°çš„ï¼Œç°åœ¨åªæœ‰æ‰‹ç¯ã€‚æˆ‘è‡ªå·±ä¹°äº†ç¬¬äºŒä»£çš„ Apple Watchï¼ŒFitbit Forceï¼Œå°ç±³å’Œåä¸ºçš„å„ç§æ‰‹ç¯ï¼Œç°åœ¨ç”¨çš„æ˜¯åä¸ºçš„æ‰‹ç¯ï¼Œåªæ˜¯å› ä¸ºå®ƒåœ¨æ¸¸æ³³çš„æ—¶å€™è®¡åœˆç›¸å¯¹å‡†ä¸€ç‚¹ç‚¹ã€‚</p>
<p>å¤§éƒ¨åˆ†æ—¶å€™ï¼Œæˆ‘åªæ˜¯ç”¨æ‰‹ç¯æ¥çœ‹æ—¶é—´å’Œè®¾ç½®å®šæ—¶å™¨ã€‚å¦‚æœåªæ˜¯è¿™äº›çš„è¯ï¼Œéšä¾¿å“ªå®¶çš„æ‰‹ç¯éƒ½å¯ä»¥ç”¨ã€‚</p>
<p>NFC æ”¯ä»˜åŠŸèƒ½åœ¨æ‰‹æœºä¸Šå…¶å®ä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ï¼Œå› ä¸ºä½ å¯èƒ½å¿˜å¸¦æ‰‹ç¯ï¼Œä½†æ˜¯ä½ ç»ä¸ä¼šå¿˜å¸¦æ‰‹æœºã€‚ä¸ç„¶ä½ è¿å„ç§æ¥¼éƒ½è¿›ä¸å»ï¼ˆå› ä¸ºè¦å‡ºç¤ºå¥åº·å®ï¼‰ã€‚</p>
<p>å½“å‰æ‰‹ç¯çš„ä»·æ ¼ä¹Ÿå¾ˆéš¾è¯´æœ‰å¾ˆå¤§çš„åˆ©æ¶¦ï¼Œæœ€ç»ˆçš„ç©å®¶ä¼°è®¡ä¹Ÿå°±åªæœ‰æ‰‹æœºå‚å®¶äº†ã€‚æŠŠæ‰‹ç¯ä½œä¸ºæ‰‹æœºçš„ç”Ÿæ€ç¡¬ä»¶ä¸­çš„ä¸€ç¯ï¼Œä»¥è¾¾æˆæ›´å¥½çš„ä½“éªŒã€‚æˆ‘çš„åä¸ºæ‰‹ç¯è¿˜æœ‰ä¸€ä¸ªé‡è¦åŠŸèƒ½å°±æ˜¯â€œæ‰¾æ‰‹æœºâ€ï¼ŒåŸºæœ¬ä¸Šæ¯ä¸¤å¤©å°±è¦ç”¨ä¸€æ¬¡ã€‚</p>
<h2 id="æ— äººæœº"><a href="#æ— äººæœº" class="headerlink" title="æ— äººæœº"></a>æ— äººæœº</h2><p>æ— äººæœºæ˜¯ä¸€ä¸ªéå¸¸å€¼å¾—èŠçš„è¯é¢˜ã€‚æˆ‘ä»¬åˆšåˆšçœ‹åˆ°çš„å°‘æœ‰çš„å‡ ä¸ªæˆåŠŸçš„ç¡¬ä»¶äº§å“ï¼šæ™ºèƒ½éŸ³ç®±ã€æ‰‹ç¯éƒ½æ˜¯è¢«å¤§å‚æŠ¢äº†ç”Ÿæ„ã€‚æ”¾åœ¨æ— äººæœºé¢†åŸŸï¼Œå½“ç„¶å¤§ç–†çš„ç«äº‰è€…å¹¶ä¸å°‘ã€‚ä¸€æ–¹é¢æ˜¯å›½å†…çš„å°ç±³ç­‰å¤§å‚ï¼Œå¦ä¸€æ–¹é¢æ˜¯å›½å¤–åƒ GoPro è¿™ç§åœ¨ç›¸æœºé¢†åŸŸæ‹¥æœ‰ä¼˜åŠ¿çš„å…¬å¸ã€‚æœ€ç»ˆå¤§ç–†æ˜¯å¦‚ä½•èƒœå‡ºçš„å‘¢ï¼Ÿ</p>
<p>åˆšåˆšæˆ‘ä»¬æåˆ°ï¼Œåƒæ™ºèƒ½éŸ³ç®±ã€æ‰‹ç¯ç›¸å¯¹æ ¸å¿ƒç«äº‰åŠ›ä¸å¼ºï¼Œåœ¨å½“æ—¶çš„æŠ€æœ¯ä¸‹ï¼Œå¤§å®¶çš„æŠ€æœ¯å£å’éƒ½ä¸é«˜ï¼Œåœ¨èƒ½åŠ›ç›¸ä¼¼çš„æƒ…å†µä¸‹ï¼Œæœ€ç»ˆèµ¢å®¶æ˜¯é ä»·æ ¼å’Œè¡¥è´´å®Œæˆäº†ç«äº‰ã€‚</p>
<p>æ— äººæœºä¹‹æ‰€ä»¥ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° 2016 å¹´å·¦å³ GoPro å’Œå¤§ç–†ç›´æ¥ç«äº‰çš„æ—¶å€™ï¼Œä»–ä»¬åŒè´¨åŒ–çš„äº§å“æ˜¯ GoPro Karma å’Œ Mavic Proï¼Œæœ€åå› ä¸ºå‰è€…å‡ºç°äº†æå¤§çš„è´¨é‡é—®é¢˜ï¼Œå…¨éƒ¨å¬å›ã€‚ç”±äºæŠ€æœ¯ä¼˜åŠ¿ï¼Œå¸‚åœºç»™äº†å¤§ç–†å®Œå…¨ç©ºç™½çš„ç«äº‰æœŸã€‚åœ¨è¿™æ®µæ—¶æœŸï¼Œå¤§ç–†åˆæŒç»­åœ°ç ”å‘ä½æˆæœ¬çš„æ— äººæœºï¼Œå°† Mavic ç³»åˆ—çš„ä½“ç§¯å’Œä»·æ ¼è¶Šåšè¶Šä½ã€‚å¤§ç–†ç”šè‡³è¿˜æˆç«‹äº†ä¸€å®¶å­å…¬å¸åšäº†ä¸€ä¸ª 799 çš„ Tello æ— äººæœºã€‚</p>
<p>åœ¨æˆ‘çœ‹æ¥ï¼Œå¤§ç–†çš„æ— äººæœºåœ¨æŠ€æœ¯ä¸Šçš„å£å’å·²ç»é¢†å…ˆåŒè¡Œ 2 å¹´å·¦å³ï¼ŒåŒæ—¶æ— äººæœºçš„ç ”å‘æŠ•å…¥å¹¶ä¸ä½ï¼ŒåŠ ä¸Šè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå·¨å¤§çš„æ¶ˆè´¹è€…å¸‚åœºï¼ˆç›¸å¯¹æ‰‹æœºã€æ‰‹ç¯ã€éŸ³ç®±ã€æ±½è½¦æ¥è¯´ï¼‰ï¼Œåˆ«çš„ç¡¬ä»¶å‚å•†æœªå¿…æ„¿æ„æŠ•å…¥é‚£ä¹ˆé•¿çš„æ—¶é—´å’Œé’±æ¥è¿½èµ¶ï¼Œäºæ˜¯å¤§ç–†å°±æˆåŠŸäº†ã€‚</p>
<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><ul>
<li>ç¡¬ä»¶äº§å“ç›¸å¯¹äºè½¯ä»¶äº§å“ï¼Œåœ¨ç ”å‘å‘¨æœŸã€è¿­ä»£å‘¨æœŸã€ç®¡ç†éš¾åº¦ã€èµ„é‡‘æŠ•å…¥ã€ä½“éªŒéš¾åº¦éƒ½è¦éš¾ä¸€äº›ã€‚</li>
<li>æ™ºèƒ½ç¡¬ä»¶å¤§å¤šæ˜¯ä¼ªéœ€æ±‚ã€‚æ™ºèƒ½éŸ³ç®±å½“å‰æˆä¸ºå®¶åº­æ¥å…¥çš„æ¡¥æ¢ï¼Œä½†ç”Ÿæ€è¿˜æœªå®Œå–„ã€‚</li>
<li>åƒå¤§ç–†è¿™æ ·ï¼Œç¡¬ä»¶äº§å“å¦‚æœèƒ½å¤Ÿç§¯ç´¯è¶³å¤Ÿçš„æŠ€æœ¯å£å’ï¼Œé‚£ä¹ˆå¯ä»¥æˆåŠŸã€‚</li>
<li>åƒæ‰‹ç¯ã€éŸ³ç®±è¿™æ ·ï¼Œç¡¬ä»¶äº§å“å’ŒåŒè¡Œæ²¡æœ‰è¶³å¤Ÿçš„å·®å¼‚æ€§ï¼Œé‚£ä¹ˆå°±æ˜¯èµ„æºç«äº‰ï¼Œçœ‹è°çš„èµ„é‡‘å’Œè¡¥è´´èƒ½åŠ›å¼ºï¼ŒèƒŒåæ˜¯é›†å›¢äº§å“çš„æˆ˜ç•¥ååŒç›®æ ‡ã€‚</li>
</ul>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/06/23/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BB%8E%E5%B7%B2%E6%8D%9F%E5%9D%8F%E7%9A%84Git%E4%BB%93%E5%BA%93%E4%B8%AD%E6%89%BE%E5%9B%9E%E4%BB%A3%E7%A0%81%E7%9A%84%E7%BB%8F%E5%8E%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/23/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BB%8E%E5%B7%B2%E6%8D%9F%E5%9D%8F%E7%9A%84Git%E4%BB%93%E5%BA%93%E4%B8%AD%E6%89%BE%E5%9B%9E%E4%BB%A3%E7%A0%81%E7%9A%84%E7%BB%8F%E5%8E%86/" itemprop="url">è®°ä¸€æ¬¡ä»å·²æŸåçš„ Git ä»“åº“ä¸­æ‰¾å›ä»£ç çš„ç»å†</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-23T17:08:17+08:00">
                2020-06-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index">
                    <span itemprop="name">å¼€å‘å·¥å…·</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <p>çªç„¶å‘è§‰ï¼Œå¤äººå…¶å®ç‰¹åˆ«æœ‰è¶£ï¼Œè­¬å¦‚æœ‰å¤è¯­äº‘ï¼šã€å¸¸åœ¨æ²³è¾¹èµ°ï¼Œå“ªæœ‰ä¸æ¹¿é‹ã€ï¼Œå®åœ¨æ˜¯å¯Œæœ‰ç”Ÿæ´»æ°”æ¯çš„ä¸€å¥ä¿—è¯­ï¼Œå¯å¤äººåˆæœ‰è¨€è¯­ï¼šã€å…‰è„šçš„ä¸æ€•ç©¿é‹çš„ã€ï¼Œæ›´æ˜¯æœ´å®æ— åçš„ä¸€å¥è¯ã€‚ä¸Šå‘¨ä¸‹ç­é€‚é€¢å¤©é™å¤§é›¨ï¼Œæˆ‘æ’‘ä¼é€ä¸€ä½åŒäº‹åˆ°åœ°é“ç«™ï¼Œç»“æœèµ°åˆ°åŠè·¯äººå®¶æ¥ä¸€å¥ï¼Œâ€œä½ å¿«ç‚¹èµ°å§ï¼Œæˆ‘ç©¿ç€å‡‰é‹â€ï¼Œä¸€æ—¶ç«Ÿæ— è¯­å‡å™ã€‚å¸¸åœ¨æ²³è¾¹èµ°ï¼Œå›ºç„¶ä¼šæœ‰æ¹¿é‹çš„é¡¾è™‘ï¼Œå¯çœŸæ­£çš„æ°”åº¦ç»ä¸æ˜¯å…‰ç€è„šæ»¡åœ°è·‘ï¼Œå¦‚ä½•åšåˆ°æ¹¿äº†é‹å­è€Œä¸æ…Œå‘¢ï¼Ÿç­”æ¡ˆæ˜¯è„šä¸Šæ— å‡‰é‹è€Œå¿ƒä¸­æœ‰å‡‰é‹ã€‚ä»Šå¤©ï¼Œæˆ‘å°†ä¸ºå¤§å®¶æˆ‘åœ¨ä½¿ç”¨<code>Git</code>è¿‡ç¨‹ä¸­å¦‚ä½•â€œæ¹¿é‹â€ã€å¦‚ä½•ä¸æ€•â€œæ¹¿é‹â€çš„ä¸€ä¸ªæ•…äº‹(é€ƒ</p>
<h1 id="è“å±é‡å¯å-Git-å±…ç„¶åäº†"><a href="#è“å±é‡å¯å-Git-å±…ç„¶åäº†" class="headerlink" title="è“å±é‡å¯å Git å±…ç„¶åäº†"></a>è“å±é‡å¯å Git å±…ç„¶åäº†</h1><p>ä¸­å›½ä¼ ç»Ÿå°è¯´å–œæ¬¢ä»ç¥è¯è®²èµ·ï¼Œç«¯çš„æ˜¯æ±ªæ´‹æ£è‚†ã€çºµæ¨ªæ­é˜–ã€‚è€Œå›½å¤–å°è¯´åˆ™å–œæ¬¢ä»ä¸€ç‰‡å¸¸é’è—¤å¶è¿™ç§ä¸æ˜¾çœ¼çš„äº‹ç‰©å†™èµ·ï¼Œè¶³å¯è§äºŒè€…è§å¤©åœ°ä¼—ç”Ÿè§†è§’ä¹‹ä¸åŒã€‚è€Œæˆ‘è¿™ä¸ªæ•…äº‹ï¼Œæ˜¯å†æ™®é€šä¸è¿‡çš„ä¸€æ¬¡è“å±ã€‚é‡å¯å Visual Studio æç¤ºæ¢å¤äº†æœªä¿å­˜çš„ä»£ç ï¼Œæ­¤æ—¶ï¼Œæˆ‘å¹¶æœªæ³¨æ„åˆ° Git ä»“åº“æŸåçš„æƒ…å†µï¼Œå°±è¿™æ ·ï¼Œæˆ‘åœ¨ä¸€ä¸ªâ€œæ¸¸ç¦»æ€â€çš„ç‰ˆæœ¬ä¸Šç¼–å†™ä»£ç ï¼Œç›´åˆ°æˆ‘æ‰“å¼€ SourceTree çš„æ—¶å€™(ä½œè€…æ³¨ï¼š<strong>æˆ‘å°±æ˜¯é‚£ä¸ªå‘½ä»¤è¡Œå’Œ GUI æ··åˆä½¿ç”¨çš„å¥‡è‘©</strong>)ï¼Œå‘ç°å·¦ä¾§æœ¬åœ°åˆ†æ”¯å…¨éƒ¨æ¶ˆå¤±ï¼Œåœ¨å‘½ä»¤è¡Œé‡Œ<code>git status</code>ï¼Œå‘ç°æ ¹æœ¬æ²¡æœ‰è¿™ä¸ªåˆ†æ”¯ï¼Œè€Œ<code>.git/refs/</code>å¯¹åº”åˆ†æ”¯æŒ‡å‘äº†ä¸€ä¸ªé”™è¯¯çš„ Hashï¼Œæˆ‘æ„è¯†åˆ°æˆ‘çš„ Git ä»“åº“æ–‡ä»¶å¯èƒ½æŸåäº†ï¼Œè¿™æ„å‘³ç€æˆ‘å†™çš„æ–° feature å¯èƒ½ä¸¢å¤±äº†ï¼Œæ­¤æ—¶ï¼ŒGit ä¸­æç¤ºçš„ç±»ä¼¼çš„é”™è¯¯ä¿¡æ¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ error: refs/remotes/origin/HEAD: invalid sha1 pointer 0000000000000000000000000000000000000000</span><br></pre></td></tr></table></figure>
<p>åœ¨æ­¤ä¹‹å‰ï¼Œå…¶å®åšä¸»å·²ç»ç»å†è¿‡ç±»ä¼¼çš„äº‹æƒ…ï¼Œåœ¨æ²¡æœ‰æœªæäº¤çš„ä»£ç çš„æƒ…å†µä¸‹ï¼Œå…¶å®å¯ä»¥æš´åŠ›åˆ é™¤<code>. git</code>ç›®å½•ï¼Œç„¶ååœ¨<code>git init</code>å³å¯ï¼Œè¿™ç›¸å½“äºé‡æ–°åˆå§‹åŒ–ä»“åº“å•¦ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ¬åœ°çš„åˆ†æ”¯ä¼šè¢«åˆ æ‰ï¼Œä½ éœ€è¦é‡æ–°å»ºæ–°åˆ†æ”¯ã€‚å¯æ˜¯è¿™æ¬¡ä¸ä¸€æ ·å•Šï¼Œåœ¨åšçš„æ˜¯ä¸€ä¸ªå³å°†å‘ç‰ˆçš„æ–° featureï¼Œä¸å…è®¸æˆ‘å‡ºè¿™æ ·çš„é€‰æ‹©å•Šï¼åšä¸»åŒæŒåˆä¸€ï¼Œåƒå¤æ´›å…‹ä¸€æ ·å†·é™æ€è€ƒï¼Œç¼“ç¼“åœ°åœ¨å‘½ä»¤è¡Œä¸‹æ•²å‡º<code>git reflog</code>ï¼Œè¿™æ¡å‘½ä»¤ç›¸å½“äºä½ åœ¨ Git ä¸­çš„ç›‘æ§æ—¥å¿—ï¼Œä½ å¯¹ Git æ‰€åšçš„ä¸€åˆ‡éƒ½ä¼šæˆä¸ºå‘ˆå ‚è¯ä¾›ã€‚æ­¤æ—¶ï¼Œä½ ä¼šå¾—åˆ°ä¸‹é¢çš„ä¿¡æ¯â€”â€”æ²‰é»˜æ˜¯ä»Šæ™šçš„åº·æ¡¥â€¦â€¦</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ fatal: You are on a branch yet to be born</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæ„æ€å°±æ˜¯è¿™ä¸ªåˆ†æ”¯è¿˜æ˜¯ä¸€ä¸ªâ€œæ–°ç”Ÿå„¿â€œçš„çŠ¶æ€ï¼Œæ–°ç”Ÿå„¿æ€ä¹ˆå¯èƒ½åˆæ´»åŠ¨è®°å½•å‘¢ï¼Ÿæ‰€ä»¥ï¼Œä½¿ç”¨ Git çš„å‡†åˆ™ä¹‹ä¸€ï¼Œåªè¦ä»“åº“æ²¡æœ‰åï¼Œé€šè¿‡<code>git reflog</code>æ‰¾åˆ°å¯¹åº”çš„ Hash ï¼Œ<code>git checkout</code>å°±å¯ä»¥æ‰¾å›ä»£ç ï¼Œå“ªæ€•ä½ åˆšåˆšæ‰‹æ»‘åˆ é™¤äº†ä¸€ä¸ªæœªæäº¤çš„åˆ†æ”¯ï¼Œè¿™ç§æƒ…å†µä¸‹éƒ½å¯ä»¥æ‰¾å›æ¥ã€‚But ç°åœ¨è¿™ç§çŠ¶å†µä¸‹ï¼Œè¿™æ¡è·¯æ˜¾ç„¶æ˜¯èµ°ä¸é€šå•¦ã€‚ç»§ç»­åŒæŒåˆä¸€ï¼Œåƒå¤æ´›å…‹ä¸€æ ·å†·é™æ€è€ƒï¼Œæ¯ä¸ªåˆ†æ”¯é‡Œå…¶å®æ˜¯è®°å½•ç€ä¸€ä¸ª hash ï¼Œå¯¹åº”ç€æœ€åçš„ä¸€æ¬¡æäº¤ï¼Œç°åœ¨æ˜¯è¿™ä¸ª hash ä¸å¯¹ï¼Œé‚£å°±è¦æ‰¾åˆ°æ­£ç¡®çš„ hash å•Šã€‚å‘½ä»¤è¡Œå·²ç»éå¸¸æ˜ç¡®åœ°å‘Šè¯‰ä½ ï¼Œæ˜¯å› ä¸ºæŸäº› object ä¸¢å¤±æˆ–è€…æŸåäº†ï¼Œé‚£ä¸å¦¨å…ˆç”¨<code>git fsck</code>è¯•è¯•ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ git fsck</span><br><span class="line">notice: HEAD points to an unborn branch (master)</span><br><span class="line">Checking object directories: 100% (256/256), <span class="keyword">done</span>.</span><br><span class="line">Checking objects: 100% (589/589), <span class="keyword">done</span>.</span><br><span class="line">error: refs/remotes/origin/HEAD: invalid sha1 pointer 0000000000000000000000000000000000000000</span><br><span class="line">notice: No default references</span><br><span class="line">dangling tag 92d0fe18f9a55177d955edf58048b49db7987d5b</span><br><span class="line">dangling commit aa7856977e80d11833e97b4151f400a516316179</span><br><span class="line">dangling commit 16e449da82ec8bb51aed56c0c4c05473442db90a</span><br><span class="line">dangling commit 864c345397fcb3bdb902402e17148e19b3f263a8</span><br><span class="line">dangling tag be9471e1263a78fd765d4c72925c0425c90d3d64</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±ä¼šå¾—åˆ°è¿™æ ·çš„ä¿¡æ¯ã€‚æˆ‘å¤©ï¼Œè¿™ç®€ç›´å¤ªè‰¯å¿ƒäº†å¥½å§ï¼Œè¿å“ªä¸€ä¸ª object ä¸¢äº†éƒ½æ˜æ˜ç™½ç™½åœ°å‘Šè¯‰ä½ ã€‚æ—¢ç„¶æ˜¯æç¤ºè§£åŒ…(unpack)çš„æ—¶å€™å¤±è´¥ï¼Œä¸å¦¨å…ˆæ‰‹åŠ¨è§£åŒ…çœ‹çœ‹å‘—ï¼Œå¥½å§ï¼Œæœç„¶ç¨‹åºæ˜¯ä¸ä¼šæ¬ºéª—äººçš„ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘æ³¨æ„åˆ°è¿™äº›é‡Œé¢æœ‰ä¸€äº›æäº¤(commit)ï¼Œæˆ‘åœ¨æƒ³è¿™äº›æœ‰æ²¡æœ‰å¯èƒ½æ˜¯æ®‹ç•™çš„æœ‰æ•ˆåˆ†æ”¯ï¼Œäºæ˜¯ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤åˆ›å»ºä¸´æ—¶åˆ†æ”¯ï¼Œä¸€ç•ªæŠ˜è…¾å‘ç°è¿™äº›åˆ†æ”¯éƒ½ç¦»æˆ‘çš„åˆ†æ”¯æ¯”è¾ƒè¿œï¼Œæ‰€ä»¥ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤äº†ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//å°è¯•æ‰‹åŠ¨è§£åŒ…</span><br><span class="line">$ <span class="built_in">mv</span> .git/objects/pack/pack-0672bd01813664b80248dbe8330bf52da9c02b9f.pack .</span><br><span class="line">$ git unpack-objects -r &lt; pack-0672bd01813664b80248dbe8330bf52da9c02b9f.pack</span><br><span class="line">//ä»æŸä¸ªcommitæ–°å»ºä¸´æ—¶åˆ†æ”¯</span><br><span class="line">$ git update-ref refs/heads/recovery-1 aa7856977e80d11833e97b4151f400a516316179</span><br></pre></td></tr></table></figure>
<p>æˆ‘åˆä¸ç”˜å¿ƒåœ°çœ‹äº†çœ‹<code>git fsck</code>å‘½ä»¤ï¼Œå‘ç°å®ƒå±…ç„¶æœ‰ä¸€ä¸ª<code>--lost-found</code>çš„å‚æ•°å¯ä»¥ç”¨ï¼Œè¿™æ ·å­ï¼Œæˆ‘å±…ç„¶å°±å¾—åˆ°ä¸€ä¸ªåä¸º<code>lost-found</code>çš„æ–‡ä»¶å¤¹ï¼Œå®ƒé‡Œé¢æœ‰ä¸€äº›ä»¥ hash å‘½åçš„æ–‡ä»¶ï¼Œæˆ‘æŒ‘é€‰äº†ä¸€ä¸ªç¦»æˆ‘è“å±æ—¶é—´æœ€è¿‘çš„æ–‡ä»¶ï¼Œç›´æ¥<code>git checkout</code>è¿‡å»ï¼Œå‘ç°è¿™æ­£æ˜¯æˆ‘éœ€è¦çš„å†…å®¹ï¼Œèµ¶ç´§<code>git checkout â€“b</code>å­˜æ¡£ï¼Œè¿™å®åœ¨æ˜¯å¤ªçè´µäº†ï¼</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ git fsck --lost-found</span><br><span class="line">error: inflate: data stream error (unknown compression method)</span><br><span class="line">error: unable to unpack header of .git/objects/67/781ba4991aee01c0bc0d640ae9ee8b674b2f47</span><br><span class="line">error: 67781ba4991aee01c0bc0d640ae9ee8b674b2f47: object corrupt or missing: .git/objects/67/781ba4991aee01c0bc0d640ae9ee8b674b2f47</span><br><span class="line">error: inflate: data stream error (unknown compression method)</span><br><span class="line">error: unable to unpack header of .git/objects/6f/34f2bbde304619622f77f9ca159ed97b6ddafd</span><br><span class="line">error: 6f34f2bbde304619622f77f9ca159ed97b6ddafd: object corrupt or missing: .git/objects/6f/34f2bbde304619622f77f9ca159ed97b6ddafd</span><br><span class="line">error: inflate: data stream error (unknown compression method)</span><br><span class="line">error: unable to unpack header of .git/objects/89/6e969a25c2238ebbb41e895753e82da1cdc7af</span><br><span class="line">error: 896e969a25c2238ebbb41e895753e82da1cdc7af: object corrupt or missing: .git/objects/89/6e969a25c2238ebbb41e895753e82da1cdc7af</span><br><span class="line">error: inflate: data stream error (unknown compression method)</span><br><span class="line">error: unable to unpack header of .git/objects/d8/a180969f6cf8047def4b50c7c920dcd2b6f5cd</span><br><span class="line">error: d8a180969f6cf8047def4b50c7c920dcd2b6f5cd: object corrupt or missing: .git/objects/d8/a180969f6cf8047def4b50c7c920dcd2b6f5cd</span><br></pre></td></tr></table></figure>
<p>å…¶å®ï¼Œæ¥è§¦ Git çš„è¿™äº›å¹´é‡Œï¼Œä½¿ç”¨å‘½ä»¤è¡Œå¹¶æ²¡æœ‰è®©æˆ‘è§‰å¾— Git éš¾ä»¥æ¥è¿‘ï¼Œç›¸åå®ƒè®©æˆ‘å¯¹ GUI ç†è§£æ›´æ·±ä¸€ç‚¹ï¼Œå°±åƒå¥½å¤šäººåˆ†ä¸æ¸…<code>pull</code>å’Œ<code>fetch</code>ï¼Œå› ä¸ºä½ ä¸çœ‹å‘½ä»¤è¡Œçš„è¾“å‡ºå•Šï¼›æœ‰å¥½å¤šäººæ¯æ¬¡ SourceTree ä¸€æŠ¥é”™å°±ä¸çŸ¥é“è¯¥æ€ä¹ˆåŠ ï¼Œå…¶å® Git ç»™çš„æç¤ºçœŸçš„ç›¸å½“æ¸…æ™°äº†ï¼›æˆ‘ä¹‹å‰ä¸€ç›´ä¸çŸ¥é“ä»€ä¹ˆå«<code>cherry-pick</code>ï¼Œåæ¥å‘ç°è¿™ç©æ„å„¿å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„â€œè¡¥ä¸â€ã€‚å¹³æ—¶è¿™ç§é—®é¢˜å¯èƒ½å°±æ”¾è¿‡å»äº†ï¼Œå¯è¿™æ¬¡â€œæ‰¶å¤§å¦äºå°†é¡·â€ï¼Œè®©ä»£ç å¤±è€Œå¤å¾—çš„ç»å†ï¼Œçš„ç¡®ä»¤äººéš¾å¿˜ï¼Œæ‰€ä»¥ï¼Œæˆ‘æ›´æƒ³æŠŠå®ƒå†™ä¸‹æ¥ï¼Œå½“ä½ éƒ½èƒ½çœŸæ­£é©¾é©­å®ƒäº†ï¼Œæ˜¯ç”¨å‘½ä»¤è¡Œè¿˜æ˜¯ç”¨ GUI å°±çœŸçš„ä¸åœ¨é‡è¦å•¦ï¼è¿™æ¬¡çš„ä¸€ä¸ªä¾‹å¤–æ˜¯ç´¢å¼•æ²¡æœ‰åï¼Œå¦‚æœç´¢å¼•åäº†ï¼Œå¯ä»¥è¯•è¯•ä¸‹é¢çš„å‘½ä»¤ï¼š<code>git reset --mixed</code>ã€‚æˆ‘è¿˜æ˜¯åšæŒä¸€ä¸ªè§‚ç‚¹ï¼Œ<strong>Git ä»“åº“åäº†ï¼Œèƒ½ä¿®å¤å°½é‡å»ä¿®å¤ï¼Œä¸åˆ°ä¸‡ä¸å¾—å·²ï¼Œåƒä¸‡ä¸è¦å»åˆ <code>. git</code>ç›®å½•</strong>ã€‚</p>
<h1 id="å„ç§åœºæ™¯ä¸‹çš„-Git-æ¢å¤-æ’¤é”€"><a href="#å„ç§åœºæ™¯ä¸‹çš„-Git-æ¢å¤-æ’¤é”€" class="headerlink" title="å„ç§åœºæ™¯ä¸‹çš„ Git æ¢å¤&#x2F;æ’¤é”€"></a>å„ç§åœºæ™¯ä¸‹çš„ Git æ¢å¤&#x2F;æ’¤é”€</h1><p>åœ¨è¿™ç¯‡æ–‡ç« åˆšå¼€å§‹çš„æ—¶å€™ï¼Œæˆ‘é—®å¤§å®¶ï¼Œå¦‚ä½•åšåˆ°æ¹¿äº†é‹å­è€Œä¸æ…Œå‘¢ï¼Ÿç­”æ¡ˆæ˜¯è„šä¸Šæ— å‡‰é‹è€Œå¿ƒä¸­æœ‰å‡‰é‹ã€‚è™½ç„¶ Git æœ¬èº«æ˜¯ä¸€æ¬¾éå¸¸å¤æ‚çš„è½¯ä»¶ï¼Œå¯æˆ‘ä»¬ä¾ç„¶æœ‰å¾ˆå¤šçš„ç­–ç•¥å»åº”å¯¹å„ç§â€œå¤±è¯¯â€ï¼Œæ­£å¦‚è¿™ç¯‡æ–‡ç«  <a target="_blank" rel="noopener" href="https://git.seveas.net/undoing-all-kinds-of-mistakes.html#undoing-all-kinds-of-mistakes">Undoing all kinds of mistakes</a> æ‰€è¨€ï¼ŒGit æ·±çŸ¥äººç±»éƒ½æ˜¯ä¸å®Œç¾çš„ï¼Œé¢å¯¹å¹³æ—¶ä½¿ç”¨ Git è¿‡ç¨‹ä¸­çš„å„ç§å¤±è¯¯ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨ä¸‹é¢çš„æ€è·¯æ¥è§£å†³ã€‚</p>
<h2 id="æ›´æ”¹æœªæäº¤åˆ°æš‚å­˜åŒº"><a href="#æ›´æ”¹æœªæäº¤åˆ°æš‚å­˜åŒº" class="headerlink" title="æ›´æ”¹æœªæäº¤åˆ°æš‚å­˜åŒº"></a>æ›´æ”¹æœªæäº¤åˆ°æš‚å­˜åŒº</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//æ”¾å¼ƒæ‰€æœ‰æ–‡ä»¶çš„æ›´æ”¹</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git reset --hard</span></span><br><span class="line">//æ”¾å¼ƒæŒ‡å®šæ–‡ä»¶çš„æ›´æ–°</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout -- &lt;path/to/file&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="æ›´æ”¹å·²æäº¤åˆ°æš‚å­˜åŒº"><a href="#æ›´æ”¹å·²æäº¤åˆ°æš‚å­˜åŒº" class="headerlink" title="æ›´æ”¹å·²æäº¤åˆ°æš‚å­˜åŒº"></a>æ›´æ”¹å·²æäº¤åˆ°æš‚å­˜åŒº</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//å›åˆ°æœ€è¿‘çš„ä¸€æ¬¡æäº¤(æ”¹å˜æŒ‡é’ˆ)</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git reset --hard HEAD^</span></span><br><span class="line">//å›åˆ°æŸä¸€æ¬¡æäº¤(æ”¹å˜æŒ‡é’ˆ)</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git reset --hard &lt;commitId&gt;</span></span><br><span class="line">//å…¨éƒ¨æ”¾å¼ƒ=å›åˆ°æœ€è¿‘çš„ä¸€æ¬¡æäº¤(æ”¹å˜æŒ‡é’ˆ)</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git reset --hard å…¨éƒ¨æ”¾å¼ƒ</span></span><br><span class="line">//æ”¾å¼ƒæäº¤æŒ‡å®šæ–‡ä»¶</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git reset HEAD &lt;path/to/file&gt;</span></span><br><span class="line">//ä¿®æ”¹æäº¤ä¿¡æ¯</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git commit --amend</span></span><br></pre></td></tr></table></figure>

<h2 id="æ›´æ”¹å·²æ¨é€åˆ°è¿œç¨‹æœåŠ¡å™¨"><a href="#æ›´æ”¹å·²æ¨é€åˆ°è¿œç¨‹æœåŠ¡å™¨" class="headerlink" title="æ›´æ”¹å·²æ¨é€åˆ°è¿œç¨‹æœåŠ¡å™¨"></a>æ›´æ”¹å·²æ¨é€åˆ°è¿œç¨‹æœåŠ¡å™¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//æ’¤é”€å‰ä¸€æ¬¡æäº¤(äº§ç”Ÿæ–°çš„æäº¤)</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git revert HEAD</span> </span><br><span class="line">//æ’¤é”€å‰å‰ä¸€æ¬¡æäº¤(äº§ç”Ÿæ–°çš„æäº¤) </span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git revert HEAD^</span></span><br><span class="line">//æ’¤é”€æŸä¸€ä¸ªæäº¤(äº§ç”Ÿæ–°çš„æäº¤)</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git revert commit</span>  </span><br></pre></td></tr></table></figure>

<h2 id="ä¸‡èƒ½å…¬å¼"><a href="#ä¸‡èƒ½å…¬å¼" class="headerlink" title="ä¸‡èƒ½å…¬å¼"></a>ä¸‡èƒ½å…¬å¼</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//ä¸‡èƒ½å…¬å¼</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git reflog</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git checkout &lt;commitId&gt;</span></span><br><span class="line">//é€€è€Œæ±‚å…¶æ¬¡</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git fsck --lost-found</span></span><br></pre></td></tr></table></figure>

<p>é™¤äº† SourceTreeï¼Œæˆ‘æƒ³å®‰åˆ©ç¬¬äºŒä¸ª Git GUI å·¥å…·ï¼š<a target="_blank" rel="noopener" href="https://git-fork.com/">Fork</a>ï¼Œå¤§å®¶æ„Ÿå…´è¶£çš„è¯å¯ä»¥å®‰è£…è¯•ç”¨ã€‚</p>
<h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><ul>
<li><a target="_blank" rel="noopener" href="https://git.seveas.net/repairing-and-recovering-broken-git-repositories.html">Repairing and recovering broken git repositories</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/72091550?utm_source=cn.wiz.note&utm_medium=social&utm_oi=53182268964864">Git æ’¤é”€&amp;å›æ»šæ“ä½œ</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.psjay.com/posts/git-revert-merge-commit/">Git æ’¤é”€åˆå¹¶</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/9059335/get-parents-of-a-merge-commit-in-git">How to get the parents of a merge commit in git?</a></li>
</ul>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/06/20/NET-Core%E5%8E%9F%E7%94%9FDI%E6%89%A9%E5%B1%95%E4%B9%8B%E5%B1%9E%E6%80%A7%E6%B3%A8%E5%85%A5%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/20/NET-Core%E5%8E%9F%E7%94%9FDI%E6%89%A9%E5%B1%95%E4%B9%8B%E5%B1%9E%E6%80%A7%E6%B3%A8%E5%85%A5%E5%AE%9E%E7%8E%B0/" itemprop="url">.NET Core åŸç”Ÿ DI æ‰©å±•ä¹‹å±æ€§æ³¨å…¥å®ç°</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-20T13:10:31+08:00">
                2020-06-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" itemprop="url" rel="index">
                    <span itemprop="name">ç¼–ç¨‹è¯­è¨€</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <p>åœ¨ä¸Šä¸€ç¯‡åšå®¢é‡Œï¼Œæˆ‘ä»¬ä¸º<code>.NET Core</code>åŸç”Ÿ DI æ‰©å±•äº†åŸºäºåç§°çš„æ³¨å…¥åŠŸèƒ½ã€‚è€Œä»Šå¤©ï¼Œæˆ‘ä»¬è¦æ¥èŠä¸€èŠå±æ€§æ³¨å…¥ã€‚å…³äºå±æ€§æ³¨å…¥ï¼Œå†æ¥äº‰è®®ä¸æ–­ï¼Œæ”¯æŒæ´¾è®¤ä¸ºï¼Œæ„é€ å‡½æ•°æ³¨å…¥ä¼šè®©æ„é€ å‡½æ•°å˜å¾—å†—ä½™ï¼Œå…¶ç«‹æ„ç‚¹ä¸»è¦åœ¨ä»£ç çš„å¯è¯»æ€§ã€‚è€Œåå¯¹æ´¾åˆ™è®¤ä¸ºï¼Œå±æ€§æ³¨å…¥ä¼šè®©ç»„ä»¶é—´çš„ä¾èµ–å…³ç³»å˜å¾—æ¨¡ç³Šï¼Œå…¶ç«‹æ„ç‚¹ä¸»è¦åœ¨ä»£ç æ˜¯å¦åˆ©äºæµ‹è¯•ã€‚æˆ‘è®¤è¯†çš„ä¸€ä½å‰è¾ˆæ›´æ˜¯ç•™ä¸‹ä¸€å¥è¯ï¼š<strong>åªè¦æ„é€ å‡½æ•°ä¸­è¶…è¿‡ 5 ä¸ªä»¥ä¸Šçš„å‚æ•°ï¼Œæˆ‘å°±è§‰å¾—æ— æ³•å¿å—</strong>ã€‚æˆ‘ä¸ªäººæ˜¯æ”¯æŒæ´¾ï¼Œå› ä¸ºæˆ‘å†™è¿™ç¯‡åšå®¢çš„åŠ¨æœºï¼Œæ­£æ˜¯ä¸€ä½æœ‹å‹å‘æˆ‘åæ§½å…¬å¸é¡¹ç›®ï¼Œè¯´ä¸€ä¸ªæ§åˆ¶å™¨é‡Œå•å•æ˜¯æ„é€ å‡½æ•°é‡Œçš„å‚æ•°å°±æœ‰åæ¥ä¸ªã€‚åœ¨è¿™å…¶ä¸­æœ€å¤§çš„ç—›ç‚¹æ˜¯ï¼Œæœ‰äº›åœ¨æ„é€ å‡½æ•°ä¸­æ³¨å…¥çš„ç±»å‹å…¶å®æ˜¯é‡å¤çš„ï¼Œè­¬å¦‚<code>ILogger&lt;&gt;</code>ã€<code>IMapper</code>ã€<code>IRepository&lt;&gt;</code>ä»¥åŠç”¨æˆ·ä¸Šä¸‹æ–‡ä¿¡æ¯ç­‰ï¼Œè™½ç„¶ç»§æ‰¿å¯ä»¥è®©ç—›è‹¦å‡è½»ä¸€ç‚¹ï¼Œå¯éšä¹‹è€Œæ¥çš„å°±æ˜¯å†—é•¿çš„ base è°ƒç”¨é“¾ã€‚åšä¸»å‚ä¸çš„é¡¹ç›®é‡Œä¸ä¹æœ‰å¤§é‡ä½¿ç”¨é™æ€ç±»ã€é™æ€æ–¹æ³•çš„ï¼Œè­¬å¦‚ LogExã€UserContext ç­‰ç­‰ï¼Œå¯è¿™ç§å®è·µæ˜¾ç„¶ä¸ä¾èµ–æ³¨å…¥çš„æ€æƒ³èƒŒé“è€Œé©°ï¼Œä¸ºå¾æ‰€ä¸å–ä¹Ÿï¼Œè¿™å°±æ˜¯è¿™ç¯‡åšå®¢äº§ç”Ÿçš„èƒŒæ™¯å•¦ï¼</p>
<p>å¥½äº†ï¼Œå½“è§†è§’æ­£å¼åˆ‡å…¥å±æ€§æ³¨å…¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸å¦¨å…ˆæ¥è€ƒè™‘è¿™æ ·ä¸€ä»¶äº‹æƒ…ï¼Œå³ï¼šå½“æˆ‘ä»¬ä»å®¹å™¨é‡Œ Resolve ä¸€ä¸ªç‰¹å®šçš„ç±»å‹çš„æ—¶å€™ï¼Œè¿™ä¸ªå®ä¾‹åˆ°åº•æ˜¯æ€ä¹ˆè¢«åˆ›å»ºå‡ºæ¥çš„å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜å¦‚æœç»™åˆ°ä¸‰å¹´å‰çš„æˆ‘ï¼Œæˆ‘ä¼šä¸å‡æ€ç´¢çš„è¯´å‡ºä¸¤ä¸ªå­—â€”â€”åå°„ã€‚çš„ç¡®ï¼Œè¿™æ˜¯æœ€ç®€å•çš„ä¸€ç§å®ç°æ–¹å¼ï¼Œæ¢å¥è¯è¯´ï¼Œé¦–å…ˆï¼Œå®¹å™¨æ”¶é›†æ„é€ å‡½æ•°ä¸­çš„ç±»å‹ä¿¡æ¯ï¼Œå¹¶æ ¹æ®è¿™äº›ç±»å‹ä¿¡æ¯ Resolve å¯¹åº”çš„å®ä¾‹ï¼›å…¶æ¬¡ï¼Œè¿™äº›å®ä¾‹æœ€ç»ˆä¼šè¢«æ”¾åˆ°ä¸€ä¸ª<code>object[]</code>é‡Œï¼Œå¹¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™<code>Activator.CreateInstance()</code>æ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªä¸€èˆ¬æ„ä¹‰ä¸Šçš„ Ioc å®¹å™¨çš„å·¥ä½œæœºåˆ¶ã€‚é‚£ä¹ˆï¼Œç›¸å¯¹åº”åœ°ï¼Œå…³äºå±æ€§æ³¨å…¥ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºå®¹å™¨ Reslove ä¸€ä¸ªç‰¹å®šç±»å‹çš„æ—¶å€™ï¼Œè¿™ä¸ªç±»å‹æä¾›äº†ä¸€ä¸ªç©ºçš„æ„é€ å‡½æ•°(<strong>è¿™ä¸€ç‚¹éå¸¸é‡è¦</strong>)ï¼Œå†åˆ›å»ºå®Œå®ä¾‹ä»¥åï¼Œå†å» Reslove è¿™ä¸ªç±»å‹ä¸­çš„å­—æ®µæˆ–è€…æ˜¯å±æ€§ã€‚æ‰€ä»¥ï¼Œä¸ºäº†åœ¨å¾®è½¯è‡ªå¸¦çš„ DI ä¸Šå®ç°å±æ€§æ³¨å…¥ï¼Œæˆ‘ä»¬å°±å¿…é¡»å®ç°è‡ªå·±çš„ ServiceProviderâ€”â€”AutowiredServiceProviderï¼Œè¿™ä¸ª ServiceProvider ç›¸æ¯”é»˜è®¤çš„ ServiceProvider å¤šäº†ä¸€éƒ¨åˆ†åŠŸèƒ½ï¼Œå³åå°„å±æ€§æˆ–è€…å­—æ®µçš„è¿‡ç¨‹ã€‚ä¸€æ—¦æƒ³é€šè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘è£…é¥°å™¨æ¨¡å¼ã€‚</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AutowiredServiceProvider</span> : <span class="title">IServiceProvider</span>, <span class="title">ISupportRequiredService</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IServiceProvider _serviceProvider;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AutowiredServiceProvider</span> (<span class="params">IServiceProvider serviceProvider</span>)</span> &#123;</span><br><span class="line">        _serviceProvider = serviceProvider;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">object</span> <span class="title">GetRequiredService</span> (<span class="params">Type serviceType</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> GetService (serviceType);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">object</span> <span class="title">GetService</span> (<span class="params">Type serviceType</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> instance = _serviceProvider.GetService (serviceType);</span><br><span class="line">        Autowried (instance);</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">Autowried</span> (<span class="params"><span class="built_in">object</span> instance</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (_serviceProvider == <span class="literal">null</span> || instance == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> flags = BindingFlags.Public | BindingFlags.NonPublic;</span><br><span class="line">        <span class="keyword">var</span> type = instance <span class="keyword">as</span> Type ?? instance.GetType ();</span><br><span class="line">        <span class="keyword">if</span> (instance <span class="keyword">is</span> Type) &#123;</span><br><span class="line">            instance = <span class="literal">null</span>;</span><br><span class="line">            flags |= BindingFlags.Static;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            flags |= BindingFlags.Instance;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Feild</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> field <span class="keyword">in</span> type.GetFields (flags)) &#123;</span><br><span class="line">        <span class="keyword">var</span> autowriedAttr = field.GetCustomAttribute&lt;AutowiredAttribute&gt; ();</span><br><span class="line">            <span class="keyword">if</span> (autowriedAttr != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> dependency = GetService (field.FieldType);</span><br><span class="line">                <span class="keyword">if</span> (dependency != <span class="literal">null</span>)</span><br><span class="line">                    field.SetValue (instance, dependency);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Property</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> property <span class="keyword">in</span> type.GetProperties (flags)) &#123;</span><br><span class="line">            <span class="keyword">var</span> autowriedAttr = property.GetCustomAttribute&lt;AutowiredAttribute&gt; ();</span><br><span class="line">            <span class="keyword">if</span> (autowriedAttr != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> dependency = GetService (property.PropertyType);</span><br><span class="line">                <span class="keyword">if</span> (dependency != <span class="literal">null</span>)</span><br><span class="line">                    property.SetValue (instance, dependency);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è£…é¥°å™¨æ¨¡å¼ï¼Œåˆè¢«ç§°ä¹‹ä¸ºâ€œé™æ€ä»£ç†â€ï¼Œæ˜¯é¢å‘åˆ‡é¢ç¼–ç¨‹(<strong>AOP</strong>)çš„å®ç°æ–¹å¼ä¹‹ä¸€ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œä¸ºé»˜è®¤çš„ ServiceProvider å¢åŠ äº†<code>Autowired()</code>æ–¹æ³•ï¼Œå®ƒä¼šæ‰«ææ‰€æœ‰å«<code>[Autowired]</code>æ ‡ç­¾çš„å­—æ®µæˆ–å±æ€§ï¼Œå¹¶å°è¯•ä»å®¹å™¨ä¸­è·å–å¯¹åº”ç±»å‹çš„å®ä¾‹ã€‚æ‰€ä»¥ï¼Œè¿™åˆè¯´åˆ°äº†åå¯¹å±æ€§æ³¨å…¥ç¬¬äºŒä¸ªç†ç”±ï¼Œå³ï¼šä½¿ç”¨åå°„å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œå°¤å…¶æ˜¯å½“ä¾èµ–é¡¹é—´çš„å¼•ç”¨å…³ç³»å¼‚å¸¸å¤æ‚çš„æ—¶å€™ã€‚å½“ç„¶ï¼Œæ‰€è°“â€œå…µæ¥å°†æŒ¡ï¼Œæ°´æ¥åœŸæ©â€ï¼Œåå°„äº§ç”Ÿæ€§èƒ½æŸå¤±ï¼Œå¯ä»¥è€ƒè™‘ç”¨ Emit æˆ–è€…è¡¨è¾¾ä¹¦æ ‘ä½œæ¥æ›¿ä»£åå°„ï¼Œä¸è¿‡ï¼Œå¾®è½¯è²Œä¼¼åœ¨.NET Core ä¸­é˜‰å‰²äº†ä¸€éƒ¨åˆ† Emit çš„ APIï¼Œè¿™äº›éƒ½æ˜¯ Todo å•¦ä½ æ‡‚å°±å¥½ï¼Œæˆ‘ä»¬ç»§ç»­å¾€ä¸‹è¯´ã€‚æ¥ä¸‹æ¥ï¼Œä¸ºäº†æ›¿æ¢æ‰å¾®è½¯é»˜è®¤çš„ ServiceProviderï¼Œæˆ‘ä»¬è¿˜å¿…é¡»å®ç°è‡ªå·±çš„ ServiceProviderFactoryï¼Œåƒ Autofacã€Unityã€Castle ç­‰å®¹å™¨ï¼Œéƒ½æ˜¯é‡‡ç”¨ç±»ä¼¼çš„åšæ³•æ¥æ”¯æŒ.NET Coreã€‚</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AutowiredServiceProviderFactory</span> : <span class="title">IServiceProviderFactory</span>&lt;<span class="title">IServiceCollection</span>&gt; &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IServiceProvider <span class="title">CreateServiceProvider</span> (<span class="params">IServiceCollection containerBuilder</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> serviceProvider = containerBuilder.BuildServiceProvider ();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AutowiredServiceProvider (serviceProvider);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    IServiceCollection IServiceProviderFactory&lt;IServiceCollection&gt;.CreateBuilder (IServiceCollection services) &#123;</span><br><span class="line">        <span class="keyword">if</span> (services == <span class="literal">null</span>) <span class="keyword">return</span> <span class="keyword">new</span> ServiceCollection ();</span><br><span class="line">        <span class="keyword">return</span> services;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºæˆ‘ä»¬æ˜¯ä»¥å¾®è½¯å†…ç½®çš„ DI ä¸ºåŸºç¡€æ¥è¿›è¡Œæ‰©å±•çš„ï¼Œæ‰€ä»¥ï¼Œåœ¨å®ç°<code>AutowiredServiceProviderFactory</code>çš„æ—¶å€™ï¼Œæä¾›çš„æ³›å‹å‚æ•°ä¾ç„¶æ˜¯<code>IServiceCollection</code>ã€‚å®ƒéœ€è¦å®ç°ä¸¤ä¸ªæ–¹æ³•ï¼š<code>CreateBuilder</code>å’Œ<code>CreateServiceProvider</code>ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬éœ€è¦è¿”å›æˆ‘ä»¬â€œè£…é¥°â€è¿‡çš„ ServiceProviderã€‚æ¥ä¸‹æ¥ï¼Œä¸‡äº‹ä¿±å¤‡ï¼Œåªæ¬ ä¸œé£ï¼Œæˆ‘ä»¬éœ€è¦åœ¨é¡¹ç›®å…¥å£(<strong>Program.cs</strong>)è°ƒç”¨<code>UseServiceProviderFactory()</code>æ–¹æ³•ï¼Œå¦‚æœä½ åœ¨.NET Core ä½¿ç”¨ Autofacï¼Œåº”è¯¥ä¼šå¯¹æ­¤æ„Ÿåˆ°äº²åˆ‡ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IHostBuilder <span class="title">CreateHostBuilder</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span> =&gt;</span><br><span class="line">  Host.CreateDefaultBuilder(args)</span><br><span class="line">    .ConfigureWebHostDefaults(webBuilder =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">      webBuilder.UseStartup&lt;Startup&gt;();</span><br><span class="line">    &#125;)</span><br><span class="line">    .UseServiceProviderFactory(<span class="keyword">new</span> AutowiredServiceProviderFactory());</span><br></pre></td></tr></table></figure>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†å¯¹å¾®è½¯é»˜è®¤çš„ ServiceProvider çš„æ›¿æ¢ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ¥å£ï¼š<code>IFooService</code>å’Œ<code>IBarService</code>ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//IFooService &amp;&amp; FooService</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IFooService</span> &#123;</span><br><span class="line">  <span class="function"><span class="built_in">string</span> <span class="title">Foo</span> ()</span>;</span><br><span class="line">  IBarService Bar &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">FooService</span> : <span class="title">IFooService</span> &#123;</span><br><span class="line">  [<span class="meta">Autowired</span>]</span><br><span class="line">  <span class="keyword">public</span> IBarService Bar &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Foo</span> ()</span> =&gt; <span class="string">&quot;I am Foo&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//IBarService &amp;&amp; BarService</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IBarService</span> &#123;</span><br><span class="line">  <span class="function"><span class="built_in">string</span> <span class="title">Bar</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BarService</span> : <span class="title">IBarService</span> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Bar</span> ()</span> =&gt; <span class="string">&quot;I am Bar&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°<code>FooService</code>ä¾èµ–<code>IBarService</code>ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦ç»™<code>Bar</code>åŠ ä¸Š<code>[Autowired]</code>æ ‡ç­¾å³å¯ï¼Œé£æ ¼ä¸Šå€Ÿé‰´äº†<code>Spring</code>çš„<code>@Autowired</code>ã€‚åªè¦è¿™ä¸¤ä¸ªæ¥å£è¢«æ³¨å…¥åˆ° Ioc å®¹å™¨ä¸­ï¼Œè¿™ä¸ªå±æ€§å°±å¯ä»¥è‡ªåŠ¨è·å¾—ç›¸åº”çš„æœåŠ¡å®ä¾‹ã€‚ä¸€èµ·æ¥çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">services.AddTransient&lt;IFooService,FooService&gt;();</span><br><span class="line">services.AddTransient&lt;IBarService, BarService&gt;();</span><br><span class="line"><span class="keyword">var</span> serviceProvider = <span class="keyword">new</span> AutowiredServiceProvider(services.BuildServiceProvider());</span><br><span class="line"><span class="keyword">var</span> fooService = serviceProvier.GetRequiredService&lt;IFooService&gt;();</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;fooService.Foo()&#125;</span> , <span class="subst">&#123;fooService.Bar.Bar()&#125;</span>&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>å›åˆ°æˆ‘ä»¬ä¸€å¼€å§‹é‡åˆ°çš„é‚£ä¸ªé—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬è®©<code>IFooService</code>å˜æˆ Controller ä¸­çš„ä¸€ä¸ªå±æ€§ï¼Œæ˜¯å¦å°±èƒ½è§£å†³æ„é€ å‡½æ•°å‚æ•°å†—ä½™çš„é—®é¢˜äº†å‘¢ï¼Ÿä¸‹é¢æ˜¯ä¸€æ®µç®€å•çš„ä»£ç ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ApiController</span>]</span><br><span class="line">[<span class="meta">Route(<span class="string">&quot;[controller]&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WeatherForecastController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">  [<span class="meta">Autowired</span>]</span><br><span class="line">  <span class="keyword">public</span> IFooService Foo &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">  [<span class="meta">Autowired</span>]</span><br><span class="line">  <span class="keyword">public</span> ILogger&lt;WeatherForecastController&gt; Logger &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">  [<span class="meta">HttpGet</span>]</span><br><span class="line">  [<span class="meta">Route(<span class="string">&quot;Autowired&quot;</span>)</span>]</span><br><span class="line">  <span class="function"><span class="keyword">public</span> ActionResult <span class="title">GetAutowriedService</span>()</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> Content(<span class="string">$&quot;<span class="subst">&#123;Foo.Foo()&#125;</span> , <span class="subst">&#123;Foo.Bar.Bar()&#125;</span>&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°<code>Foo</code>å±æ€§æç¤ºç©ºå¼•ç”¨é”™è¯¯ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¿™æ˜¯å› ä¸º Controller å¹¶ä¸æ˜¯é€šè¿‡ IoC å®¹å™¨æ¥è´Ÿè´£åˆ›å»ºå’Œé”€æ¯çš„ï¼Œä¸ºäº†å®ç°å±æ€§æ³¨å…¥çš„ç›®çš„ï¼Œæˆ‘ä»¬å°±å¿…é¡»è®© IoC å®¹å™¨æ¥å…¨é¢æ¥ç®¡ Controller çš„åˆ›å»ºå’Œé”€æ¯ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åšä¸¤ä»¶äº‹æƒ…ï¼Œå…¶ä¸€ï¼Œæ³¨å†Œ Controller åˆ° IoC å®¹å™¨ä¸­ï¼›å…¶äºŒï¼Œå®ç°è‡ªå®šä¹‰çš„<code>IControllerActivator</code>ï¼Œå¹¶æ›¿æ¢é»˜è®¤çš„ ControllerActivator:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">services.AddControllers();</span><br><span class="line">services.AddControllersWithViews().AddControllersAsServices();</span><br><span class="line">services.Replace(ServiceDescriptor.Transient&lt;IControllerActivator, AutowiredControllerActivator&gt;());</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼Œ<code>AutowiredControllerActivator</code>å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AutowiredControllerActivator</span> : <span class="title">IControllerActivator</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="built_in">object</span> <span class="title">Create</span>(<span class="params">ControllerContext context</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> (context == <span class="literal">null</span>)</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(ControllerContext));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> controllerType = context.ActionDescriptor.ControllerTypeInfo.AsType();</span><br><span class="line">    <span class="keyword">var</span> serviceProvider = context.HttpContext.RequestServices;</span><br><span class="line">    <span class="keyword">if</span>(!(serviceProvider <span class="keyword">is</span> AutowiredServiceProvider))</span><br><span class="line">      serviceProvider = <span class="keyword">new</span> AutowiredServiceProvider(context.HttpContext.RequestServices);</span><br><span class="line">    <span class="keyword">var</span> controller = serviceProvider.GetRequiredService(controllerType);</span><br><span class="line">    <span class="keyword">return</span> controller;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Release</span>(<span class="params">ControllerContext context, <span class="built_in">object</span> controller</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> (context == <span class="literal">null</span>)</span><br><span class="line">      <span class="function">hrow <span class="keyword">new</span> <span class="title">ArgumentNullException</span>(<span class="params"><span class="keyword">nameof</span>(ControllerContext</span>))</span>;</span><br><span class="line">    <span class="keyword">if</span> (controller == <span class="literal">null</span>)</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(controller));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> disposeable = controller <span class="keyword">as</span> IDisposable;</span><br><span class="line">    <span class="keyword">if</span> (disposeable != <span class="literal">null</span>)</span><br><span class="line">      disposeable.Dispose();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶ï¼Œä¸€åˆ‡éƒ½ä¼šåƒæˆ‘ä»¬æœŸå¾…çš„é‚£æ ·ç¾å¥½ï¼Œè¿”å›æ­£ç¡®çš„ç»“æœã€‚ç›®å‰ï¼Œè¿™ä¸ªæ–¹æ¡ˆæœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œåœ¨é Controller å±‚ä½¿ç”¨çš„æ—¶å€™ï¼Œè¿˜æ˜¯éœ€è¦æ„é€ <code>AutowirdServiceProvider</code>å®ä¾‹ã€‚å…¶å®ï¼Œåœ¨<code>AutowiredControllerActivator</code>é‡ŒåŒæ ·æœ‰è¿™ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä½ å³ä½¿å®ç°<code>IServiceProviderFactory</code>æ¥å£ï¼Œä¾ç„¶æ²¡æœ‰åŠæ³•æ›¿æ¢æ‰é»˜è®¤çš„ ServiceProvider å®ç°ï¼Œåªèƒ½è¯´å®ƒèƒ½è§£å†³ä¸€éƒ¨åˆ†é—®é¢˜ï¼ŒåŒæ—¶åˆå¼•å…¥äº†æ–°çš„é—®é¢˜ï¼Œæœ€ç›´è§‚çš„ä¾‹å­æ˜¯ï¼Œä½ çœ‹åˆ°ä¸€ä¸ªæ¥å£çš„æ—¶å€™ï¼Œä½ å¹¶ä¸èƒ½æ‰¾å…¨æ‰€æœ‰åŠ äº†<code>[Autowired]</code>æ ‡ç­¾çš„ä¾èµ–é¡¹ï¼Œæ‰€ä»¥ï¼Œç›´æ¥é€ æˆäº†ä¾èµ–å…³ç³»æ¨¡ç³Šã€ä¸é€æ˜ã€éš¾ä»¥æµ‹è¯•ç­‰ç­‰çš„ä¸€ç³»åˆ—é—®é¢˜ï¼Œæˆ‘è®¤ä¸ºï¼Œåœ¨ä¸€ä¸ªå¯æ§çš„ã€å°èŒƒå›´å†…ä½¿ç”¨è¿˜æ˜¯å¯ä»¥çš„ã€‚</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2020/06/10/NET-Core%E5%8E%9F%E7%94%9FDI%E6%89%A9%E5%B1%95%E4%B9%8B%E5%9F%BA%E4%BA%8E%E5%90%8D%E7%A7%B0%E7%9A%84%E6%B3%A8%E5%85%A5%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="é€æµå°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/10/NET-Core%E5%8E%9F%E7%94%9FDI%E6%89%A9%E5%B1%95%E4%B9%8B%E5%9F%BA%E4%BA%8E%E5%90%8D%E7%A7%B0%E7%9A%84%E6%B3%A8%E5%85%A5%E5%AE%9E%E7%8E%B0/" itemprop="url">.NET Core åŸç”Ÿ DI æ‰©å±•ä¹‹åŸºäºåç§°çš„æ³¨å…¥å®ç°</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-10T13:08:03+08:00">
                2020-06-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" itemprop="url" rel="index">
                    <span itemprop="name">ç¼–ç¨‹è¯­è¨€</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
        
          
            <p>æ¥è§¦ <code>.NET Core</code> æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œæœ€å¤§çš„æ„Ÿå—æ— å¤–ä¹æ— æ‰€ä¸åœ¨çš„ä¾èµ–æ³¨å…¥ï¼Œä»¥åŠæŠ½è±¡åŒ–ç¨‹åº¦æ›´é«˜çš„å…¨æ–°æ¡†æ¶è®¾è®¡ã€‚æƒ³èµ·ä¸‰å¹´å‰ Peter å¤§ç¥æ‰‹å†™ IoC å®¹å™¨æ—¶çš„æƒŠè‰³ï¼Œæ­¤æ—¶æ­¤åˆ»ï¼Œä¹Ÿè®¸ä¼šæœ‰ä¸ä¸€æ ·çš„ä½“ä¼šã€‚çš„ç¡®ï¼Œé‚£ä¸ªåŸºäºå­—å…¸å®ç°çš„ IoC å®¹å™¨ç›¸å½“â€œç®€é™‹â€ï¼Œå°±åƒ <code>.NET Core</code> é‡Œçš„ä¾èµ–æ³¨å…¥ï¼Œé»˜è®¤(åŸç”Ÿ)éƒ½æ˜¯é‡‡ç”¨æ„é€ å‡½æ•°æ³¨å…¥çš„æ–¹å¼ï¼Œå¯å…¶å®ä»æ•´ä¸ªä¾èµ–æ³¨å…¥çš„ç†è®ºä¸Šè€Œè¨€ï¼Œå±æ€§æ³¨å…¥å’Œæ–¹æ³•æ³¨å…¥çš„æ–¹å¼ï¼ŒåŒæ ·æ˜¯ä¾èµ–æ³¨å…¥çš„å®ç°æ–¹å¼å•Šã€‚æœ€è¿‘ä¸€ä½æœ‹å‹æ‰¾æˆ‘è®¨è®ºï¼Œ<code>.NET Core</code> é‡Œè¯¥å¦‚ä½•å®ç° <code>Autowried</code>ï¼Œè¿™ä½æœ‹å‹æœ¬èº«æ˜¯ Java å‡ºèº«ï¼Œä¸€ç•ªæ”€è°ˆäº†è§£åˆ°åŸæ¥æ˜¯æŒ‡å±æ€§æ³¨å…¥å•Šã€‚æ‰€ä»¥ï¼Œæˆ‘æ‰“ç®—ç”¨ä¸¤ç¯‡åšå®¢æ¥èŠèŠ <code>.NET Core</code> ä¸­çš„åŸç”Ÿ DI çš„æ‰©å±•ï¼Œè€Œä»Šå¤©è¿™ç¯‡ï¼Œåˆ™å•è®²åŸºäºåç§°çš„æ³¨å…¥çš„å®ç°ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://autofac.org/">Autofac</a>æ˜¯ä¸€ä¸ªéå¸¸ä¸é”™çš„ IoC å®¹å™¨ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨å®ƒæ¥æ›¿æ¢å¾®è½¯å†…ç½®çš„ IoC å®¹å™¨ã€‚ä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢ï¼Ÿå…¶å®ï¼Œå¾®è½¯åœ¨å…¶å®˜æ–¹<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-3.1">æ–‡æ¡£</a>ä¸­æ—©å·²ç»™å‡ºäº†è¯´æ˜ï¼Œå³å¾®è½¯å†…ç½®çš„ IoC å®¹å™¨å®é™…ä¸Šæ˜¯ä¸æ”¯æŒä»¥ä¸‹ç‰¹æ€§çš„ï¼š <strong>å±æ€§æ³¨å…¥ã€åŸºäºåç§°çš„æ³¨å…¥ã€å­å®¹å™¨ã€è‡ªå®šä¹‰ç”Ÿå­˜æœŸç®¡ç†ã€å¯¹è¿Ÿç¼“åˆå§‹åŒ–çš„ Func<T> æ”¯æŒã€åŸºäºçº¦å®šçš„æ³¨å†Œ</strong>ã€‚è¿™æ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦æ›¿æ¢å¾®è½¯å†…ç½®çš„ IoC  å®¹å™¨çš„åŸå› ï¼Œé™¤äº† Autofac ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è€ƒè™‘ <code>Unity</code> ã€<code>Castle</code> ç­‰å®¹å™¨ï¼Œå¯¹æˆ‘ä¸ªäººè€Œè¨€ï¼Œå…¶å®æœ€éœ€è¦çš„ä¸€ä¸ªåŠŸèƒ½æ˜¯â€œæ‰«æâ€ï¼Œå³å®ƒå¯ä»¥é’ˆå¯¹ç¨‹åºé›†ä¸­çš„ç»„ä»¶æˆ–è€…æœåŠ¡è¿›è¡Œè‡ªåŠ¨æ³¨å†Œã€‚è¿™ä¸ªåŠŸèƒ½å¯ä»¥è®©äººå†™èµ·ä»£ç æ›´çœå¿ƒä¸€ç‚¹ï¼Œæœç„¶ï¼Œäººç±»çš„æœ¬è´¨å°±æ˜¯è®©è‡ªå·±å˜å¾—æ›´åŠ æ‡’æƒ°å‘¢ã€‚å¥½äº†ï¼Œè¯é¢˜æ‹‰å›åˆ°æœ¬æ–‡ä¸»é¢˜ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦åŸºäºåç§°çš„æ³¨å…¥å‘¢ï¼Ÿå®ƒå…¶å®é’ˆå¯¹çš„æ˜¯â€œ<strong>åŒä¸€ä¸ªæ¥å£å¯¹åº”å¤šç§ä¸åŒçš„å®ç°</strong>â€è¿™ç§åœºæ™¯ã€‚</p>
<p>OK ï¼Œå‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªæ¥å£ ISayHelloï¼Œå®ƒå¯¹å¤–æä¾›ä¸€ä¸ªæ–¹æ³• SayHelloï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ISayHello</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="built_in">string</span> <span class="title">SayHello</span>(<span class="params"><span class="built_in">string</span> receiver</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç›¸å¯¹åº”åœ°ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªå®ç°ç±»ï¼ŒChineseSayHello å’Œ EnglishSayHelloï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ChineseSayHello</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ChineseSayHello</span> : <span class="title">ISayHello</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">SayHello</span>(<span class="params"><span class="built_in">string</span> receiver</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">$&quot;ä½ å¥½ï¼Œ<span class="subst">&#123;receiver&#125;</span>&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//EnglishSayHello</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EnglishSayHello</span> : <span class="title">ISayHello</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">SayHello</span>(<span class="params"><span class="built_in">string</span> receiver</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">$&quot;Helloï¼Œ<span class="subst">&#123;receiver&#125;</span>&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ï¼Œä¸€é¡¿æ“ä½œçŒ›å¦‚è™ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> services = <span class="keyword">new</span> ServiceCollection();</span><br><span class="line">services.AddTransient&lt;ISayHello, ChineseSayHello&gt;();</span><br><span class="line">services.AddTransient&lt;ISayHello, EnglishSayHello&gt;();</span><br><span class="line"><span class="keyword">var</span> serviceProvider = services.BuildServiceProvider();</span><br><span class="line"><span class="keyword">var</span> sayHello = serviceProvider.GetRequiredService&lt;ISayHello&gt;();</span><br></pre></td></tr></table></figure>
<p>æ²¡æƒ³åˆ°ï¼Œå°´å°¬çš„äº‹æƒ…å°±å‘ç”Ÿäº†ï¼Œå¤§å®¶æ¥çŒœçŒœçœ‹ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬è·å–åˆ°çš„<code>ISayHello</code>åˆ°åº•æ˜¯å“ªä¸€ä¸ªå‘¢ï¼Ÿäº‹å®ä¸Šï¼Œå®ƒä¼šè·å–åˆ°<code>EnglishSayHello</code>è¿™ä¸ªå®ç°ç±»ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºå®ƒåæ³¨å†Œçš„å‘€ï¼å½“ç„¶ï¼Œå¾®è½¯çš„å·¥ç¨‹å¸ˆä»¬ä¸å¯èƒ½æƒ³ä¸åˆ°è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥ï¼Œå®˜æ–¹æ¨èçš„åšæ³•æ˜¯ä½¿ç”¨<code>IEnumerable&lt;ISayHello&gt;</code>ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½æ‹¿åˆ°æ‰€æœ‰æ³¨å†Œçš„<code>ISayHello</code>ï¼Œç„¶åè‡ªå·±å†³å®šåˆ°åº•è¦ä½¿ç”¨ä¸€ç§å®ç°ï¼Œç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sayHellos = _serviceProvider.GetRequiredService&lt;IEnumerable&lt;ISayHello&gt;&gt;();</span><br><span class="line"><span class="keyword">var</span> chineseSayHello = sayHellos.FirstOrDefault(x =&gt; x.GetType() == (<span class="keyword">typeof</span>(ChineseSayHello)));</span><br><span class="line"><span class="keyword">var</span> englishSayHello = sayHellos.FirstOrDefault(x =&gt; x.GetType() == (<span class="keyword">typeof</span>(EnglishSayHello)));</span><br></pre></td></tr></table></figure>
<p>å¯è¿™æ ·è¿˜æ˜¯æœ‰ä¸€ç‚¹ä¸æ–¹ä¾¿å•Šï¼Œç»§ç»­æ”¹é€ ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">services.AddTransient&lt;ChineseSayHello&gt;();</span><br><span class="line">services.AddTransient&lt;EnglishSayHello&gt;();</span><br><span class="line">services.AddTransient(implementationFactory =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  Func&lt;<span class="built_in">string</span>, ISayHello&gt; sayHelloFactory = lang =&gt;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">switch</span> (lang)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;Chinese&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> implementationFactory.GetService&lt;ChineseSayHello&gt;();</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&quot;English&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> implementationFactory.GetService&lt;EnglishSayHello&gt;();</span><br><span class="line">      <span class="literal">default</span>:</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NotImplementedException();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> sayHelloFactory;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å­ï¼Œè¿™ä¸ªå·¥å‚ç±»çœ‹èµ·æ¥å°±æ¶ˆå¤±äº†å¯¹å§ï¼Œå…¶å®å¹¶æ²¡æœ‰(é€ƒ</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sayHelloFactory = _serviceProvider.GetRequiredService&lt;Func&lt;<span class="built_in">string</span>, ISayHello&gt;&gt;();</span><br><span class="line"><span class="keyword">var</span> chineseSayHello = sayHelloFactory(<span class="string">&quot;Chinese&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> englishSayHello = sayHelloFactory(<span class="string">&quot;English&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>è¿™è·ç¦»æˆ‘ä»¬çš„ç›®æ ‡æœ‰ä¸€ç‚¹æ¥è¿‘äº†å“ˆï¼Œå”¯ä¸€çš„é—æ†¾æ˜¯è¿™ä¸ªå·¥å‚ç±»å¯¹è°ƒç”¨æ–¹æ˜¯é€æ˜çš„ï¼Œå¯è°“æ˜¯éšè—ç»†èŠ‚ä¸Šçš„å¤±è´¥ã€‚æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ¡ˆå‘¢ï¼Ÿå¥½äº†ï¼Œæˆ‘ä¸å–å…³å­å•¦ï¼Œä¸€èµ·æ¥çœ‹ä¸‹é¢çš„å®ç°ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ¥å£<code>INamedServiceProvider</code>, é¡¾åæ€ä¹‰ï¼Œå°±ä¸éœ€è¦å†è§£é‡Šä»€ä¹ˆäº†:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">INamedServiceProvider</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function">TService <span class="title">GetService</span>&lt;<span class="title">TService</span>&gt;(<span class="params"><span class="built_in">string</span> serviceName</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ï¼Œç¼–å†™å®ç°ç±»<code>NamedServiceProvider</code>:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">NamedServiceProvider</span> : <span class="title">INamedServiceProvider</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> IServiceProvider _serviceProvider;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> IDictionary&lt;<span class="built_in">string</span>, Type&gt; _registrations;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">NamedServiceProvider</span>(<span class="params">IServiceProvider serviceProvider, IDictionary&lt;<span class="built_in">string</span>, Type&gt; registrations</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">    _serviceProvider = serviceProvider;</span><br><span class="line">    _registrations = registrations;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> TService <span class="title">GetService</span>&lt;<span class="title">TService</span>&gt;(<span class="params"><span class="built_in">string</span> serviceName</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!_registrations.TryGetValue(serviceName, <span class="keyword">out</span> <span class="keyword">var</span> implementationType))</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">$&quot;Service \&quot;<span class="subst">&#123;serviceName&#125;</span>\&quot; is not registered in container&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> (TService)_serviceProvider.GetService(implementationType);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬è¿™é‡Œç”¨ä¸€ä¸ªå­—å…¸æ¥ç»´æŠ¤åç§°å’Œç±»å‹é—´çš„å…³ç³»ï¼Œä¸€åˆ‡ä»¿ä½›åˆå›åˆ°ä¸‰å¹´å‰ Peter å¤§ç¥æ‰‹å†™ IoC çš„é‚£ä¸ªä¸‹åˆã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª<code>INamedServiceProviderBuilder</code>, å®ƒå¯ä»¥è®©æˆ‘ä»¬ä½¿ç”¨é“¾å¼è¯­æ³•æ³¨å†ŒæœåŠ¡ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">INamedServiceProviderBuilder</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function">INamedServiceProviderBuilder <span class="title">AddNamedService</span>&lt;<span class="title">TService</span>&gt;(<span class="params"><span class="built_in">string</span> serviceName, ServiceLifetime lifetime</span>) <span class="keyword">where</span> TService : <span class="keyword">class</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function">INamedServiceProviderBuilder <span class="title">TryAddNamedService</span>&lt;<span class="title">TService</span>&gt;(<span class="params"><span class="built_in">string</span> serviceName, ServiceLifetime lifetime</span>) <span class="keyword">where</span> TService : <span class="keyword">class</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">Build</span>()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œï¼ŒAdd å’Œ TryAdd çš„åŒºåˆ«å°±æ˜¯åè€…ä¼šå¯¹å·²æœ‰çš„é”®è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœé”®å­˜åœ¨åˆ™ä¸ä¼šç»§ç»­æ³¨å†Œï¼Œå’Œå¾®è½¯è‡ªå¸¦çš„ DI ä¸­çš„ Add&#x2F;TryAdd å¯¹åº”ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹å®ƒçš„å®ç°ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">NamedServiceProviderBuilder</span> : <span class="title">INamedServiceProviderBuilder</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> IServiceCollection _services;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">readonly</span> IDictionary&lt;<span class="built_in">string</span>, Type&gt; _registrations = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, Type&gt;();</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">NamedServiceProviderBuilder</span>(<span class="params">IServiceCollection services</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">    _services = services;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Build</span>()</span></span><br><span class="line">  &#123;</span><br><span class="line">    _services.AddTransient&lt;INamedServiceProvider&gt;(sp =&gt; <span class="keyword">new</span> NamedServiceProvider(sp, _registrations));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> INamedServiceProviderBuilder <span class="title">AddNamedService</span>&lt;<span class="title">TImplementation</span>&gt;(<span class="params"><span class="built_in">string</span> serviceName, ServiceLifetime lifetime</span>) <span class="keyword">where</span> TImplementation : <span class="keyword">class</span></span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">switch</span> (lifetime)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> ServiceLifetime.Transient:</span><br><span class="line">        _services.AddTransient&lt;TImplementation&gt;();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> ServiceLifetime.Scoped:</span><br><span class="line">        _services.AddScoped&lt;TImplementation&gt;();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> ServiceLifetime.Singleton:</span><br><span class="line">        _services.AddSingleton&lt;TImplementation&gt;();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    _registrations.Add(serviceName, <span class="keyword">typeof</span>(TImplementation));</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> INamedServiceProviderBuilder <span class="title">TryAddNamedService</span>&lt;<span class="title">TImplementation</span>&gt;(<span class="params"><span class="built_in">string</span> serviceName, ServiceLifetime lifetime</span>) <span class="keyword">where</span> TImplementation : <span class="keyword">class</span></span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">switch</span> (lifetime)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> ServiceLifetime.Transient:</span><br><span class="line">        _services.TryAddTransient&lt;TImplementation&gt;();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> ServiceLifetime.Scoped:</span><br><span class="line">        _services.TryAddScoped&lt;TImplementation&gt;();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> ServiceLifetime.Singleton:</span><br><span class="line">        _services.TryAddSingleton&lt;TImplementation&gt;();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    _registrations.TryAdd(serviceName, <span class="keyword">typeof</span>(TImplementation));</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç›¸ä¿¡åˆ°è¿™é‡Œï¼Œå¤§å®¶éƒ½æ˜ç™½åšä¸»çš„æ„å›¾äº†å§ï¼Œæ ¸å¿ƒå…¶å®æ˜¯åœ¨<code>Build()</code>æ–¹æ³•ä¸­ï¼Œå› ä¸ºæˆ‘ä»¬æœ€ç»ˆéœ€è¦çš„æ˜¯å…¶å®æ˜¯<code>NamedServiceProvider</code>ï¼Œè€Œåœ¨æ­¤ä¹‹å‰çš„ç§ç§ï¼Œéƒ½å±äºæ”¶é›†ä¾èµ–ã€æ„å»º ServiceProvider çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥ï¼Œå®ƒè¢«å®šä¹‰ä¸º<code>NamedServiceProviderBuilder</code>ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œç»´æŠ¤çš„è¿™ä¸ªå­—å…¸ï¼Œæœ€ç»ˆä¼šè¢«ä¼ å…¥åˆ°<code>NamedServiceProvider</code>çš„æ„é€ å‡½æ•°ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬å°±çŸ¥é“æ ¹æ®åç§°åº”è¯¥è¿”å›å“ªä¸€ä¸ªæœåŠ¡äº†ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œä¸ºäº†è®©å®ƒå’Œå¾®è½¯è‡ªå¸¦çš„ DI æ— ç¼ç²˜åˆï¼Œæˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ç‚¹æ‰©å±•æ–¹æ³•ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">ServiceCollectionExstension</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> TService <span class="title">GetNamedService</span>&lt;<span class="title">TService</span>&gt;(<span class="params"><span class="keyword">this</span> IServiceProvider serviceProvider, <span class="built_in">string</span> serviceName</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">var</span> namedServiceProvider = serviceProvider.GetRequiredService&lt;INamedServiceProvider&gt;();</span><br><span class="line">    <span class="keyword">if</span> (namedServiceProvider == <span class="literal">null</span>)</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">$&quot;Service \&quot;<span class="subst">&#123;<span class="keyword">nameof</span>(INamedServiceProvider)&#125;</span>\&quot; is not registered in container&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> namedServiceProvider.GetService&lt;TService&gt;(serviceName);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> INamedServiceProviderBuilder <span class="title">AsNamedServiceProvider</span>(<span class="params"><span class="keyword">this</span> IServiceCollection services</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">var</span> builder = <span class="keyword">new</span> NamedServiceProviderBuilder(services);</span><br><span class="line">    <span class="keyword">return</span> builder;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨ï¼Œå›åˆ°æˆ‘ä»¬ä¸€å¼€å§‹çš„é—®é¢˜ï¼Œå®ƒæ˜¯å¦‚ä½•è¢«è§£å†³çš„å‘¢ï¼Ÿ</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">services</span><br><span class="line">  .AsNamedServiceProvider()</span><br><span class="line">  .AddNamedService&lt;ChineseSayHello&gt;(<span class="string">&quot;Chinese&quot;</span>, ServiceLifetime.Transient)</span><br><span class="line">  .AddNamedService&lt;EnglishSayHello&gt;(<span class="string">&quot;English&quot;</span>, ServiceLifetime.Transient)</span><br><span class="line">  .Build();</span><br><span class="line"><span class="keyword">var</span> serviceProvider = services.BuildServiceProvier();</span><br><span class="line"><span class="keyword">var</span> chineseSayHello = serviceProvider.GetNamedService&lt;ISayHello&gt;(<span class="string">&quot;Chinese&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> englishSayHello = serviceProvider.GetNamedService&lt;ISayHello&gt;(<span class="string">&quot;English&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ—¶å€™ï¼Œå¯¹è°ƒç”¨æ–¹è€Œå·²ï¼Œä¾ç„¶æ˜¯ç†Ÿæ‚‰çš„ ServiceProviderï¼Œå®ƒåªéœ€è¦ä¼ å…¥ä¸€ä¸ªåç§°æ¥è·å–æœåŠ¡å³å¯ï¼Œç”±æ­¤ï¼Œæˆ‘ä»¬å°±å®ç°äº†åŸºäºåç§°çš„ä¾èµ–æ³¨å…¥ã€‚å›é¡¾ä¸€ä¸‹å®ƒçš„å®ç°è¿‡ç¨‹ï¼Œå…¶å®æ˜¯ä¸€ä¸ªé€æ­¥æ¨è¿›çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼Œæœ¬æ¥æ˜¯å¸Œæœ›ä¾èµ–æŠ½è±¡ï¼Œå³é’ˆå¯¹åŒä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥æ— ç—›åœ°ä»ä¸€ç§å®ç°åˆ‡æ¢åˆ°å¦å¤–ä¸€ç§å®ç°ã€‚å¯æˆ‘ä»¬å‘ç°ï¼Œå½“è¿™äº›å®ç°åŒæ—¶è¢«æ³¨å†Œåˆ°å®¹å™¨é‡Œçš„æ—¶å€™ï¼Œå®¹å™¨ä¸€æ ·ä¼šè¿·æƒ‘äºåˆ°åº•ç”¨å“ªä¸€ç§å®ç°ï¼Œè¿™å°±è®©æˆ‘ä»¬å¼€å§‹æ€è€ƒï¼Œè¿™ç§åŸºäºå­—å…¸çš„ IoC å®¹å™¨è®¾è®¡æ–¹æ¡ˆæ˜¯å¦å­˜åœ¨ç¼ºé™·ã€‚æ‰€ä»¥ï¼Œåœ¨.NET Core é‡Œçš„ DI è®¾è®¡ä¸­è¿˜å¼•å…¥äº†å·¥å‚çš„æ¦‚å¿µï¼Œå› ä¸ºå¹¶ä¸æ˜¯æ‰€ä»¥çš„ Resolve<T>éƒ½å¯ä»¥é€šè¿‡<code>Activator.Create</code>æ¥å®ç°ï¼Œæ›´ä¸å¿…è¯´ Autofac å’Œ Castle ä¸­è¿˜æœ‰å­å®¹å™¨çš„æ¦‚å¿µï¼Œåªèƒ½è¯´äººç”Ÿä¸åŒçš„é˜¶æ®µæ€»ä¼šæœ‰ä¸åŒçš„ç†è§£å§ï¼å¥½äº†ï¼Œè¿™ç¯‡åšå®¢å°±å…ˆå†™åˆ°è¿™é‡Œï¼Œæ¬¢è¿å¤§å®¶ç»™æˆ‘ç•™è¨€ï¼Œæ™šå®‰ï¼</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/20/">&lt;</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><span class="page-number current">21</span><a class="page-number" href="/page/22/">22</a><span class="space">&hellip;</span><a class="page-number" href="/page/79/">79</a><a class="extend next" rel="next" href="/page/22/">&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">1579</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">64</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">914</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Laird Lau</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
