<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Liunx Python Rust Goalng DevOPS" />










<meta name="description" content="个人随想，瞎子的世界">
<meta property="og:type" content="website">
<meta property="og:title" content="逐流小站">
<meta property="og:url" content="https://blog.feedscoin.com/page/9/index.html">
<meta property="og:site_name" content="逐流小站">
<meta property="og:description" content="个人随想，瞎子的世界">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Laird Lau">
<meta property="article:tag" content="Liunx Python Rust Goalng DevOPS">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://blog.feedscoin.com/page/9/"/>





  <title>逐流小站</title>
  





<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MW47YH6RH0"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MW47YH6RH0');
</script>





<meta name="generator" content="Hexo 7.0.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">逐流小站</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">想回到那个能随便跳槽的年代</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            Sitemap
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2022/05/07/2022-05-07-principles-for-dealing-with-the-changing-world-order/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/05/07/2022-05-07-principles-for-dealing-with-the-changing-world-order/" itemprop="url">经济周期与中国崛起 - 读《原则2：应对变化中的世界秩序》</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-05-07T16:03:09+08:00">
                2022-05-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/summary/" itemprop="url" rel="index">
                    <span itemprop="name">summary</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <img src="/images/principle-book.jpg" width="600px" />

<h2 id="一、序"><a href="#一、序" class="headerlink" title="一、序"></a>一、序</h2><p>最近看了一本书叫做《原则2：应对变化中的世界秩序》，作者是桥水公司的创始人达瑞欧。</p>
<p>看完这本书，我最大的感受是：</p>
<ul>
<li>理解了中国人和美国人在认知上的一些根本性的差异。</li>
<li>在达瑞欧的视角下，学会如何分析中国和美国整体的发展状况。</li>
</ul>
<p>在达瑞欧的预测下，中国未来整体的实力大概率会超过美国，这会带来一系列的冲突，甚至有可能是战争。</p>
<p>书中将这部分的中美冲突一一展开讨论，对我们评估未来影响自身切身利益的因素有了一些参考。</p>
<p>以下是一些分享。</p>
<h2 id="二、中美文化的差异"><a href="#二、中美文化的差异" class="headerlink" title="二、中美文化的差异"></a>二、中美文化的差异</h2><p>中美有一个文化上的巨大差异：中国人认为集体利益大于个人利益；美国人认为个人利益大于集体利益。</p>
<p>举几个面对新冠的例子：</p>
<ul>
<li>当国家让大家打疫苗的时候。中国人大部分都会主动配合打疫苗；而美国人认为打不打疫苗是自己的权力，国家不能强制。</li>
<li>当国家让大家戴口罩的时候。中国人大部分都会主动佩戴口罩；而美国人，上到<a target="_blank" rel="noopener" href="https://www.bbc.com/zhongwen/trad/world-53263390">特朗普</a>下到民众，都不太愿意遵守。</li>
<li>在中国，你如果让一个人因为是密接隔离 14 天，他大概率是配合的；而美国人则会把这个上升到人权自由。</li>
</ul>
<p>类似的例子还有很多，比如持有枪支，发表言论等。中国人会更加务实，站在集体利益最大化角度来决策；而美国人会用“人权”来强调自己的个人利益，即便这对集体来说是有害的。</p>
<p>为什么会有这样的巨大文化差异呢？我个人认为是历史造成的。</p>
<p>中国是一个具有几千年历史的文化大国。在这几千年，华夏文明形成了自己独有的文化风格。这些文化风格随着时代的传承成为中华民族的一些民族性格。例如：中国古代有一个著名的故事，叫《孔融让梨》，这个故事让大家意识到为别人着想是更高尚的一种行为。类似的传统文化很多，最终形成了中华民族勤劳、朴素、谦让、内敛的文化。</p>
<p>在这种文化下，中国人喜欢少说多做，不喜欢给别人添麻烦，遇到利益的时候喜欢谦让。而这些文化在美国是没有的。</p>
<ul>
<li>在美国，人们更崇尚自由，你想要什么你就主动去争取。别人的利益如果跟你的利益不一样，你就努力去说服别人达成你的目标。</li>
<li>在中国，人们喜欢用一种内敛的方式把自己的事情做好，不喜欢对别人指指点点。</li>
</ul>
<p>美国人喜欢将自己的意见充分表达出来，然后为自己争取利益，也为别人争取相似的利益。所以说当美国人觉得他自己看来的人权被侵犯的时候，就会奋起为中国人来争取这些权利。但实际上中国人不一定特别在意这些权利。</p>
<p>中国人喜欢把事情默默的做好，相信水到渠成，该来的奖励最终都会到来，所以不太会主动为自己争取提拔和表现的机会，也不太愿意为了捍卫自己的观点与别人起激烈的冲突。</p>
<p>两种文化哪种更好？我觉得都有好的一面：</p>
<ul>
<li>自由开放的人更加创新，更加积极主动；</li>
<li>而内敛的人更加为集体着想，会容易达成群体益利最大化。</li>
</ul>
<p>但如果因为文化不一样，两个国家产生冲突，那就不好了。比如：</p>
<ul>
<li>美国就不应该管那么多中国和别的国家的内政。中国人自己的事情自己知道怎么处理，中国人自己的权利自己知道争取。</li>
<li>中国面对美国也确实需要多表达。让美国人知道我们的立场，我们的态度，我们的文化差异。</li>
</ul>
<h2 id="三、经济周期与中国的实力"><a href="#三、经济周期与中国的实力" class="headerlink" title="三、经济周期与中国的实力"></a>三、经济周期与中国的实力</h2><p>达瑞欧在研究完过去 500 年各国的历史后，首先提出了周期的概念：每一个国家都会经历反复的周期化波动，周期包括：</p>
<ul>
<li>新秩序</li>
<li>上升阶段</li>
<li>顶部阶段</li>
<li>下跌阶段</li>
<li>再次形成新秩序</li>
</ul>
<p>如下所示：</p>
<img src="/images/principle-2-2.png" class="">

<p>而在不同的周期中，国家会有不同的特征。例如：在上升阶段，国家重视教育。而在下跌阶段，国家会有巨额债务。</p>
<p>为了计算各国间的实力以及考察各国所处的周期，达瑞欧提出了一个模型，用于评估国家的实力。这个模型包括以下几个维度：债务负担、教育水平、创新和技术、成本竞争力、军事实力、贸易、经济产出、市场和金融中心、储备货币地位、基础设施和投资、品格&#x2F;教养&#x2F;决心、国家治理&#x2F;法规、财富&#x2F;机会&#x2F;价值观。</p>
<p>然后，达瑞欧认为，中国处在上升阶段，中国现在的发展已经使得中国能够一定程度上对抗美国，这让美国感觉到了威胁。</p>
<p>比如：达瑞欧在书中写到，按照购买力平价折算，中国的 GDP 的总量已经超过了美国，达到了全球 GDP 的 23%（如下图）。</p>
<img src="/images/principle-2-1.png" class="">

<p>又比如：中国整体的负债水平较低，而美国政府常年赤字，其实是一直在通过借贷来消费。中国的出口一直大于进口，这使得中国一直在获得外汇储备。而美国的出口小于进口，这使得美国一直相当于在借债消费。</p>
<h2 id="四、可能的冲突"><a href="#四、可能的冲突" class="headerlink" title="四、可能的冲突"></a>四、可能的冲突</h2><p>达瑞欧认为国家之间的战争分成五类，分别是：</p>
<ul>
<li>贸易&#x2F;经济战。例如：加征关税、切断对方必需品进口。中国提出的“双循环”，就是为了应对这种危机而采取的措施。</li>
<li>技术战。例如：断供芯片，断供最新的各类工业软件，例如 Xcode，IntelliJ。</li>
<li>地缘政治战。例如：台湾问题，西藏问题，新疆棉问题。</li>
<li>资本战。例如：没收&#x2F;冻结冲突国家的境外资产。最近乌俄冲突，某些国家就把俄罗斯所有公民的境外资产都冻结了。</li>
<li>军事战。例如第一、二次世界大战。</li>
</ul>
<p>书中讨论到了中国持有的美国国债问题。作者表示：中国虽然持有 1 万亿美元的美国国债，但是这仅占美国 24 万亿美元国债的很小一部分比例，所以即便因为中美冲突，中国将国债换成别的资产，对美国的影响也是很小的。</p>
<p>讨论到军事战时，作者有一个观点：当冲突双方都有了“毁灭一切”的能力时，战争反倒不容易发生了。这有点类似于上个世纪美苏之间的冷战。</p>
<h2 id="五、教育和其它"><a href="#五、教育和其它" class="headerlink" title="五、教育和其它"></a>五、教育和其它</h2><p>书中关于国家应该重视教育的观点，让我对“创造价值”的感受进一加强。对于一个国家来说，他应该努力创造价值，价值来源于两部分，一部分是出口，另一部分就是内部的经济循环。如何增加这两部分的价值呢？有一个很好的办法，就是提升生产力，提升创新能力，用更好的产品来满足国内外人民的需求。</p>
<p>这让我想起来，邓小平在改革开放的最初做的第一件事情就是恢复高考。科技是第一生产力，而科技的背后就是国家对教育人才的培养储备。做这种投资回报是很慢的，因为培养出一个优秀的科技人才需要花费非常长的时间。而国家在这上面的投入有助于这些人才最终产生科技创新，提升生产力，反过来创造更多的对人民有价值的产品，提升整体的 GDP 的收入和国家的商业竞争力。</p>
<p>以上。</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-weekly" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/post/weekly-11.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/weekly-11.html" itemprop="url">周刊第11期：扩大你的运气表面积（Luck Surface Area）</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-05-05T00:00:00+08:00">
                2022-05-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <h2 id="扩大你的运气表面积"><a href="#扩大你的运气表面积" class="headerlink" title="扩大你的运气表面积"></a>扩大你的运气表面积</h2><p>想说两件事，第一件事，在上周的某天下午，我收到了一封邮件：</p>
<p><img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images202204282317575.png" alt="image-20220428231741858"></p>
<p>这是 V2EX 上的一位老哥发来的邮件，他也在写周刊<a target="_blank" rel="noopener" href="http://weekly.codelc.com/">《野生架构师》</a>，估计不少人都听过，毕竟最近在 V2EX 上比较活跃，收到这封来信让我非常开心，毕竟自己的周刊内容得到了他人的认可。</p>
<p>同时也让我知道了一个新的概念：运气表面积（Luck Surface Area）。</p>
<p>这个概念该如何理解，根据<a target="_blank" rel="noopener" href="https://www.codusoperandi.com/posts/increasing-your-luck-surface-area">《How to Increase Your Luck Surface Area》</a>的描述：</p>
<blockquote>
<p>在你的生活中发生意外的数量，就是你的运气表面积，它与你所热爱的事情、以及被有效沟通的人数是成正比的，换句话说，你的运气是你自己创造的。</p>
</blockquote>
<p>它的公式是：<strong>运气表面积 &#x3D; 你采取的行动 [X] x 你沟通的人数 [X]</strong> 。</p>
<p>运气表面积的工作原理是这样的，当你投入精力去做某件事情，你分享出去，你就会产生价值，但很多时候，这个价值会被所影响的人放大，它有可能会以某种你未曾预料的方式回报你，比如招聘你、投资你，但无论以何种方式发生，它都是偶然的。</p>
<p>说回上面那封邮件，我之所以写周刊在<a target="_blank" rel="noopener" href="https://4ark.me/post/weekly-idea.html">《我为什么要写周刊》</a> 中有提到，我希望我能够对我每周所阅读的文章做一份总结，以此巩固我自身的理解，并希望不时输出自己观点的同时也能够帮助到其他人。</p>
<p>正因为我写周刊，被这位老哥看到了，发来这么一封邮件，让我感受到了被认可的快乐，因此更加坚定了我继续写周刊的信心，这就是我的运气表面积在扩大，但这一切都是非常偶然的，我在做这件事情的时候，我没有预料到这一点，所以正是因为我做这件事情为我自己创造了运气。</p>
<p>另外一件让我感到运气表面积在扩大的事，在一直订阅的<a target="_blank" rel="noopener" href="https://hutusi.com/">胡涂说</a>的周刊<a target="_blank" rel="noopener" href="https://hutusi.com/articles/weekly-13">《No.13: 周刊的周刊》</a>发现了他推荐我的周刊，而他的原话是：</p>
<blockquote>
<p>看到很多博主在写周刊，我想还是把这一传统给拾起来。</p>
</blockquote>
<p>这让我想到了一件非常奇妙的事情，前段时间 V2EX 上有讨论 <a target="_blank" rel="noopener" href="https://v2ex.com/t/842511">为什么忽然间大家都开始做周刊了</a>，但我坦承我不是在跟风，或许别人也是如此，那么有没有可能是因为某一个人持续地在做这件事，影响了很多人，然后大家又互相影响，无形中扩大了大家的运气表面积，如果真是这样，那我认为是阮一峰影响了我，而我也可能在影响其他人。</p>
<p>最后从<a target="_blank" rel="noopener" href="https://dimzou.feat.com/zh-CN/draft/580665/585314">这里</a>摘录一下以下三者的不同：</p>
<ol>
<li><strong>幸运</strong>是发生在你身上的事情，生在好人家是福，被雷劈是祸。</li>
<li><strong>机会</strong>需要您采取行动。您需要抓住机会，例如购买彩票，或约某人出去约会，以从偶然事件中受益。</li>
<li><strong>运气</strong>是成功或失败<em>显然</em>是偶然造成的。看起来这是一个机会，因为我们很少看到在成功或失败之前发生的一切。运气是通过发现和创造机会来实现的。这是你行为的直接后果。</li>
</ol>
<p>所以，记住一件事情，<strong>你可以创造你的运气，只要你去做更多的事情影响别人</strong>。</p>
<h2 id="本周见闻"><a href="#本周见闻" class="headerlink" title="本周见闻"></a>本周见闻</h2><h3 id="POSSE-和-Mastodon"><a href="#POSSE-和-Mastodon" class="headerlink" title="POSSE 和 Mastodon"></a>POSSE 和 Mastodon</h3><p>POSSE 的全称是 Publish (on your) Own Site, Syndicate Elsewhere，意为「在你自己的网站上发布，在其他地方联合」。</p>
<p>这是 2010 年首次在<a target="_blank" rel="noopener" href="https://steveivy.gitlab.io/tantek-celik-diso-20-brass-tacks.html">《Tantek Celik Diso 20 Brass Tacks》</a> 提出的一种联合模型方案：</p>
<blockquote>
<p>在你自己的网站上发布，拥有自己的 URL 和永久链接，并通过其他社交媒体、社区中公布该链接。</p>
</blockquote>
<p>可以通过这段短片<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=X3SrZuH00GQ&t=835s">《Own your content on Social Media using the IndieWeb》</a>快速了解 POSSE。</p>
<p>采用该模型的好处是：如果我的 Twitter 帐户被删除（被官方或我自己删除），我不会丢失任何重要内容。</p>
<p>其实已经不少人采用这个方案，譬如就不少博主都会将文章链接发到 Twitter、Telegram 频道上，一方面是起到推广的作用，另一方面正是因为 POSSE。</p>
<p>你也可以通过这个链接<a target="_blank" rel="noopener" href="https://indieweb.org/POSSE">《POSSE - IndieWeb》</a> 了解更多信息。</p>
<p>之所以越来越多人采用这个方案，都是因为对官方的不信任，所以希望把数据掌握在自己的手中，所以这里简单介绍一下 Mastodon：</p>
<blockquote>
<p>Mastodon 是互联网上最大的去中心化的社交网络，它由一个非营利组织基于开放网络标准建立。</p>
</blockquote>
<p>简单来说就是一个自托管的类 Twitter、微博的网站，你可以构建并部署自己的 Mastodon 实例，也可以加入他人的实例，顺便一提之前川普搞的社交媒体的 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Truth_Social">Truth Social</a> 也是基于 Mastodon 的。</p>
<p>但 Mastodon 也有它的不足之处，譬如：</p>
<ol>
<li>稳定性，毕竟只有少部分人在维护实例。</li>
<li>还没有一个好的策略去防止虚假信息，仇恨言论，骚扰等。</li>
</ol>
<p>但也有不少人开始尝试从 Twitter 转向 Mastodon，比如 <a target="_blank" rel="noopener" href="https://2ality.com/index.html">2ality</a> 的博主 <a target="_blank" rel="noopener" href="https://fosstodon.org/@rauschma">Axel Rauschmayer</a>，有兴趣的同学可以从 <a target="_blank" rel="noopener" href="https://fosstodon.org/explore">Explore Fosstodon</a>  开始探索。</p>
<h3 id="造谣的成本有多低？"><a href="#造谣的成本有多低？" class="headerlink" title="造谣的成本有多低？"></a>造谣的成本有多低？</h3><p>在如今的网络，造谣的成本非常低，比如我们就可以通过 <a target="_blank" rel="noopener" href="https://fakedetail.com/">Fake Details</a> 这个网站去伪造各式各样的假信息，可以伪造下面这些社交媒体的假截图：</p>
<ul>
<li>Twitter 推文</li>
<li>Tiktok</li>
<li>Youtube</li>
<li>等等…</li>
</ul>
<p>甚至只需要在某个完全不相关的视频上面截个图，就可以张冠李戴地套在另外一件时事上面，而我们该如何去辨别这些假信息呢？</p>
<p>在<a target="_blank" rel="noopener" href="https://4ark.me/post/weekly-04.html">《周刊第4期：独立思考》</a> 曾推荐过几个比较可靠的事实核查网站，这里再贴一下：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://chinafactcheck.com/">有据</a></li>
<li><a target="_blank" rel="noopener" href="https://tfc-taiwan.org.tw/">台湾事实核查中心</a></li>
<li><a target="_blank" rel="noopener" href="https://www.politifact.com/">PolitiFact</a></li>
<li><a target="_blank" rel="noopener" href="https://www.truthorfiction.com/">Truth or Fiction</a></li>
<li><a target="_blank" rel="noopener" href="https://www.factcheck.org/">FactCheck.org</a></li>
<li><a target="_blank" rel="noopener" href="https://factcheck.afp.com/">Fact Check</a></li>
</ul>
<p>除了看以上这些网站给出的结论，我们还可以通过这些网站提供的<a target="_blank" rel="noopener" href="https://tfc-taiwan.org.tw/topic/4112">核查工具箱</a>，自己去学习如何做事实核查。</p>
<h2 id="一些-tips"><a href="#一些-tips" class="headerlink" title="一些 tips"></a>一些 tips</h2><h3 id="Chrome-用户体验报告比较工具"><a href="#Chrome-用户体验报告比较工具" class="headerlink" title="Chrome 用户体验报告比较工具"></a><a target="_blank" rel="noopener" href="https://crux.zaps.dev/">Chrome 用户体验报告比较工具</a></h3><p>你只需要在 Chrome UX Report Compare Tool 这个网站上输入一个或多个 URL，它将会列出它们的各项性能指标，如下图：</p>
<p><img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images202205052214723.png" alt="image-20220505221453130"></p>
<p>然而当我输入本 Blog 的域名时，它提示我：Chrome 用户体验报告中没有足够的数据，这是访问人数不够多的缘故。</p>
<p>如果想要了解背后的技术细节，可以看这篇文章<a target="_blank" rel="noopener" href="https://web.dev/chrome-ux-report-api/">《使用 Chrome 用户体验报告 API》</a>。</p>
<h3 id="使用-Javascript-的可选操作符可能会破坏你的代码"><a href="#使用-Javascript-的可选操作符可能会破坏你的代码" class="headerlink" title="使用 Javascript 的可选操作符可能会破坏你的代码"></a><a target="_blank" rel="noopener" href="https://p42.ai/blog/2022-05-04/javascript-refactoring-gotchas-5-ways-converting-to-optional-chaining-can-break-your-code">使用 Javascript 的可选操作符可能会破坏你的代码</a></h3><p>熟悉 JS 的同学都知道我们可以通过 <code>obj?.x</code> 这个语法来更安全地访问对象属性等，但是如果盲目地使用这个语法，可能会导致一些意想不到的事情发生，比如以下例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;value &amp;&amp; value.length&#125;</span>, <span class="subst">$&#123;value?.length&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>(<span class="literal">undefined</span>);       <span class="comment">// undefined, undefined</span></span><br><span class="line"><span class="title function_">test</span>(<span class="literal">null</span>);            <span class="comment">// null, undefined</span></span><br><span class="line"><span class="title function_">test</span>(<span class="literal">true</span>);            <span class="comment">// undefined, undefined</span></span><br><span class="line"><span class="title function_">test</span>(<span class="literal">false</span>);           <span class="comment">// false, undefined</span></span><br><span class="line"><span class="title function_">test</span>(<span class="number">1</span>);               <span class="comment">// undefined, undefined</span></span><br><span class="line"><span class="title function_">test</span>(<span class="number">0</span>);               <span class="comment">// 0, undefined</span></span><br><span class="line"><span class="title function_">test</span>(&#123;&#125;);              <span class="comment">// undefined, undefined</span></span><br><span class="line"><span class="title function_">test</span>([]);              <span class="comment">// 0, 0</span></span><br><span class="line"><span class="title function_">test</span>(&#123; <span class="attr">length</span>: <span class="string">&quot;a&quot;</span> &#125;); <span class="comment">// a, a</span></span><br><span class="line"><span class="title function_">test</span>(<span class="string">&#x27;&#x27;</span>);              <span class="comment">// , 0</span></span><br><span class="line"><span class="title function_">test</span>(<span class="title class_">NaN</span>);             <span class="comment">// NaN, undefined</span></span><br></pre></td></tr></table></figure>

<p>通过这个例子我们发现，仅当值为 undefined 的时候，Optional Chaining 才有可能按照预期运行，所以我们编写代码的时候一定要多加注意，什么时候应该用 &amp;&amp; 做短路判断，什么时候使用 Optional Chaining 语法。</p>
<h3 id="在-git-仓库中使用-find-exec-sed-是很危险的"><a href="#在-git-仓库中使用-find-exec-sed-是很危险的" class="headerlink" title="在 git 仓库中使用 find . -exec sed 是很危险的"></a><a target="_blank" rel="noopener" href="https://cmdcolin.github.io/posts/2022-05-04-findseddangerous">在 git 仓库中使用 find . -exec sed 是很危险的</a></h3><p>如果你想在 git 存储库中全局替换某个字符，那么你很有可能会遇到这个问题：<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/6758963/find-and-replace-with-sed-in-directory-and-sub-directories">Find and replace with sed in directory and sub directories</a>，这是因为 find 命令没有忽略 .git 目录，运行该命令可能会导致 .git 目录损坏，所以更好的方式是使用 git ls-files：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git ls-files | xargs sed -i -e <span class="string">&#x27;s/apple/orange/g&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="分享文章"><a href="#分享文章" class="headerlink" title="分享文章"></a>分享文章</h2><h3 id="凯文-·-凯利-70-岁生日写的-103-条人生忠告"><a href="#凯文-·-凯利-70-岁生日写的-103-条人生忠告" class="headerlink" title="凯文 · 凯利 70 岁生日写的 103 条人生忠告"></a><a target="_blank" rel="noopener" href="https://justinyan.me/post/4911">凯文 · 凯利 70 岁生日写的 103 条人生忠告</a></h3><p>2022年4月28日，凯文·凯利（Kevin Kelly）在他的网站上发布了 70 岁生日的文章：<a target="_blank" rel="noopener" href="https://kk.org/thetechnium/103-bits-of-advice-i-wish-i-had-known/">103 Bits of Advice I Wish I Had Known</a>，意为：103 条我希望早点知道的人生忠告。</p>
<p>此为中译版，非常推荐阅读，在这里摘录我个人认为有启发的几句：</p>
<ol>
<li>99%的时间里，真正关键的时刻就是此刻。</li>
<li>除了你以外，没有人会真的记得你拥有什么东西。</li>
<li>“但是”之前的话都是废话。</li>
<li>当你原谅其他人的时候，他们不一定会知道这件事，但你自己却会被治愈。原谅不是我们给予他人的东西；而是我们给自己的礼物。</li>
<li>教育的一半作用是学习哪些东西可以被忽略。</li>
<li>不要相信你认为你相信的一切。</li>
<li>为了丰厚的回报，请对你完全不感兴趣的事物保持好奇。</li>
<li>重复别人是一个很好的开始。重复你自己则是一个令人失望的终点。</li>
<li>如果你对于一个主题的意见可以根据你另一个主题的意见预测得出，那你可能陷入了某种意识形态的掌控。如果你认真审视你自己的意识，你的结论其实是无法预测的。</li>
</ol>
<h3 id="质疑和信任"><a href="#质疑和信任" class="headerlink" title="质疑和信任"></a><a target="_blank" rel="noopener" href="https://adactio.com/journal/19021">质疑和信任</a></h3><p>这是 Jeremy 两篇文章，主要讨论了本文作者发现的一个奇怪现象，Web 开发者普遍存在这样一种心态：他们会在项目中优先选择安装 npm 依赖，然后隐式地引入了更多的依赖，也就相当于完全地信任这些 npm 包以及它们的作者。</p>
<p>但作者认为更应该直接使用浏览器的原生特性，比如 HTML 元素、CSS 功能和 JavaScript API，虽然它们并不总是完美的，并且在开发过程中需要额外花费很多心思，但原生的特性更值得被信赖。</p>
<p>而关于这个话题的讨论将由此展开，有些人认为之所以普遍存在这样一种心态，是因为浏览器兼容性的缘故，譬如在 MDN 的 <a target="_blank" rel="noopener" href="https://insights.developer.mozilla.org/reports/mdn-web-developer-needs-assessment-2019.html#needs-assessment-segmented-view-of-the-needs-ranking">Overall Needs Ranking</a> 中排名前 5 的需求有 4 个属于兼容性问题，以前的 jQuery 和 Bootstrap 就是在这样的需求下产生，而现在这种情况已经逐步得到改善，越来越多人开始倾向于使用浏览器原生特性，而不是借助第三方库，总得来说，Web 开发者对浏览器的信任正在恢复。</p>
<p>最后提出了一个设计原则：如果可用，请默认使用浏览器原生功能，而不是第三方库。</p>
<h3 id="使用-Rust-开发单页应用程序"><a href="#使用-Rust-开发单页应用程序" class="headerlink" title="使用 Rust 开发单页应用程序"></a><a target="_blank" rel="noopener" href="https://www.sheshbabu.com/posts/rust-wasm-yew-single-page-application/">使用 Rust 开发单页应用程序</a></h3><p>这是一篇使用 Rust 和  <a target="_blank" rel="noopener" href="https://yew.rs/">Yew</a>  从 0 到 1 开发单页应用的文章，对于想要学习 Rust 和 Wasm 的同学可以看看。</p>
<h2 id="有趣的链接"><a href="#有趣的链接" class="headerlink" title="有趣的链接"></a>有趣的链接</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://exercism.org/">Exercism</a>：一个学习编程语言的网站，非常有用。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://kill-the-newsletter.com/">Kill the Newsletter</a>：可将通过邮件订阅的 newsletters 转换为 RSS 源。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://wantwords.net/">汉语反向词典</a>：输入描述或词语，找到更多相似词语，帮助词穷的人更好地写作。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://ludwig.guru/">Ludwig</a>：和上面的差不多，不过是针对英文的。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=0eKVizvYSUQ">How Google Search Works</a>：一段介绍 Google 搜索如何工作的五分钟短片。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://notefolio.net/">notefolio</a>：一个韩国的 UI 设计网站。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://natto.dev/">natto</a>：一个在线画 2D canvas 的工具。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://jimmysong.io/eng-practices/">谷歌工程实践</a>：顾名思义，Google 的通用工程实践，几乎涵盖所有语言和项目，内含 Code Review 以及代码编写指南。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://workers.cloudflare.com/">Cloudflare Workers</a>：Cloudflare 的云函数产品。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/StepfenShawn/Cantonese">Cantonese</a>：一个高中生写的粤语编程语言。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/mattpocock/ts-error-translator">TypeScript Error Translator</a>：将 TypeScript 错误翻译成英语，提供 VSCode 扩展。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/adriancooney/puppeteer-heap-snapshot">puppeteer-heap-snapshot</a>：一个用来获取和查询 Chome DevTools 堆快照的 CLI 工具。</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2022/05/04/2022-5-4-apps/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/05/04/2022-5-4-apps/" itemprop="url">近期值得关注的 App</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-05-04T21:53:00+08:00">
                2022-05-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <p>本文首发于公众号「效率工具指南」<br>作者&#x2F;彭宏豪     </p>
<p>Hello 各位好，我是小豪。<br>今天照例来更新一下这个不定期更新的栏目「近期值得关注的 App」，希望能给你带来一些有用的信息。</p>
<p>Enjoy~       </p>
<h2 id="Goodnotes"><a href="#Goodnotes" class="headerlink" title="Goodnotes"></a>Goodnotes</h2><p>Goodnotes，一款在 iPad 上非常受欢迎的手写笔记应用，在上个月宣布由付费下载转为「免费下载 + 内购解锁」的方式。  </p>
<p>如果你之前没有购买过 Goodnotes，现在可以免费下载并试用这款软件了。对于免费用户，Goodnotes 支持在 App 内创建 3 个笔记本。    </p>
<p><img src="https://img.penghh.fun/2022/05/04/16516687639596.jpg"></p>
<p>内购解锁后，你将获得额外的权限： </p>
<ul>
<li>无限制的笔记本数量  </li>
<li>手写识别，可以通过内置的搜索功能来搜索你手写的内容   </li>
<li>从电子邮件导入文件</li>
</ul>
<p><img src="https://img.penghh.fun/2022/05/04/16516688928219.jpg"></p>
<h2 id="Uno-Calculator"><a href="#Uno-Calculator" class="headerlink" title="Uno Calculator"></a>Uno Calculator</h2><p>Uno Calculator，这是 iPad 上一款免费的计算器 App，外观设计很像 Win10 自带的计算器。   </p>
<p>用过 Win10 上的计算器的朋友，想必对下图的 App 界面并不陌生。   </p>
<p><img src="https://img.penghh.fun/2022/05/04/16516691992097.jpg"></p>
<p>说一个冷知识：用 iPad 很久之后，我才意识到原来 iPad 上并没有内置类似 iPhone 的计算器 App，如果想用 iPad 来做简单的计算，要么使用 Spotlight，要么就是得在 iPad 上额外安装一个计算器的 App。  </p>
<p>除了这里说到的 Uno Calculator，我之前还介绍过另外一个 iPad 上的计算器 App——<strong>微软数学</strong>。   </p>
<p>微软数学的特色在于，它可以识别你手写的数学符号或表达式，并返回最终的计算结果。   </p>
<h2 id="招行-App-X-iPhone-NFC-读取"><a href="#招行-App-X-iPhone-NFC-读取" class="headerlink" title="招行 App X iPhone NFC 读取"></a>招行 App X iPhone NFC 读取</h2><p>因为很久以前办的身份证过期了，前阵子收到不少银行发来的信息，让我自行到手机银行 App 里更新一下身份证信息，其中就包含招商银行。  </p>
<p>在招行 App 更新身份证信息时，第一次用上了下图的功能「<strong>身份证识读</strong>」，只需要将身份证放在手机背面摄像头的位置，就能<strong>自动读取身份证的信息</strong>，而不是像其他银行 App 那样——还是停留在手机拍照上传的旧设计……     </p>
<p>不得不说，招行 App 确实走在国内众多银行的前列，拜托其他银行也向招行学学吧。    </p>
<p><img src="https://img.penghh.fun/2022/05/04/img2265.JPEG" alt="IMG_2265"></p>
<p>第一次用上 iPhone 的这个功能，也有点让我出乎意料，问了网上的网友，说这是用到了 iPhone 的 NFC 功能。  </p>
<p>在网上查了一下信息，NFC 功能在 2014 年推出的 iPhone 6 上就有了，只不过最初这个功能仅用于苹果自家的 Apple Pay。   </p>
<p>等到 iOS 系统发展到 iOS 13，iPhone 的 NFC 功能就可以读取身份证信息了。</p>
<p>NFC 读取身份证信息，不止在招行 App 中可以使用，据说在出行应用——<strong>航旅纵横</strong> App 上也可以使用，有用过的朋友，可以到评论区留个言确认下。   </p>
<h2 id="将日历小程序添加为桌面小组件"><a href="#将日历小程序添加为桌面小组件" class="headerlink" title="将日历小程序添加为桌面小组件"></a>将日历小程序添加为桌面小组件</h2><p>倏地一下，五一假期就过完了，下一个让人有盼头的节日，只能是下半年的国庆了。   </p>
<p>今天距离 2022 年国庆假期还有 150 天。  </p>
<p>如果你希望可以随时看到距离国庆假期还有多少天，不妨可以考虑在桌面上添加一个下图右侧的小组件。  </p>
<p>添加小组件需要用到的工具和系统要求：     </p>
<ul>
<li>微信小程序：时刻助理   </li>
<li>iPhone App：Scriptable（免费）     </li>
<li>iOS 系统：不低于 iOS 14</li>
</ul>
<p><img src="https://img.penghh.fun/2022/05/04/img2364.PNG" alt="IMG_2364"></p>
<p>如何在桌面上添加日历小组件，小程序「时刻助理」在详情页中提供了详细的说明，这里就不再复读了，感兴趣的朋友可以自行前往小程序查看。   </p>
<p><img src="https://img.penghh.fun/2022/05/04/img9a107944581a1.jpeg" alt="IMG_9A107944581A-1"></p>
<h2 id="扫码加入我在知识星球上创建的社群「效率工具指南」"><a href="#扫码加入我在知识星球上创建的社群「效率工具指南」" class="headerlink" title="扫码加入我在知识星球上创建的社群「效率工具指南」"></a>扫码加入我在知识星球上创建的社群「效率工具指南」</h2><p>如果你觉得本文帮到了你，想支持我做得更好，欢迎戳下方图片，加入我的知识星球。     </p>
<p>关于社群「效率工具指南」的介绍，可以查看我在语雀文档上发布的文档：<a target="_blank" rel="noopener" href="https://www.yuque.com/penghonghao/af0aai/glwrg2dl0dqlegi6?singleDoc#">知识星球「效率工具指南」简介</a>    </p>
<p><img src="https://img.penghh.fun/2023/03/25/48844555552858t2.JPG" alt="48844555552858T2">   </p>
<h2 id="欢迎关注"><a href="#欢迎关注" class="headerlink" title="欢迎关注"></a>欢迎关注</h2><p>以上，就是本次想和你分享的内容，希望能够对你有一点帮助。     </p>
<p><img src="https://img.penghh.fun/2021/05/28/gong-zhong-hao-wei-bu-er-wei-ma-dailogo.png" alt="公众号：效率工具指南">     </p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2022/05/02/2022/2022-05-02-technical-interview-tips/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/05/02/2022/2022-05-02-technical-interview-tips/" itemprop="url">如何进行技术面试（面试官视角）</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-05-02T00:00:00+08:00">
                2022-05-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <p>我参加过几十场技术面试，其中作为面试官的次数要远多于候选人。</p>
<p>说起来在我第一次做面试官之前，并没有人教过我应该怎么做，我则一直将面试视作通过一小时左右的沟通，对候选人形成一个整体的印象，最后给出一个主观的评价的过程。在这么多次的面试中，我也总结出了一些经验可以和大家分享。</p>
<p><strong>验证简历真实性</strong></p>
<p>首先花一些时间聊一聊简历上提到的项目，请对方进一步介绍这个项目的业务、自己在其中承担的职责和遇到的问题。然后针对其中自己了解的部分提几个问题，如「据我所知这类项目的难点是某某方面，请问你是否有遇到、是如何解决的」，确认对方的项目经验是否真实、是否比较深度地参与了项目。</p>
<p><strong>围绕简历提问</strong></p>
<p>尽量提问对方了解和擅长的话题，让对方有足够的表达机会，发挥出正常水平，考察候选人擅长的部分要比不擅长的部分更有价值。</p>
<p><strong>开放性问题</strong></p>
<p>避免问有标准答案的问题，而是可以问「遇到某种情况时可能是什么原因、你会怎么做」或「请解释一下某个事物是如何工作的」这样开放性的问题，给对方足够的发挥空间、主动提到一些自己的知识和经验。</p>
<p>也许有些候选人不喜欢这样的问题，认为缺少安全感、不知道该说什么，但我觉得开放性问题才有足够的区分度，才能在短时间内对候选人形成立体的印象。我们可以在候选人实在不知道从何说起时，对问题再做进一步的解释和提示。</p>
<p><strong>围绕话题由浅入深</strong></p>
<p>应该针对同一话题准备多个难度逐步增加的问题，让对方回答时思路能够相对流畅，更容易考察对方在这一话题上的深度；反过来应该避免大量零散、无联系、无难度区分的小问题。</p>
<p><strong>没必要执着于答案</strong></p>
<p>有时在反复提示下对方的答案仍差那么一点，在面试时间大多比较紧张的情况下，我们没必要花更多的时间去让对方答出答案。在候选人表示无法准确回答问题时，也可以引导他做出一些合理的猜测（这时的重点在于猜测是否合理而不是是否正确）。只要候选人在这一问题上说足够多的话，我们就可以考察到其水平了，不一定要等他说出最后的答案。</p>
<p><strong>自己不懂也没关系</strong></p>
<p>在一开始，我会担心问出的问题我自己也不了解，对方回答之后会把自己问倒或者无法考察对方水平。但后来发现完全没有必要，因为面试官没有义务即时地对候选人的回答做出评价（告诉对方对还是错），即使对于不了解的话题，自己也可以从对方的自信程度、逻辑层面，对回答有一个大体的判断的。</p>
<p><strong>现场编码可以很简单</strong></p>
<p>候选人在现场会非常紧张，面试时间也有限，在现场编码环节没必要出太难的题，重点在于考察候选人是否有最基本编程思维和编码能力。例如我觉得一些难度不高，但适合用递归解决的题目会比较合适，可以考虑在候选人编码的过程中一直保持沟通，注重过程而不是结果。</p>
<p>同时我反对为候选人在面试前或面试后布置编码的作业，这会让候选人付出不对等的时间去准备面试，也很容易从「考察候选人的能力」变成「考察候选人的诚意」。</p>
<p><strong>重复使用一套题库没什么问题</strong></p>
<p>可以自己建立自己的面试题库，在一次次面试中对其进行反复地打磨，让问题更准确、考察更全面。有些话题可能是永远都不过时的，例如对于后端工程师可能是并发模型及与之相关的线程、内存等话题。</p>
<p><strong>给对方提问的机会</strong></p>
<p>一般面试的最后一个步骤是让候选人提问，不要把这个过程敷衍掉，可以引导对方提问，告诉对方都可以问哪些问题。如可以补充一下没有提及的技术话题、可以问我司的技术架构或选型、可以问所面试的职位和如果入职之后所参与的项目、可以问日常工作环境和时间等。这样可以让对方有一个主动打开话题的机会，互相判断需求是否匹配，即使没有通过面试也让对方对公司有一个比较好的印象。</p>
<p><strong>有任何顾虑都可以 pass 掉</strong></p>
<p>我们前面做了这么多都是为了让候选人有更好的面试体验、发挥出自己最好的水平。这种情况下如果仍对候选人某一方面的表现有顾虑的话，应该果断地拒绝掉，招进来一个不合适的人损失远比错过一个合适的人大。</p>
<p><strong>沟通是否顺畅很重要</strong></p>
<p>沟通是后续开展一切工作的基础，如果觉得与候选人的沟通不顺畅，对方总是不能理解自己的意思，那么即使候选人的技术水平满足要求，也应该慎重考虑。</p>
<p><strong>留下面试的记录</strong></p>
<p>我每次面试结束后都会尽快开始写对候选人的评价，大多在一两百字，先列出面试聊到的内容、觉得好和不好的地方、了解到的对方的技术栈，然后总结一下对候选人技术水平和沟通情况的评价。这样可以帮助自己整理思路，在候选人比较多的时候也不会记混，最后给出通过与否的评价，同时还能给下一轮的面试官提供参考。</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-weekly" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/post/weekly-10.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/weekly-10.html" itemprop="url">周刊第10期：你如何在网上找到可靠的信息？</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-04-26T00:00:00+08:00">
                2022-04-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <h2 id="本周见闻"><a href="#本周见闻" class="headerlink" title="本周见闻"></a>本周见闻</h2><h3 id="Git-2-36-亮点"><a href="#Git-2-36-亮点" class="headerlink" title="Git 2.36 亮点"></a><a target="_blank" rel="noopener" href="https://github.blog/2022-04-18-highlights-from-git-2-36/">Git 2.36 亮点</a></h3><p>4 月 18 日，Git 正式发布 <a target="_blank" rel="noopener" href="https://lore.kernel.org/git/xmqqh76qz791.fsf@gitster.g/T/#u">2.36 版本</a>，其中包含 96 个贡献者的改动，其中有 26 个新特性，在此罗列一些我比较感兴趣的新特性：</p>
<ol>
<li>git log –remerge-diff，更好地显示合并提交的差异，在此之前，如果我们查看一个具有合并冲突的提交差异时，输入的结果往往很难理解，而现在使用 <code>--remerge-diff</code> 则可以用 <a target="_blank" rel="noopener" href="https://git-scm.com/docs/git-config#Documentation/git-config.txt-mergeconflictStyle">mergeconflictStyle</a> 的样式显示差异。</li>
<li>更严格的存储库权限检查，在 2.35 版本时，出现了<a target="_blank" rel="noopener" href="https://github.blog/2022-04-12-git-security-vulnerability-announced/">两个安全漏洞</a>，此漏洞会影响在多用户计算机上工作的用户，这可能会导致某个用户在其他用户的存储库上执行任意命令，在 Git <a target="_blank" rel="noopener" href="https://lore.kernel.org/git/xmqqv8veb5i6.fsf@gitster.g/">2.35.2</a> 版本中发布了安全补丁，总得来说就是 Git 更改了默认行为，防止这种情况的发生，我们也可以通过最新的 <a target="_blank" rel="noopener" href="https://git-scm.com/docs/git-config/#Documentation/git-config.txt-safedirectory">safe.directory</a> 配置来有意义地绕过这个行为。</li>
<li>我们都知道 git bisect 这个命令可以用于二分查找，快速定位引入 BUG 的提交，同时它也可以通过指定一个可执行脚本来自动化这个过程，<code>git bisect run test.sh</code>，但在此之前，Git 并没有检查指定的文件是否为可执行脚本，导致 bisect 运行出错，该问题现在得到修复。</li>
<li>还有很多，感兴趣自行了解。</li>
</ol>
<h3 id="问HN：你如何在网上找到可靠的信息？"><a href="#问HN：你如何在网上找到可靠的信息？" class="headerlink" title="问HN：你如何在网上找到可靠的信息？"></a><a target="_blank" rel="noopener" href="https://news.ycombinator.com/item?id=31107699">问HN：你如何在网上找到可靠的信息？</a></h3><p>在 hacker news 上看到的一个帖子，在信息爆炸的时代，我们如何在网上找到可靠的信息？总结出了一些自认为有用的观点：</p>
<ol>
<li>在信息源寻找「信息」，而不是「观点」，我们根据这些「信息」，得到我们自己的「观点」，同时以开放的心态去验证自己的「观点」，留意那些与你不同观点的人。</li>
<li>永远不要相信单一的信息来源，譬如不要只看国内的媒体：）</li>
<li>摆脱信息茧房，学习使用 RSS 订阅你感兴趣的内容，但是如何寻找有用的信息源也是一大难题。</li>
<li>尝试使用英文搜索你的问题，如果 Google 不好用，可以试试 <a target="_blank" rel="noopener" href="https://teclis.com/">Teclis</a>。</li>
</ol>
<h2 id="一些-tips"><a href="#一些-tips" class="headerlink" title="一些 tips"></a>一些 tips</h2><h3 id="JavaScript-根据背景色显示对应的文字颜色"><a href="#JavaScript-根据背景色显示对应的文字颜色" class="headerlink" title="JavaScript 根据背景色显示对应的文字颜色"></a>JavaScript 根据背景色显示对应的文字颜色</h3><p>在 2022 的今天，dark 模式已经成为任何一个关注用户体验的应用不可或缺的功能，其中有一个很常见的需求就是根据背景颜色决定对应的文字颜色，这里就简单讲述一下我的实现思考。</p>
<p>首先我们需要知道任何颜色都有对应的灰度值的，得到颜色对应的灰度以后，就能知道该颜色是属于偏亮还是偏暗。</p>
<p>而获取灰度值的公式为：(0.299 * <em>r</em> + 0.587 * <em>g</em> + 0.114 * <em>b</em>) &#x2F; 255</p>
<p>下面我们简单测试一下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 从 rgb 获取灰度</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getGrayLevelFromRgb</span>(<span class="params">[r, g, b]</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="number">0.299</span> * r + <span class="number">0.587</span> * g + <span class="number">0.114</span> * b) / <span class="number">255</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getGrayLevelFromRgb</span>([<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>])) <span class="comment">// 1</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getGrayLevelFromRgb</span>([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>])) <span class="comment">// 0</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getGrayLevelFromRgb</span>([<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>])) <span class="comment">// 0.299</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getGrayLevelFromRgb</span>([<span class="number">18</span>, <span class="number">18</span>, <span class="number">18</span>])) <span class="comment">// 0.07058823529411765</span></span><br></pre></td></tr></table></figure>

<p>而我们只需要设定一个阈值，大于这个阈值的就属于 light，否则为 dark 即可。</p>
<p>这里我设定的阈值是 0.85，这个阈值具体是多少根据实际情况而定。</p>
<h3 id="在-Vim-中保存只读文件"><a href="#在-Vim-中保存只读文件" class="headerlink" title="在 Vim 中保存只读文件"></a>在 Vim 中保存只读文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:w ! sudo <span class="built_in">tee</span> % &gt; /dev/null</span><br></pre></td></tr></table></figure>

<h3 id="Mac-在-dock-隐藏特定应用"><a href="#Mac-在-dock-隐藏特定应用" class="headerlink" title="Mac 在 dock 隐藏特定应用"></a>Mac 在 dock 隐藏特定应用</h3><p>有时候我们想要在 Mac 的 dock 中隐藏特定应用，可以这样：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo lsappinfo setinfo -app XXX ApplicationType=UIElement</span><br></pre></td></tr></table></figure>

<h2 id="分享文章"><a href="#分享文章" class="headerlink" title="分享文章"></a>分享文章</h2><h3 id="怎么花两年时间面试一个人"><a href="#怎么花两年时间面试一个人" class="headerlink" title="怎么花两年时间面试一个人"></a><a target="_blank" rel="noopener" href="http://mindhacks.cn/2011/11/04/how-to-interview-a-person-for-two-years/">怎么花两年时间面试一个人</a></h3><p>这是一篇 11 年前的文章（2011），但在今天看来仍然非常有用，本文比较长，但我还是建议你阅读。</p>
<p>这里简单摘要一些本文内容，本文开宗明义地提出一个问题：<strong>招聘难，难于上青天</strong>。</p>
<p>这是因为：</p>
<ol>
<li>最好的人也许不投简历，就决定去哪里了。所以要在他们做决定前找到他们。</li>
<li>比较差的会投很多次简历，找不到工作的时间越多，投的简历越多，给整个 pool 带来很多噪音，top10% 的简历也许根本不算全部人的 top10%。</li>
</ol>
<p>公司招到靠谱的人非常重要，所以，<strong>招聘也许是一个公司决策当中最最重要的一个环节</strong>。</p>
<p>本文作者就根据他的一些经验，给出了一些关于如何做招聘的建议。</p>
<p>最后作者给出如何花两年时间面试一个人的方法，那就是看面试者平时的积累，推荐的方式是：书 + GitHub，这样足以相当两年左右的面试。</p>
<h3 id="你应该阅读学术计算机科学论文"><a href="#你应该阅读学术计算机科学论文" class="headerlink" title="你应该阅读学术计算机科学论文"></a><a target="_blank" rel="noopener" href="https://stackoverflow.blog/2022/04/07/you-should-be-reading-academic-computer-science-papers/">你应该阅读学术计算机科学论文</a></h3><p>作为一名在职程序员，你需要不断地学习，你可以通过查看教程、文档、StackOverflow，以及你可以找到的任何帮助你更好地编写代码并保持最新技能的内容。但是，你试过深入研究计算机科学论文来提高你的编程能力吗？</p>
<p>虽然以上提到的教程可以帮助你立即编写代码，但阅读学术论文能够帮助你了解编程的来龙去脉，从空指针到对象，这些编程中大部分日常使用的功能都可以追溯到上世纪 60 年代，未来的创新一样建立在今天的研究之上。</p>
<p>所以，不妨试一下直接通过阅读论文去了解这些编程的知识，如果认为阅读论文还是太难，可以试一下观看这些演讲：<a target="_blank" rel="noopener" href="https://www.youtube.com/c/PapersWeLove/videos">PapersWeLove - YouTube</a>。</p>
<h3 id="WebAssembly-使用JavaScript-垃圾回收器"><a href="#WebAssembly-使用JavaScript-垃圾回收器" class="headerlink" title="WebAssembly 使用JavaScript 垃圾回收器"></a><a target="_blank" rel="noopener" href="https://jott.live/markdown/js_gc_in_wasm">WebAssembly 使用JavaScript 垃圾回收器</a></h3><p>我们知道，JavaScript 自带有垃圾回收机制，而 WebAssembly 却没有这个机制，因为它在比较底层的环境中运行，我们只能靠自己分配内存。</p>
<p>目前有一个关于 WebAssembly 的<a target="_blank" rel="noopener" href="https://github.com/WebAssembly/gc/blob/main/proposals/gc/MVP.md">提案</a>，涉及实现一个垃圾回收机制，但可惜还处于 Stage 2，仍没有浏览器实现该功能。</p>
<p>而本文作者发现了一个取巧的方式可以实现这个需求，那就是使用 WeakRefs，总的来说就是通过 WeakRefs 特性，自行实现一个永久循环的函数，去做垃圾回收的事情。</p>
<p>感兴趣可以阅读相关<a target="_blank" rel="noopener" href="https://github.com/bwasti/web_assembly_experiments/tree/main/memory_management">实现代码</a>。</p>
<h2 id="有趣的链接"><a href="#有趣的链接" class="headerlink" title="有趣的链接"></a>有趣的链接</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://it-tools.tech/">IT Tools</a>：一个开发者工具，包含日常使用的功能，如 Base64 转换、QR Code 生成，URL 解析等，使用体验极佳。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.joshwcomeau.com/operator-lookup/">Operator Lookup</a>：输入一个 JavaScript 的操作符（e.g. +、&#x3D;&gt;），将会解释该操作符的作用，对初学者非常有用。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://gitexplorer.com/">Git Explorer</a>：通过的问答选择的方式寻找你想要的 Git 命令，从此使用 Git 命令不再求人。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://sourabhbajaj.com/mac-setup">macOS Setup Guide</a>：本指南介绍了在新 Mac 上设置开发环境的基础知识。旨在供所有人用作设置环境或安装语言&#x2F;库的指南。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://tiny-helpers.dev/">Tiny Helpers</a>：Web 开发者的工具集合。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://iep.utm.edu/">Internet Encyclopedia of Philosophy</a>：互联网哲学百科全书，有很多关于形而上的哲学论文。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://stage.so/">Stage</a>：一个设计工具。</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-weekly" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/post/weekly-09.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/weekly-09.html" itemprop="url">周刊第9期：Web 发展中的 100 个重大事件</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-04-17T00:00:00+08:00">
                2022-04-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <h2 id="本周见闻"><a href="#本周见闻" class="headerlink" title="本周见闻"></a>本周见闻</h2><h3 id="Web-发展中的-100-个重大事件"><a href="#Web-发展中的-100-个重大事件" class="headerlink" title="Web 发展中的 100 个重大事件"></a><a target="_blank" rel="noopener" href="https://developer.chrome.com/100/">Web 发展中的 100 个重大事件</a></h3><p>自 2008 年 Chrome 浏览器正式发布以来，到现在 Chrome 已经发展到第 100 个版本了，为此还开发了一个网站，该网站展示了从 2008 年 Chrome 浏览器发布以来的 100 个对于 Web 发展的重大里程碑事件，譬如 GitHub 一周年、Node.js 发布、Flexbox 提案等，有兴趣可以看看。</p>
<h3 id="我们如何失去-54K-的-GitHub-stars"><a href="#我们如何失去-54K-的-GitHub-stars" class="headerlink" title="我们如何失去 54K 的 GitHub stars"></a><a target="_blank" rel="noopener" href="https://httpie.io/blog/stardust">我们如何失去 54K 的 GitHub stars</a></h3><p>相信大家都知道 <a target="_blank" rel="noopener" href="https://github.com/httpie/httpie">httpie</a> 这个命令行工具，近日，由于维护者误操作将仓库设置为私有仓库，导致 54K 的 stars 被清零，经与 GitHub 官方沟通后，被告知无法恢复，截止今日（2022-04-17）已经重新涨回 12.7K。</p>
<p>httpie 在吐槽之余，还顺便教了一下 GitHub 做产品：</p>
<ol>
<li>UI&#x2F;UX 设计，在设置为私有仓库时，告知用户会损失哪些数据。</li>
<li>数据库的软删除设计。</li>
</ol>
<h2 id="一些-tips"><a href="#一些-tips" class="headerlink" title="一些 tips"></a>一些 tips</h2><h3 id="Chromium-的-DNS-缓存时间"><a href="#Chromium-的-DNS-缓存时间" class="headerlink" title="Chromium 的 DNS 缓存时间"></a><a target="_blank" rel="noopener" href="https://textslashplain.com/2022/03/31/chromiums-dns-cache/">Chromium 的 DNS 缓存时间</a></h3><p>Chromium 的 DNS 缓存时间大概在一分钟左右：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Default TTL for successful resolutions with ProcTask.</span></span><br><span class="line"><span class="keyword">const</span> unsigned kCacheEntryTTLSeconds = <span class="number">60</span>;</span><br></pre></td></tr></table></figure>

<p>DNS 的解析过程比较复杂，有兴趣可以看这个：<a target="_blank" rel="noopener" href="https://source.chromium.org/chromium/chromium/src/+/main:net/dns/README.md;drc=761feeebc0214d55f2cff89f5904f5521ab02610">Chrome Host Resolution</a>，或者简单看下这两张图：</p>
<p><img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images/20190822181732.png" alt="img"></p>
<p><img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images/1604181361-5a1397cca5644_articlex.png" alt="img"></p>
<p>上图源自本站一篇旧文：<a target="_blank" rel="noopener" href="https://4ark.me/post/b6c7c0a2.html">在浏览器输入 URL 回车之后发生了什么（超详细版）</a></p>
<p>如果想要查看浏览器 DNS 配置的详细信息，可以按照以下流程：</p>
<ol>
<li>打开：chrome:&#x2F;&#x2F;net-export，开始记录，打开任意一个网站发起请求，导出 JSON 文件。</li>
<li>在 <a target="_blank" rel="noopener" href="https://netlog-viewer.appspot.com/#import">NetLog Viewer</a> 导入查看，DNS 栏目。</li>
</ol>
<h3 id="ECMAScript-提案-通过复制改变数组"><a href="#ECMAScript-提案-通过复制改变数组" class="headerlink" title="ECMAScript 提案 - 通过复制改变数组"></a><a target="_blank" rel="noopener" href="https://2ality.com/2022/04/change-array-by-copy.html">ECMAScript 提案 - 通过复制改变数组</a></h3><p>这篇博客文章描述了 Robin Ricard 和 Ashley Claymore 提出的 ECMAScript 提案 <a target="_blank" rel="noopener" href="https://github.com/tc39/proposal-change-array-by-copy">“Change Array by copy”</a>。它为 Array 和 TypedArray 提出了四种新方法：</p>
<ul>
<li><code>.toReversed()</code></li>
<li><code>.toSorted()</code></li>
<li><code>.toSpliced()</code></li>
<li><code>.with()</code></li>
</ul>
<p>大多数 Array 方法是无副作用的 – 它们不会更改调用它们的数组，例如：<code>filter</code>、<code>map</code> 等。</p>
<p>但也有副作用的方法，例如：<code>reverse</code>、<code>sort</code>、<code>splice</code>。</p>
<p>因此新加入的三个方法为上述三种方法提供了无副作用版本，除此之外还引入了一个新方法：<code>with。</code></p>
<p>它是下面这段代码的无副作用版本：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">arr[index] = value</span><br><span class="line"></span><br><span class="line"><span class="comment">// 无副作用</span></span><br><span class="line">arr.<span class="title function_">with</span>(index, value) <span class="comment">// 返回一个新的 array</span></span><br></pre></td></tr></table></figure>

<h3 id="CSS-父选择器-has"><a href="#CSS-父选择器-has" class="headerlink" title="CSS 父选择器 - :has()"></a><a target="_blank" rel="noopener" href="https://ishadeed.com/article/css-has-parent-selector/">CSS 父选择器 - :has()</a></h3><p>在以前， 我们无法根据父元素是否包含某个子元素时决定父元素的样式。</p>
<p>譬如，我们希望在 <code>.card</code> 有子元素 <code>img</code> 时设置特定样式：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;a.jpg&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>card text<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们可以使用 <code>:has()</code>：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.card</span><span class="selector-pseudo">:has</span>(<span class="selector-tag">img</span>) &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实 <code>:has()</code> 不止可以用于检查父元素是否包含某个子元素，还可以检查后面的元素：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 检查 <span class="selector-tag">h2</span> 后面跟着 <span class="selector-tag">p</span></span><br><span class="line"><span class="selector-class">.card</span> <span class="selector-tag">h2</span><span class="selector-pseudo">:has</span>(+ <span class="selector-tag">p</span>) &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>但遗憾的是，截止目前（2022-04-18）只有 Safari 15.4和 Chrome Canary 支持该特性，详见 <a target="_blank" rel="noopener" href="https://caniuse.com/css-has">caniuse</a>。</p>
<h2 id="分享文章"><a href="#分享文章" class="headerlink" title="分享文章"></a>分享文章</h2><h3 id="React-18-允许组件渲染-Undefined"><a href="#React-18-允许组件渲染-Undefined" class="headerlink" title="React 18 允许组件渲染 Undefined"></a><a target="_blank" rel="noopener" href="https://blog.saeloun.com/2022/04/14/react-18-allows-components-to-render-undfined.html">React 18 允许组件渲染 Undefined</a></h3><p>在 React 18 之前，如果我们这样渲染了一个组件：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Shape.jsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Circle</span> <span class="keyword">from</span> <span class="string">&#x27;./Circle&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Square</span> <span class="keyword">from</span> <span class="string">&#x27;./Square&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Shape</span>(<span class="params">&#123;type&#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span>(type === <span class="string">&#x27;circle&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Circle</span> /&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(type === <span class="string">&#x27;square&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Square</span> /&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Shape</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//App.jsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) : <span class="title class_">ComponentType</span> &#123;</span><br><span class="line">  <span class="keyword">return</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Shape</span> <span class="attr">type</span>=<span class="string">&quot;rectangle&quot;</span>/&gt;</span></span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于 Shape 组件返回 Undefined，我们将得到以下报错信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: Shape(...): Nothing was returned from render. This usually means a <span class="built_in">return</span> statement is missing. Or, to render nothing, <span class="built_in">return</span> null.</span><br></pre></td></tr></table></figure>

<p>为了修复报错，我们必须显式返回 <code>null</code>：</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import React from &#x27;react&#x27;;</span><br><span class="line">import Circle from &#x27;./Circle&#x27;;</span><br><span class="line">import Square from &#x27;./Square&#x27;;</span><br><span class="line"></span><br><span class="line">function Shape(&#123;type&#125;) &#123;</span><br><span class="line">  if(type <span class="comment">=== &#x27;circle&#x27;) &#123;</span></span><br><span class="line">    return &lt;Circle /&gt;</span><br><span class="line">  &#125;</span><br><span class="line">  if(type <span class="comment">=== &#x27;square&#x27;) &#123;</span></span><br><span class="line">    return &lt;Square /&gt;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="addition">+ return null;</span></span><br><span class="line">&#125;</span><br><span class="line">export default Shape;</span><br></pre></td></tr></table></figure>

<p>但随着 React 18 的发布，即便组件未返回任何内容，也不会引发运行时错误。</p>
<p>基于以下三点原因，使 React 18 作出此改动：</p>
<ol>
<li><p>与其抛出错误，不如使用 Lint 工具</p>
<ul>
<li>渲染 Undefined 报错这个机制是在 2017 年加入的，当时类型系统和 Lint 工具还没开始流行，但现在我们完全可以使用 ESLint 等工具帮我们处理这些类型的错误。</li>
</ul>
</li>
<li><p>很难创建正确的类型，考虑以下代码：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Shape.jsx </span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Shape</span> = (&#123; children &#125;: <span class="title class_">ComponentType</span>): <span class="function"><span class="params">ComponentType</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> children;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//App.jsx</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>): <span class="title class_">ComponentType</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="language-xml"><span class="tag">&lt;<span class="name">Shape</span> /&gt;</span></span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们必须在 <code>ComponentType</code> 类型将 Undefined 排除在外，但更好的解决方法就是允许渲染 Undefined。</p>
</li>
<li><p>保持一致的行为</p>
<ul>
<li>因为最近 Suspense 的 fallbacks <a target="_blank" rel="noopener" href="https://github.com/reactwg/react-18/discussions/72">允许渲染 Undefined</a>，所以保持一致。</li>
</ul>
</li>
</ol>
<h3 id="JavaScript-中-RegExp-与-String-replace-的神奇特性"><a href="#JavaScript-中-RegExp-与-String-replace-的神奇特性" class="headerlink" title="JavaScript 中 RegExp 与 String.replace 的神奇特性"></a><a target="_blank" rel="noopener" href="https://blog.huli.tw/2022/04/14/javascript-string-regexp-magic/">JavaScript 中 RegExp 与 String.replace 的神奇特性</a></h3><p>下面这段代码的执行结果是什么呢？</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> regexp = <span class="regexp">/huli/g</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&#x27;blog.huli.tw&#x27;</span></span><br><span class="line"><span class="keyword">var</span> str2 = <span class="string">&#x27;example.huli.tw&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(regexp.<span class="title function_">test</span>(str)) <span class="comment">// ???</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(regexp.<span class="title function_">test</span>(str2)) <span class="comment">// ???</span></span><br></pre></td></tr></table></figure>

<p>相信很多人都会认为两个都是 true，但答案是 true 和 false，即便你写成这样，第二个输出结果也是 false：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> regexp = <span class="regexp">/huli/g</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&#x27;blog.huli.tw&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(regexp.<span class="title function_">test</span>(str)) <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(regexp.<span class="title function_">test</span>(str)) <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>这是因为 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp/test#%E5%BD%93%E8%AE%BE%E7%BD%AE%E5%85%A8%E5%B1%80%E6%A0%87%E5%BF%97%E7%9A%84%E6%AD%A3%E5%88%99%E4%BD%BF%E7%94%A8test">RegExp 是有副作用的</a>，以下为 MDN 原话：</p>
<blockquote>
<p>如果正则表达式设置了全局标志，<code>test() </code>的执行会改变正则表达式  <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/lastIndex"><code>lastIndex</code></a> 属性。连续地执行<code>test()</code>方法，后续的执行将会从 lastIndex 处开始匹配字符串，(<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp/exec"><code>exec()</code></a> 同样改变正则本身的 <code>lastIndex 属性值</code>).</p>
</blockquote>
<p>以下代码证明了这点：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> regex = <span class="regexp">/foo/g</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// regex.lastIndex is at 0</span></span><br><span class="line">regex.<span class="title function_">test</span>(<span class="string">&#x27;foo&#x27;</span>); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// regex.lastIndex is now at 3</span></span><br><span class="line">regex.<span class="title function_">test</span>(<span class="string">&#x27;foo&#x27;</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>再来看另外一段代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&#x27;4ark&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result = <span class="regexp">/\w+/</span>.<span class="title function_">test</span>(str)</span><br><span class="line"></span><br><span class="line">str = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 我们还能拿得到 str 之前的值吗？</span></span><br></pre></td></tr></table></figure>

<p>答案是可以的，因为 RegExp 上有一个神奇的属性：<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp/input#%E8%AF%AD%E6%B3%95">RegExp.input</a>。</p>
<p>除此之外，还有这些：</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/lastMatch">RegExp.lastMatch</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/lastParen">RegExp.lastParen</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/leftContext">RegExp.leftContext</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/rightContext">RegExp.rightContext</a></li>
</ol>
<p>但是需要注意，这些特性是非标准的，请尽量不要在生产环境中使用它！</p>
<p>另外原文还有关于 String.replace 的神奇特性：<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/replace#%E4%BD%BF%E7%94%A8%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BD%9C%E4%B8%BA%E5%8F%82%E6%95%B0">使用字符串作为参数</a>，简单来说就是：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> str = <span class="string">&#x27;123&#123;n&#125;456&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 123A456</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str.<span class="title function_">replace</span>(<span class="string">&#x27;&#123;n&#125;&#x27;</span>, <span class="string">&#x27;A&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 123123A456，原本 &#123;n&#125; 的地方变成 123A</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str.<span class="title function_">replace</span>(<span class="string">&#x27;&#123;n&#125;&#x27;</span>, <span class="string">&quot;$`A&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 123456A456，原本 &#123;n&#125; 的地方变成 456A</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str.<span class="title function_">replace</span>(<span class="string">&#x27;&#123;n&#125;&#x27;</span>, <span class="string">&quot;$&#x27;A&quot;</span>))</span><br></pre></td></tr></table></figure>

<h3 id="在用户离开页面时可靠地发送-HTTP-请求"><a href="#在用户离开页面时可靠地发送-HTTP-请求" class="headerlink" title="在用户离开页面时可靠地发送 HTTP 请求"></a><a target="_blank" rel="noopener" href="https://css-tricks.com/send-an-http-request-on-page-exit/">在用户离开页面时可靠地发送 HTTP 请求</a></h3><p>我们希望在用户离开当前页面时发送一个 HTTP 请求，这是一个非常常见的需求，譬如页面埋点等。</p>
<p>但根据 <a target="_blank" rel="noopener" href="https://developer.chrome.com/blog/page-lifecycle-api/">Chrome 页面的生命周期</a>显示，在页面终止运行时，无法保证进程内的请求会成功，因此，在离开页面时发送请求可能并不可靠，如果我们依赖这个行为，则会出现潜在的重大问题。</p>
<p>通过下图可看出在页面离开时，请求会被取消掉：</p>
<p><img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images202204181217957.gif" alt="在“网络”选项卡中查看 HTTP 请求失败"></p>
<p>为什么请求会被取消呢？下面是 Chrome 对于页面终止生命周期（Terminated）的描述：</p>
<blockquote>
<p>A page is in the <em>terminated</em> state once it has started being unloaded and cleared from memory by the browser. No <a target="_blank" rel="noopener" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">new tasks</a> can start in this state, and in-progress tasks may be killed if they run too long.</p>
<p><strong>Possible previous states:</strong><br><a target="_blank" rel="noopener" href="https://developer.chrome.com/blog/page-lifecycle-api/#state-hidden">hidden</a> <em>(via the <a target="_blank" rel="noopener" href="https://developer.chrome.com/blog/page-lifecycle-api/#event-pagehide"><code>pagehide</code></a> event)</em></p>
<p><strong>Possible next states:</strong><br>NONE</p>
</blockquote>
<p>简单来说就是一个页面被卸载并从内存清除时，它就处于终止状态，在这种状态下，没有新的任务可以启动，正在运行的任务如果运行时间过长，则有可能会被 killed 掉。</p>
<p>那我们应该如何解决这个问题呢？有下面几种方案：</p>
<ol>
<li>阻塞页面跳转，直到请求被响应：</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;link&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">async</span> (e) =&gt; &#123;</span><br><span class="line">  e.<span class="title function_">preventDefault</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Wait for response to come back...</span></span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;/log&quot;</span>, &#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">    <span class="attr">headers</span>: &#123;</span><br><span class="line">      <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="attr">body</span>: <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;</span><br><span class="line">      <span class="attr">some</span>: <span class="string">&#x27;data&#x27;</span></span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...and THEN navigate away.</span></span><br><span class="line">   <span class="variable language_">window</span>.<span class="property">location</span> = e.<span class="property">target</span>.<span class="property">href</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>但这样也有很明显的缺点，1）损害用户体验；2）没有包含所有页面离开行为，例如关闭浏览器 tab。</p>
<ol start="2">
<li>使用 Fetch 的 <a target="_blank" rel="noopener" href="https://fetch.spec.whatwg.org/#request-keepalive-flag">keepalive</a> 选项，使请求继续保留，即便页面已终止。</li>
</ol>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;/some-other-page&quot; id=&quot;link&quot;&gt;Go to Page&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  document.getElementById(&#x27;link&#x27;).addEventListener(&#x27;click&#x27;, (e) =&gt; &#123;</span><br><span class="line">    fetch(&quot;/log&quot;, &#123;</span><br><span class="line">      method: &quot;POST&quot;,</span><br><span class="line">      headers: &#123;</span><br><span class="line">        &quot;Content-Type&quot;: &quot;application/json&quot;</span><br><span class="line">      &#125;, </span><br><span class="line">      body: JSON.stringify(&#123;</span><br><span class="line">        some: &quot;data&quot;</span><br><span class="line">      &#125;), </span><br><span class="line"><span class="addition">+     keepalive: true</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>使用 <a target="_blank" rel="noopener" href="https://w3c.github.io/beacon/#sendbeacon-method">Navigator.sendBeacon()</a> 方法</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/some-other-page&quot;</span> <span class="attr">id</span>=<span class="string">&quot;link&quot;</span>&gt;</span>Go to Page<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;link&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> blob = <span class="keyword">new</span> <span class="title class_">Blob</span>([<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">some</span>: <span class="string">&quot;data&quot;</span> &#125;)], &#123; <span class="attr">type</span>: <span class="string">&#x27;application/json; charset=UTF-8&#x27;</span> &#125;);</span></span><br><span class="line"><span class="language-javascript">    navigator.<span class="title function_">sendBeacon</span>(<span class="string">&#x27;/log&#x27;</span>, blob));</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>使用 a 标签的 <a target="_blank" rel="noopener" href="https://css-tricks.com/the-ping-attribute-on-anchor-links/">ping 属性</a></li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://localhost:3000/other&quot;</span> <span class="attr">ping</span>=<span class="string">&quot;http://localhost:3000/log&quot;</span>&gt;</span></span><br><span class="line">  Go to Other Page</span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>点击该链接后，它会自动发出一个 POST 请求，并将 href 属性放在请求头中：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">headers<span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  &#x27;ping-from&#x27;<span class="punctuation">:</span> &#x27;http<span class="punctuation">:</span><span class="comment">//localhost:3000/&#x27;,</span></span><br><span class="line">  &#x27;ping-to&#x27;<span class="punctuation">:</span> &#x27;http<span class="punctuation">:</span><span class="comment">//localhost:3000/other&#x27;</span></span><br><span class="line">  &#x27;content-type&#x27;<span class="punctuation">:</span> &#x27;text/ping&#x27;</span><br><span class="line">  <span class="comment">// ...other headers</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>

<p>但有如下限制：</p>
<ol>
<li>只能在 a 标签上使用</li>
<li>浏览器支持很好，但 Firefox 除外 :(</li>
<li>无法自定义发送的数据…</li>
</ol>
<p>如果选择使用哪个方法呢？文中还给出了一个很好的提示：</p>
<ul>
<li>以下情况，推荐使用 fetch + keepalive<ul>
<li>需要自定义 header 和请求内容</li>
<li>希望发出 GET，而不只是 POST</li>
<li>需要支持较旧的浏览器，并且已有 fetch 的 polyfill。</li>
</ul>
</li>
<li>以下情况，推荐使用 <code>sendBeacon()</code><ul>
<li>只是简单的请求，不需要太多的自定义内容</li>
<li>喜欢更干净、更优雅的 API。</li>
<li>您希望保证您的请求不会与应用程序中发送的其它高优先级的请求竞争。</li>
</ul>
</li>
</ul>
<h2 id="有趣的链接"><a href="#有趣的链接" class="headerlink" title="有趣的链接"></a>有趣的链接</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/Troland/how-javascript-works">Troland&#x2F;how-javascript-works</a>：本文是翻译介绍 JavaScript 的工作原理的，该系列原文还在更新中，原文见<a target="_blank" rel="noopener" href="https://blog.sessionstack.com/tagged/tutorial">这里</a>。此为<a target="_blank" rel="noopener" href="https://xcoder.in/">死月</a>翻译的中文版。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://webaim.org/projects/million/">The WebAIM Million</a> ：2022年关于前 100 万个主页的可访问性报告。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://turborepo.org/">Turborepo</a>：Turborepo 是一个针对 JavaScript 和 TypeScript 代码库的高性能构建系统。</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2022/04/16/2022-4-16-4399games/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/04/16/2022-4-16-4399games/" itemprop="url">怀旧！电脑上怎么玩4399小游戏？</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-04-16T20:58:00+08:00">
                2022-04-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <p>Hello 各位晚上好。  </p>
<p>去年写过一篇<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzAxMjY0NTY5OA==&mid=2649905749&idx=1&sn=6188e9922f00e6f9994b43ee8e2e4bab&chksm=83a85e78b4dfd76eb9ceda175d69fabef5dfcdb9a538bc89ce2ed05a60c1c6d31730051b6ad8&token=1621633249&lang=zh_CN#rd">关于 Flash 停用的文章</a>，介绍了 4 种应对 Flash 停用的方法，其中介绍了一个浏览器插件 Ruffle。  </p>
<p>今天想来纠正一下，即便是安装了 Ruffle 插件，在用到 Flash 技术的网页游戏页面，例如 4399 小游戏，还是会无法正常加载，导致玩不了游戏。    </p>
<p><img src="https://article-picbed-1302715071.cos.ap-guangzhou.myqcloud.com/2022/04/16/16501096533005.jpg"></p>
<p>对于这个问题，我找到了两个解决方法，希望能帮到想玩网页小游戏的朋友。  </p>
<h2 id="换用另一个在线游戏网站"><a href="#换用另一个在线游戏网站" class="headerlink" title="换用另一个在线游戏网站"></a>换用另一个在线游戏网站</h2><p>yikm：一个提供了多款小霸王游戏的在线网站，例如超级玛丽、坦克大战、魂斗罗、雪人兄弟、冒险岛、双截龙、拳皇系列等。   </p>
<p>在这个网站，我试着搜了一下 4399 有的「死神VS火影」，结果还真有，它提供了两个版本——1.0 和 2.0。  </p>
<p>这两个版本的死神VS火影应该是用 H5 重制过了，不需要用到 Flash，所以在没装 Flash 插件的 Chrome 浏览器上可以正常运行。   </p>
<p>听到 死神VS火影1.0 开头的那段背景音乐，真的非常亲切，想起了 N 多年以前和我的老表第一次玩这个游戏的场景。     </p>
<p><img src="https://article-picbed-1302715071.cos.ap-guangzhou.myqcloud.com/2022/04/16/16501112854630.jpg"></p>
<p>yikm 网址：<br><a target="_blank" rel="noopener" href="https://www.yikm.net/">https://www.yikm.net/</a>     </p>
<h2 id="360-极速浏览器"><a href="#360-极速浏览器" class="headerlink" title="360 极速浏览器"></a>360 极速浏览器</h2><p>yikm 里面比较多的是小霸王上的游戏，如果你在里面没有搜到 4399 上面有的游戏，那还是要回到 4399 上面去玩。   </p>
<p>这时候就要安装另外一个浏览器——360 极速浏览器，这个浏览器内置了 Flash 插件，因此打开 4399 就可以直接开始游戏了。  </p>
<p>虽然不推荐把 360 极速浏览器作为主力的浏览器，但是我们可以用它来打开需要用到 Flash 技术的网站，无论是这里说到的 4399，还是其他比较古老的网站，至少它可以让你远离中国特供版的 Flash。  </p>
<h2 id="欢迎关注"><a href="#欢迎关注" class="headerlink" title="欢迎关注"></a>欢迎关注</h2><p>以上，就是本次想和你分享的内容，希望能够对你有一点帮助。     </p>
<p><img src="https://article-picbed-1302715071.cos.ap-guangzhou.myqcloud.com/2021/05/28/gong-zhong-hao-wei-bu-er-wei-ma-dailogo.png" alt="公众号：效率工具指南">     </p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2022/04/15/2022-04-15-the-thinking-of-value/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/04/15/2022-04-15-the-thinking-of-value/" itemprop="url">价值的思考</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-04-15T22:01:29+08:00">
                2022-04-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/summary/" itemprop="url" rel="index">
                    <span itemprop="name">summary</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <p>我最近对于价值有了一些思考，分享给大家。</p>
<p>这个世界的经济运行，是建立在对于价值认可的基础上的。比如：我们去餐厅吃饭，一定是我们认为这份餐给我们带来的价值，大于我们付出的钱，我们才会做出购买的行为。</p>
<h2 id="一、价值的来源"><a href="#一、价值的来源" class="headerlink" title="一、价值的来源"></a>一、价值的来源</h2><p>价值来源于哪里呢？</p>
<p>价值来源于人们的各种需求，包括：马斯洛提到的各种需求：性，安全，食物，社交，自我实现，自由。</p>
<p>价值也来源于人们追求更好，更丰富的生活，比如住更大的房子，吃更好吃的东西，享受更好的服务。</p>
<p>价值也来源于效率的提升。比如原来生产某个东西很慢，但是上了机器，生产变更快了。</p>
<h2 id="二、人和公司的存活"><a href="#二、人和公司的存活" class="headerlink" title="二、人和公司的存活"></a>二、人和公司的存活</h2><p>因为人和公司的存活，需要消耗一些价值，比如人的消费就是消耗别人创造的价值。公司付出的各种人力成本，生产成本，就是消耗别人创造的价值。</p>
<p>所以，他们需要创造出更高的价值，才可以通过价值交换，换得自己需要的东西。为了方便交换和标定价值，所以我们有了钱。</p>
<p>于是人和公司，都通过交换将自己创造的价值换成钱，再拿钱换别人创造的东西。</p>
<h2 id="三、价值的衡量"><a href="#三、价值的衡量" class="headerlink" title="三、价值的衡量"></a>三、价值的衡量</h2><p>为了衡量人，公司以及国家在创造价值上的差异，我们有了各种指标。</p>
<ul>
<li>对于国家来说，GDP 就是国家产生的价值。</li>
<li>对于公司来说，营业额就是它产生的价值。</li>
<li>对于个人来说，他为公司的营业额做出的贡献，就是他的价值。</li>
</ul>
<p>拆分到每个人的贡献不太好衡量，但是一个业务的人均销售额，就是一个重要指标来衡量公司的人力投入效率。</p>
<p>我有一个朋友，他说他的公司人均能做到 500 万的营业额，就表示每个人创建了 500 万的价值。当然，这里面有很多价值是来源于产品的原材料本身，增值的部分才是每个人真正贡献的价值。</p>
<h2 id="四、工作中的价值视角"><a href="#四、工作中的价值视角" class="headerlink" title="四、工作中的价值视角"></a>四、工作中的价值视角</h2><p>有人说：为什么公司不给我涨薪，为什么公司要裁员，为什么不给我更多机会，我感觉他们的想法都不对。他应该想：我应该如何为公司创造价值，怎么样可以创造更多的价值。或者说，如果我在这家公司无法创造出足够多价值，我是否应该换一个公司。</p>
<p>因为公司的钱不是白白变出来的，公司的钱也是通过价值交换挣来的，如果员工不能创造更多的价值，那他就不能获得更多的回报。</p>
<p>从价值视角，也可以感受到公司从产品研发到市场推广过程中，不同岗位对于公司价值的贡献变化。</p>
<ul>
<li>在产品研发期，产品创新是在试图解决用户需求，创造巨大的价值。</li>
<li>而产品研发完成后，市场和销售部门又在从用户获取角度，给公司创造巨大的价值。</li>
</ul>
<p>价值创造角度的思考，也是一种合作共赢的思维。因为只有你为别人带来了收益，别人才会给你带来收益。</p>
<h2 id="五、个人成长中的价值视角"><a href="#五、个人成长中的价值视角" class="headerlink" title="五、个人成长中的价值视角"></a>五、个人成长中的价值视角</h2><p>在提升个人技能的时候，也需要时刻思考：自己的技能在价值贡献中的作用。</p>
<ul>
<li>比如：如果你是一个管理者，那么提升你的组织能力价值就很大，因为你可以将团队的贡献通过你的能力扩大。</li>
<li>比如：如果你是一个产品经理，那么你的价值就是通过迭代使产品本身的价值提升。例如用户 NPS 值，复购率，留存率等核心指标。</li>
<li>比如：如果你是一个程序员，那么你的价值也是应该体现在用技术提升产品的价值。比如实现产品功能，减少崩溃率，减少加载时间等等。</li>
</ul>
<p>如果你提升了一项能力，但是最终没有转化为公司产品的价值，那就没什么卵用。比如你是个运营岗位，抽空学了个编程，但是工作中没有用上，那就没价值。但是你如果通过编程，优化了运营岗位的一些工作，那就是有价值的。</p>
<h2 id="六、结语"><a href="#六、结语" class="headerlink" title="六、结语"></a>六、结语</h2><p>所以，不管是个人，公司还是国家都应该努力提升自己的价值，只有这样才能保持竞争优势，获得足够回报。</p>
<p>以上。</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-weekly" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/post/weekly-08.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/weekly-08.html" itemprop="url">周刊第8期：阅读 ECMAScript 规范</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-04-11T00:00:00+08:00">
                2022-04-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <h2 id="阅读-ECMAScript-规范"><a href="#阅读-ECMAScript-规范" class="headerlink" title="阅读 ECMAScript 规范"></a>阅读 ECMAScript 规范</h2><p>有必要先向部分初学者解释一下 JavaScript 和 ECMAScript 的区别，最开始 ECMA 仅是 European Computer Manufacturers Association （欧洲计算机制造商协会）的首字母缩写，不过随着计算机的国际化，组织的标准牵涉到很多其他国家，因此这个组织已经改名为 Ecma 国际，所以现在的 Ecma 本身就是一个名字，不再是首字母缩写。</p>
<p>ECMAScript 与 JavaScript 其实就是同一个东西，只是因为 JavaScript 这个名称已经被 Sun 公司注册了商标，并且不开放给 Ecma 协会使用，所以 JavaScript 的标准只能叫做 ECMAScript，而 JavaScript 可以看做是 ECMAScript 规范的一种实现。</p>
<p>我们为什么要学习阅读 ECMAScript 规范呢？如果你只是一名 JavaScript 的初学者，你确实没有太大的必要去阅读 ECMAScript 规范，只需要通过阅读 MDN 文档就能学习如何编写 JavaScript，但随着 JavaScript 水平的提升，我们会越来越不满足于使用，我们会想要知道更多内部的细节，然而并不是所有的 JavaScript 细节都会在 MDN 文档上说明。</p>
<p>下面我就举个在工作中真实遇到的场景，以此阐述我们为什么需要阅读 ECMAScript 规范。</p>
<p>考虑以下代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="number">300</span>: <span class="number">300</span>,</span><br><span class="line">  <span class="number">100</span>: <span class="number">100</span>,</span><br><span class="line">  <span class="number">200</span>: <span class="number">200</span>,</span><br><span class="line">  <span class="number">50.5</span>: <span class="number">50.5</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(obj[key])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>你觉得这段代码的输出顺序是什么呢？答案是：<code>100,200,300,50.5</code>。</p>
<p>这是为什么呢？</p>
<p>从 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/for...in">for…in</a> 的 MDN 文档中，无法得到我们想要的答案，这时候就只能通过阅读 ECMAScript 规范：</p>
<p> <img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images202204080105185.png" alt="image-20220408010524823"></p>
<p>通过以上信息我们得知，JavaScript 在遍历一个对象的时候，它将按照如下规则执行：</p>
<ol>
<li>创建一个空的列表用于存放 keys</li>
<li>将所有<strong>合法的数组索引</strong>按升序的顺序存入</li>
<li>将所有<strong>字符串类型索引</strong>按属性创建时间以升序的顺序存入</li>
<li>将所有 <strong><code>Symbol</code> 类型索引</strong>按属性创建时间以升序的顺序存入</li>
<li>返回 keys</li>
</ol>
<p>PS：当然 for…in 是不会返回 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol">Symbol</a> 类型的属性的，需要使用 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertySymbols">Object.getOwnPropertySymbols()</a>。</p>
<p>以上源自我遇到的一个真实案例，详见<a target="_blank" rel="noopener" href="https://4ark.me/post/how-object-keys-work.html">《一行 Object.keys() 引发的血案》</a>。</p>
<p>相信大家都已经非常清楚学习阅读 ECMAScript 规范的重要性，可 ECMAScript 规范也不是这么容易阅读的，所以这里提供了一些文章，帮助你快速学习阅读 ECMAScript 规范：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://timothygu.me/es-howto/#example-string-prototype-substring">How to Read the ECMAScript Specification</a></li>
<li><a target="_blank" rel="noopener" href="https://v8.dev/blog/tags/understanding-ecmascript">Understanding the ECMAScript spec</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.huli.tw/2022/01/30/how-to-validate-javascript-knowledge/">你知道的 JavaScript 知識都有可能是錯的</a></li>
</ul>
<p>总之，与本文一样带着问题去阅读，往往能够事半功倍。</p>
<h2 id="《编程语言的设计与实现》——-松本行弘"><a href="#《编程语言的设计与实现》——-松本行弘" class="headerlink" title="《编程语言的设计与实现》—— 松本行弘"></a>《编程语言的设计与实现》—— 松本行弘</h2><p>此书是 Ruby 语言的创造者 —— 松本行宏在《日经Linux》杂志上的连载整合而成，主要介绍了新语言 Streem 的设计与实现过程。作者从设计 Streem 这门新语言的动机开始讲起，由浅入深，详细介绍了新语言开发中的各个环节，以及语言设计上的纠结与取舍，其中也不乏对其他编程语言的调查与思考，向读者展示了创建编程语言的乐趣。</p>
<p>笔者现在刚看完第二章，不过也可以谈谈我的阅读感悟：作为一名野生前端，我对编译原理可谓是一窍不通，顶多也就写个 Babel 小玩具的水平，像《编译原理》这种专业书，我是连前十页都啃不下去，好在日系书籍有一个很大的特点就是：<strong>浅显易懂</strong>，此书也不例外，在前两章就带领读者如何通过 lex 进行词法解析，然后通过 yacc 进行语法解析，这过程还会将编译原理中的一些知识带出来，譬如 BNF（巴科斯范式）、窥孔优化等。</p>
<p>除了编译原理以外，我们还可以通过本书学习如何站在语言设计者的角度去思考语言的特性，为什么要这么设计，从而使我们的视野更加开阔，所以建议每一位开发者都阅读本书（对我这种野生程序员尤为重要）。</p>
<h2 id="本周见闻"><a href="#本周见闻" class="headerlink" title="本周见闻"></a>本周见闻</h2><h3 id="CSS-属性使用次数排行榜"><a href="#CSS-属性使用次数排行榜" class="headerlink" title="CSS 属性使用次数排行榜"></a><a target="_blank" rel="noopener" href="https://chromestatus.com/metrics/css/popularity">CSS 属性使用次数排行榜</a></h3><p>Chrome 使用<a target="_blank" rel="noopener" href="https://source.chromium.org/chromium/chromium/src/+/main:tools/metrics/histograms/enums.xml">匿名使用统计数据</a>计算每个在 Chrome 浏览器加载的页面中 CSS 属性出现的次数，数据的实时性大概在 24 小时之内。</p>
<p>以下截取部分排名靠前的 CSS 属性：</p>
<p><img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images202204080001598.png" alt="image-20220408000057438"></p>
<h2 id="一些-tips"><a href="#一些-tips" class="headerlink" title="一些 tips"></a>一些 tips</h2><h3 id="为什么-HTTP-301-后会把-POST-转为-GET？"><a href="#为什么-HTTP-301-后会把-POST-转为-GET？" class="headerlink" title="为什么 HTTP 301 后会把 POST 转为 GET？"></a><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/HTTP_301">为什么 HTTP 301 后会把 POST 转为 GET？</a></h3><p>根据 <a target="_blank" rel="noopener" href="https://datatracker.ietf.org/doc/html/rfc7231#section-6.4.2">RFC 7231, section 6.4.2: 301 永久重定向</a> 指出：</p>
<blockquote>
<p>Note: For historical reasons, a user agent MAY change the request<br> method from POST to GET for the subsequent request.  If this<br> behavior is undesired, the 307 (Temporary Redirect) status code<br> can be used instead.</p>
</blockquote>
<p>简而言之就是因为历史原因，当某些 HTTP&#x2F;1.0 客户端收到该状态码时，可能会将 POST 方法改为 GET 方法，继续向新地址发出请求，这是错误的实现——故而后续标准引入了 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/HTTP_307">HTTP 307</a>。</p>
<p>所以最好只在 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/GET"><code>GET</code></a> 或 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/HEAD"><code>HEAD</code></a> 方法时使用 301，其他情况使用 307 或者 308 来替代 301。</p>
<h3 id="JavaScript-的数字安全范围"><a href="#JavaScript-的数字安全范围" class="headerlink" title="JavaScript 的数字安全范围"></a><a target="_blank" rel="noopener" href="https://blog.huli.tw/2022/03/14/javascript-number/">JavaScript 的数字安全范围</a></h3><p>你会如何解释这段代码：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">9007199254740992</span> === <span class="number">9007199254740993</span> <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>我们知道 JavaScript 的数字是用 64 bit 來存，而且遵循的规格是 IEEE 754-2019，既然用 64 bit 来存，那可以表示的数字自然是有限的。</p>
<p>我们可以用 <code>Number.MAX_SAFE_INTEGER</code> 表示 JavaScript 最大正整数的安全范围，也就是 <code>2^53 - 1</code> &#x3D; <code>9007199254740991</code>。</p>
<p>这里所说的安全指的是：<strong>能够准确区分两个不相同的值</strong>，例如 <code>Number.MAX_SAFE_INTEGER + 1 === Number.MAX_SAFE_INTEGER + 2</code> 这在 JavaScript 上是成立的，但它在数学上是错误的，我们可以使用 <code>Number.isSafeInteger()</code> 来判断一个数字是否是一个「安全整数」。</p>
<p>需要注意的是，最大的安全范围不代表 JavaScript 只能存储 <code>Number.MAX_SAFE_INTEGER</code> 这么大的数字，其实我们最大可以存储 <code>Number.MAX_VALUE</code> 也就是 1.7976931348623157e+308 ，只是它不在安全范围之内罢了。</p>
<p>总之，对于一些比较大的数字（譬如 uuid 这类），优先考虑是否使用 String 类型，如果一定要数字类型，可以了解下 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/BigInt">BigInt</a>。</p>
<h3 id="为什么「Enter键」要被翻译为「回车键」？"><a href="#为什么「Enter键」要被翻译为「回车键」？" class="headerlink" title="为什么「Enter键」要被翻译为「回车键」？"></a><a target="_blank" rel="noopener" href="https://haohailong.net/2012/why-enter-key-is-huiche-in-chinese">为什么「Enter键」要被翻译为「回车键」？</a></h3><p>其实「回车」并不是 “Enter” 的翻译，而是 “return” 的翻译。这个 return 其实指的是 “↵+Enter” 中箭头的意思，换言之，Enter 并不是“↵”的一个解释，严格讲 “Enter” 和“↵”是这个键的两种不同的名称，也即两个不同的用途。</p>
<p>之所以会被翻译成「回车」，是因为现代电脑键盘是从过去的打字机上继承过来的，在过去的机械打字机上有个部件叫「字车」，每打一个字符，字车前进一格，打完一行后，我们需要让字车回到起始位置，而 “Return” 键最早就是这个作用，因此被翻译为「回车」。</p>
<p>有兴趣可以看看这个视频：</p>
<iframe src="//player.bilibili.com/player.html?aid=591562931&bvid=BV1uq4y1k7EM&cid=440002269&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>

<h2 id="分享文章"><a href="#分享文章" class="headerlink" title="分享文章"></a>分享文章</h2><h3 id="DeepL-Api-设计中的欺骗战术"><a href="#DeepL-Api-设计中的欺骗战术" class="headerlink" title="DeepL Api 设计中的欺骗战术"></a><a target="_blank" rel="noopener" href="https://zu1k.com/posts/thinking/deception-tactics-in-deepl-api-design/">DeepL Api 设计中的欺骗战术</a></h3><p>本文作者通过逆向 DeepL 的 Windows 客户端（C#），破解了 DeepL 如何实现接口防滥用。</p>
<p>直接说结论，其实 DeepL 并没有使用一些常规的方法（譬如 token、签名等）去实现接口防滥用，而是通过两个非常取巧的方法去把开发者绕晕：</p>
<ol>
<li>timestamp 参数并不是一个真实的时间戳，而是通过时间戳和源文本的长度进行伪造的，公式是：<code>ts - ts % i_count + i_count</code>，由于与真实的时间戳仅有毫秒部分的差别，一般人无法直接看出端倪。</li>
<li>id 参数就是一个随机数，只不过后续的请求会在此基础上 + 1，并且这个 id 会决定文本中一个小小的、微不足道的空格。但由于我们通过拿到结果后都会先对 JSON 进行一下格式化，所以很容易忽略这种细节。</li>
</ol>
<p>如果不是逆向源代码，相信一般人很难发现这两点细节，不得不感叹 DeepL 工程师的脑洞。</p>
<h3 id="Cloudflare-如何将网站加载时间缩短-30"><a href="#Cloudflare-如何将网站加载时间缩短-30" class="headerlink" title="Cloudflare 如何将网站加载时间缩短 30%"></a><a target="_blank" rel="noopener" href="https://blog.cloudflare.com/early-hints/">Cloudflare 如何将网站加载时间缩短 30%</a></h3><p>本文介绍 Cloudflare 在 2021 年发布的一个新特性：Early Hints，准确来说它是一个 <a target="_blank" rel="noopener" href="https://httpwg.org/specs/rfc8297.html">Web 标准</a>，它定义了一个新的状态码 103。</p>
<p>其最核心的功能是：在服务器响应 200 时，先向客户端响应 103，其响应内容包含这个网页所需呈现内容的资源提示，客户端可利用此提示加载页面速度，如下图：</p>
<p><img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images202204111949351.png" alt="img"></p>
<p>在上面提到的 <a target="_blank" rel="noopener" href="https://httpwg.org/specs/rfc8297.html">RFC</a> 中可看到 HTTP 103 的响应大概长这样（其中可能会有多个 103 响应）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Client request:</span><br><span class="line"></span><br><span class="line">  GET / HTTP/1.1</span><br><span class="line">  Host: example.com</span><br><span class="line"></span><br><span class="line">Server response:</span><br><span class="line"></span><br><span class="line">  HTTP/1.1 103 Early Hints</span><br><span class="line">  Link: &lt;/style.css&gt;; rel=preload; as=style</span><br><span class="line">  Link: &lt;/script.js&gt;; rel=preload; as=script</span><br><span class="line"></span><br><span class="line">  HTTP/1.1 200 OK</span><br><span class="line">  Date: Fri, 26 May 2017 10:02:11 GMT</span><br><span class="line">  Content-Length: 1234</span><br><span class="line">  Content-Type: text/html; charset=utf-8</span><br><span class="line">  Link: &lt;/style.css&gt;; rel=preload; as=style</span><br><span class="line">  Link: &lt;/script.js&gt;; rel=preload; as=script</span><br><span class="line"></span><br><span class="line">  &lt;!doctype html&gt;</span><br><span class="line">  [... rest of the response body is omitted from the example ...]</span><br></pre></td></tr></table></figure>

<p>我们可以在 Chrome 94 及更新版本使用该特性，关于更多内容可见：<a target="_blank" rel="noopener" href="https://blog.cloudflare.com/early-hints/">early-hints</a>。</p>
<h2 id="有趣的链接"><a href="#有趣的链接" class="headerlink" title="有趣的链接"></a>有趣的链接</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://cn.history.js.org/index.html">JavaScript 二十年</a>：这本书纪录了从 1995 年到 2015 年这二十年的 JavaScript 历史，看完它会对 JavaScript 有不同的体会（还会知道很多冷知识），此为中译版，原版地址：<a target="_blank" rel="noopener" href="http://wirfs-brock.com/allen/posts/866">JavaScript: The First 20 Years</a>。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/mozilla-spidermonkey/jsparagus/blob/master/js-quirks.md#readme">js-quirks</a>：关于 JavaScript 的一些怪癖语法说明，对于想要实现 JavaScript 解析器的同学很有帮助和启发。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://moonvy.com/">Moonvy 月维</a>：探索「设计生产力」之道，与你一起， 创造设计师与开发者的必备工具。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://quokkajs.com/">QUOKKA</a>：<em>Quokka</em> 是一个调试工具，可以为您正在编写的代码提供实时反馈（可惜大部分功能都要收费。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.iconfinder.com/p/free-ukraine-icons">Free Ukraine icons</a>：一些与乌克兰战争有关的免费 icon 图标。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://express.adobe.com/zh-Hans-CN/sp/">Adobe Creative Cloud Express</a>：Adobe 新推出的一个设计工具，可提供快速「去除背景」、「转换为 GIF」、「合并 PDF」以及更多高级操作。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://uxtools.co/challenges">UX Design Challenges | UX Tools</a>：一些 UX 的挑战，帮助你学习如何提高产品的用户体验。</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-weekly" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/post/weekly-07.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/weekly-07.html" itemprop="url">周刊第7期：使用新的周刊模板</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-04-04T00:00:00+08:00">
                2022-04-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <h2 id="使用新的周刊模板"><a href="#使用新的周刊模板" class="headerlink" title="使用新的周刊模板"></a>使用新的周刊模板</h2><p>在本期开始采用新的周刊模板，新增了两个模块：</p>
<ul>
<li>本周见闻：一些有趣的事情、观点，与「分享文章」最大的区别在于它们通常是一些比较简短的信息。</li>
<li>tips：一些有用的技巧，可以帮助你提高工作效率。</li>
</ul>
<p>如此，周刊内容就显得更加丰富，可以分享更多元的信息了。</p>
<h2 id="本周见闻"><a href="#本周见闻" class="headerlink" title="本周见闻"></a>本周见闻</h2><h3 id="React-v18-正式发布"><a href="#React-v18-正式发布" class="headerlink" title="React v18 正式发布"></a><a target="_blank" rel="noopener" href="https://reactjs.org/blog/2022/03/29/react-v18.html">React v18 正式发布</a></h3><ol>
<li><p><strong>自动批处理</strong></p>
<p>批处理是指 React 将多个状态更新合并到单个 re-render 中以获得更好的性能。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在之前: 只有 React 事件是批处理的。</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">setCount</span>(<span class="function"><span class="params">c</span> =&gt;</span> c + <span class="number">1</span>);</span><br><span class="line">  <span class="title function_">setFlag</span>(<span class="function"><span class="params">f</span> =&gt;</span> !f);</span><br><span class="line">  <span class="comment">// React 将渲染两次，每次状态更新一次（没有批处理的情况）</span></span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在之后: setTimeout、Promise、原生事件这类异步操作都将合并到一次 re-render 中。</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">setCount</span>(<span class="function"><span class="params">c</span> =&gt;</span> c + <span class="number">1</span>);</span><br><span class="line">  <span class="title function_">setFlag</span>(<span class="function"><span class="params">f</span> =&gt;</span> !f);</span><br><span class="line">  <span class="comment">// React 只会在最后重新渲染一次（这就是批处理！）</span></span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<p>了解更多：<a target="_blank" rel="noopener" href="https://github.com/reactwg/react-18/discussions/21">https://github.com/reactwg/react-18/discussions/21</a></p>
</li>
<li><p><strong>Transitions</strong></p>
<p>这是 React 中的一个新概念，用于区分紧急和非紧急更新（过渡更新）。</p>
<ul>
<li><strong>紧急更新</strong>：反映了直接交互，如输入、单击、按下等。</li>
<li><strong>过渡更新</strong>：将 UI 从一个视图转换为另一个视图。</li>
</ul>
<p>通常，为了获得最佳用户体验，单个用户输入应同时导致紧急更新和非紧急更新。您可以在输入事件中使用 startTransition API 来通知 React 哪些更新是紧急的，哪些是过渡的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;startTransition&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 紧急，显示输入的内容</span></span><br><span class="line"><span class="title function_">setInputValue</span>(input);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将内部的任何状态更新标记为转换</span></span><br><span class="line"><span class="title function_">startTransition</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 过渡：显示结果</span></span><br><span class="line">  <span class="title function_">setSearchQuery</span>(input);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>startTransition 中包含的更新操作都将作为过渡更新进行处理，如果出现更紧急的更新，则会打断之前的过渡更新，只渲染最新的。</p>
<p>了解更多：<a target="_blank" rel="noopener" href="https://reactjs.org/docs/react-api.html#transitions">https://reactjs.org/docs/react-api.html#transitions</a></p>
</li>
<li><p><strong>Hooks</strong></p>
<ol>
<li><a target="_blank" rel="noopener" href="https://reactjs.org/docs/hooks-reference.html#useid">useId</a>：用于在客户端和服务器上生成唯一 ID</li>
<li><a target="_blank" rel="noopener" href="https://reactjs.org/docs/hooks-reference.html#usetransition">useTransition</a>：标记为过渡性更新。</li>
<li><a target="_blank" rel="noopener" href="https://reactjs.org/docs/hooks-reference.html#usedeferredvalue">useDeferredValue</a>：允许您延迟重新渲染树的非紧急部分，类似于防抖。</li>
<li><a target="_blank" rel="noopener" href="https://reactjs.org/docs/hooks-reference.html#usesyncexternalstore">useSyncExternalStore</a>：允许外部存储通过强制对存储的更新为同步来支持并发读取。</li>
<li><a target="_blank" rel="noopener" href="https://reactjs.org/docs/hooks-reference.html#useinsertioneffect">useInsertionEffect</a>：允许 CSS-in-JS 库解决在渲染中注入样式的性能问题。</li>
</ol>
</li>
</ol>
<p>关于 React v18 更多新功能请查看：<a target="_blank" rel="noopener" href="https://reactjs.org/blog/2022/03/29/react-v18.html">React v18.0 – React Blog </a></p>
<h3 id="CSS-新提案-共享元素转场效果"><a href="#CSS-新提案-共享元素转场效果" class="headerlink" title="CSS 新提案 - 共享元素转场效果"></a><a target="_blank" rel="noopener" href="https://github.com/WICG/shared-element-transitions/blob/main/explainer.md">CSS 新提案 - 共享元素转场效果</a></h3><p>CSS 的一个新提案，为切换页面提供平滑加载动画，无论是 SPA 还是 MPA 都适用，效果如下：</p>
<p><video src="https://user-images.githubusercontent.com/93594/141100217-ba1fa157-cd79-4a9d-b3b4-67484d3c7dbf.mp4" controls auto-play="true" ></video></p>
<p>关于更多可了解：<a target="_blank" rel="noopener" href="https://github.com/WICG/shared-element-transitions/blob/main/explainer.md">shared-element-transitions&#x2F;explainer.md</a></p>
<h3 id="尊重用户的默认字体大小"><a href="#尊重用户的默认字体大小" class="headerlink" title="尊重用户的默认字体大小"></a><a target="_blank" rel="noopener" href="https://www.huy.rocks/everyday/03-27-2022-typography-respect-user-s-default-font-size">尊重用户的默认字体大小</a></h3><p>在处理文本和 CSS 时，我们通常都会默认设置一个固定的字体大小：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这在大部分 WEB 网站都没有问题，但是对于内容网站（如新闻网站、论坛、博客等），这可能会导致可用性问题，因为每个人设置的默认字体大小有可能不一样，比如在 Chrome 就可以通过 chrome:&#x2F;&#x2F;settings&#x2F;fonts 更改字体大小，所以更好的做法是：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后在内部元素采用 <code>em</code> 和 <code>rem</code>。</p>
<h3 id="TypeScript-的-Web-API-类型声明是怎么来的？"><a href="#TypeScript-的-Web-API-类型声明是怎么来的？" class="headerlink" title="TypeScript 的 Web API 类型声明是怎么来的？"></a><a target="_blank" rel="noopener" href="https://www.huy.rocks/everyday/03-29-2022-typescript-a-note-about-lib-dom-d-ts">TypeScript 的 Web API 类型声明是怎么来的？</a></h3><p>在 TypeScript 中，所有的 Web API 类型声明都在 <a target="_blank" rel="noopener" href="https://github.com/microsoft/TypeScript/blob/main/lib/lib.dom.d.ts">lib.dom.d.ts</a> 中实现，一共多达 18877 行，它当然不是手动编写的，而是利用 <a target="_blank" rel="noopener" href="https://github.com/w3c/webref">webref</a> 进行生成机器可读的 Web 标准，每 6 小时自动生成一次，然后利用 <a target="_blank" rel="noopener" href="https://github.com/microsoft/TypeScript-DOM-lib-generator/">TypeScript-DOM-lib-generator</a> 自动生成 lib.dom.d.ts。</p>
<h2 id="一些-tips"><a href="#一些-tips" class="headerlink" title="一些 tips"></a>一些 tips</h2><h3 id="使用-Lighthouse-展示网站的-JavaScript-依赖关系"><a href="#使用-Lighthouse-展示网站的-JavaScript-依赖关系" class="headerlink" title="使用 Lighthouse 展示网站的 JavaScript 依赖关系"></a><a target="_blank" rel="noopener" href="https://sia.codes/posts/lighthouse-treemap/">使用 Lighthouse 展示网站的 JavaScript 依赖关系</a></h3><p>熟悉 Webpack 的前端同学应该知道有一个插件叫做 <a target="_blank" rel="noopener" href="https://github.com/webpack-contrib/webpack-bundle-analyzer">Webpack-bundle-analyzer</a>，它用于展示每个 npm 包的体积。</p>
<p>现在我们也可以通过 Lighthouse Treemap 查看网站的 JavaScript 依赖关系和文件体积，效果如下：</p>
<p><img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images202204041746785.jpg"></p>
<p>使用方法：在 Chrome 使用 Lighthouse 检查，然后在结果页中点击「View Treemap」即可。</p>
<h2 id="分享文章"><a href="#分享文章" class="headerlink" title="分享文章"></a>分享文章</h2><h3 id="我讨厌的5个编码面试问题"><a href="#我讨厌的5个编码面试问题" class="headerlink" title="我讨厌的5个编码面试问题"></a><a target="_blank" rel="noopener" href="https://thoughtspile.github.io/2022/03/21/bad-tech-interview/">我讨厌的5个编码面试问题</a></h3><p>本文列举几个作者最不喜欢的五类面试题目：</p>
<ol>
<li><p><strong>一些不重要的琐事</strong></p>
<p>这一类面试题通常是一些实际工作中很少遇到的场景，比如：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> x = &#123;&#125;;</span><br><span class="line"><span class="keyword">const</span> y = &#123;&#125;;</span><br><span class="line">x.<span class="property">__proto__</span> = y;</span><br><span class="line">y.<span class="property">__proto__</span> = x;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x.<span class="property">field</span>);</span><br></pre></td></tr></table></figure>

<p>首先 <code>__proto__</code> 并不是一个标准的属性，实际工作中也应该避免使用它来修改原型链，能够正确回答它并不能真正显示候选人的 JavaScript 水平，只能体现他看过多少面试题。</p>
<p>这些题目通常关注于一些 JavaScript ES5 之前的糟粕，但现在已经是 2022 年了，我们没有必要再问这类问题。</p>
</li>
<li><p><strong>具体的细节</strong></p>
<p>这类问题通常过于关注细节，比如：</p>
<ul>
<li>迁移到 Webpack 6 会遇到什么问题？</li>
<li>如何检查浏览器对服务器发送事件的支持？</li>
</ul>
<p>这些问题，即便候选人真的在工作中解决过，除非事先准备好，否则也很难完整地回答出来，但我们都擅长通过搜索引擎解决这类问题。</p>
<p>这些题目极有可能是面试官最近解决过的一些棘手问题，他对此记忆犹新，但是根据这些问题来判断候选人的能力是不公平的，因为即便候选人回答不出来，也不代表他无法解决此类问题，这只是双方信息不对称所导致的。</p>
<p>所以面试官更应该着重关注于候选人最近解决过什么棘手问题，以此判断候选人解决问题的能力。</p>
</li>
<li><p><strong>混淆问题</strong></p>
<p>这些问题通常具有一个标准的答案，比如：</p>
<ol>
<li>Number 和 Object 之间有什么区别？</li>
</ol>
<p>这个题目的答案仅仅是：Number 是不可变的。</p>
<p>但候选人可能会认为这是一个开放式的题目，因此会从各方面对它们进行对比，这严重浪费时间。</p>
<p>同样的，这些问题也体现出候选人的面试经验，只有他被问过几次同样的题目，才熟练地知道它具有一个标准的答案。</p>
<p>所以面试官应该更直接地问：哪些 JavaScript 类型是不可变的。</p>
</li>
<li><p><strong>实现问题</strong></p>
<p>这类问题通常与浏览器实现细节相关，但它们不在规范里面：</p>
<ul>
<li><code>console.log(Object.keys(&#123; x: 0, y: 0 &#125;).join())</code> 问 x 和 y 哪个在前面？</li>
</ul>
<p>大多数人都知道正确的答案：根据添加顺序进行排序。</p>
<p>但此类特性依赖于 JS 引擎的实现，在 ECMAScript 规范中并没有明确定义。</p>
<p>所以面试官在问这类题目的时候，不应该持有标准化答案的心态，它更应该是一个开放式的题目。</p>
<p>PS：我曾写过一篇文章深入剖析 <code>Object.keys</code> 的规范：《<a target="_blank" rel="noopener" href="https://4ark.me/post/how-object-keys-work.html">一行 Object.keys() 引发的血案</a>》。</p>
</li>
<li><p><strong>缺少上下文</strong></p>
<p>开放式问题是你在面试中可以问的最好的问题之一，因为它们具有挑战性，并能够真正体现候选人解决问题的能力，然而这些问题取决于面试官个人观点，否则容易引起反作用。</p>
<p>例如，这个函数有什么问题：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">map</span>(<span class="params">arr, fn</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    arr[i] = <span class="title function_">fn</span>(arr[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个问题对于不同的人具有不同的观点，有些人觉得这段代码问题一大堆，比如：</p>
<ol>
<li>为什么使用 <code>var</code> 而不是 <code>let</code> ？</li>
<li>为什么不使用 <code>for...of</code> ?</li>
<li>它具有副作用，不应该直接修改 <code>arr</code></li>
<li>为什么不直接使用 <code>.map()</code> ?</li>
</ol>
<p>但也有人觉得它没有任何问题，既然它能够正常工作，我们为什么需要重构它？仅仅是为了让它看上去更好吗？我们的目标是什么？没有明确目标的重构就是浪费时间！</p>
<p>所以，双方都没有错，因为它完全取决于上下文。</p>
<p>所以，当你提出一个开放式问题时，要么放下你预期的答案，专注于解决问题的过程，要么引入缺失的要求来指导你想要的解决方案。</p>
<p>最后，作者给出了一个如何改进面试题目的建议：</p>
<p><img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images202204041732556.png" alt="img"></p>
</li>
</ol>
<h3 id="不良面试官的七个习惯"><a href="#不良面试官的七个习惯" class="headerlink" title="不良面试官的七个习惯"></a><a target="_blank" rel="noopener" href="https://blog.thoughtspile.tech/2022/03/28/interview-bad-habits/">不良面试官的七个习惯</a></h3><p>此文接着上一篇《我讨厌的5个编码面试问题》，列举几个面试官不好的习惯：</p>
<ol>
<li><p><strong>骄傲的自负</strong></p>
<p>有些面试官通常抱有一种「<strong>既然是我在面试你，那么我的能力自然比你强</strong>」的心态，他们往往摆出一副居高临下的样子，但你要清楚，你掌握所有面试问题的答案，这本就是一种信息不对称，所以你不应该抱有这种想法。</p>
</li>
<li><p><strong>专注于答案</strong></p>
<p>就像考试一样，面试官列出所有的面试题目，照本宣科地问问题，这类问题通常具有标准答案，但真正的工作中很少是考试一样解决问题的，并且这类问题都可以通过搜索引擎解决。</p>
<p>我们更应该倾向于开放式的题目，专注于候选人解决问题的过程，比如问「如何设计一个 Swiper」会比「具有哪些触摸事件」更合适。</p>
<p>此类问题其实还蕴含了一个顾虑：不信任候选人，认为他们缺乏这些基础知识。</p>
</li>
<li><p><strong>不给出任何提示</strong></p>
<p>试问当你身边的同事在某个问题卡住的时候，你会选择帮助他还是立即解雇他？所以我们应该引导候选人，而不是让他一个人苦苦挣扎。</p>
</li>
<li><p><strong>规划不善</strong></p>
<p>面试前没有提前规划好面试流程、或者是面试流程安排得太紧凑都会导致面试效果不佳。</p>
<p>假设你们明显有可能在某个问题上进行深入地探讨，千万不要仅仅因为你需要问更多初级的问题而打断候选人展示自己的机会。又或者你招聘的是高级开发人员，而候选者碰巧是一位非常不错的初级开发人员，你也不要轻易地错过。</p>
</li>
<li><p><strong>忽略简历</strong></p>
<p>不要浪费候选人的宝贵时间，假设候选人是一位顶尖大学毕业、甚至有一个技术博客和开源项目，这都可以体现出候选人的专业技能，而面试官仍要花费近 30 分钟去问一些基础问题，这会让候选人觉得是在浪费自己的时间。</p>
<p>诚然简历是可以造假，但仍不应该花费过多的时间去印证候选人是否具备这些基础知识，把时间花在更有价值的问题上。</p>
</li>
<li><p><strong>过渡延长</strong></p>
<p>不要让面试时间过长，除非你有自信保证候选人愿意花费这么多时间。</p>
</li>
<li><p><strong>避免群体面试的不良反应</strong></p>
<p>多个面试官时千万不要你一句我一句的，也不要显得某个面试官在场是完全没必要的，更好的做法是其中一位面试官负责主要的问题，其他面试官负责观察。</p>
</li>
</ol>
<h3 id="如何看待-ECMAScript-新提案-Type-Annotations"><a href="#如何看待-ECMAScript-新提案-Type-Annotations" class="headerlink" title="如何看待 ECMAScript 新提案 - Type Annotations"></a><a target="_blank" rel="noopener" href="https://2ality.com/2022/03/type-annotations-first-look.html">如何看待 ECMAScript 新提案 - Type Annotations</a></h3><p>这个月有一个 ECMAScript 的新提案，可以在 JavaScript 中使用 TypeScript 部分类型声明，参见：<a target="_blank" rel="noopener" href="https://github.com/tc39/proposal-type-annotations">tc39&#x2F;proposal-type-annotations</a>。</p>
<p>此提案一经提出，在中英文社区都引起了不少的轰动，而《<a target="_blank" rel="noopener" href="https://exploringjs.com/impatient-js/">JavaScript for impatient programmers</a>》的作者 Dr. Axel Rauschmayer 在这篇文章中提出了一些他的看法。</p>
<p>先展示一下这个提案的一些使用示例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">x: number, y: number</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很标准的 TypeScript 语法，而 JavaScript 将这样处理这些类型声明：</p>
<ol>
<li>在运行时，JavaScript 引擎完全忽略它们 - 就好像它们是注释一样。</li>
<li>在开发时，类型检查器可以静态分析注释并警告开发人员有关潜在问题。</li>
</ol>
<p>下面是本文作者的一些看法：</p>
<ul>
<li>优点：<ul>
<li>为类型声明标准化是很好的，并且将使该领域的工具和实验更容易。</li>
<li>可以在不编译源代码的情况下使用 TypeScript 进行编程（例如）。在开发时只会进行类型检查。这将大大改善静态类型 JavaScript 的开发体验：<ul>
<li>执行时不需要中间文件。<ul>
<li>这在 Node 上特别有用 .js 您可以直接运行 TypeScript 文件。</li>
</ul>
</li>
<li>调试时，不需要源映射即可查看原始源代码。</li>
<li><code>.d.ts</code>文件通常也不需要。</li>
</ul>
</li>
</ul>
</li>
<li>缺点：<ul>
<li>像 TypeScript 这样的静态类型系统是完全可选的 JavaScript 之上的层，不会给 JavaScript 增加任何复杂性。</li>
<li>该提案为该语言添加了许多新的语法。即使引擎忽略它，它们仍然必须能够解析它。升级  JavaScript 工具需要时间和精力。</li>
<li>如果在将库部署到 npm 之前没有将 TypeScript（等）编译为 JavaScript，那么对于不喜欢 TypeScript 的人来说，浏览 TypeScript 开发人员编写的源代码将变得不那么愉快。<ul>
<li>为了帮助解决这个问题，从文件中删除所有类型批注可能成为文本编辑器支持的操作。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="个人思考"><a href="#个人思考" class="headerlink" title="个人思考"></a>个人思考</h4><p>我个人非常喜欢这个提案，也很希望这个提案能够最终进入到 ECMAScript 的标准中。但这背后仍会有无数的坑，比如 <code> add&lt;number&gt;(4,5)</code> 它也是合法的 JavaScript 代码，至于如何解决这类与现有代码冲突的问题，就让我们拭目以待吧。</p>
<h2 id="有趣的链接"><a href="#有趣的链接" class="headerlink" title="有趣的链接"></a>有趣的链接</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://www.patterns.dev/">改进构建 Web 应用程序的方式</a>：一本关于设计模式和组件模式的免费书籍，用于使用原生 JavaScript 和 React 构建强大的 Web 应用程序。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/k88hudson/git-flight-rules/blob/master/README_zh-CN.md">Git 飞行规则(Flight Rules)</a>：这是一篇给宇航员（这里就是指使用 Git 的程序员们）的指南，用来指导问题出现后的应对之法。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://devhints.io/">里科的备忘单</a>：一些语言、框架、工具的 TL;DR，帮助你快速了解某一门技术。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://refactoringguru.cn/design-patterns">常用的设计模式有哪些？</a>：图文并茂地列出了几乎所有的设计模式，帮助你理解设计模式。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://developer-advocacy.com/">开发人员的宣传手册</a>：本手册引导你成为任何产品或公司的布道者。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.accessguide.io/">访问指南</a>：这是对可访问性的友好介绍！列出了很多有用的知识帮助你提高网站的可访问性。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://tldp.org/LDP/abs/html/index.html">高级 Bash 脚本编写指南</a>：帮助你学习 Bash 脚本，而且它没有任何版权，可用于课堂、知识分享会。</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-weekly" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/post/weekly-06.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/weekly-06.html" itemprop="url">周刊第6期：网络没有版本号</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-03-28T00:00:00+08:00">
                2022-03-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <h2 id="分享文章"><a href="#分享文章" class="headerlink" title="分享文章"></a>分享文章</h2><blockquote>
<p>一些本周阅读过的好文章、以及我的一些总结和个人思考；非常建议你直接阅读原文，毕竟一千个读者就有一千个哈姆雷特，而且我的理解可能是错的。</p>
</blockquote>
<h3 id="网络没有版本号"><a href="#网络没有版本号" class="headerlink" title="网络没有版本号"></a><a target="_blank" rel="noopener" href="https://hiddedevries.nl/en/blog/2022-01-03-the-web-doesnt-have-version-numbers">网络没有版本号</a></h3><p>在过去一年时间里，我们经常听到 WEB3 ，以及相关的术语：如区块链、加密、NTF 等，让不少 WEB 开发者认为这项技术是未来的趋势，于是每个开发者都跃跃欲试，但本文作者认为我们应该对这个充满误导性的术语 「WEB3」持谨慎态度，因为网络并没有版本号，更没有某个权威的机构会定期更新网络的版本。</p>
<p>希望 WEB3 及其相关术语不会成为 WEB 开发者的简历上必备的流行词，对于大部分 WEB 开发者而言，该领域的专业知识是不必要的。</p>
<h3 id="您在软件开发方面的经验水平将使您产生截然不同的观点和意见"><a href="#您在软件开发方面的经验水平将使您产生截然不同的观点和意见" class="headerlink" title="您在软件开发方面的经验水平将使您产生截然不同的观点和意见"></a><a target="_blank" rel="noopener" href="https://www.kevinhooke.com/2022/03/22/your-experience-level-in-software-development-will-lead-you-to-wildly-different-points-of-view-and-opinions/">您在软件开发方面的经验水平将使您产生截然不同的观点和意见</a></h3><p>假设你是一个初级开发者，你为了实现某个功能，而刚好有一个库&#x2F;框架能够满足你的需求，所以你希望能够把这个库&#x2F;框架加入到项目中，但比你更有经验的同事拒绝了这个建议，他认为没必要仅仅为了实现一个功能而添加一个库&#x2F;框架。</p>
<p>你可能会认为这是一个短视的看法，他们不应该被困在什么都自己重新造轮子的旧观念上。</p>
<p>但也许他是这样思考问题的：</p>
<ol>
<li>添加一个库，意味着增加系统的复杂度、意味着更多的风险。</li>
<li>需要及时跟踪这个库的安全漏洞、并在 breaking change 时更新现有的代码。</li>
<li>这个库的安全性如何？是否会有意外的情况发生？</li>
<li>添加这个库的成本和风险？成本是否会比自己开发更低？</li>
</ol>
<h4 id="个人思考"><a href="#个人思考" class="headerlink" title="个人思考"></a>个人思考</h4><p>对于任何一个商业项目而言，不应该也不可能完全脱离开源社区的框架、类库，我们确实不可能所有事情都重新造轮子，开源类库的健壮性肯定比自己实现要强，但这也不意味着我们可以盲目地使用开源类库，即便要使用类库，也可能会面临多个不同选择，我们应该从生态社区、维护积极性、安全性等多方面进行考察和对比，最终选择出适合的方案。</p>
<h3 id="当你在构建产品时，你应该听取谁的意见？"><a href="#当你在构建产品时，你应该听取谁的意见？" class="headerlink" title="当你在构建产品时，你应该听取谁的意见？"></a><a target="_blank" rel="noopener" href="https://justinjackson.ca/opinion">当你在构建产品时，你应该听取谁的意见？</a></h3><aside>
💬 "在我使用苹果产品的这么多年里，我从来没有退过一个产品。直到现在。上个月我购买了带 Touch Bar 的新 MacBook Pro。真让人失望。这是第一个让我的工作效率下降的苹果设备。该公司已经与史蒂夫-乔布斯关于简单、优雅机器的愿景脱节。- 迈克尔-凯特
</aside>

<p>人们根据自己的背景来重视不同的东西。就比如对于笔记本电脑，不同的群体需要不同的功能：</p>
<ul>
<li><strong>学生们</strong>想要一台价格实惠且重量轻的笔记本电脑（因为他们会把它带到课堂上）。</li>
<li><strong>程序员</strong>想要一台具有高分辨率屏幕，大量内存和全尺寸键盘的笔记本电脑。</li>
<li><strong>游戏玩家</strong>想要一个具有超强 CPU和 GPU 的电脑，他们也不介意笔记本电脑是否笨重。</li>
</ul>
<p>本文作者提出我们在构建产品时，最应该听从谁的意见，以及如何听从：</p>
<ul>
<li><strong>只接受为您的产品付费的人的产品反馈</strong>，很多人可能不同意这个观点，但是请看看 Feedbook 和谷歌，我们中的许多人都在每天使用它，但是 Facebook 和谷歌似乎不太关心我们的隐私，并在未经我们同意的情况下分享我们的信息。为什么？<strong>因为他们效忠的是广告商</strong>。</li>
</ul>
<h3 id="在浏览器-devtools-中打印图片"><a href="#在浏览器-devtools-中打印图片" class="headerlink" title="在浏览器 devtools 中打印图片"></a><a target="_blank" rel="noopener" href="https://www.bram.us/2022/02/13/log-images-to-the-devtools-console-with-console-image/">在浏览器 devtools 中打印图片</a></h3><p><img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images202203282335113.png" alt="Untitled"></p>
<p>我们使用以下代码在 devtools 中利用 <code>console.log</code> 输出图片：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getBox</span>(<span class="params">width, height</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">string</span>: <span class="string">&quot;+&quot;</span>,</span><br><span class="line">        <span class="attr">style</span>: <span class="string">&quot;font-size: 1px; padding: &quot;</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(height/<span class="number">2</span>) + <span class="string">&quot;px &quot;</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(width/<span class="number">2</span>) + <span class="string">&quot;px; line-height: &quot;</span> + height + <span class="string">&quot;px;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="property">image</span> = <span class="keyword">function</span>(<span class="params">url, scale</span>) &#123;</span><br><span class="line">    scale = scale || <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> img = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line"></span><br><span class="line">    img.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> dim = <span class="title function_">getBox</span>(<span class="variable language_">this</span>.<span class="property">width</span> * scale, <span class="variable language_">this</span>.<span class="property">height</span> * scale);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;%c&quot;</span> + dim.<span class="property">string</span>, dim.<span class="property">style</span> + <span class="string">&quot;background: url(&quot;</span> + url + <span class="string">&quot;); background-size: &quot;</span> + (<span class="variable language_">this</span>.<span class="property">width</span> * scale) + <span class="string">&quot;px &quot;</span> + (<span class="variable language_">this</span>.<span class="property">height</span> * scale) + <span class="string">&quot;px; color: transparent;&quot;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    img.<span class="property">src</span> = url;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>或者直接使用这个库：<a target="_blank" rel="noopener" href="https://github.com/adriancooney/console.image">https://github.com/adriancooney/console.image</a></p>
<h2 id="有趣的链接"><a href="#有趣的链接" class="headerlink" title="有趣的链接"></a>有趣的链接</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://myxml.in/cors-tester.html">CORS Tester</a>：跨域对于前后端来说都是一个不可逾越的知识点，在实际项目开发中也必然会遇到各种各样的跨域问题，可以使用这个网站在线体验跨域的请求。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://effective-shell.com/">Effective Shell</a>：一本学习 Shell 的在线书籍，适合任何一个想要入门 Shell 的同学。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://curlconverter.com/">Convert curl commands to code</a>：将 CURL 转换到各编程语言的实例中，当然我们平常都会使用 Postman、PAW 等工具进行转换，不过也总有需要在线转换的时候把？</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://exploringjs.com/impatient-js/index.html">JavaScript for impatient programmers (ES2022 edition)</a>：在 JavaScript 世界中有很多非常经典的书籍，如 《JavaScript 权威指南》、《JavaScript 高级程序设计》、《你不知道的 JavaScript》 等，但我推荐这本更加现代化的书，包含了最新的 ES2022 新特性。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://charm.sh/">Charm</a>：在 CLI 构建你的图形界面，真的很漂亮！</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://jless.io/">jless</a>：一个更好地显示 JSON 的 CLI 工具，推荐使用！</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://devtoys.app/">DevToys</a>：堪称开发者的瑞士军刀，提供了比如文件转换（JSON &lt;&gt; YAML ）、编码解码、格式化（支持 JSON、SQL、XML）、哈希生成、UUID 生成、图片压缩多种功能。</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2022/03/27/2022-03-27-invest-summary-2022/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/03/27/2022-03-27-invest-summary-2022/" itemprop="url">最近的投资感悟</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-03-27T10:27:02+08:00">
                2022-03-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/summary/" itemprop="url" rel="index">
                    <span itemprop="name">summary</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <h2 id="一、序"><a href="#一、序" class="headerlink" title="一、序"></a>一、序</h2><p>这几个月，美港股的中概股持续下跌，A 股也跌，我之前配置的不少指数增强产品亏损接近 10%。只有 CTA 产品略微盈利，但收益也不算高。我的美股去年 10 月因为一个偶然的原因全部清仓了，逃过了一劫。</p>
<p>亏损让人反思：到底之前的策略错在哪里。以下是一些感悟，分享给大家。</p>
<h2 id="二、投资的本质"><a href="#二、投资的本质" class="headerlink" title="二、投资的本质"></a>二、投资的本质</h2><h3 id="2-1-投资是为了获得超额收益"><a href="#2-1-投资是为了获得超额收益" class="headerlink" title="2.1 投资是为了获得超额收益"></a>2.1 投资是为了获得超额收益</h3><p>投资的本质是希望获得超额收益，不然就还不如存银行。</p>
<p>之所以投资可能获得超额收益，是因为投资有一定风险，所以大家是用风险来换取了获得超额收益的概率。只要整体的数学期望是超额的，那么长期看来收益就是超额的。</p>
<p>为了看清楚投资的决策逻辑，我们来做一些假设，从而控制变量。</p>
<p>我们假设：有一家公司 A，它估值 100 亿，每年利润固定是 3 亿，每年它都把 3 亿利润分红给股东。</p>
<p>同时，有一个低风险理财产品 B，年化收益率是 3%，保本保息，随时申赎。</p>
<p>如果不考虑 A 的经营风险，那么 A 和 B 就是两个完全一样的理财产品。</p>
<p>假如 B 的收益率比 3% 还高，那你就应该买 B，反之就应该买 A。</p>
<p>大部分时候，买股票就应该是和买理财产品一样的逻辑，你只是希望获得高于无风险收益产品（例如国债等）的投资回报。</p>
<p>实际情况当然比我们的假设复杂得多。比如，很多公司就根本不会分红。那这个时候，你的收益可能是来源于因为利润高而带动的股价上涨。有一些公司甚至亏损，那你的收益可能是来源于未来能够挣很多钱的 “概念故事” 带来的股价上涨。</p>
<h3 id="2-2-投资收益来自于哪里"><a href="#2-2-投资收益来自于哪里" class="headerlink" title="2.2 投资收益来自于哪里"></a>2.2 投资收益来自于哪里</h3><p>大部分收益来自于：1、分红；2、股价上涨。</p>
<p>如果公司股价不变，收益就来自分红。如果分红的同时股价也在变动，那收益就是分红叠加上股价的变化。</p>
<p>如果公司不分红，你的收益只能来自股价上涨，如果股价下跌，你就是亏损的。</p>
<p>在不分红的情况下，投资收益来自于股票价格的持续上涨。</p>
<p>那什么情况下，一个不分红的公司，股票可以持续上涨？</p>
<h3 id="2-3-股价持续上涨的理由"><a href="#2-3-股价持续上涨的理由" class="headerlink" title="2.3 股价持续上涨的理由"></a>2.3 股价持续上涨的理由</h3><p>是盈利能力。</p>
<p>公司的股票可以因为追捧或者概念涨个几个月或一两年，但是如果要持续一直不断上涨，五年，十年甚至上百年上涨，只有一个原因：这家公司持续在挣钱，如果它不分红，那么经营现金流就会持续增加。</p>
<p>举个极端的例子：一个市值 100 亿的公司，如果它持续挣钱不分红，当它的现金到了 500 亿的时候，如果没有特别的原因，它的股价至少应该是 500 亿。</p>
<p>因为如果太低的话，某个投资机构完全可以把它收购下来分红，就可以把自己收购的本金拿回来。所以，市场的套利机会会让股价回归正常值。</p>
<h3 id="2-4-股价的支持"><a href="#2-4-股价的支持" class="headerlink" title="2.4 股价的支持"></a>2.4 股价的支持</h3><p>如果一家公司股票一直跌，支持剩下投资人不卖的信心是什么？</p>
<p>还是盈利能力。</p>
<p>只要公司盈利，股价低到一定程度，利润分红收益明显高于无风险理财产品，同时又比较稳定的话，那么管理层或者投资机构都会去套利，从而稳定股价。</p>
<h3 id="2-5-互联网的泡沫"><a href="#2-5-互联网的泡沫" class="headerlink" title="2.5 互联网的泡沫"></a>2.5 互联网的泡沫</h3><p>我现在发现互联网的公司股票，概念的东西太多太多了。</p>
<p>比如哔哩哔哩吧，它总给你讲用户要做到多少多少亿，但是你不知道它到了那一天商业化的能力能不能保证盈利。如果买入的价格很高，那到时候万一盈利不及预期，就会遭遇很大的估值下跌。</p>
<p>又比如滴滴吧，一直说自己是很好的生意，你算下来也是很合理的，但是财报亏得一塌糊涂。那到底应该怎么估值呢？</p>
<p>过去 10 年互联网创业热火朝天，互联网的概念，有多大的概率真的变成了事实？有多少公司最后真正拥有了高盈利能力？</p>
<p>很多公司，做到很大很大以后，才发现其实盈利也就那么一点点，增长也乏力以后，戴维斯双杀，估值就掉得非常厉害。比如微博，比如已经退市的优酷，比如爱奇艺。</p>
<h3 id="2-6-怎么买股票"><a href="#2-6-怎么买股票" class="headerlink" title="2.6 怎么买股票"></a>2.6 怎么买股票</h3><p>​<br>互联网早已经没有了红利，甚至现在从反垄断角度来看，互联网反倒是不利的。在现在的市场环境，股票的购买还是应该回归到盈利能力上。</p>
<p>同时，从共同富裕角度看，公司盈利也应该建立在创造社会价值，解决人民需求这个角度上，通过创新和提效，获得合理的利润。</p>
<p>找到了这种股票，怎么决定买入价格呢？直接和无风险的理财产品比较比较，看看自己承担了多少风险，对等的预期增长对赌合不合理，有没有安全边际。</p>
<h2 id="三、小结"><a href="#三、小结" class="headerlink" title="三、小结"></a>三、小结</h2><ul>
<li>投资是为了获得收益。</li>
<li>因为可以套利，盈利能力是股价的有效支持。</li>
<li>概念和增长突然不及预期会遭遇戴维斯双杀。</li>
<li>应该买那些稳定盈利并且创造社会价值的股票。</li>
<li>买的时候，留够安全边际，不便宜的不碰。</li>
</ul>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-weekly" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/post/weekly-05.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/weekly-05.html" itemprop="url">周刊第5期：拖延症</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-03-23T00:00:00+08:00">
                2022-03-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <h2 id="拖延症"><a href="#拖延症" class="headerlink" title="拖延症"></a>拖延症</h2><p>本期周刊延迟了两天，今晚抽空补上，内容会相对比较少。</p>
<p>反思一下，一个原因是这周比较忙，但主要还是因为自己的拖延症，希望以后能够克服这个问题。</p>
<h2 id="分享文章"><a href="#分享文章" class="headerlink" title="分享文章"></a>分享文章</h2><blockquote>
<p>一些本周阅读过的好文章、以及我的一些总结和个人思考；非常建议你直接阅读原文，毕竟一千个读者就有一千个哈姆雷特，而且我的理解可能是错的。</p>
</blockquote>
<h3 id="Exhausting-Exhaustive-Testing"><a href="#Exhausting-Exhaustive-Testing" class="headerlink" title="Exhausting Exhaustive Testing"></a><a target="_blank" rel="noopener" href="https://www.openmymind.net/Exhausting-Exhaustive-Testing/">Exhausting Exhaustive Testing</a></h3><p><em>原文地址：<a target="_blank" rel="noopener" href="https://www.openmymind.net/Exhausting-Exhaustive-Testing/">《Exhausting Exhaustive Testing》 | openmymind</a></em></p>
<p>非常短的一篇文章，但作者的观点让我醒醐灌顶：编写有效的测试具有挑战性，每个测试用例都需要考虑最大化其价值。</p>
<p>举一个例子，比如我们有这么一个软删除用户的函数：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">func <span class="title function_">deleteUser</span>(id) (bool, error) &#123;</span><br><span class="line">  tag, err := conn.<span class="title class_">Exec</span>(<span class="string">`</span></span><br><span class="line"><span class="string">    update users</span></span><br><span class="line"><span class="string">    set status = &#x27;deleted&#x27;</span></span><br><span class="line"><span class="string">    where id = $1</span></span><br><span class="line"><span class="string">  `</span>, id)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> tag.<span class="title class_">RowsAffected</span>() == <span class="number">1</span>, err</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通常我们会如何测试这个函数？是不是这样：</p>
<ol>
<li>插入一个新的用户</li>
<li>调用这个函数</li>
<li>判断这个新用户是否被删除</li>
</ol>
<p>这样测试没有错，但是我们忽略了一点：如果这个函数把所有用户都删除了呢？是不是也能通过测试？</p>
<p>所以正确的测试方式是：插入两个用户，删除第一个用户，确保第二个用户没有被删除。</p>
<p>还有另外一个例子，假如我们要获取用户列表，SQL 是这样的：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, name</span><br><span class="line"><span class="keyword">from</span> users</span><br><span class="line"><span class="keyword">where</span> status <span class="operator">=</span> <span class="string">&#x27;normal&#x27;</span></span><br><span class="line">  <span class="keyword">and</span> customer_id <span class="operator">=</span> $<span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> name</span><br></pre></td></tr></table></figure>

<p>通常我们可能是这样测试的：</p>
<ol>
<li>插入一个新用户，设置 customer_id</li>
<li>调用函数</li>
<li>判断是否返回这个新用户</li>
</ol>
<p>但作者认为至少需要插入四个新用户才能进行这个测试：</p>
<ol>
<li>四个用户，其中一个被删除的 A、一个 customer_id 不符合的 B，剩余两个才符合条件</li>
<li>确保没有返回 A 和 B</li>
</ol>
<h4 id="个人思考"><a href="#个人思考" class="headerlink" title="个人思考"></a>个人思考</h4><p>诚然我们都认同测试的重要性，但是如何编写测试是一门非常高深的学问，只是编写测试用例的时候只是流于表面的，那么其价值是非常低的，甚至是浪费时间的。</p>
<h3 id="百度腾讯阿里真的是高科技企业吗？"><a href="#百度腾讯阿里真的是高科技企业吗？" class="headerlink" title="百度腾讯阿里真的是高科技企业吗？"></a><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/JseMDsqTDKfIepmFj3u55w">百度腾讯阿里真的是高科技企业吗？</a></h3><p><em>原文地址：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/JseMDsqTDKfIepmFj3u55w">《百度腾讯阿里真的是高科技企业吗？》 | 马工</a></em></p>
<p>那么，这些潜力人才去了BAT，在干什么呢？腾讯的公众号文章《搞了运维开发这么多年，原来 Ping 还能这么玩儿！》揭示了部分真相：一个北大本科毕业生在腾讯研究一个1981年的协议ICMP，而这个协议因为不安全已经被大多数美国同行比如AWS给默认禁掉了。说句不客气的话，ICMP协议就是IT行业的回字的四种写法，让北大毕业生去研究ICMP协议，就是把他们变成孔乙己。</p>
<h2 id="有趣的链接"><a href="#有趣的链接" class="headerlink" title="有趣的链接"></a>有趣的链接</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://oktools.net/aes">AES加密&#x2F;解密</a>：一个在线 AES 加密&#x2F;解密的工具。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://plantuml-editor.kkeisuke.dev/">PlantUML Editor</a>：一个在线画 PlantUML 的工具。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://getoss.art/">OssArt</a>：一个非常有意思的开源项目，它可以帮你打印出最早从 2010 年开始的 GitHub Activity 贡献图，让你的成就感满满。</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2022/03/20/2022-03-20-the-right-it-book-summary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/03/20/2022-03-20-the-right-it-book-summary/" itemprop="url">极致 MVP - 读《做对产品》</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-03-20T23:24:01+08:00">
                2022-03-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/summary/" itemprop="url" rel="index">
                    <span itemprop="name">summary</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <img src="/images/the-right-it-book-cover.jpg" class="">

<h2 id="一、序"><a href="#一、序" class="headerlink" title="一、序"></a>一、序</h2><p>最近海晨给我推荐了一本书，叫<a target="_blank" rel="noopener" href="https://item.jd.com/10037047269016.html">《做对产品》</a>，英文名叫《The Right It》。作者是谷歌前工程总监索维亚，曾领导过谷歌广告团队。</p>
<p>索维亚写这本书源自于他的第四个创业项目：这个项目花了 2500 万美元的融资，历时长达 5 年，最后失败了。但他在这之前曾经 3 次创业成功。</p>
<p>这次失败的经历让他重新审视整个创业过程，从而发现产品本身的方向不对是失败的核心原因。</p>
<p>于是，如何最小化成本、最快速地去验证产品成为了本书的命题。</p>
<p>以下是一些总结。</p>
<h2 id="二、创业失败率与失败原因"><a href="#二、创业失败率与失败原因" class="headerlink" title="二、创业失败率与失败原因"></a>二、创业失败率与失败原因</h2><p>作者引用了尼尔森公司的市场调研：80% 的新产品表现远低于预期。而低于预期的原因主要有三个（简称 FLOP）：</p>
<ul>
<li>获客遇到问题：Failure due to Lanuch</li>
<li>执行遇到问题：Operations</li>
<li>产品定义遇到问题：Premise</li>
</ul>
<p>而大部分的问题集中在第 3 个：产品定义遇到问题。即：产品的创意有问题，用户根本不刚需。</p>
<p>所以，定义好产品，保证在“做对的事情”，成为了创业的关键。</p>
<h2 id="三、空想之地的危害"><a href="#三、空想之地的危害" class="headerlink" title="三、空想之地的危害"></a>三、空想之地的危害</h2><p>人们常常通过思考来判断需求是否成立，通常的办法就是假设自己处于目标消费者的场景，但是这种思考有很大的局限。</p>
<p>最大的问题就是用户其实不知道自己是否真的接受它，除非你亲自把产品放到它手上。</p>
<p>书中举了一个 Uber 的例子：作者刚从别人那儿听说 Uber 的时候，觉得自己绝对不会接受坐陌生人的车，而且司机还没有专业的出租车司机持证。但是他自己尝试体验过一次之后，就完全不这么想了。</p>
<p>从逻辑上来看，作者的理由很合理：安全感是人类的最底层需求，陌生人的车 + 没有受过专业训练的司机 &#x3D; 危险。</p>
<p>但是实际体验下来，作者发现司机很随和很体贴，整个乘车过程感受很好，安全感问题一下子就不是问题了。</p>
<h2 id="四、用数据替代空想"><a href="#四、用数据替代空想" class="headerlink" title="四、用数据替代空想"></a>四、用数据替代空想</h2><p>为了防止各种空想带来的问题，作者在原型前，首先引入了一个数据量化的方法，这个方法叫：「XYZ 假说」。</p>
<p>「XYZ 假说」将用户需求用量化的方式来描述：至少 X% 的 Y 会 Z。</p>
<p>例如，初始的创意：</p>
<blockquote>
<p>在污染严重的城市中生活的一些人会有兴趣购买价格合理的设备用于净化空气。</p>
</blockquote>
<p>以上描述很模糊，什么是“污染严重”？什么是“价格合理”？「XYZ 假说」将这些量化，改成了这样：</p>
<blockquote>
<p>在 AQI 超过 100 的城市中生活的人，有至少 10% 的比例会购买售价为 120 美元以内的空气净化机。</p>
</blockquote>
<p>「XYZ 假说」进一步将验证范围缩小，演化成一个待办的可具体测试目标，如：</p>
<blockquote>
<p>在公司 A，有至少 10% 的比例会购买售价为 120 美元以内的空气净化机。</p>
</blockquote>
<p>然后拿着上面的假说，就可以在公司 A 做相关的原型实验了。</p>
<h2 id="五、预型：快速化原型"><a href="#五、预型：快速化原型" class="headerlink" title="五、预型：快速化原型"></a>五、预型：快速化原型</h2><p>作者创造了一个新的词：预型（pretotype），以区别原型。</p>
<p>在我看来，这是一系列快速化原型测试的简称，用以强调快速、低成本。</p>
<p>书中举了很多方法，比较有意思的有：</p>
<p>土耳其机器人。用真人躲在机器里面假装机器完成任务，用以验证需求是否成立。案例是：IBM 当年测试大型的语音输入机器是否刚需。</p>
<img src="/images/pretotype-1.jpg" class="">

<p>匹诺曹预型。假装你真的拥有它，然后在各种场景中使用它，观测效果。案例是：Palm 的创始人当前就是用木制的假设备来模拟每天的操作。</p>
<img src="/images/pretotype-2.jpg" class="">

<p>假门预型。做一个假的店面门，看看有多少人被吸引进来。</p>
<p>一夜情预型。做一次服务招募，看看需求和体验强弱。案例是：爱彼迎（AirBnb）。爱彼迎的创始团队因为没钱付房租，从而尝试把房间的 3 个床位出租补贴自己，很快有 3 个人购买了这样的服务，于是他们发现这个需求是成立的。</p>
<p>改标签预型。把一些产品的标签进行更改，让用户以为这个产品就是你宣传的产品。</p>
<h2 id="六、分析预型"><a href="#六、分析预型" class="headerlink" title="六、分析预型"></a>六、分析预型</h2><p>作者提供了几个分析预型的工具：</p>
<ul>
<li>切身利益卡尺。强调一定要让用户付出成本，才能把预型中的结论总结成正向案例。付出成本包括：留下邮箱，留下电话，预付定金，预约详细了解等。而一般的“感兴趣”都不算作正向案例。</li>
<li>TRI 计量仪。将测试结果分为 5 个范围，用于不同范围成功的可能性。</li>
<li>量化预型的成本。用时间成本（单位是小时）和金钱成本来描述预型方案的敏捷程度。这里时间单位是小时，用以强调大部分的预型应该在 48 小时内完成。如果一个预型要做 1 个月，就太复杂了。</li>
</ul>
<h2 id="七、调整"><a href="#七、调整" class="headerlink" title="七、调整"></a>七、调整</h2><p>利用预型、TRI 计量仪，我们可以不断调整我们的「XYZ 假说」，然后从新做预型测试。</p>
<p>书中举了很多案例，最详尽的一个案例是作者自己的 BusU 项目，这是一个在上下班通勤车上进行教学的服务：</p>
<ul>
<li>通过一轮问卷预型，作者迅速调整了自己的「XYZ 假说」。</li>
<li>通过一轮一夜情预型，作者发现晚上的教学效果非常差，并且大家不愿意购买 10 周的课程。</li>
</ul>
<h2 id="八、小结"><a href="#八、小结" class="headerlink" title="八、小结"></a>八、小结</h2><ul>
<li>产品没做对，是大部分创业失败的原因。做对的事情至关重要。</li>
<li>空想很难判断创意是否靠谱。</li>
<li>用「XYZ 假说」将用户需求用量化的方式来描述：至少 X% 的 Y 会 Z。</li>
<li>用预型：快速化原型来验证需求，方法包括：土耳其机器人、匹诺曹预型、假门预型、一夜情预型、改标签预型等。核心就是要快，要省钱。</li>
<li>预型中一定要让用户付出成本才算正向案例。</li>
<li>利用 TRI 计量仪来调整「XYZ 假说」，不断快速测试。</li>
</ul>
<p>再次感谢海晨推荐，特别棒的一本书，也推荐给大家~</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/post/hg-hooks.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/hg-hooks.html" itemprop="url">Hg hooks 实践历程</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-03-17T00:00:00+08:00">
                2022-03-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <h2 id="故事的开始"><a href="#故事的开始" class="headerlink" title="故事的开始"></a>故事的开始</h2><blockquote>
<aside> 💬 提交代码前记得 lint</aside>
<aside> 💬 又有人没跑测试就提交代码</aside>
<aside> 💬 project-config 有改动，麻烦 yarn setup 一下</aside>
</blockquote>
<p>相信使用 Hg 的同学们已经非常熟悉上面这几句话了，我们每次在提交或者拉取代码时总需要手动执行某些命令，实在繁琐。</p>
<p>但现在已经 2022 年了，难道就没有更好的解决方法吗？</p>
<p>有的，我们知道，在 Git 有个东西叫做 hooks（钩子），可以在特定事件发生之前或之后执行特定动作。</p>
<p>同样的，Hg 也有 <a target="_blank" rel="noopener" href="https://www.mercurial-scm.org/wiki/hook">hooks</a>，不过并不像 Git 一样生态蓬勃发展，也没有太多现有的开源工具可供大家使用。</p>
<p>本文就来介绍一下我们从 0 到 1 的 Hg hooks 实践过程，同时也希望能够起到抛砖引玉的作用。</p>
<h2 id="石器时代"><a href="#石器时代" class="headerlink" title="石器时代"></a>石器时代</h2><p>在没有引入 Hg hooks 之前，我们常常会面对几种情况：</p>
<ol>
<li>有同学在提交代码时忘记执行 <code>yarn lint</code>、<code>yarn test</code></li>
<li>修改了 <code>project-config</code> 的常量，却忘记通知大家，或者有人错过了这条信息。</li>
</ol>
<p>这都有可能会导致其他小伙伴拉取代码后，发现页面上的某个功能突然异常，花费一段时间排查才发现原来是没有执行 <code>yarn setup</code>。</p>
<p>可能有部分同学会想到，那我自定义一个命令在提交或者拉取代码时自动做这件事不就好了吗？</p>
<p>比如这样：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; yarn lint &amp;&amp; hg commit -m <span class="string">&quot;xxx&quot;</span></span><br><span class="line"></span><br><span class="line">&gt; hg pull --update &amp;&amp; yarn setup</span><br></pre></td></tr></table></figure>

<p>这样也不是不行，但是会存在一些问题：</p>
<ol>
<li>由于每个人的拉取代码的命令不一样，如果项目开发流程发生变化，则每个人都需要同步修改</li>
<li>有些同学习惯使用图形化界面，比如 SourceTree、vscode-hg 等，则无法自定义操作命令</li>
</ol>
<p>因此，我们另辟蹊径，寻找更好的解决方案。</p>
<h2 id="青铜时代"><a href="#青铜时代" class="headerlink" title="青铜时代"></a>青铜时代</h2><p>我们最主要想解决的问题就是：</p>
<ol>
<li>在提交代码前自动执行 <code>yarn lint</code>、<code>yarn test</code>，不通过则直接终止提交。</li>
<li>在拉取代码后，检测到如果 project-config 目录发生改动，则自动执行 <code>yarn setup</code>。</li>
<li>还有更多：<ol>
<li>检查 commit message 规范</li>
<li>统一代码的格式化风格</li>
</ol>
</li>
</ol>
<p>这些都可以通过 Hg hooks 解决，所以开始之前，我们先对 Hg hooks 做一个简单的认识。</p>
<h3 id="Hg-hooks-介绍"><a href="#Hg-hooks-介绍" class="headerlink" title="Hg hooks 介绍"></a>Hg hooks 介绍</h3><p>Hg hooks 能做什么，这次再介绍一遍：<strong>它可以在特定事件发生之前或之后执行特定动作。</strong></p>
<p>特定事件，指的就是我们在对 Hg 仓库进行操作时的一些钩子，比如提交前（precommit）、提交后（commit），可以在这里查看全部 hooks 列表：<a target="_blank" rel="noopener" href="https://www.mercurial-scm.org/repo/hg/help/hgrc">hooks</a>。</p>
<p>下面介绍一下如何使用 hook，我们可以通过以下两个文件进行配置：</p>
<ol>
<li><code>~/.hgrc</code>：全局的，将对所有 hg 仓库起作用。</li>
<li>项目根目录的 <code>.hg/hgrc</code> ：仅对当前仓库起作用。</li>
</ol>
<p>比如我们想要实现一个简单的需求：在提交代码前进行 <code>yarn lint</code>。</p>
<p>首先编辑 <code>.hg/hgrc</code>文件：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">hooks</span>]</span><br><span class="line"><span class="string">precommit</span> <span class="string">=</span> <span class="string">./bin/hooks/precommit.sh</span> <span class="comment"># 这个路径是相对于项目根目录的</span></span><br></pre></td></tr></table></figure>

<p>然后编写脚本 <code>bin/hooks/precommit.sh</code>（也可以使用 python）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">PATH=/usr/local/bin:/opt/homebrew/bin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line">yarn lint</span><br><span class="line"></span><br><span class="line"><span class="comment"># lint 没有通过直接退出</span></span><br><span class="line"><span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span> <span class="built_in">exit</span> 1; <span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<p>这里需要特别指出，之所以需要重新声明 <code>PATH</code> 变量：</p>
<ol>
<li>hooks 脚本的运行环境取决于同学提交代码的地方，比如通过 SourceTree 提交，由于环境不一样，就可能会出现 <code>yarn: command not found</code> 的报错，参见：<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/22883197/git-command-not-found-in-the-custom-action-for-sourcetree">‘Git Command Not found’ in the custom action for SourceTree - Stack Overflow</a>。</li>
<li>每个同学安装 hg 的方式可能不一样，有通过 brew、pip、甚至自己手动编译的，它们的可执行文件路径不一样。<ul>
<li>可以通过 <code>which hg</code> 查看这个命令的可执行文件路径。</li>
</ul>
</li>
</ol>
<p>这样，一个简单的 hook 就配置完成了，这时候提交代码就会触发 <code>precommit.sh</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; hg commit -m <span class="string">&quot;ci: precommit hooks&quot;</span></span><br><span class="line"></span><br><span class="line">$ eslint <span class="string">&#x27;**/*.js&#x27;</span> --cache --fix</span><br></pre></td></tr></table></figure>

<p>当 hook 脚本的 exit code 不为 0 的时候，则会终止当前的 Hg 操作，对于某些具有事务性的 hook（e.g. pretxncommit），还会自动进行回滚。</p>
<p>可以通过以下链接对 Hg hooks 进行更深入地学习：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.mercurial-scm.org/wiki/hookExamples">hookExamples</a></li>
<li><a target="_blank" rel="noopener" href="https://www.mercurial-scm.org/wiki/Usefulhooks">Usefulhooks</a></li>
<li><a target="_blank" rel="noopener" href="http://hgbook.red-bean.com/read/handling-repository-events-with-hooks.html">Chapter 10. Handling repository events with hooks (red-bean.com)</a></li>
</ul>
<h3 id="Hg-hooks-实践"><a href="#Hg-hooks-实践" class="headerlink" title="Hg hooks 实践"></a>Hg hooks 实践</h3><h4 id="提交代码前（precommit）"><a href="#提交代码前（precommit）" class="headerlink" title="提交代码前（precommit）"></a>提交代码前（precommit）</h4><p>这里需要用到的 hook 是 precommit，它的运行时机在提交之前，exit code 非 0 时将终止提交。</p>
<p> <code>precommit.sh</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">PATH=/usr/local/bin:/opt/homebrew/bin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$SKIP_LINT</span>&quot;</span> = <span class="string">&quot;1&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 需要 lint 的项目</span></span><br><span class="line">apps=(</span><br><span class="line">    <span class="string">&#x27;miniprogram&#x27;</span></span><br><span class="line">    <span class="string">&#x27;dashboard&#x27;</span></span><br><span class="line">    <span class="string">&#x27;core&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> app <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$&#123;apps[@]&#125;</span>&quot;</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="comment"># 判断是否修改该项目，无则跳过 lint</span></span><br><span class="line">    has_change=$(hg status | grep <span class="string">&quot;<span class="variable">$&#123;app&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$has_change</span>&quot;</span> ]; <span class="keyword">then</span> <span class="built_in">continue</span>; <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$app</span>&quot;</span> || <span class="built_in">exit</span> 1</span><br><span class="line"></span><br><span class="line">    yarn &amp;&amp; yarn lint</span><br><span class="line"></span><br><span class="line">    <span class="comment"># lint 是否报错，是则直接退出脚本</span></span><br><span class="line">    <span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span> <span class="built_in">exit</span> 1; <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cd</span> -</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 针对当前修改或新增的文件批量进行 prettier 格式化</span></span><br><span class="line">hg status | grep -E <span class="string">&quot;^(M|A).*.(js|json|wxss)$&quot;</span> | sed <span class="string">&#x27;s|^M||g; s|^A||g&#x27;</span> | xargs ./node_modules/.bin/prettier --write &gt;/dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure>

<p>比较浅显易懂，由于是 Monorepo 架构，所以仅针对当前改动的子项目执行 <code>yarn lint</code> ，当 lint 不通过时终止提交；然后仅对当前变更的文件做 prettier 格式化，并且忽略这行命令的输出和错误。</p>
<p>ps：其实这里的 prettier 机制有点问题，原本的目的是仅格式化当前提交的文件，但 Hg 没有 staging area 的概念，故只能粗暴处理，如果有更好的解决方法欢迎指教。</p>
<ul>
<li>hg commit 可以只提交指定的部分文件，所以是有 changed files 和 commited files 两个概念，但是没有找到办法获取 commited files，参见：<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/24565802/mercurial-pre-commit-hook-how-to-tell-apart-changed-and-committed-files">Mercurial pre-commit hook: How to tell apart changed and committed files - Stack Overflow</a></li>
<li>另一种思路：使用 pretxncommit 钩子，就可通过 $Hg_NODE 变量拿到当前 commit 的信息，但缺点是 pretxncommit 阶段将不能再对文件进行改动，则格式化后需要重新提交一遍。</li>
</ul>
<p>随着版本迭代，在 precommit 钩子中增加了检测 utils、test 目录改动则自动执行单元测试 ：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改以下文件需要执行单元测试</span></span><br><span class="line">apps=(</span><br><span class="line">    <span class="string">&#x27;miniprogram/utils miniprogram/test&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> app <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$&#123;apps[@]&#125;</span>&quot;</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">dir</span>=(<span class="variable">$app</span>)</span><br><span class="line">    pass=0</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$&#123;dir[@]&#125;</span>&quot;</span>; <span class="keyword">do</span></span><br><span class="line">        <span class="comment"># 判断是否修改工具方法、测试用例，无则跳过</span></span><br><span class="line">        has_change=$(hg status | grep <span class="string">&quot;<span class="variable">$&#123;d&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$has_change</span>&quot;</span> ]; <span class="keyword">then</span> <span class="built_in">continue</span>; <span class="keyword">fi</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 同一个项目只执行一次</span></span><br><span class="line">        [ <span class="variable">$pass</span> -eq 1 ] &amp;&amp; <span class="built_in">break</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$d</span>&quot;</span> || <span class="built_in">exit</span> 1</span><br><span class="line">        yarn &amp;&amp; yarn <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># test 是否报错，是则直接退出脚本</span></span><br><span class="line">        <span class="keyword">if</span> [ $? -ne 0 ]; <span class="keyword">then</span> <span class="built_in">exit</span> 1; <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">        pass=1</span><br><span class="line"></span><br><span class="line">        <span class="built_in">cd</span> -</span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h4 id="拉取代码后（changegroup）"><a href="#拉取代码后（changegroup）" class="headerlink" title="拉取代码后（changegroup）"></a>拉取代码后（changegroup）</h4><p>主要想解决的问题是：当拉取代码后，检测到 project-config 目录发生变更，则执行 <code>yarn setup</code>。</p>
<p>首先要解决第一点，如何获取从远端拉取代码所改动的文件？有下面几种方法：</p>
<ol>
<li><p><a target="_blank" rel="noopener" href="https://backend.bolt80.com/hgdoc/hg-incoming.html">hg incoming</a>：显示远端中的新 commit</p>
<ul>
<li>缺点：该方法只是显示新的 commit，后面仍需要再进行一次 pull 才能将新 commit 拉取下来，导致拉取代码时间翻倍。</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://backend.bolt80.com/hgdoc/hg-pull.html">hg pull</a>：在拉取代码之后、进行 update 或 rebase 之前，通过 <code>hg log</code> 对比本地 head 和 远端拉取下来的 head。</p>
</li>
<li><p>hooks：</p>
<ol>
<li>update：工作目录发生改变时，所以只要进行提交、储藏、切换分支都会触发，<strong>不考虑</strong>。</li>
<li>incoming：每一个新的 commit 被传入时都会触发一次，过于频繁，<strong>不考虑</strong>。</li>
<li>changegroup：在 push、pull、unbundle 时都会触发，但多个 commit 被传入也只会触发一次，<strong>可考虑</strong>。</li>
<li>还有一些不太满足的 hooks 不一一介绍了。</li>
</ol>
</li>
</ol>
<p>在一开始，我们曾尝试使用第二种方法解决该问题：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">hgpl</span></span>() &#123;</span><br><span class="line">    no_shelve=$(hg shelve | grep <span class="string">&quot;nothing changed&quot;</span>)</span><br><span class="line"></span><br><span class="line">    hg pull</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 改动文件</span></span><br><span class="line">    regex=<span class="string">&#x27;\bproject-config&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取本次 pull 变更集的改动文件列表，判断是否有改动相关文件</span></span><br><span class="line">    <span class="comment"># @link：https://stackoverflow.com/questions/3277334/what-files-will-be-changed-vs-added-when-i-do-an-hg-pull-and-hg-update</span></span><br><span class="line">    has_change=$(hg <span class="built_in">log</span> --verbose -r .:tip | grep <span class="string">&quot;files:&quot;</span> | grep -E <span class="string">&quot;<span class="variable">$regex</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 参考 hg update --rebase 的实现，先尝试 rebase，如果不需要 rebase，则直接 update</span></span><br><span class="line">    <span class="comment"># @link：https://stackoverflow.com/questions/35327163/what-is-the-rebase-command-used-in-hg-pull-rebase</span></span><br><span class="line">    <span class="comment"># @link：https://www.mercurial-scm.org/repo/hg/file/tip/hgext/rebase.py#l2172</span></span><br><span class="line">    has_rebase=$(hg rebase -b . -d <span class="string">&#x27;last(branch(.))&#x27;</span> | grep <span class="string">&quot;nothing to rebase&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> [ ! -z <span class="string">&quot;<span class="variable">$has_rebase</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        hg update</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 有改动相关文件，需要执行 yarn setup</span></span><br><span class="line">    <span class="keyword">if</span> [ ! -z <span class="string">&quot;<span class="variable">$has_change</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        yarn setup</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 如果之前有 shelve，需要恢复 shelve</span></span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$no_shelve</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        hg unshelve</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个方法可以很好地工作，它可以满足：</p>
<ul>
<li>拉取代码时自动储藏、恢复本地改动</li>
<li>当两端都同时修改 project-config 时，可以 update 或者 rebase 后再统一 <code>yarn setup</code></li>
</ul>
<p>后来发现使用 changegroup  hook 配合 <code>hg log</code> 一样可以解决问题，于是就有了 <code>changegroup.sh</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">PATH=/usr/local/bin:/opt/homebrew/bin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 改动文件</span></span><br><span class="line">regex=<span class="string">&#x27;\bproject-config&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取本次变更集的改动文件列表，判断是否有改动相关文件</span></span><br><span class="line"><span class="comment"># @see：https://stackoverflow.com/questions/3277334/what-files-will-be-changed-vs-added-when-i-do-an-hg-pull-and-hg-update</span></span><br><span class="line">has_change=$(hg <span class="built_in">log</span> -v -r <span class="variable">$Hg_NODE</span>: | grep <span class="string">&quot;files:&quot;</span> | grep -E <span class="string">&quot;<span class="variable">$regex</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 有改动相关文件，需要执行 yarn setup</span></span><br><span class="line"><span class="keyword">if</span> [ ! -z <span class="string">&quot;<span class="variable">$has_change</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">cd</span> $(hg root) || <span class="built_in">exit</span> 1</span><br><span class="line">    yarn setup</span><br><span class="line">    <span class="built_in">cd</span> -</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<p> 因此 <code>hgpl</code> 可以精简成这样：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">hgpl</span></span>() &#123;</span><br><span class="line">    has_shelve=$(hg shelve | grep <span class="string">&quot;nothing changed&quot;</span>)</span><br><span class="line"></span><br><span class="line">    hg pull --rebase</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 如果之前有 shelve，需要恢复 shelve</span></span><br><span class="line">    <span class="keyword">if</span> [ -z <span class="string">&quot;<span class="variable">$has_shelve</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">        hg unshelve</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="commit-message-检查（pretxncommit）"><a href="#commit-message-检查（pretxncommit）" class="headerlink" title="commit message 检查（pretxncommit）"></a>commit message 检查（pretxncommit）</h4><p>使用 pretxncommit 钩子可对当前提交信息进行检查，如检查 commit message：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">PATH=/usr/local/bin:/opt/homebrew/bin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$SKIP_LINT</span>&quot;</span> = <span class="string">&quot;1&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">shelve_user=<span class="string">&quot;shelve@localhost&quot;</span></span><br><span class="line"></span><br><span class="line">commit_user=$(hg tip --template &#123;user&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 因为 hg shelve 也会触发 pretxncommit 钩子，所以要进行忽略</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$commit_user</span>&quot;</span> == <span class="string">&quot;<span class="variable">$shelve_user</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">exit</span> 0</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">commit_message=$(hg tip --template &#123;desc&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[msg] <span class="variable">$commit_message</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$commit_message</span>&quot;</span> | ./node_modules/.bin/commitlint</span><br></pre></td></tr></table></figure>

<h2 id="铁器时代？"><a href="#铁器时代？" class="headerlink" title="铁器时代？"></a>铁器时代？</h2><p>这个标题之所以打上一个问号，是因为该方案仍在 POC 阶段，尚未落地实施，但也可作为一个对未来的展望。</p>
<p>迄今为止，我们的 Hg hooks 已经能够满足大部分场景了，那还存在些什么问题呢？</p>
<p>相信不少同学已经发现这样操作会存在有一个很明显的问题，那就是：hooks 配置如何同步？</p>
<p>我们知道 <code>.hg</code> 目录是不会加入版本控制的，这是非常合理且必要的，因为 hooks 本身是一些权限极高的可执行脚本，所以出于安全考虑（你也不想你 clone 一个仓库后，它会自动执行某些你不想执行的命令），<strong>因此是不会有任何一个 VSC 会将 hooks 加入版本控制的。</strong></p>
<p>可是这就会导致：</p>
<ol>
<li>假如项目新增了一个 hook，需要通知项目成员同步修改本地的 hooks 配置。</li>
<li>新成员加入项目，需要手动配置 hooks。</li>
</ol>
<p>如果这个问题不能得到解决，那归根到底还是无法绕过通知项目成员手动操作的过程。</p>
<p>所幸，以上问题在 Git 中同样存在，并且已经有很多非常成熟的方案，如： <a target="_blank" rel="noopener" href="https://github.com/typicode/husky">huksy</a>、<a target="_blank" rel="noopener" href="https://pre-commit.com/">pre-commit</a> 。</p>
<p>那有没有人在 Hg 生态上解决这个问题呢？粗略找到了两个：</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://github.com/TobiasTimm/husky-hg">husky-hg</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/theylom/tdog-husky-hg">tdog-husky-hg</a>（前者的 fork</li>
</ol>
<p>都是基于 husky <a target="_blank" rel="noopener" href="https://github.com/tobiastimm/husky-hg/commit/fcd100f4f1a7bdf04c05f51ddd80af9f87687ddc#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519R2">v0.14.3</a> 改造的，最后提交时间都在三年前（2019），然而 husky 现在已经迭代到 <a target="_blank" rel="noopener" href="https://github.com/typicode/husky/releases/tag/v7.0.4">v7</a> 版本了，这 3 年间经过无数迭代，使用方式和实现原理都发生翻天覆地的变化，于是我们决定基于 husky v7 自行改造。</p>
<p>但是在此之前，我们先了解一下 Git 如何配置 hooks：</p>
<ol>
<li>在以前的 Git 版本中，如果要配置一个 hooks 则需要在 <code>.git/hooks</code> 目录新增一个 hook 同名的可执行文件，并且出于前面说的安全考虑， <code>.git</code>  目录是不会被加入版本控制的，<strong>因此也存在上面所说的问题</strong>。</li>
<li>在 Git v2.9 以后，支持通过配置 core.hooksPath 自定义项目的 hooks 的存放路径，也即意味着可将 hooks 加入版本控制，项目成员只需要在第一次配置 core.hooksPath 即可，后续增删 hooks 都可直接使用。</li>
</ol>
<p>因为 Git 支持 core.hooksPath ，所以 husky 直接采用了新的实现原理重构：</p>
<ol>
<li><p>在 huksy v4 的时候，由于 Git hooks 目录无法被加入版本控制，它们是这样解决这个问题的：</p>
<ol>
<li>在初始化的时候就在 <code>.git/hooks</code> 目录预先创建所有的 hooks 可执行文件，然后在 hooks 文件中执行定义在 <code>package.json</code> 中的 hooks 命令。</li>
<li>这样很显然可以解决 hooks 无法同步的问题，但是这个实现原理也被不少人诟病，见 <a target="_blank" rel="noopener" href="https://github.com/typicode/husky/issues/260">#260</a> 。</li>
</ol>
</li>
<li><p>由于 Git v2.9 的升级，在 husky v7 中使用了新的实现方式：</p>
<ol>
<li>将 hooks 可执行文件存放在一个可以被进行版本控制的目录（默认是 <code>.husky</code>），然后初始化的时候只需要配置  core.hooksPath 即可。</li>
</ol>
</li>
</ol>
<p>显然，v7 的实现方式更加方便快捷了，除此之外，它们的使用方式也有很大的不同：</p>
<ol>
<li>在 v4 中，通过在 <code>package.json</code>  中配置 <code>husky</code> 字段来定义 hooks。</li>
<li>在 v7 中，<strong>它不再仅限于 Node.js 项目</strong>，可以直接通过 CLI 的方式进行配置，参见：<a target="_blank" rel="noopener" href="https://blog.typicode.com/husky-git-hooks-javascript-config/">Why husky has dropped conventional JS config</a>。</li>
</ol>
<p>在深入了解背后的实现原理后，我们得出了结论：</p>
<ol>
<li>v4 版本的代码<strong>有较多历史包袱，不利于改造，故基于 v7 版本修改</strong>。</li>
<li>但 v7 版本的实现方式对 Hg 并不完全适用，所以需要继续沿用 v4 的部分实现方式，所以这样设计：<ol>
<li>将 hooks 脚本存放在可被版本控制的 <code>.husky</code> 目录</li>
<li>但不通过预注册所有的 hooks 的方式，而是采用按需配置，初始化时根据 <code>.husky</code> 的 hooks 可执行文件列表注入 hooks 配置。<ol>
<li>比如在 Node.js 项目中可以通过 npm 的 <a target="_blank" rel="noopener" href="https://docs.npmjs.com/cli/v8/using-npm/scripts#prepare-and-prepublish">prepare</a> 钩子来自动初始化。</li>
</ol>
</li>
</ol>
</li>
<li>因此，使用方式与 husky <a target="_blank" rel="noopener" href="https://typicode.github.io/husky/">文档</a> 中基本一致。<ol>
<li><code>husky install</code>、<code>husky add .husky/pre-commit</code></li>
</ol>
</li>
</ol>
<p>以上的心路历程、改造进展可以通过这个 <a target="_blank" rel="noopener" href="https://github.com/gd4Ark/husky/pull/1">PR</a> 查看，感兴趣的同学可自行尝试：</p>
<ol>
<li>clone 项目，安装依赖，执行 npm link。</li>
<li>参考  husky <a target="_blank" rel="noopener" href="https://typicode.github.io/husky/">文档</a> 进行使用。</li>
</ol>
<h2 id="背后的一些二三事"><a href="#背后的一些二三事" class="headerlink" title="背后的一些二三事"></a>背后的一些二三事</h2><p>最后分享一些我们在实践 Hg hooks 时的小插曲。</p>
<h3 id="一个隐藏字符引发的前端事故"><a href="#一个隐藏字符引发的前端事故" class="headerlink" title="一个隐藏字符引发的前端事故"></a>一个隐藏字符引发的前端事故</h3><p>有一天下午，在群里收到这么一个反馈：</p>
<img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images202203191549957.jpg"  alt="2471647676117_.pic" style="margin-left: 0;" />

<p>点开大图一看，好家伙！赫然一个「口」字就这么明目张胆地贴在页面的左下角，看它「浓眉大眼」的。</p>
<p>到底是哪里出了问题呢？</p>
<p>仔细看清楚，才发现它其实不是一个「口」字，而是「□」，学名叫做 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-hans/%E8%99%9A%E7%BC%BA%E5%8F%B7">虚缺号</a>，通俗地讲就是一个特殊字符。</p>
<p>于是打开对应的代码文件，果然一个红底白色 BS 字符引入眼帘：</p>
<p><img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images202204042021847.png"></p>
<h4 id="这是-VSCode-的锅？"><a href="#这是-VSCode-的锅？" class="headerlink" title="这是 VSCode 的锅？"></a>这是 VSCode 的锅？</h4><p>在网上有一番搜寻后，发现早就已经有不少人遇到过这个问题：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/wangduanduan/wangduanduan.github.io/issues/158">vscode控制字符引起的问题以及解决思路</a></li>
<li><a target="_blank" rel="noopener" href="https://jiangxiaokun.com/css/2018/11/15/ghost_chars/">隐藏字符引发的血案</a></li>
</ul>
<p>看下他们提供的复现过程：</p>
<p><img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images202203191703719.gif" alt="hmmm"></p>
<p>直接说下这个 Bug 的结论：</p>
<ol>
<li>VSCode 开启 webview 的情况下，使用中文输入法时按下退格键，就会导致出现退格符。</li>
<li>VSCode 底层是 Electron，Electron 底层用的 chromium，这个 BUG 是 chromium 的。</li>
<li>该 BUG 已经在 VSCode v1.4.0 得到修复，参见这个 <a target="_blank" rel="noopener" href="https://github.com/microsoft/vscode/issues/37114#issuecomment-544236959">issue</a>。</li>
</ol>
<p>但既然该问题在 2019 年已经修复，那为什么在 2022 年的今天还会出现这个退格符呢？</p>
<p>由于已经复现不了，根源追求也就只能不了了之，但影响又如此之大，所以我们应该怎么去规避它呢？</p>
<h4 id="规避方案"><a href="#规避方案" class="headerlink" title="规避方案"></a>规避方案</h4><h5 id="利用-VSCode-扩展自动删除"><a href="#利用-VSCode-扩展自动删除" class="headerlink" title="利用 VSCode 扩展自动删除"></a>利用 VSCode 扩展自动删除</h5><p>有一个 VSCode 扩展 <a target="_blank" rel="noopener" href="https://github.com/satokaz/vscode-bs-ctrlchar-remover">Remove backspace control character</a> 专门用于解决此类问题，安装后我们只需要在 setting.json 添加如下配置：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;[wxml]&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;editor.formatOnSave&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;editor.defaultFormatter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;satokaz.vscode-bs-ctrlchar-remover&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>即可在保存代码的时候自动移除这些特殊的隐藏字符。</p>
<p>实现方式主要是通过正则去匹配这类隐藏字符：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/[\u0000]|[\u0001]|[\u0002]|[\u0003]|[\u0004]|[\u0005]|[\u0006]|[\u0007]|[\u0008]|[\u000b]|[\u000c]|[\u000d]|[\u000e]|[\u000f]|[\u0010]|[\u0011]|[\u0012]|[\u0013]|[\u0014]|[\u0015]|[\u0016]|[\u0017]|[\u0018]|[\u0019]|[\u001a]|[\u001b]|[\u001c]|[\u001d]|[\u001e]|[\u001f]|[\u001c]|[\u007f]/gm</span><br></pre></td></tr></table></figure>

<p>在这里查看所有字符的介绍：<a target="_blank" rel="noopener" href="https://www.techonthenet.com/unicode/chart.php">Unicode</a>，本文所出现的 BS 正是 [\u0008]，也就是退格符。</p>
<h5 id="提交代码前自动删除"><a href="#提交代码前自动删除" class="headerlink" title="提交代码前自动删除"></a>提交代码前自动删除</h5><p>更好的方式是：我们可以在 precommit 钩子自动做这件事：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">find . -name <span class="string">&quot;*.wxml&quot;</span> -<span class="built_in">exec</span> perl -i -p -e <span class="string">&quot;s/[\x08]//g&quot;</span> &#123;&#125; +</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这行命令的 time total</span></span><br><span class="line">0.10s user 0.80s system 93% cpu 0.953 total</span><br></pre></td></tr></table></figure>

<h3 id="让-vscode-hg-提交代码时显示-ESLint-报错的规则"><a href="#让-vscode-hg-提交代码时显示-ESLint-报错的规则" class="headerlink" title="让 vscode-hg 提交代码时显示 ESLint 报错的规则"></a>让 vscode-hg 提交代码时显示 ESLint 报错的规则</h3><p>起因是某位同学反映在 vscode-hg 提交代码的时候，无法显示 ESLint 校验不通过的规则提示：</p>
<p><img src="https://gd4ark-1258805822.cos.ap-guangzhou.myqcloud.com/images202203201415448.png" alt="image-20220320141520784"></p>
<p>通常我们提交代码时，如果 yarn lint 不通过，会输出如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ eslint <span class="string">&#x27;**/*.js&#x27;</span> --cache --fix</span><br><span class="line"></span><br><span class="line">/Users/4ark/project/helper/404.js</span><br><span class="line">  9:7  error  <span class="string">&#x27;a&#x27;</span> is assigned a value but never used  no-unused-vars</span><br><span class="line"></span><br><span class="line">✖ 1 problem (1 error, 0 warnings)</span><br><span class="line"></span><br><span class="line">error Command failed with <span class="built_in">exit</span> code 1.</span><br><span class="line">info Visit https://yarnpkg.com/en/docs/cli/run <span class="keyword">for</span> documentation about this <span class="built_in">command</span>.</span><br><span class="line">abort: pre-commit hook exited with status 1</span><br></pre></td></tr></table></figure>

<p>而 vscode-hg 只输出如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">error Command failed with <span class="built_in">exit</span> code 1.</span><br><span class="line">abort: pre-commit hook exited with status 1</span><br></pre></td></tr></table></figure>

<p>不过经测试在 VSCode 中进行 Git 代码提交时并不存在该问题，所以猜测是 vscode-hg 这个扩展的原因。</p>
<p>于是抱着怀疑的态度看一下源码，发现果然如此：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/hg.ts#L620</span></span><br><span class="line"><span class="keyword">if</span> (options.<span class="property">logErrors</span> !== <span class="literal">false</span> &amp;&amp; result.<span class="property">stderr</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;result.stderr&#125;</span>\n`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里只输出了 stderr，但是 ESLint 的规则输出是 stdout。</p>
<p>于是我们为了更好地使用 Hg hooks，让它支持了输出 ESLint 规则，见 <a target="_blank" rel="noopener" href="https://github.com/mrcrowl/vscode-hg/issues/185">#185</a>。</p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>以上就是我们在实践 Hg hooks 过程的一些经历和心得，未必是最佳解决方案，正如文本开头所说，撰写本文的目的是希望能起到抛砖引玉的作用，与大家一起进一步的深入探讨。</p>
<p>对于本文的实践思路、代码实现有任何的意见和建议，都请不吝指教。</p>
<p>最后感谢大家的阅读。</p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2022/03/12/2022-03-12-central-bank/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/03/12/2022-03-12-central-bank/" itemprop="url">央行是干嘛的 - 读《金融的本质》</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-03-12T20:35:36+08:00">
                2022-03-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/summary/" itemprop="url" rel="index">
                    <span itemprop="name">summary</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <img src="/images/financial-crisus.jpg" class="">

<h2 id="一、序"><a href="#一、序" class="headerlink" title="一、序"></a>一、序</h2><p>最近读完了<a target="_blank" rel="noopener" href="https://item.jd.com/12169610.html#none">《金融的本质》</a>，作者是美国的央行—-<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%81%94%E9%82%A6%E5%82%A8%E5%A4%87%E7%B3%BB%E7%BB%9F">美联储</a>的前主席 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%9C%AC%C2%B7%E4%BC%AF%E5%8D%97%E5%85%8B">伯南克</a> 。</p>
<p>伯南克任职期间为 06 ~ 14 年，他任期内美国及全球爆发了严重的经济危机，而他通过降低利率、量化宽松，以及承担最后贷款人职责等手段，有效降低了经济危机对美国的影响。</p>
<p>以下是我的一些笔记。</p>
<h2 id="二、央行的使命"><a href="#二、央行的使命" class="headerlink" title="二、央行的使命"></a>二、央行的使命</h2><p>央行是一个特殊的机构，在伯南克看来，央行主要有两大使命：</p>
<ul>
<li>1、保持经济的稳定增长</li>
<li>2、维持金融的稳定</li>
</ul>
<p>这里面，<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%BB%8F%E6%B5%8E/403149">经济</a>和<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%87%91%E8%9E%8D">金融</a>的差别困扰了我一阵子，原来它俩不是一个意思：</p>
<ul>
<li>经济一般是人类的价值创造过程。所以“保持经济的稳定增长”主要就是指 GDP 能够持续增长，保证就业率，同时维持低通胀。</li>
<li>金融是指对经济活动中对资金本身的一些“交易”，比如银行、证券、保险、债券。所以”金融稳定”就是指各种借贷关系是正常的，没有大面积的违约。</li>
</ul>
<p>那央行有什么特殊的技能，能够达成这两个使命呢？这主要靠国家赋予它的两个特殊的权力：</p>
<ul>
<li>1、制定经济活动中各种规则的能力。比如：调节利率、存款保证金比例、中期借贷便利（MLF）等等。</li>
<li>2、承担最后贷款人责任，为各种金融资产兜底。</li>
</ul>
<p>下面我展开说说我对这两个职责的理解。</p>
<h2 id="三、保持经济的稳定增长"><a href="#三、保持经济的稳定增长" class="headerlink" title="三、保持经济的稳定增长"></a>三、保持经济的稳定增长</h2><p>经济衰退肯定是不好的，因为经济衰退情况下会有大量的失业，通货紧缩。在通货紧缩的时候，因为钱升值了，借贷的人就会发现钱越来越值钱，但是他以前借的 100 万还是需要还 100 万，相当于他的债务内在价值越来越高。这种现象会使得大家更不愿意花钱，带动整体经济进一步下滑。</p>
<h3 id="3-1-降低利率"><a href="#3-1-降低利率" class="headerlink" title="3.1 降低利率"></a>3.1 降低利率</h3><p>面对经济衰退，央行通常的办法就是降低利率，同时减少社会融资成本。美国 08 年经济危机，美联储为了减少社会融资成本，把长期利率降成了 0%。</p>
<h3 id="3-2-量化宽松"><a href="#3-2-量化宽松" class="headerlink" title="3.2 量化宽松"></a>3.2 量化宽松</h3><p>然后美国施行了多轮的量化宽松政策，具体的做法是购买了大量的国债。大量的国债被购买后，市场上流通的债券就只剩利率更低的企业债等产品，这样就可以带动社会各种借贷的利率下降，从而刺激经济活动。</p>
<p>在本书中，伯南克否认量化宽松政策是“直接印钱”（书中第132页），因为：</p>
<ul>
<li>钱是从存款保证金余额中借出来的。</li>
<li>量化宽松主要购买的是国债，国债到期后可以将本金及利息收回。</li>
</ul>
<p>但是，量化宽松到期后能不能把钱全部收回，也取决于到时的政府财政状态，如果经济没有好转，大家还是缺钱，这样就只能到期继续购买国债，相当于往市场中注入了收不回来的现金。</p>
<h3 id="3-3-直接印钱"><a href="#3-3-直接印钱" class="headerlink" title="3.3 直接印钱"></a>3.3 直接印钱</h3><p>刺激经济的手段还有直接印钱。</p>
<p>印来的钱可以直接发给大家。比如：2020 年，美国总统特朗普的 2 万亿美元的财政刺激计划里面，就有 2500 亿发给了个人。其中年收入低于 7.5 万美元的单身人员将获得 1200 美元。</p>
<p>印来的钱也可以用来加大基础建设投资，我国面对 08 年金融危机时提出的 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%9B%9B%E4%B8%87%E4%BA%BF%E6%8A%95%E8%B5%84%E8%AE%A1%E5%88%92">四万亿投资计划</a> 就是这样的例子。</p>
<p>基础建设的投资可以带动上下游产业，从而把印出来的钱转变成大家的工资，进而刺激消费。但是这种行为多少还是会带来一定程度的通货膨胀。我为此专门查了一下中国的 CPI 数据，当时 CPI 在 08 年上升到 5.9%，但是后面迅速回落了，可见政府对价格的调整做得还是挺好的。</p>
<img src="/images/china-cpi.jpg" class="">


<h3 id="3-4-对面经济泡沫"><a href="#3-4-对面经济泡沫" class="headerlink" title="3.4 对面经济泡沫"></a>3.4 对面经济泡沫</h3><p>经济过热也是不好的，如果央行觉得经济泡沫太多，就会想办法抑制投资，给经济降温。常见的办法就是刺激经济的逆操作：加息，提高存款保证金，退出量化宽松政策等。</p>
<h3 id="3-5-CPI-多少是合适的"><a href="#3-5-CPI-多少是合适的" class="headerlink" title="3.5 CPI 多少是合适的"></a>3.5 CPI 多少是合适的</h3><p>书中关于这个有不少讨论，但并没有提供详细的精算过程。核心就是：既要保证为波动留够安全边际，保证不会通缩；又要不能太高，带来泡沫。最终实践出来的物价稳定的低通胀率是 2%。</p>
<p>拿这个标准来看，中国过去 5 年做得都是比较优秀的，除了疫情等原因外，中国在 16 - 19年的 CPI 都稳定在 2% 左右。</p>
<img src="/images/china-cpi-2.jpg" class="">

<h2 id="四、最后贷款人"><a href="#四、最后贷款人" class="headerlink" title="四、最后贷款人"></a>四、最后贷款人</h2><p>最后贷款人是一种安全机制，让大家可以安心地把钱放在各种金融机构中。</p>
<p>我稍微展开解释一下：</p>
<blockquote>
<p>银行收到大家的存款后，其实是会借贷给需要的企业或个人，大家的存款很多是短期的，而借贷很多是长期的。比如我自己的房贷，就是 30 年的，但是我存在银行的定期，大多是一年期的。这就造成了资金的错配。</p>
<p>资金的错配使得如果大家都到银行挤兑的话，银行是不可能拿出那么多现金来的。如果银行为了强行付钱来快速变卖资产或债务，就会造成资产价格的下降，进一步冲击经济。</p>
<p>所以，央行就承担起最后贷款人的责任，当真的发生挤兑的时候，央行可以直接拿银行的资产当作抵押，为银行提供现金。</p>
</blockquote>
<p>以上只是一种理论情况。当你相信央行会行使最后贷款人责任的时候，你就建立了资金的安全感，从而挤兑行为就不会发生了。</p>
<p>在实操中，国内确实出现过银行倒闭的现象：2020 年<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%8C%85%E5%95%86%E9%93%B6%E8%A1%8C">包商银行</a> 破产，央行就承担起了最后贷款人责任，为民众的存款提供保障。</p>
<p>但是根据<a target="_blank" rel="noopener" href="http://www.gov.cn/zhengce/content/2015-03/31/content_9562.htm">《存款保险条例》</a>，存款保险实行限额偿付，最高偿付限额为人民币 50 万元。所以超过 50 万以上的存款还是无法赔付。个人如果有大量的存款，可以考虑分散到多家银行中。</p>
<p>另外保险和理财产品大多数是银行代销，其实并不属于银行的自营业务，在发生风险的时候，也无法按照《存款保险条例》赔付。</p>
<p>比如之前大量的 P2P 理财产品暴雷，就不能指望央行来承担最后贷款人责任。</p>
<h2 id="五、小结"><a href="#五、小结" class="headerlink" title="五、小结"></a>五、小结</h2><p>作为独立机构，央行的使命是维持经济和金融稳定，保证就业率和低通胀率。它通过调节利率、调节存款保证金、逆回购、调节 MLF、购买国债、增发货币、承担最后贷款人等方式来实现以上目标。</p>
<h2 id="六、参考资料"><a href="#六、参考资料" class="headerlink" title="六、参考资料"></a>六、参考资料</h2><ul>
<li>经济的定义：<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%BB%8F%E6%B5%8E/403149">https://baike.baidu.com/item/%E7%BB%8F%E6%B5%8E/403149</a></li>
<li>金融的定义：<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%87%91%E8%9E%8D">https://zh.wikipedia.org/wiki/%E9%87%91%E8%9E%8D</a></li>
<li>量化宽松的定义：<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%87%8F%E5%8C%96%E5%AE%BD%E6%9D%BE/9019987">https://baike.baidu.com/item/%E9%87%8F%E5%8C%96%E5%AE%BD%E6%9D%BE/9019987</a></li>
<li>中央人民政府网站公布的核心经济数据：<a target="_blank" rel="noopener" href="http://www.gov.cn/shuju/hgjjyxqk/detail.html?q=1">http://www.gov.cn/shuju/hgjjyxqk/detail.html?q=1</a></li>
<li>四万亿投资计划：<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%9B%9B%E4%B8%87%E4%BA%BF%E6%8A%95%E8%B5%84%E8%AE%A1%E5%88%92">https://zh.wikipedia.org/wiki/%E5%9B%9B%E4%B8%87%E4%BA%BF%E6%8A%95%E8%B5%84%E8%AE%A1%E5%88%92</a></li>
<li>常听到的“MLF操作”，对我们到底有啥影响: <a target="_blank" rel="noopener" href="https://m.21jingji.com/article/20210522/herald/ff87816c4132382ef27b46127121c1a1.html">https://m.21jingji.com/article/20210522/herald/ff87816c4132382ef27b46127121c1a1.html</a></li>
<li>逆回购：<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%80%86%E5%9B%9E%E8%B4%AD/2612290">https://baike.baidu.com/item/%E9%80%86%E5%9B%9E%E8%B4%AD/2612290</a></li>
<li>《存款保险条例》: <a target="_blank" rel="noopener" href="http://www.gov.cn/zhengce/content/2015-03/31/content_9562.htm">http://www.gov.cn/zhengce/content/2015-03/31/content_9562.htm</a></li>
</ul>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-weekly" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/post/weekly-04.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/post/weekly-04.html" itemprop="url">周刊第4期：独立思考</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-03-12T00:00:00+08:00">
                2022-03-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <h2 id="本周做了啥"><a href="#本周做了啥" class="headerlink" title="本周做了啥"></a>本周做了啥</h2><p>给日常使用的 <a target="_blank" rel="noopener" href="https://github.com/mrcrowl/vscode-hg">vscode-hg</a> 扩展提了两个没什么技术含量的 PR，顺便蹭了一个 contributor：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/mrcrowl/vscode-hg/pull/184">docs: typo lineAnnotationEnabled option</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/mrcrowl/vscode-hg/pull/185">feat: output stdout</a></li>
</ul>
<h2 id="分享文章"><a href="#分享文章" class="headerlink" title="分享文章"></a>分享文章</h2><blockquote>
<p>一些本周阅读过的好文章、以及我的一些总结和个人思考；非常建议你直接阅读原文，毕竟一千个读者就有一千个哈姆雷特，而且我的理解可能是错的。</p>
</blockquote>
<h3 id="useMemo-和-useCallback-之间的深入比较"><a href="#useMemo-和-useCallback-之间的深入比较" class="headerlink" title="useMemo 和 useCallback 之间的深入比较"></a><a target="_blank" rel="noopener" href="https://www.chakshunyu.com/blog/a-deep-dive-comparison-between-usememo-and-usecallback/">useMemo 和 useCallback 之间的深入比较</a></h3><p><em>原文地址：<a target="_blank" rel="noopener" href="https://www.chakshunyu.com/blog/a-deep-dive-comparison-between-usememo-and-usecallback/">《A Deep Dive Comparison Between useMemo And useCallback》 | Technical Blog</a></em></p>
<ul>
<li>它们的目的：都是通过缓存提高性能，避免组件重复渲染</li>
<li>相似之处：<ul>
<li>用法一致：与所有 hooks 一样，只能在组件的顶层调用</li>
<li>接收的参数一致：第一个为函数，第二个为依赖项</li>
<li>功能一致：返回缓存过的值，检测到依赖性发生时重新计算并缓存</li>
</ul>
</li>
<li>区别：<ul>
<li>它们表面上没有真正的区别</li>
<li>它们的内部实现也基本一致</li>
<li>使用场景的区别：<code>useCallback</code> 缓存函数，而 <code>useMemo</code> 缓存其它类型</li>
<li>实现原理的区别：<code>useCallback</code> 是缓存函数本身，而 <code>useMemo</code> 是缓存函数的返回值。</li>
</ul>
</li>
</ul>
<p>以下是它们的实现方式：</p>
<ul>
<li>useCallback</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> updateCallback&lt;T&gt;(<span class="attr">callback</span>: T, <span class="attr">deps</span>: <span class="title class_">Array</span>&lt;mixed&gt; | <span class="keyword">void</span> | <span class="literal">null</span>): T &#123;</span><br><span class="line">  <span class="keyword">const</span> hook = <span class="title function_">updateWorkInProgressHook</span>();</span><br><span class="line">  <span class="keyword">const</span> nextDeps = deps === <span class="literal">undefined</span> ? <span class="literal">null</span> : deps;</span><br><span class="line">  <span class="keyword">const</span> prevState = hook.<span class="property">memoizedState</span>;</span><br><span class="line">  <span class="keyword">if</span> (prevState !== <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nextDeps !== <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> <span class="attr">prevDeps</span>: <span class="title class_">Array</span>&lt;mixed&gt; | <span class="literal">null</span> = prevState[<span class="number">1</span>];</span><br><span class="line">      <span class="keyword">if</span> (<span class="title function_">areHookInputsEqual</span>(nextDeps, prevDeps)) &#123;</span><br><span class="line">        <span class="keyword">return</span> prevState[<span class="number">0</span>];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  hook.<span class="property">memoizedState</span> = [callback, nextDeps];</span><br><span class="line">  <span class="keyword">return</span> callback;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>useMemo</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> updateCallback&lt;T&gt;(<span class="attr">callback</span>: T, <span class="attr">deps</span>: <span class="title class_">Array</span>&lt;mixed&gt; | <span class="keyword">void</span> | <span class="literal">null</span>): T &#123;</span><br><span class="line">  <span class="keyword">const</span> hook = <span class="title function_">updateWorkInProgressHook</span>();</span><br><span class="line">  <span class="keyword">const</span> nextDeps = deps === <span class="literal">undefined</span> ? <span class="literal">null</span> : deps;</span><br><span class="line">  <span class="keyword">const</span> prevState = hook.<span class="property">memoizedState</span>;</span><br><span class="line">  <span class="keyword">if</span> (prevState !== <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nextDeps !== <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> <span class="attr">prevDeps</span>: <span class="title class_">Array</span>&lt;mixed&gt; | <span class="literal">null</span> = prevState[<span class="number">1</span>];</span><br><span class="line">      <span class="keyword">if</span> (<span class="title function_">areHookInputsEqual</span>(nextDeps, prevDeps)) &#123;</span><br><span class="line">        <span class="keyword">return</span> prevState[<span class="number">0</span>];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  hook.<span class="property">memoizedState</span> = [callback, nextDeps];</span><br><span class="line">  <span class="keyword">return</span> callback;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="初级开发人员如何为新团队提供价值"><a href="#初级开发人员如何为新团队提供价值" class="headerlink" title="初级开发人员如何为新团队提供价值"></a><a target="_blank" rel="noopener" href="https://www.chakshunyu.com/blog/how-you-as-a-junior-developer-can-immediately-provide-value-when-joining-a-team/">初级开发人员如何为新团队提供价值</a></h3><p><em>原文地址：<a target="_blank" rel="noopener" href="https://www.chakshunyu.com/blog/how-you-as-a-junior-developer-can-immediately-provide-value-when-joining-a-team/">《How You As a Junior Developer Can Immediately Provide Value When Joining a Team》 | Technical Blog</a></em></p>
<ul>
<li><strong>初级开发人员并不意味着不能提供价值：</strong>相反，初级开发人员可以给团队带来很多东西。</li>
<li><strong>质疑现状：</strong>如果一个团队长期合作，人们会开始接受彼此的缺点，习惯于某种风格和工作方式，也就会陷入舒适区，这可能会使团队停滞不前。所以你需要保持批判性，寻找团队懒惰、坏习惯、效率低下或者可以改进的地方，并且付诸行动去改变现状。</li>
<li><strong>新鲜血液：</strong>任何一个项目组都不可能每时每刻使用最新的技术、工具，可能会使得团队成员没有动力跟上最先进的技术，陷入一种恶性循环之中。你作为一个团队的新成员，可能你反而会在当前领域了解更多最先进的技术和工具，从而打破团队的恶性循环。</li>
<li><strong>意识到团队沟通的问题：</strong>长期合作的团队可能面临习惯现有的沟通方式，会自动忽略对方的缺陷，导致缺乏真正的沟通。而你能够意识到这些问题，并帮助团队提高这方面的效率。</li>
<li><strong>挑战团队现有的知识</strong>：每个团队内部都有一些的解决方案或流程，并且习惯于此，而你可以提出更多潜在的替代方案，帮助团队寻找更优的解决方案。</li>
</ul>
<h4 id="个人思考"><a href="#个人思考" class="headerlink" title="个人思考"></a>个人思考</h4><p>作为一名初级开发人员可能认为自己只能负责最简单的一部分业务，并没有意识到自己能给团队带来这么多价值，但其实你可以通过你作为一个新成员的位置，去发现你刚加入的团队一些不好的习惯，通过正确的心态和行动去改变现状。</p>
<h3 id="你的代码不必完美无缺"><a href="#你的代码不必完美无缺" class="headerlink" title="你的代码不必完美无缺"></a><a target="_blank" rel="noopener" href="https://www.chakshunyu.com/blog/your-code-doesnt-have-to-be-perfect/">你的代码不必完美无缺</a></h3><p><em>原文地址：<a target="_blank" rel="noopener" href="https://www.chakshunyu.com/blog/your-code-doesnt-have-to-be-perfect/">《Your Code Doesn’t Have to Be Perfect》 | Technical Blog</a></em></p>
<p>作者通过一段经历，讲述他在实现某个功能时，由于想要实现最佳的解决方案，一开始就花费了大量的时间去进行完美的设计、抽象和封装，结果一个星期的时间没有任何真正的业务产出。</p>
<p>以下是作者一些教训：</p>
<ul>
<li><strong>不要从开始就重构：</strong>不需要刚开始就寻找最优的实现方式，这会让你过早地陷入到某个细节当中，把大量的时间花费在无意义的抽象中。</li>
<li><strong>复制粘贴还不错：</strong>我们应该坚持 DRY（不要重复你自己），但这不应该是起点，而是最终目标。可以在刚开始时通过复制粘贴实现功能，但这不意味着它就是最终上线的代码，而是在这个功能工作之后，再通过重构来提高代码质量。</li>
<li><strong>真正的重构需要适当的知识：</strong>通过改进现有的代码会使你的重构过程更加高效，因为这时候你已经掌握了更多的信息，可以更好地了解哪些代码是有意义的抽象。</li>
</ul>
<h4 id="个人思考-1"><a href="#个人思考-1" class="headerlink" title="个人思考"></a>个人思考</h4><p>每个开发者都经历过这个阶段，想要一开始就设计好所有的细节、编写最完美的代码，但这是不可能的，所有代码都是经过不断地重构。你的代码不必在一开始就完美无缺，在生产项目中更是如此，毕竟不存在没有 deadline 的项目，只要懂得这个道理，你的工作效率会大大提高。</p>
<h3 id="关于编写可读代码的最重要的事情"><a href="#关于编写可读代码的最重要的事情" class="headerlink" title="关于编写可读代码的最重要的事情"></a><a target="_blank" rel="noopener" href="https://www.chakshunyu.com/blog/the-most-important-thing-i-learned-about-writing-readable-code/">关于编写可读代码的最重要的事情</a></h3><p>原文地址：<a target="_blank" rel="noopener" href="https://www.chakshunyu.com/blog/the-most-important-thing-i-learned-about-writing-readable-code/">《The Most Important Thing I Learned About Writing Readable Code》</a></p>
<p>编写代码时最重要的是可读性，一段难以理解的代码，即使你已经知道它的目的，你也很难理解它。所以编写具有可读性的代码是非常必要的。</p>
<p>已经有非常多的经典书籍在探讨这个话题，例如：</p>
<ul>
<li>《代码大全》</li>
<li>《重构》</li>
<li>《代码整洁之道》</li>
</ul>
<p>本文作者之前也写过几篇关于代码可读性的文章，不过我认为大部分已经是老生常谈了：</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://blog.logrocket.com/write-more-readable-react-code/">《如何编写更具可读性的 React 代码》</a></p>
<ul>
<li><strong>代码长度：</strong>更短的代码通常更容易阅读，但有时候并非如此。所以要根据场景，代码并不是越短越好。</li>
<li><strong>代码分组：</strong>将特定上下文的代码组合在一起，使得阅读性更高。React 的自定义组件、Hook 就是做这件事情。</li>
<li><strong>复杂的 JavaScript 结构：</strong>不是所有人都完全熟悉 JavaScript 的语言特性，如果依赖某些特性的固定或隐式行为，会使某些对 JavaScript 不太熟悉的开发人员难以理解这些代码。作者还特地拿 <code>Array.reduce</code> 来举了个例子，认为使用 <code>Array.reduce</code> 虽然可以让代码更加紧凑，但内部需要跟踪太多细节，如果直接使用 <code>for-loop</code> 会使代码更具有可读性。</li>
<li><strong>条件运算符 &amp;&amp;：</strong>这种短路的隐式行为没有 if-else 的可读性高。</li>
<li><strong>一次处理多种情况：</strong>例如在同一个 <code>useEffect</code> 处理多个 deps，会使代码更加混乱。</li>
<li><strong>变量命名：</strong>计算机两大难题之一，这个命题有点大。</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.chakshunyu.com/blog/6-concrete-tips-that-will-make-your-react-pull-requests-easier-to-review/">《6 个技巧使你的 PR 更容易被 Review》</a></p>
<ul>
<li><strong>PR 的用途</strong>：Why、How</li>
<li><strong>分享视觉变化的屏幕截图</strong>：根据代码变更很难想象视觉的变化，所以展示一个截图可以帮助 Reviewer 更快地知道界面变化。</li>
<li><strong>列出功能要求</strong>：列出你想要实现的功能预期，否则很难通过代码上下文去预测你的实现是否正确、或者还有更优的解决方案。</li>
<li><strong>列出新的依赖</strong>：如果新增了依赖，你是如何决定采用哪一个库的。</li>
<li><strong>避免复杂的代码实现</strong></li>
<li><strong>提供有关如何 Review 的其他说明</strong>：告诉 Reviewer 从哪里开始 Review。</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.chakshunyu.com/blog/this-is-my-10-questions-react-code-reviewing-routine/">《帮助你对 React 代码进行 Review 的 10 个问题》</a></p>
<ul>
<li>代码是否正常工作？</li>
<li>我明白了发生了什么吗？</li>
<li>代码是否可读？</li>
<li>组件或 Hook 是否做得太多？</li>
<li>这必须是组件或者 Hook 吗？</li>
<li>这个 API 设计可以简化吗？</li>
<li>有测试吗？</li>
<li>测试有意义吗？</li>
<li>这个功能的辅助功能方面如何？</li>
<li>是否更新了相应的文档？</li>
</ul>
</li>
</ul>
<p>但作者认为有一件更重要的事情被忽略了，那就是：<strong>沟通。</strong></p>
<p>每个人对于「代码是否具有可读性」的理解都不一样，所以日常中经常会出现下面这种对话：</p>
<ul>
<li>“你觉得这段代码非常难以阅读，但我认为它很容易。”</li>
<li>“我不同意，我经常使用这种实现方式，但理解它并没有难度。”</li>
<li>“使用这种方式实现，而不是你提供的那种方式实现，意味着我们不需要担心 xxx，可以使代码更短。”</li>
</ul>
<p>这种回答并非完全没有道理的，但它们都有共同点：<strong>他们之所以不同意使用这种实现会使代码可读性更差，是因为他们觉得自己能够理解这样的代码。</strong></p>
<p>的确，他们确实非常熟悉这段代码是如何工作的，但他们搞错了一件事：<strong>他们认为我是因为理解不了这段代码，才觉得这段代码难以阅读。</strong></p>
<p>然而事实并非如此，因为问题的根本在于：<strong>代码的可读性与你无关，而是与其他人有关，准确地说，是与未来接手这段代码的人有关，甚至这个人很可能就是六个月后的自己。</strong></p>
<p>所以，你要为他们编写具有可读性的代码。</p>
<h4 id="个人思考-2"><a href="#个人思考-2" class="headerlink" title="个人思考"></a>个人思考</h4><p>首先我需要说明，我并不认同作者提到的「 <code>for-loop</code> 可读性比 <code>Array.reduce</code> 好」这个结论，我认为 <code>Array.reduce</code> 与 <code>forEach</code>、<code>map</code> 这些标准方法并无不同，不是 JavaScript 的糟粕，甚至是精华部分；另外 <code>Array.reduce</code>  真正需要考虑的细节也不多，只要熟悉递归思想，它其实很好理解。</p>
<p>除此之外的大部分观点我都是非常认同的，特别是本文讲到的「沟通」二字。我曾待过一个团队，当时合并代码前是需要两人交叉 Review 的，也遇到过几次关于「这样实现的可读性好不好」的问题展开讨论，基本都是各执一词，往往这种时候都需要一个第三者来进行判断，由这个人决定采用哪一种实现。</p>
<p>还记得有一次更离谱，某位同学酷爱使用位运算符，他对此给出的理由是：这样实现会使代码更快。</p>
<p>首先我并不认同这种说法，因为他没有给出专业的对比分析，即便这是真的，但在我们负责的这种 Web 项目中，这种速度的提升简直是可以忽略不计的，所以我就「可读性」本身这件事与他讨论，结果他开始和我解释这个位运算符是如何工作的，这位同学就犯了上面提到的问题，其实我不是不理解位运算符如何工作，我还曾写过一篇《<a target="_blank" rel="noopener" href="https://4ark.me/post/learn-bitwise-operators.html">深入理解按位操作符</a>》的文章，我只是单纯认为不应该在项目中使用位运算符罢了。</p>
<h2 id="有趣的链接"><a href="#有趣的链接" class="headerlink" title="有趣的链接"></a>有趣的链接</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://www.aisixiang.com/">爱思想</a>：华语圈内最具原创性和思想性的公益纯学术网站，有人文社科各领域、人品和作品均有一定高度的学者的大量访谈记录、论文等，可帮助你提高独立思考的能力。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.allhistory.com/">全历史</a>：在全历史 App 或网站里，你可以按照时间轴、关系图谱、时间地图查看各国，各个历史时期的历史相关内容。</p>
</li>
<li><p>在信息爆炸的今天，充斥着大量的虚假信息，这里推荐一些事实核查网站帮助你快速辨别信息真伪：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://chinafactcheck.com/">有据</a></li>
<li><a target="_blank" rel="noopener" href="https://tfc-taiwan.org.tw/">台湾事实核查中心</a></li>
<li><a target="_blank" rel="noopener" href="https://www.politifact.com/">PolitiFact</a></li>
<li><a target="_blank" rel="noopener" href="https://www.truthorfiction.com/">Truth or Fiction</a></li>
<li><a target="_blank" rel="noopener" href="https://www.factcheck.org/">FactCheck.org</a></li>
<li><a target="_blank" rel="noopener" href="https://factcheck.afp.com/">Fact Check</a></li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2022/03/10/2022-03-10-china-revolution-insight/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/03/10/2022-03-10-china-revolution-insight/" itemprop="url">理解改革开放 - 读《置身事内》</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-03-10T23:04:38+08:00">
                2022-03-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/summary/" itemprop="url" rel="index">
                    <span itemprop="name">summary</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <h2 id="一、序"><a href="#一、序" class="headerlink" title="一、序"></a>一、序</h2><p>最近看完了一本讲中国政府与经济发展的书，叫<a target="_blank" rel="noopener" href="https://book.douban.com/subject/35546622/">《置身事内》</a>，作者是复旦大学经济学院副教授兰小欢。</p>
<p>这本书一开始看就停不下来了。原来过去几十年，中国遇到了这么多发展问题，中央政府通过不停地改革试错，摸着石头过河，保证了中国经济的持续发展。</p>
<p>了解完当时的背景，“置身事内”之后，你很容易就理解各种政策背后的原因了，有一种恍然大悟的感觉。</p>
<p>以下是一些笔记。</p>
<h2 id="二、从财政包干到分税制"><a href="#二、从财政包干到分税制" class="headerlink" title="二、从财政包干到分税制"></a>二、从财政包干到分税制</h2><p>书中详细介绍了国内改革开放后，做得比较成功的经济改革。</p>
<p>第一次改革，是 1985 年开始的财政包干制度。不同于之前的大锅饭，全国各地搞承包责任制，提高生产积极性。</p>
<p>大锅饭因为干好干坏一个样，极大地损害了大家的劳动积极性。所以很容易就想到了通过多劳多得来刺激大家的积极性。</p>
<p>但这样的制度落地，其实也是不容易的。因为当年这种行为被左派指责为走资本主义。邓小平的用“不管黑猫白猫，抓到耗子就是好猫”来鼓励大家尝试，让大家把重点放到如何有效改善人民的生活水平上。</p>
<p>于是，在 20 世纪 80 年代，农村搞土地承包，城市搞企业承包，政府搞财政承包。</p>
<p>在那个年代，财政包干制度有效促进了经济发展。但是到了 90 年代，承包制的问题开始凸显：</p>
<ul>
<li>承包制让地方收入越来越大，中央缺钱。</li>
<li>地方有隐匿收入的动力。通过计划外收入，违规减税等方式将企业利润留给自己，不分给中央。</li>
<li>因为地方企业所得税归地方，造成地方保护主义盛行，不利于构建全国统一市场。</li>
</ul>
<p>以上的问题主要是体现在增值税和企业所得税。具体的改革如下：</p>
<ul>
<li>1994 年进行了增值税的改革。增值税以前由地方独占，改成中央 75%，地方 25%。并且中央通过“返还”保证不比以前少。</li>
<li>2002 年进行了企业所得税改革。地方企业税收以前归地方，现在改成中央 60%，地方 40%。中央通过“返还”过渡。</li>
</ul>
<p>分税制是 20 世纪 90 年代推行的根本性改革之一，也是最为成功的改革之一。改革扭转了“两个比重”不断下滑的趋势：</p>
<ul>
<li>中央占全国预算收入的比重从改革前的 22％ 一跃变成 55%，并长期稳定在这一水平；</li>
<li>国家预算收入占 GDP 的比重也从改革前的 11％ 逐渐增加到了 20％ 左右。</li>
</ul>
<p>最近正值两会召开，从政府工作报告中，我们能看到 2021 年的国家预算收入 20 万亿，占 114 万亿 GDP 的 17%。可见分税制改革一直有效地保证着国家预算收入的稳定。</p>
<p>经济改革一直在持续，书中没有提到的是：在 2016 年，为了避免重复多次计税，减轻制造业的税赋压力，国家将营业税改为增值税，同时将增值税的分成改成中央和地方各 50%，进一步刺激经济健康发展。</p>
<h2 id="三、从分税制到土地财政"><a href="#三、从分税制到土地财政" class="headerlink" title="三、从分税制到土地财政"></a>三、从分税制到土地财政</h2><p>全国预算收入是不包括卖地收入，卖地收入被统计在政府性基金收入中，从《2021年财政收支情况》来看，2021 年有 8.7 万亿的国有土地出让收入。</p>
<p>分税制改革使得中央有钱了，但是地方却很缺钱。这个时候，1998 年的两项改革：取消福利分房和地方政府垄断国有土地出让，使得卖地收入成为地方政府的主要收入来源。</p>
<p>土地财政使得中国加速向城镇化方向发展，同时地方政府可以通过廉价出让工业用地来招商引资，刺激经济、增加税收、解决就业。</p>
<p>因为地方政府需要刺激经济，通过卖地获得的收入，可以通过政府主导的投资，来达成招商引资的目标，带动经济进一步增长。所以，地方政府可以深入介入经济活动中。书中举了京东方等企业的故事，说明政府对于集中力量发展重点产业的优势。</p>
<p>类似的例子我们不断地可以见到，比如特斯拉落户上海的超级工厂，就是一次成功的政府主导的招商引资，带动新能源上下游产业链成长的案例。</p>
<h2 id="四、中国的政治架构"><a href="#四、中国的政治架构" class="headerlink" title="四、中国的政治架构"></a>四、中国的政治架构</h2><p>书中还介绍了中国的政治架构：党委、政府、人大、政协。从中央到省、市、县层层复制同样的架构。党委领导政府、政府具体施政、人大决定法律、政协提意见和建议。</p>
<p>最近北京在开“两会”，就是指全国的人民代表大会和政治协商会议。人大班子每 5 年换届一次，现在是到了第十三届，而人大会议每年开一次，今年（2022年）是第五次会议。</p>
<p>党委和政府的官员通常都是交叉任职，但是又不是绝对的人事重合关系。你可以理解成两个大的不完全相交的圆。</p>
<h2 id="五、小结"><a href="#五、小结" class="headerlink" title="五、小结"></a>五、小结</h2><p>中国改革开放几十年来取得了空前的成功，离不开我们在经济发展上的不断创新和改进。</p>
<p>《置身事内》介绍了中国发展中的历次经济政策调整以及带来的效果，让读者能够理解并且认同到改革的巨大价值。</p>
<p>本书不但有助于大家理解各种经济运行的原理，也有助于理解中国特色社会主义经济环境下，各种改革如何落地。</p>
<p>如果再对比上过去几十年别的国家的经济发展速度，本书还能让读者建立起较强的民族自信和自豪感。因为照搬美国发展模式的一些国家（比如乌克兰），事实证明发展得并不顺利。</p>
<h2 id="六、参考资料"><a href="#六、参考资料" class="headerlink" title="六、参考资料"></a>六、参考资料</h2><p>从本书出发，我也查了一些政府网站的资料，一并分享给大家：</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.stats.gov.cn/tjsj/ndsj/2018/html/zb07.htm">《全国预算收入定义》</a></li>
<li><a target="_blank" rel="noopener" href="http://www.npc.gov.cn/npc/c30834/202008/08bd6bb3168e4916a2da92ac68771386.shtml">《我国的中央和地方财政关系》 </a></li>
<li><a target="_blank" rel="noopener" href="http://gks.mof.gov.cn/tongjishuju/202201/t20220128_3785692.htm">《2021年财政收支情况》 </a></li>
<li><a target="_blank" rel="noopener" href="https://finance.sina.cn/2019-03-21/detail-ihtxyzsk9155411.d.html?vt=4&pos=108">《全国土地收入去年6.5万亿 钱都花去哪了？》</a></li>
<li><a target="_blank" rel="noopener" href="http://www.chinatax.gov.cn/n810341/n810765/n812171/n812680/c1190924/content.html">《中华人民共和国消费税暂行条例》</a></li>
</ul>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2022/03/09/2022/63-%E5%8C%85%E4%B8%80%E9%A1%BF%E8%8A%B9%E8%8F%9C%E9%A5%BA%E5%AD%90%E8%A7%A3%E8%A7%A3%E9%A6%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/03/09/2022/63-%E5%8C%85%E4%B8%80%E9%A1%BF%E8%8A%B9%E8%8F%9C%E9%A5%BA%E5%AD%90%E8%A7%A3%E8%A7%A3%E9%A6%8B/" itemprop="url">包一顿芹菜饺子解解馋</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-03-09T13:00:00+08:00">
                2022-03-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%94%9F%E6%B4%BB/" itemprop="url" rel="index">
                    <span itemprop="name">生活</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
          <p>鉴于近日疫情严峻，我就尽量减少了外出。这几天吃多了外卖，也不得不考虑换换口味了。超市买的速冻饺子大多是韭菜、白菜馅的，不禁让我十分怀念家里妈妈包的芹菜猪肉馅饺子了。所以就在网上买了芹菜、硬豆腐、梅肉、饺子皮准备自己包一顿饺子解解馋（为了减少外出，买菜也网购了，倒也挺方便的）。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2022/03/09/2022/63-%E5%8C%85%E4%B8%80%E9%A1%BF%E8%8A%B9%E8%8F%9C%E9%A5%BA%E5%AD%90%E8%A7%A3%E8%A7%A3%E9%A6%8B/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.feedscoin.com/2022/03/06/2022-3-6-videocover/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逐流小站">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2022/03/06/2022-3-6-videocover/" itemprop="url">电脑上如何给视频设置封面？</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-03-06T23:26:00+08:00">
                2022-03-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5167312561"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
      
      

      
        
        
          
            <p>本文首发于我的公众号「<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/7hH8NbkZ2YT-FOVdSdPHPA">效率工具指南</a>」<br>文&#x2F;彭宏豪    </p>
<p>Hello 各位好，我是小豪。   </p>
<p>用过剪映 App 剪过视频的朋友，可能会留意到时间轴最前面的「<strong>设置封面</strong>」，使用这个功能，可以给视频自定义封面。  </p>
<p><img src="https://article-picbed-1302715071.cos.ap-guangzhou.myqcloud.com/2022/03/06/img096e1d8351a31.jpeg" alt="IMG_096E1D8351A3-1"></p>
<p>在当下信息爆炸的时代，视频封面就像是一个人的颜值，好的封面会有更高的回头率，对应到视频或者其他媒介上，就意味着会有更高的打开率或者播放量。   </p>
<p>所以，如果你想让自己的视频有更高的曝光，设置一个好看的<strong>视频封面</strong>，其重要性不言而喻。</p>
<p>如果你是在手机上剪视频，使用剪映 App 内置的这个功能，就可以很方便地自定义视频封面。   </p>
<p>但如果是换到电脑上，「似乎」就没有很方便地给视频设置封面的工具。  </p>
<p>似乎确实是似乎，不用怀疑，能看到这篇文章，说明我已经找到方法啦。  </p>
<p><img src="https://article-picbed-1302715071.cos.ap-guangzhou.myqcloud.com/2022/03/06/16465779024433.jpg"></p>
<p>今天这篇文章，介绍 个在电脑上给视频设置封面的方法。    </p>
<h2 id="Mac-电脑自带功能"><a href="#Mac-电脑自带功能" class="headerlink" title="Mac 电脑自带功能"></a>Mac 电脑自带功能</h2><p>右击想要自定义封面的视频，点击「<strong>显示简介</strong>」，打开视频的属性面板。   </p>
<p><img src="https://article-picbed-1302715071.cos.ap-guangzhou.myqcloud.com/2022/03/06/16465780869183.jpg"></p>
<p>打开属性面板后，将封面直接拖拽到属性面板左上角的缩略图，就可以替换掉视频原来默认的封面了。   </p>
<p>在 Mac 上更换视频封面，就是这么简单。  </p>
<p><img src="https://article-picbed-1302715071.cos.ap-guangzhou.myqcloud.com/2022/03/06/geng-huan-shi-pin-feng-mian.gif" alt="更换视频封面"></p>
<h2 id="快剪辑"><a href="#快剪辑" class="headerlink" title="快剪辑"></a>快剪辑</h2><p>上面的方法仅适用于苹果电脑，对于使用 Windows 系统的朋友，可以使用另外一个软件——由 360 推出的「<strong>快剪辑</strong>」。  </p>
<p>说到快剪辑，还得提到另外一个熟悉的名字——爱剪辑。</p>
<p>可以这么说，在剪映还没推出电脑版之前，很多人应该都用过这个傻瓜式的剪辑软件，快剪辑应该就是看到爱剪辑火得一塌糊涂之后，顺势推出的（快剪辑上线时间 2017 年）。    </p>
<p>说回正事，快剪辑在导出视频的环节，有一个可<strong>编辑视频封面</strong>的选项，如下图所示，使用这个功能，也可以为视频自定义封面。    </p>
<p><img src="https://article-picbed-1302715071.cos.ap-guangzhou.myqcloud.com/2022/03/06/kuai-jian-ji-she-zhi-shi-pin-feng-mian.png" alt="快剪辑设置视频封面"></p>
<p>值得一提的是，<strong>快剪辑只有 Windows 版本</strong>，Mac 用户无法使用。      </p>
<h2 id="剪映电脑版"><a href="#剪映电脑版" class="headerlink" title="剪映电脑版"></a>剪映电脑版</h2><p>上面介绍的两个方法，还是不够完美，每一个方法都只能在一个平台上使用。   </p>
<p>这里介绍一个终极解决方法，使用剪映电脑版。   </p>
<p>没记错的话，剪映电脑版最开始并没有设置视频封面的功能。   </p>
<p>不过，今晚在写文章之前，我重新打开剪映，意外地发现电脑版也有了和 App 一样的功能。      </p>
<p><img src="https://article-picbed-1302715071.cos.ap-guangzhou.myqcloud.com/2022/03/06/16465795068903.jpg"></p>
<p>视频封面可以来自视频中的某一帧，也可以是从本地导入的图片，导入之后，还可以使用剪映的「编辑」功能，给封面套上内置的模板，让封面变得更好看一些。       </p>
<p><img src="https://article-picbed-1302715071.cos.ap-guangzhou.myqcloud.com/2022/03/06/16465796493150.jpg"></p>
<p><img src="https://article-picbed-1302715071.cos.ap-guangzhou.myqcloud.com/2022/03/06/16465798344893.jpg"></p>
<h2 id="欢迎关注"><a href="#欢迎关注" class="headerlink" title="欢迎关注"></a>欢迎关注</h2><p>以上，就是本次想和你分享的内容，希望能够对你有一点帮助。     </p>
<p><img src="https://article-picbed-1302715071.cos.ap-guangzhou.myqcloud.com/2021/05/28/gong-zhong-hao-wei-bu-er-wei-ma-dailogo.png" alt="公众号：效率工具指南">     </p>

          
        
      
    </div>
    
    
    

    


    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/">&lt;</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/73/">73</a><a class="extend next" rel="next" href="/page/10/">&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">1451</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">71</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">914</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4522670236044605"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-4522670236044605"
     data-ad-slot="5358884258"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Laird Lau</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.4"></script>



  

  

  

  
  

  

  

  

</body>
</html>
